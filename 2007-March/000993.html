<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Windstille-commit] r1340 - in trunk: . html2image media	media/artwork media/images media/images/misc	media/images/tiles media/models/misc	media/models/misc/carseat media/models/vehicles/heavylifter	txt2png windstille/data/images windstille/data/images/tiles
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/windstille-commit/2007-March/index.html" >
   <LINK REL="made" HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r1340%20-%20in%20trunk%3A%20.%20html2image%20media%0A%09media/artwork%20media/images%20media/images/misc%0A%09media/images/tiles%20media/models/misc%0A%09media/models/misc/carseat%20media/models/vehicles/heavylifter%0A%09txt2png%20windstille/data/images%20windstille/data/images/tiles&In-Reply-To=%3C200703211746.l2LHkFm8005559%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000992.html">
   <LINK REL="Next"  HREF="000994.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Windstille-commit] r1340 - in trunk: . html2image media	media/artwork media/images media/images/misc	media/images/tiles media/models/misc	media/models/misc/carseat media/models/vehicles/heavylifter	txt2png windstille/data/images windstille/data/images/tiles</H1>
    <B>grumbel at BerliOS</B> 
    <A HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r1340%20-%20in%20trunk%3A%20.%20html2image%20media%0A%09media/artwork%20media/images%20media/images/misc%0A%09media/images/tiles%20media/models/misc%0A%09media/models/misc/carseat%20media/models/vehicles/heavylifter%0A%09txt2png%20windstille/data/images%20windstille/data/images/tiles&In-Reply-To=%3C200703211746.l2LHkFm8005559%40sheep.berlios.de%3E"
       TITLE="[Windstille-commit] r1340 - in trunk: . html2image media	media/artwork media/images media/images/misc	media/images/tiles media/models/misc	media/models/misc/carseat media/models/vehicles/heavylifter	txt2png windstille/data/images windstille/data/images/tiles">grumbel at mail.berlios.de
       </A><BR>
    <I>Wed Mar 21 18:46:15 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000992.html">[Windstille-commit] r1339 - in trunk/media/models/vehicles: .	artillery battleship cleansweep mech misc rocketlauncher	truck truck2
</A></li>
        <LI>Next message: <A HREF="000994.html">[Windstille-commit] r1341 - in trunk: media media/images	media/images/objects windstille/data/images/objects
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#993">[ date ]</a>
              <a href="thread.html#993">[ thread ]</a>
              <a href="subject.html#993">[ subject ]</a>
              <a href="author.html#993">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: grumbel
Date: 2007-03-21 18:45:59 +0100 (Wed, 21 Mar 2007)
New Revision: 1340

Added:
   trunk/media/images/
   trunk/media/images/misc/
   trunk/media/images/misc/car.xcf
   trunk/media/images/misc/carsketch.xcf
   trunk/media/images/misc/controldialog.xcf
   trunk/media/images/misc/cryo.xcf
   trunk/media/images/misc/elevator.xcf
   trunk/media/images/misc/elevatorbase.xcf
   trunk/media/images/misc/elevatorhead.xcf
   trunk/media/images/misc/elevatorsketch.xcf
   trunk/media/images/misc/elevatorsketchcolor.xcf
   trunk/media/images/misc/elevatorwheel.xcf
   trunk/media/images/misc/generator.xcf
   trunk/media/images/misc/gun.xcf
   trunk/media/images/misc/gun1.xcf
   trunk/media/images/misc/gun3.xcf
   trunk/media/images/misc/gun4.xcf
   trunk/media/images/misc/haus2.xcf
   trunk/media/images/misc/haus3.xcf
   trunk/media/images/misc/hause.xcf
   trunk/media/images/misc/metalwall.xcf
   trunk/media/images/misc/minesketch.xcf
   trunk/media/images/misc/plasmagranate.xcf
   trunk/media/images/misc/policecar.xcf
   trunk/media/images/misc/rifle.xcf
   trunk/media/images/misc/room.xcf
   trunk/media/images/misc/room2.xcf
   trunk/media/images/misc/satchel.xcf
   trunk/media/images/misc/shuttle.xcf
   trunk/media/images/misc/sketchmu.xcf
   trunk/media/images/misc/stairs.xcf
   trunk/media/images/misc/streetlamp.xcf
   trunk/media/images/misc/stuff.xcf
   trunk/media/images/misc/train.xcf
   trunk/media/images/misc/truck.xcf
   trunk/media/images/misc/windstille-logosmall.xcf
   trunk/media/images/misc/windstillelevel.xcf
   trunk/media/images/tiles/
   trunk/media/images/tiles/airport.xcf
   trunk/media/images/tiles/airportbar.xcf
   trunk/media/images/tiles/airportshop.xcf
   trunk/media/images/tiles/apartment-background.xcf
   trunk/media/images/tiles/apartment.xcf
   trunk/media/images/tiles/arboretum.xcf
   trunk/media/images/tiles/bar.xcf
   trunk/media/images/tiles/bluestone.xcf
   trunk/media/images/tiles/building.xcf
   trunk/media/images/tiles/building2.xcf
   trunk/media/images/tiles/column1.xcf
   trunk/media/images/tiles/forestground.xcf
   trunk/media/images/tiles/industrial-doors.xcf
   trunk/media/images/tiles/industrial.xcf
   trunk/media/images/tiles/industrial2.xcf
   trunk/media/images/tiles/industrial3.xcf
   trunk/media/images/tiles/library.xcf
   trunk/media/images/tiles/mine1.xcf
   trunk/media/images/tiles/mine2.xcf
   trunk/media/images/tiles/mine3.xcf
   trunk/media/images/tiles/mineroom.xcf
   trunk/media/images/tiles/prototypes.xcf
   trunk/media/images/tiles/shuttle.xcf
   trunk/media/images/tiles/stairs.xcf
   trunk/media/images/tiles/stonetextures.xcf
   trunk/media/images/tiles/virtualreality-background.xcf
   trunk/media/images/tiles/virtualreality-foreground.xcf
   trunk/media/images/tiles/woodblock.xcf
   trunk/media/images/tiles/workerapartment.xcf
   trunk/media/images/tiles/workerwall.xcf
   trunk/media/images/tiles/yellowstone.xcf
   trunk/media/models/misc/carseat/
   trunk/media/models/misc/carseat/carseat.blend
   trunk/scripts/
Removed:
   trunk/windstille/data/images/car.xcf
   trunk/windstille/data/images/carsketch.xcf
   trunk/windstille/data/images/controldialog.xcf
   trunk/windstille/data/images/cryo.xcf
   trunk/windstille/data/images/elevator.xcf
   trunk/windstille/data/images/elevatorbase.xcf
   trunk/windstille/data/images/elevatorhead.xcf
   trunk/windstille/data/images/elevatorsketch.xcf
   trunk/windstille/data/images/elevatorsketchcolor.xcf
   trunk/windstille/data/images/elevatorwheel.xcf
   trunk/windstille/data/images/generator.xcf
   trunk/windstille/data/images/gun.xcf
   trunk/windstille/data/images/gun1.xcf
   trunk/windstille/data/images/gun3.xcf
   trunk/windstille/data/images/gun4.xcf
   trunk/windstille/data/images/haus2.xcf
   trunk/windstille/data/images/haus3.xcf
   trunk/windstille/data/images/hause.xcf
   trunk/windstille/data/images/metalwall.xcf
   trunk/windstille/data/images/minesketch.xcf
   trunk/windstille/data/images/plasmagranate.xcf
   trunk/windstille/data/images/policecar.xcf
   trunk/windstille/data/images/rifle.xcf
   trunk/windstille/data/images/room.xcf
   trunk/windstille/data/images/room2.xcf
   trunk/windstille/data/images/satchel.xcf
   trunk/windstille/data/images/shuttle.xcf
   trunk/windstille/data/images/sketchmu.xcf
   trunk/windstille/data/images/stairs.xcf
   trunk/windstille/data/images/streetlamp.xcf
   trunk/windstille/data/images/stuff.xcf
   trunk/windstille/data/images/tiles/airport.xcf
   trunk/windstille/data/images/tiles/airportbar.xcf
   trunk/windstille/data/images/tiles/airportshop.xcf
   trunk/windstille/data/images/tiles/apartment-background.xcf
   trunk/windstille/data/images/tiles/apartment.xcf
   trunk/windstille/data/images/tiles/arboretum.xcf
   trunk/windstille/data/images/tiles/bar.xcf
   trunk/windstille/data/images/tiles/bluestone.xcf
   trunk/windstille/data/images/tiles/building.xcf
   trunk/windstille/data/images/tiles/building2.xcf
   trunk/windstille/data/images/tiles/column1.xcf
   trunk/windstille/data/images/tiles/forestground.xcf
   trunk/windstille/data/images/tiles/industrial-doors.xcf
   trunk/windstille/data/images/tiles/industrial.xcf
   trunk/windstille/data/images/tiles/industrial2.xcf
   trunk/windstille/data/images/tiles/industrial3.xcf
   trunk/windstille/data/images/tiles/library.xcf
   trunk/windstille/data/images/tiles/mine1.xcf
   trunk/windstille/data/images/tiles/mine2.xcf
   trunk/windstille/data/images/tiles/mine3.xcf
   trunk/windstille/data/images/tiles/mineroom.xcf
   trunk/windstille/data/images/tiles/prototypes.xcf
   trunk/windstille/data/images/tiles/shuttle.xcf
   trunk/windstille/data/images/tiles/stairs.xcf
   trunk/windstille/data/images/tiles/stonetextures.xcf
   trunk/windstille/data/images/tiles/virtualreality-background.xcf
   trunk/windstille/data/images/tiles/virtualreality-foreground.xcf
   trunk/windstille/data/images/tiles/woodblock.xcf
   trunk/windstille/data/images/tiles/workerapartment.xcf
   trunk/windstille/data/images/tiles/workerwall.xcf
   trunk/windstille/data/images/tiles/yellowstone.xcf
   trunk/windstille/data/images/train.xcf
   trunk/windstille/data/images/truck.xcf
   trunk/windstille/data/images/windstille-logosmall.xcf
   trunk/windstille/data/images/windstillelevel.xcf
Modified:
   trunk/
   trunk/html2image/htmlcreator.cpp
   trunk/html2image/htmlcreator.h
   trunk/media/artwork/
   trunk/media/models/vehicles/heavylifter/heavylifter.blend
   trunk/txt2png/txt2png.cpp
Log:
- moving .xcf files out of the source tree


Property changes on: trunk
___________________________________________________________________
Name: svn:ignore
   - 
autom4te.cache
config.h
config.h.in
config.log
config.status
configure
depcomp
install-sh
Makefile
Makefile.in
missing
mkinstalldirs
old
semantic.cache
src/custom.py
stamp-h1
screenshot.png
.emacs
Jamconfig.in
Jamconfig
build
miniswig
windstille
*.exe
aclocal.m4
autom4te.cache
stuff


   + 
aclocal.m4
autom4te.cache
build
config.h
config.h.in
config.log
config.status
configure
depcomp
.emacs
*.exe
install-sh
Jamconfig
Jamconfig.in
Makefile
Makefile.in
miniswig
missing
mkinstalldirs
old
.sconf_temp/
.sconsign.dblite
screenshot.png
semantic.cache
src/custom.py
stamp-h1
stuff
windstille


Modified: trunk/html2image/htmlcreator.cpp
===================================================================
--- trunk/html2image/htmlcreator.cpp	2007-03-21 15:29:42 UTC (rev 1339)
+++ trunk/html2image/htmlcreator.cpp	2007-03-21 17:45:59 UTC (rev 1340)
@@ -4,10 +4,10 @@
 #include &lt;kapp.h&gt;
 #include &lt;kapplication.h&gt;
 #include &lt;kcmdlineargs.h&gt;
-#define private public
+#define protected public
 #include &lt;khtml_part.h&gt;
 #include &lt;khtmlview.h&gt;
-#undef  private 
+#undef   protected
 #include &lt;kuniqueapplication.h&gt;
 #include &lt;qimage.h&gt;
 #include &lt;qpainter.h&gt;
@@ -21,24 +21,9 @@
 
 QCString output_file;
 QCString input_file;
+QCString debug_file;
+bool verbose = false;
 
-void trim(QImage&amp; img)
-{
-  for(int i = img.height()-1; i &gt;= 0; --i)
-    {
-      uchar* p = img.scanLine(i);
-      int width = img.width();
-      for(int x = 0; x &lt; 4*width; ++x)
-        {
-          if (p[x] != 255)
-            {
-              img = img.copy(0, 0, img.width(), std::max(272, i + 16));
-              return;
-            }
-        }
-    }
-}
-
 int last_empty_line(QImage&amp; img)
 {
   for(int i = img.height()-1; i &gt;= 0; --i)
@@ -125,22 +110,29 @@
     }
 }
 
-HTMLCreator::HTMLCreator(int width, int heigth)
-  : KMainWindow(0L, &quot;HTMLCreator&quot;)
+HTMLCreator::HTMLCreator(int width_, int height_)
+  : KMainWindow(0L, &quot;HTMLCreator&quot;),
+    picture_width(width_),
+    picture_height(height_)
 {
+  if (verbose)
+    std::cout &lt;&lt; &quot;HTMLCreator: &quot; &lt;&lt; width_ &lt;&lt; &quot;x&quot; &lt;&lt; height_ &lt;&lt; std::endl;
+
   QVBox * vbox = new QVBox ( this );
 
   m_html = new KHTMLPart;//(vbox);
+  
   connect(m_html, SIGNAL(completed()), this, SLOT(save()));
+
   m_html-&gt;setJScriptEnabled(false);
   m_html-&gt;setJavaEnabled(false);
   m_html-&gt;setPluginsEnabled(false);
   m_html-&gt;setMetaRefreshEnabled(false);
   m_html-&gt;setOnlyLocalReferences(false);
-  m_html-&gt;setZoomFactor(100);
+  m_html-&gt;setZoomFactor(70);
   //m_html-&gt;getHeight();
-  //m_html-&gt;resize(480,640);
-  m_html-&gt;view()-&gt;resize(480,640);
+  //m_html-&gt;resize(width_, height_);
+  m_html-&gt;view()-&gt;resize(width_,height_);
   
   m_html-&gt;openURL(input_file);
   std::cout &lt;&lt; &quot;Opening: &quot; &lt;&lt; input_file &lt;&lt; std::endl;
@@ -149,7 +141,10 @@
   //  QObject::connect( print, SIGNAL(clicked()), this, SLOT(save()) );
 
   setCentralWidget(vbox);
-  resize(480, 640); // must be same as QPainter size
+  resize(width_, height_); // must be same as QPainter size
+  
+  std::cout &lt;&lt; &quot;HTML::get_width:  &quot; &lt;&lt; m_html-&gt;widget()-&gt;width() &lt;&lt; std::endl;
+  std::cout &lt;&lt; &quot;HTML::get_height: &quot; &lt;&lt; m_html-&gt;widget()-&gt;height() &lt;&lt; std::endl;
 }
 
 HTMLCreator::~HTMLCreator()
@@ -158,9 +153,11 @@
 }
 
 void HTMLCreator::save()
-{
+{ // This get triggered when the 'complete' signal is send
+  if (verbose)
+    std::cout &lt;&lt; &quot;HTMLCreator::save&quot; &lt;&lt; std::endl;
+
   QImage  img;
-  bool more = false;
   int yoff = 0;
   int last_empty = 1; 
   
@@ -168,16 +165,29 @@
   do
     {
       QPixmap pix;
-      pix.resize(480, 2048);
+      pix.resize(picture_width, 2048); // different widths here cause the result to be scaled (ugly)
       pix.fill( QColor( 255, 255, 255 ));
-      //QRect rc(0, -yoff, pix.width(), pix.height()+yoff);
       QRect rc(0, -yoff, pix.width(), pix.height()+yoff);
       QPainter p;
       ////p.setRenderHints()
       p.begin(&amp;pix);
-      m_html-&gt;paint(&amp;p, rc, yoff, &amp;more);
+
+      // Could also use
+      /// m_html-&gt;paint(&amp;p, rc, yoff, &amp;more);
+      // but that causes rendering glitches (lines go missing if they fall on a page break)
+      m_html-&gt;paint(&amp;p, rc, 0, 0);
+      //m_html-&gt;view()-&gt;drawContents(&amp;p, rc.left(), rc.top(), rc.width(), rc.height());
+
       p.end();
 
+      if (0)
+        {
+          std::cout &lt;&lt; &quot;Rect:width:  &quot; &lt;&lt; rc.width() &lt;&lt; std::endl;
+          std::cout &lt;&lt; &quot;Rect:height: &quot; &lt;&lt; rc.height() &lt;&lt; std::endl;
+          std::cout &lt;&lt; &quot;HTML::get_width:  &quot; &lt;&lt; m_html-&gt;widget()-&gt;width() &lt;&lt; std::endl;
+          std::cout &lt;&lt; &quot;HTML::get_height: &quot; &lt;&lt; m_html-&gt;widget()-&gt;height() &lt;&lt; std::endl;
+        }
+
       yoff += pix.height();
   
       img = pix.convertToImage();
@@ -186,10 +196,16 @@
 
       images.push_back(img.copy(0, 0, img.width(), 
                                 std::max(0, std::min(last_empty + 6, img.height()))));
+
+      if (debug_file != &quot;&quot;)
+        {
+          images.back().save(QString(debug_file).arg(images.size(), 4), &quot;PNG&quot;);
+        }
+
+      if (verbose)
+        std::cout &lt;&lt; &quot;HTMLCreator::save: rendering page: &quot; &lt;&lt; images.size() &lt;&lt; &quot; lastempty: &quot; &lt;&lt; last_empty &lt;&lt; std::endl;
     }
-  while(last_empty != 0); //(img.height() &gt; start_height - 100 &amp;&amp; !(start_height &gt; img.height()) &amp;&amp; start_height &lt; 16384);
-      
-  //std::cout &lt;&lt; &quot;Got &quot; &lt;&lt; images.size() &lt;&lt; &quot; pages&quot; &lt;&lt; std::endl;
+  while(last_empty != 0);
 
   int img_width  = 480;
   int img_height = 0;
@@ -199,14 +215,14 @@
   QImage total(img_width, img_height, 32);
 
   int y = 0;
+  // assemble the complete image of a html page
   for(int i = 0; i &lt; (int)images.size(); ++i)
     {
       bitBlt(&amp;total, 0, y, &amp;images[i], 0, 0, -1, -1, 0);
       y += images[i].height();
     }
-
-  //img = img.copy(0, 0, img.width(), std::max(272, last_empty));
-
+  total.save(&quot;/tmp/out.jpg&quot;, &quot;JPEG&quot;, 80);
+  
   if (total.height() &lt; 272)
     { // expant small images to fullscreen
       QImage img(480,272,32);
@@ -219,41 +235,41 @@
     }
   else
     {
-  std::vector&lt;Empty&gt; empties;
-  check_empties(total, empties);
+      std::vector&lt;Empty&gt; empties;
+      check_empties(total, empties);
 
-  // calc page size
-  int num_pages = std::max(int((total.height()/(272*3.0f) + 0.5f)), 1);
-  int page_size = total.height() / num_pages;
-  int current_pos = 0;
-  for(int i = 0; i &lt; num_pages &amp;&amp; current_pos &lt; total.height(); ++i)
-    {
-      int current_page_size;
-      if (i != num_pages-1)
-        current_page_size = find_size(current_pos, page_size, empties);
-      else // last page
+      // calc page size
+      int num_pages = std::max(int((total.height()/(272*1.0f) + 0.5f)), 1);
+      int page_size = total.height() / num_pages;
+      int current_pos = 0;
+      for(int i = 0; i &lt; num_pages &amp;&amp; current_pos &lt; total.height(); ++i)
         {
-          std::cout &lt;&lt; &quot;Last page! &quot; &lt;&lt; current_pos &lt;&lt; &quot; &quot; &lt;&lt; total.height() &lt;&lt; std::endl;
-          current_page_size = total.height() - current_pos;
-        }
+          int current_page_size;
+          if (i != num_pages-1)
+            current_page_size = find_size(current_pos, page_size, empties);
+          else // last page
+            {
+              std::cout &lt;&lt; &quot;Last page! &quot; &lt;&lt; current_pos &lt;&lt; &quot; &quot; &lt;&lt; total.height() &lt;&lt; std::endl;
+              current_page_size = total.height() - current_pos;
+            }
 
-      std::cout &lt;&lt; &quot;Current_Page_Size: &quot; &lt;&lt; current_page_size &lt;&lt; std::endl;
-      if (current_pos + current_page_size &gt; total.height())
-        current_page_size = total.height() - current_pos;
+          std::cout &lt;&lt; &quot;Current_Page_Size: &quot; &lt;&lt; current_page_size &lt;&lt; std::endl;
+          if (current_pos + current_page_size &gt; total.height())
+            current_page_size = total.height() - current_pos;
 
-      if (total.height() - current_pos - current_page_size &lt; 350)
-        { // last page to small, merge with former one
-          current_page_size = total.height() - current_pos;
-        }
+          if (total.height() - current_pos - current_page_size &lt; 350)
+            { // last page to small, merge with former one
+              current_page_size = total.height() - current_pos;
+            }
 
-      QImage page = total.copy(0, current_pos, total.width(), current_page_size);
-      QString out = QString(output_file).arg(i);
-      page.save(out, &quot;JPEG&quot;, 80);
-      std::cout &lt;&lt; &quot;Outfile: &quot; &lt;&lt; out &lt;&lt; std::endl;
+          QImage page = total.copy(0, current_pos, total.width(), current_page_size);
+          QString out = QString(output_file).arg(i, 4);
+          page.save(out, &quot;JPEG&quot;, 80);
+          std::cout &lt;&lt; &quot;Outfile: &quot; &lt;&lt; out &lt;&lt; std::endl;
 
-      current_pos += current_page_size;
+          current_pos += current_page_size;
+        }
     }
-    }
   // Brute force!
   exit(0);
 }
@@ -262,6 +278,8 @@
   {
     { &quot;output &lt;file&gt;&quot;, &quot;Output file&quot;, 0 },
     { &quot;file &lt;file&gt;&quot;,   &quot;A required argument 'file'&quot;, 0 },
+    { &quot;debug &lt;file&gt;&quot;,   &quot;Debug file&quot;, 0 },
+    { &quot;verbose&quot;,       &quot;Verbose output&quot;, 0 },
     { NULL }
   };
   
@@ -279,6 +297,8 @@
 
   output_file = args-&gt;getOption(&quot;output&quot;);
   input_file  = args-&gt;getOption(&quot;file&quot;);
+  debug_file  = args-&gt;getOption(&quot;debug&quot;);
+  verbose     = args-&gt;isSet(&quot;verbose&quot;);
       
   HTMLCreator* html = new HTMLCreator(480, 480);
   app.setMainWidget(html);

Modified: trunk/html2image/htmlcreator.h
===================================================================
--- trunk/html2image/htmlcreator.h	2007-03-21 15:29:42 UTC (rev 1339)
+++ trunk/html2image/htmlcreator.h	2007-03-21 17:45:59 UTC (rev 1340)
@@ -16,6 +16,9 @@
   KHTMLPart *m_html;
   QPushButton *print;
 
+  int picture_width;
+  int picture_height;
+
             public slots:
             void save();
 };


Property changes on: trunk/media/artwork
___________________________________________________________________
Name: svn:ignore
   - old/

   + 
*.blend[1-9]
old
old/
render


Copied: trunk/media/images/misc/car.xcf (from rev 1312, trunk/windstille/data/images/car.xcf)

Copied: trunk/media/images/misc/carsketch.xcf (from rev 1312, trunk/windstille/data/images/carsketch.xcf)

Copied: trunk/media/images/misc/controldialog.xcf (from rev 1312, trunk/windstille/data/images/controldialog.xcf)

Copied: trunk/media/images/misc/cryo.xcf (from rev 1312, trunk/windstille/data/images/cryo.xcf)

Copied: trunk/media/images/misc/elevator.xcf (from rev 1312, trunk/windstille/data/images/elevator.xcf)

Copied: trunk/media/images/misc/elevatorbase.xcf (from rev 1312, trunk/windstille/data/images/elevatorbase.xcf)

Copied: trunk/media/images/misc/elevatorhead.xcf (from rev 1312, trunk/windstille/data/images/elevatorhead.xcf)

Copied: trunk/media/images/misc/elevatorsketch.xcf (from rev 1312, trunk/windstille/data/images/elevatorsketch.xcf)

Copied: trunk/media/images/misc/elevatorsketchcolor.xcf (from rev 1312, trunk/windstille/data/images/elevatorsketchcolor.xcf)

Copied: trunk/media/images/misc/elevatorwheel.xcf (from rev 1312, trunk/windstille/data/images/elevatorwheel.xcf)

Copied: trunk/media/images/misc/generator.xcf (from rev 1312, trunk/windstille/data/images/generator.xcf)

Copied: trunk/media/images/misc/gun.xcf (from rev 1312, trunk/windstille/data/images/gun.xcf)

Copied: trunk/media/images/misc/gun1.xcf (from rev 1312, trunk/windstille/data/images/gun1.xcf)

Copied: trunk/media/images/misc/gun3.xcf (from rev 1312, trunk/windstille/data/images/gun3.xcf)

Copied: trunk/media/images/misc/gun4.xcf (from rev 1312, trunk/windstille/data/images/gun4.xcf)

Copied: trunk/media/images/misc/haus2.xcf (from rev 1312, trunk/windstille/data/images/haus2.xcf)

Copied: trunk/media/images/misc/haus3.xcf (from rev 1312, trunk/windstille/data/images/haus3.xcf)

Copied: trunk/media/images/misc/hause.xcf (from rev 1312, trunk/windstille/data/images/hause.xcf)

Copied: trunk/media/images/misc/metalwall.xcf (from rev 1312, trunk/windstille/data/images/metalwall.xcf)

Copied: trunk/media/images/misc/minesketch.xcf (from rev 1312, trunk/windstille/data/images/minesketch.xcf)

Copied: trunk/media/images/misc/plasmagranate.xcf (from rev 1312, trunk/windstille/data/images/plasmagranate.xcf)

Copied: trunk/media/images/misc/policecar.xcf (from rev 1312, trunk/windstille/data/images/policecar.xcf)

Copied: trunk/media/images/misc/rifle.xcf (from rev 1312, trunk/windstille/data/images/rifle.xcf)

Copied: trunk/media/images/misc/room.xcf (from rev 1312, trunk/windstille/data/images/room.xcf)

Copied: trunk/media/images/misc/room2.xcf (from rev 1312, trunk/windstille/data/images/room2.xcf)

Copied: trunk/media/images/misc/satchel.xcf (from rev 1312, trunk/windstille/data/images/satchel.xcf)

Copied: trunk/media/images/misc/shuttle.xcf (from rev 1312, trunk/windstille/data/images/shuttle.xcf)

Copied: trunk/media/images/misc/sketchmu.xcf (from rev 1312, trunk/windstille/data/images/sketchmu.xcf)

Copied: trunk/media/images/misc/stairs.xcf (from rev 1312, trunk/windstille/data/images/stairs.xcf)

Copied: trunk/media/images/misc/streetlamp.xcf (from rev 1312, trunk/windstille/data/images/streetlamp.xcf)

Copied: trunk/media/images/misc/stuff.xcf (from rev 1312, trunk/windstille/data/images/stuff.xcf)

Copied: trunk/media/images/misc/train.xcf (from rev 1312, trunk/windstille/data/images/train.xcf)

Copied: trunk/media/images/misc/truck.xcf (from rev 1312, trunk/windstille/data/images/truck.xcf)

Copied: trunk/media/images/misc/windstille-logosmall.xcf (from rev 1312, trunk/windstille/data/images/windstille-logosmall.xcf)

Copied: trunk/media/images/misc/windstillelevel.xcf (from rev 1312, trunk/windstille/data/images/windstillelevel.xcf)

Copied: trunk/media/images/tiles/airport.xcf (from rev 1312, trunk/windstille/data/images/tiles/airport.xcf)

Copied: trunk/media/images/tiles/airportbar.xcf (from rev 1312, trunk/windstille/data/images/tiles/airportbar.xcf)

Copied: trunk/media/images/tiles/airportshop.xcf (from rev 1312, trunk/windstille/data/images/tiles/airportshop.xcf)

Copied: trunk/media/images/tiles/apartment-background.xcf (from rev 1312, trunk/windstille/data/images/tiles/apartment-background.xcf)

Copied: trunk/media/images/tiles/apartment.xcf (from rev 1312, trunk/windstille/data/images/tiles/apartment.xcf)

Copied: trunk/media/images/tiles/arboretum.xcf (from rev 1312, trunk/windstille/data/images/tiles/arboretum.xcf)

Copied: trunk/media/images/tiles/bar.xcf (from rev 1312, trunk/windstille/data/images/tiles/bar.xcf)

Copied: trunk/media/images/tiles/bluestone.xcf (from rev 1312, trunk/windstille/data/images/tiles/bluestone.xcf)

Copied: trunk/media/images/tiles/building.xcf (from rev 1312, trunk/windstille/data/images/tiles/building.xcf)

Copied: trunk/media/images/tiles/building2.xcf (from rev 1312, trunk/windstille/data/images/tiles/building2.xcf)

Copied: trunk/media/images/tiles/column1.xcf (from rev 1312, trunk/windstille/data/images/tiles/column1.xcf)

Copied: trunk/media/images/tiles/forestground.xcf (from rev 1312, trunk/windstille/data/images/tiles/forestground.xcf)

Copied: trunk/media/images/tiles/industrial-doors.xcf (from rev 1312, trunk/windstille/data/images/tiles/industrial-doors.xcf)

Copied: trunk/media/images/tiles/industrial.xcf (from rev 1312, trunk/windstille/data/images/tiles/industrial.xcf)

Copied: trunk/media/images/tiles/industrial2.xcf (from rev 1312, trunk/windstille/data/images/tiles/industrial2.xcf)

Copied: trunk/media/images/tiles/industrial3.xcf (from rev 1312, trunk/windstille/data/images/tiles/industrial3.xcf)

Copied: trunk/media/images/tiles/library.xcf (from rev 1312, trunk/windstille/data/images/tiles/library.xcf)

Copied: trunk/media/images/tiles/mine1.xcf (from rev 1312, trunk/windstille/data/images/tiles/mine1.xcf)

Copied: trunk/media/images/tiles/mine2.xcf (from rev 1312, trunk/windstille/data/images/tiles/mine2.xcf)

Copied: trunk/media/images/tiles/mine3.xcf (from rev 1312, trunk/windstille/data/images/tiles/mine3.xcf)

Copied: trunk/media/images/tiles/mineroom.xcf (from rev 1312, trunk/windstille/data/images/tiles/mineroom.xcf)

Copied: trunk/media/images/tiles/prototypes.xcf (from rev 1312, trunk/windstille/data/images/tiles/prototypes.xcf)

Copied: trunk/media/images/tiles/shuttle.xcf (from rev 1312, trunk/windstille/data/images/tiles/shuttle.xcf)

Copied: trunk/media/images/tiles/stairs.xcf (from rev 1312, trunk/windstille/data/images/tiles/stairs.xcf)

Copied: trunk/media/images/tiles/stonetextures.xcf (from rev 1312, trunk/windstille/data/images/tiles/stonetextures.xcf)

Copied: trunk/media/images/tiles/virtualreality-background.xcf (from rev 1312, trunk/windstille/data/images/tiles/virtualreality-background.xcf)

Copied: trunk/media/images/tiles/virtualreality-foreground.xcf (from rev 1312, trunk/windstille/data/images/tiles/virtualreality-foreground.xcf)

Copied: trunk/media/images/tiles/woodblock.xcf (from rev 1312, trunk/windstille/data/images/tiles/woodblock.xcf)

Copied: trunk/media/images/tiles/workerapartment.xcf (from rev 1312, trunk/windstille/data/images/tiles/workerapartment.xcf)

Copied: trunk/media/images/tiles/workerwall.xcf (from rev 1312, trunk/windstille/data/images/tiles/workerwall.xcf)

Copied: trunk/media/images/tiles/yellowstone.xcf (from rev 1312, trunk/windstille/data/images/tiles/yellowstone.xcf)

Copied: trunk/media/models/misc/carseat/carseat.blend (from rev 1337, trunk/media/models/vehicles/misc/carseat.blend)

Modified: trunk/media/models/vehicles/heavylifter/heavylifter.blend
===================================================================
(Binary files differ)

Modified: trunk/txt2png/txt2png.cpp
===================================================================
--- trunk/txt2png/txt2png.cpp	2007-03-21 15:29:42 UTC (rev 1339)
+++ trunk/txt2png/txt2png.cpp	2007-03-21 17:45:59 UTC (rev 1340)
@@ -127,6 +127,7 @@
   int text_width;
   int text_height;
   bool done;
+  int chapter;
   TextStream* stream;
 
   Renderer()
@@ -135,6 +136,8 @@
     y = 0; // &lt;- refers to the baseline of the font not to top-left corner!
     start_x = 0;
     start_y = 0;
+
+    chapter = 0;
   }
 
   void print(const std::string&amp; text)
@@ -195,7 +198,8 @@
           }
         else if (word == &quot;###PAGEBREAK###&quot;)
           {
-            print(&quot;                                                            * * *&quot;);
+            //            print(&quot;                                                            * * *&quot;);
+            chapter += 1;
             done = true;
           }
         else
@@ -385,6 +389,7 @@
       TextStream stream(text);
       int page = 0;
   
+      int chapter = 1;
       while(!stream.eof())
         { 
           Renderer renderer;
@@ -414,10 +419,15 @@
             }
 
           std::ostringstream str;
-          str &lt;&lt; options.output_file &lt;&lt; std::setfill('0') &lt;&lt; std::setw(3) &lt;&lt; page &lt;&lt; &quot;.jpg&quot;;
+          str &lt;&lt; options.output_file
+              &lt;&lt; &quot;chapter&quot; &lt;&lt; std::setfill('0') &lt;&lt; std::setw(2) &lt;&lt; chapter &lt;&lt; &quot;/&quot;
+              &lt;&lt; &quot;page&quot;    &lt;&lt; std::setfill('0') &lt;&lt; std::setw(4) &lt;&lt; page &lt;&lt; &quot;.jpg&quot;;
+ 
           std::cout &lt;&lt; &quot;Writing: &quot; &lt;&lt; str.str() &lt;&lt; std::endl;
           bitmap.write_jpg(str.str());
           bitmap.clear();
+
+          chapter += renderer.chapter;
         }
       TTFFont::deinit();
     }

Deleted: trunk/windstille/data/images/car.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/carsketch.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/controldialog.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/cryo.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/elevator.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/elevatorbase.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/elevatorhead.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/elevatorsketch.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/elevatorsketchcolor.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/elevatorwheel.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/generator.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/gun.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/gun1.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/gun3.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/gun4.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/haus2.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/haus3.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/hause.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/metalwall.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/minesketch.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/plasmagranate.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/policecar.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/rifle.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/room.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/room2.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/satchel.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/shuttle.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/sketchmu.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/stairs.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/streetlamp.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/stuff.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/airport.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/airportbar.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/airportshop.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/apartment-background.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/apartment.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/arboretum.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/bar.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/bluestone.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/building.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/building2.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/column1.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/forestground.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/industrial-doors.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/industrial.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/industrial2.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/industrial3.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/library.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/mine1.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/mine2.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/mine3.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/mineroom.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/prototypes.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/shuttle.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/stairs.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/stonetextures.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/virtualreality-background.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/virtualreality-foreground.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/woodblock.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/workerapartment.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/workerwall.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/tiles/yellowstone.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/train.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/truck.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/windstille-logosmall.xcf
===================================================================
(Binary files differ)

Deleted: trunk/windstille/data/images/windstillelevel.xcf
===================================================================
(Binary files differ)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000992.html">[Windstille-commit] r1339 - in trunk/media/models/vehicles: .	artillery battleship cleansweep mech misc rocketlauncher	truck truck2
</A></li>
	<LI>Next message: <A HREF="000994.html">[Windstille-commit] r1341 - in trunk: media media/images	media/images/objects windstille/data/images/objects
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#993">[ date ]</a>
              <a href="thread.html#993">[ thread ]</a>
              <a href="subject.html#993">[ subject ]</a>
              <a href="author.html#993">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/windstille-commit">More information about the Windstille-commit
mailing list</a><br>
</body></html>
