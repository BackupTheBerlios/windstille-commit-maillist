<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Windstille-commit] r3025 - in trunk/windstille/src: app collision	display engine gui hud input lisp math navigation particles	screen sound sprite2d sprite3d tile util
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/windstille-commit/2009-August/index.html" >
   <LINK REL="made" HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r3025%20-%20in%20trunk/windstille/src%3A%20app%20collision%0A%09display%20engine%20gui%20hud%20input%20lisp%20math%20navigation%20particles%0A%09screen%20sound%20sprite2d%20sprite3d%20tile%20util&In-Reply-To=%3C200908240021.n7O0LcY7016267%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002021.html">
   <LINK REL="Next"  HREF="002023.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Windstille-commit] r3025 - in trunk/windstille/src: app collision	display engine gui hud input lisp math navigation particles	screen sound sprite2d sprite3d tile util</H1>
    <B>grumbel at BerliOS</B> 
    <A HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r3025%20-%20in%20trunk/windstille/src%3A%20app%20collision%0A%09display%20engine%20gui%20hud%20input%20lisp%20math%20navigation%20particles%0A%09screen%20sound%20sprite2d%20sprite3d%20tile%20util&In-Reply-To=%3C200908240021.n7O0LcY7016267%40sheep.berlios.de%3E"
       TITLE="[Windstille-commit] r3025 - in trunk/windstille/src: app collision	display engine gui hud input lisp math navigation particles	screen sound sprite2d sprite3d tile util">grumbel at mail.berlios.de
       </A><BR>
    <I>Mon Aug 24 02:21:38 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002021.html">[Windstille-commit] r3024 - in trunk/windstille/src: app collision	engine hud input lisp objects screen scripting
</A></li>
        <LI>Next message: <A HREF="002023.html">[Windstille-commit] r3026 - in trunk/windstille/src: app collision	screen
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2022">[ date ]</a>
              <a href="thread.html#2022">[ thread ]</a>
              <a href="subject.html#2022">[ subject ]</a>
              <a href="author.html#2022">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: grumbel
Date: 2009-08-24 02:21:33 +0200 (Mon, 24 Aug 2009)
New Revision: 3025

Modified:
   trunk/windstille/src/app/menu_manager.cpp
   trunk/windstille/src/collision/collision_engine.cpp
   trunk/windstille/src/display/color.hpp
   trunk/windstille/src/display/display.cpp
   trunk/windstille/src/display/drawing_context.cpp
   trunk/windstille/src/display/drawing_request.hpp
   trunk/windstille/src/display/graphic_context_state.cpp
   trunk/windstille/src/display/opengl_state.cpp
   trunk/windstille/src/display/scene_context.cpp
   trunk/windstille/src/display/software_surface.cpp
   trunk/windstille/src/display/surface.cpp
   trunk/windstille/src/display/surface_manager.cpp
   trunk/windstille/src/display/text_area.cpp
   trunk/windstille/src/display/texture_packer.cpp
   trunk/windstille/src/display/vertex_array_drawing_request.cpp
   trunk/windstille/src/engine/squirrel_thread.cpp
   trunk/windstille/src/gui/list_view.cpp
   trunk/windstille/src/hud/speech_manager.cpp
   trunk/windstille/src/input/input_configurator.cpp
   trunk/windstille/src/lisp/property_iterator.hpp
   trunk/windstille/src/math/matrix.cpp
   trunk/windstille/src/math/point.hpp
   trunk/windstille/src/math/quaternion.hpp
   trunk/windstille/src/math/size.hpp
   trunk/windstille/src/math/vector3.hpp
   trunk/windstille/src/navigation/edge_position.cpp
   trunk/windstille/src/particles/deform_drawer.cpp
   trunk/windstille/src/particles/particle_system.cpp
   trunk/windstille/src/particles/randomizer.hpp
   trunk/windstille/src/particles/surface_drawer.cpp
   trunk/windstille/src/screen/sprite3dview.cpp
   trunk/windstille/src/screen/title_screen.cpp
   trunk/windstille/src/sound/stream_sound_source.cpp
   trunk/windstille/src/sprite2d/sprite.cpp
   trunk/windstille/src/sprite2d/sprite.hpp
   trunk/windstille/src/sprite3d/sprite3d.cpp
   trunk/windstille/src/tile/tile_map.cpp
   trunk/windstille/src/tile/tile_packer.cpp
   trunk/windstille/src/util/baby_xml.cpp
   trunk/windstille/src/util/response_curve.cpp
Log:
Cleaned up a bunch of float/int/double conversion warnings

Modified: trunk/windstille/src/app/menu_manager.cpp
===================================================================
--- trunk/windstille/src/app/menu_manager.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/app/menu_manager.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -364,8 +364,8 @@
   pos.y += size.height / 2.0f;
 
   // scale the coordinates
-  pos.x = pos.x * Display::get_width() / 800;
-  pos.y = pos.y * Display::get_height() / 600;
+  pos.x = pos.x * static_cast&lt;float&gt;(Display::get_width())  / 800.0f;
+  pos.y = pos.y * static_cast&lt;float&gt;(Display::get_height()) / 600.0f;
 
   // move pos back to top/left
   pos.x -= size.width  / 2.0f;
@@ -377,8 +377,8 @@
 Rectf
 MenuManager::create_centered_rect(float w, float h)
 {
-  return Rectf(Vector2f((Display::get_width()  - w)/2.0f,
-                        (Display::get_height() - h)/2.0f),
+  return Rectf(Vector2f((static_cast&lt;float&gt;(Display::get_width())  - w)/2.0f,
+                        (static_cast&lt;float&gt;(Display::get_height()) - h)/2.0f),
                Sizef(w, h));
 }
   

Modified: trunk/windstille/src/collision/collision_engine.cpp
===================================================================
--- trunk/windstille/src/collision/collision_engine.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/collision/collision_engine.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -140,8 +140,8 @@
 
 int c_round(float f)
 {
-  int i=(int)f;
-  if(fabs(f-i)&gt;0.5)
+  int i = static_cast&lt;int&gt;(f);
+  if(fabsf(f-i)&gt;0.5)
     {
       if(i&gt;0)
 	i++;
@@ -312,8 +312,8 @@
 			  r.object2 = *j;
 			  col_data = r;
 			  min_time = r.col_time;
-			  if (min_time &gt; 0.0005)
-			    min_time -= 0.0005;
+			  if (min_time &gt; 0.0005f)
+			    min_time -= 0.0005f;
 			}
 		    }
 		}
@@ -530,10 +530,10 @@
   int miny, maxy;
   int x, y;
 
-  minx = (int)(r.left   / TILE_SIZE);
-  maxx = (int)(r.right  / TILE_SIZE);
-  miny = (int)(r.top    / TILE_SIZE);
-  maxy = (int)(r.bottom / TILE_SIZE);
+  minx = static_cast&lt;int&gt;(r.left   / TILE_SIZE);
+  maxx = static_cast&lt;int&gt;(r.right  / TILE_SIZE);
+  miny = static_cast&lt;int&gt;(r.top    / TILE_SIZE);
+  maxy = static_cast&lt;int&gt;(r.bottom / TILE_SIZE);
 
   assert(maxy&gt;=miny);
   assert(maxx&gt;=minx);
@@ -556,10 +556,10 @@
   int miny, maxy;
   int x, y;
 
-  minx = (int)r.left   / TILE_SIZE;
-  maxx = (int)r.right  / TILE_SIZE;
-  miny = (int)r.top    / TILE_SIZE;
-  maxy = (int)r.bottom / TILE_SIZE;
+  minx = static_cast&lt;int&gt;(r.left   / TILE_SIZE);
+  maxx = static_cast&lt;int&gt;(r.right  / TILE_SIZE);
+  miny = static_cast&lt;int&gt;(r.top    / TILE_SIZE);
+  maxy = static_cast&lt;int&gt;(r.bottom / TILE_SIZE);
 
   for (y = std::max (0, miny); y &lt;= std::min (maxy, tilemap-&gt;get_height() - 1); ++y)
     for (x = std::max (0, minx); x &lt;= std::min (maxx, tilemap-&gt;get_width() - 1); ++x)

Modified: trunk/windstille/src/display/color.hpp
===================================================================
--- trunk/windstille/src/display/color.hpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/display/color.hpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -25,8 +25,8 @@
   Color()
     : r(0), g(0), b(0), a(1.0)
   { }
-  Color(float r, float g, float b, float a = 1.0)
-    : r(r), g(g), b(b), a(a)
+  Color(float r_, float g_, float b_, float a_ = 1.0)
+    : r(r_), g(g_), b(b_), a(a_)
   { }
 
   float r, g, b, a;

Modified: trunk/windstille/src/display/display.cpp
===================================================================
--- trunk/windstille/src/display/display.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/display/display.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -296,14 +296,14 @@
   state.color(color);
   state.activate();
 
-  float n = segments/4.0f;
+  float n = static_cast&lt;float&gt;(segments) / 4.0f;
   glBegin(GL_TRIANGLE_FAN);
   glVertex2f(pos.x, pos.y);
   glVertex2f(radius + pos.x, pos.y);
   for(int i = 1; i &lt; segments; ++i)
     {
-      float x = cosf(i * (math::pi/2) / n) * radius;
-      float y = sinf(i * (math::pi/2) / n) * radius;
+      float x = cosf(static_cast&lt;float&gt;(i) * (math::pi/2) / static_cast&lt;float&gt;(n)) * radius;
+      float y = sinf(static_cast&lt;float&gt;(i) * (math::pi/2) / static_cast&lt;float&gt;(n)) * radius;
       
       glVertex2f(x + pos.x, y + pos.y);
     }
@@ -322,7 +322,7 @@
     }
   else
     {
-      float step  = (2.0f * math::pi) / segments;
+      float step  = (2.0f * math::pi) / static_cast&lt;float&gt;(segments);
 
       if (start &gt; end) 
         std::swap(start, end);
@@ -362,7 +362,7 @@
     }
   else
     {
-      float step  = (2.0f * math::pi) / segments;
+      float step  = (2.0f * math::pi) / static_cast&lt;float&gt;(segments);
 
       if (start &gt; end) 
         std::swap(start, end);
@@ -410,13 +410,13 @@
   for(float x = start_x; x &lt; Display::get_width(); x += size.width)
     {
       glVertex2f(x, 0);
-      glVertex2f(x, Display::get_height());
+      glVertex2f(x, static_cast&lt;float&gt;(Display::get_height()));
     }
 
   for(float y = start_y; y &lt; Display::get_height(); y += size.height)
     {
       glVertex2f(0, y);
-      glVertex2f(Display::get_width(), y);
+      glVertex2f(static_cast&lt;float&gt;(Display::get_width()), y);
     }
 
   glEnd();  

Modified: trunk/windstille/src/display/drawing_context.cpp
===================================================================
--- trunk/windstille/src/display/drawing_context.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/display/drawing_context.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -188,9 +188,12 @@
   SurfaceDrawingParameters params;
 
 public:
-  SurfaceDrawingRequest(Surface surface, const SurfaceDrawingParameters&amp; params, float z_pos_,
-                        const Matrix&amp; modelview)
-    : DrawingRequest(pos, z_pos_, modelview), surface(surface), params(params)
+  SurfaceDrawingRequest(Surface surface_, const SurfaceDrawingParameters&amp; params_,
+                        float z_pos_,
+                        const Matrix&amp; modelview_)
+    : DrawingRequest(pos, z_pos_, modelview_), 
+      surface(surface_), 
+      params(params_)
   {}
 
   virtual ~SurfaceDrawingRequest()

Modified: trunk/windstille/src/display/drawing_request.hpp
===================================================================
--- trunk/windstille/src/display/drawing_request.hpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/display/drawing_request.hpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -34,8 +34,8 @@
   Matrix  modelview;
 
 public:
-  DrawingRequest(const Vector2f&amp; pos_, float z_pos = 0,  const Matrix&amp; modelview_ = Matrix::identity())
-    : pos(pos_), z_pos(z_pos), modelview(modelview_)
+  DrawingRequest(const Vector2f&amp; pos_, float z_pos_ = 0,  const Matrix&amp; modelview_ = Matrix::identity())
+    : pos(pos_), z_pos(z_pos_), modelview(modelview_)
   {}
   virtual ~DrawingRequest() {}
   

Modified: trunk/windstille/src/display/graphic_context_state.cpp
===================================================================
--- trunk/windstille/src/display/graphic_context_state.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/display/graphic_context_state.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -69,9 +69,11 @@
 {
   sc.push_modelview();
 
-  sc.translate(impl-&gt;width/2, impl-&gt;height/2);
+  sc.translate(static_cast&lt;float&gt;(impl-&gt;width)  / 2.0f, 
+               static_cast&lt;float&gt;(impl-&gt;height) / 2.0f);
   sc.rotate(impl-&gt;rotation);
-  sc.translate(-impl-&gt;width/2, -impl-&gt;height/2);
+  sc.translate(static_cast&lt;float&gt;(-impl-&gt;width)  / 2.0f,
+               static_cast&lt;float&gt;(-impl-&gt;height) / 2.0f);
 
   sc.scale(get_zoom(), get_zoom());
   sc.translate(impl-&gt;offset.x, impl-&gt;offset.y);
@@ -88,15 +90,15 @@
 {
   return Rectf(Vector2f(-impl-&gt;offset.x,
                          -impl-&gt;offset.y),
-               Sizef(get_width()  / impl-&gt;zoom,
-                     get_height() / impl-&gt;zoom));
+               Sizef(static_cast&lt;float&gt;(get_width())  / impl-&gt;zoom,
+                     static_cast&lt;float&gt;(get_height()) / impl-&gt;zoom));
 }
-
+    
 void
 GraphicContextState::set_pos(const Vector2f&amp; pos)
 {
-  impl-&gt;offset.x = -pos.x + (get_width()/2  / impl-&gt;zoom);
-  impl-&gt;offset.y = -pos.y + (get_height()/2 / impl-&gt;zoom);
+  impl-&gt;offset.x = -pos.x + (static_cast&lt;float&gt;(get_width())  / 2.0f / impl-&gt;zoom);
+  impl-&gt;offset.y = -pos.y + (static_cast&lt;float&gt;(get_height()) / 2.0f / impl-&gt;zoom);
 }
 
 Vector2f
@@ -108,8 +110,8 @@
 Vector2f
 GraphicContextState::get_pos() const
 {
-  return Vector2f(-impl-&gt;offset.x + (get_width()/2  / impl-&gt;zoom),
-                   -impl-&gt;offset.y + (get_height()/2  / impl-&gt;zoom));
+  return Vector2f(-impl-&gt;offset.x + (static_cast&lt;float&gt;(get_width())  / 2.0f / impl-&gt;zoom),
+                  -impl-&gt;offset.y + (static_cast&lt;float&gt;(get_height()) / 2.0f / impl-&gt;zoom));
 }
 
 void
@@ -147,33 +149,33 @@
   //std::cout &lt;&lt; &quot;Screen: &quot; &lt;&lt; screen_relation &lt;&lt; &quot; Zoom: &quot; &lt;&lt; rect_relation &lt;&lt; std::endl;
   if (rect_relation &lt; screen_relation) // take width, ignore height
     {
-      impl-&gt;zoom = get_width()/width; 
+      impl-&gt;zoom = static_cast&lt;float&gt;(get_width()) / width; 
     }
   else // take height, ignore width
     {
-      impl-&gt;zoom = get_height()/height;
+      impl-&gt;zoom = static_cast&lt;float&gt;(get_height()) / height;
     }
 
-  impl-&gt;offset.x = (get_width()  / (2*impl-&gt;zoom)) - center_x;
-  impl-&gt;offset.y = (get_height() / (2*impl-&gt;zoom)) - center_y;
+  impl-&gt;offset.x = (static_cast&lt;float&gt;(get_width())  / (2.0f * impl-&gt;zoom)) - center_x;
+  impl-&gt;offset.y = (static_cast&lt;float&gt;(get_height()) / (2.0f * impl-&gt;zoom)) - center_y;
 }
 
 Vector2f
 GraphicContextState::screen_to_world(const Vector2f&amp; pos_)
 {
   Vector2f pos(pos_.x, pos_.y);
-  float sa = sin(-impl-&gt;rotation/180.0f*M_PI);
-  float ca = cos(-impl-&gt;rotation/180.0f*M_PI);
+  float sa = sinf(-impl-&gt;rotation / 180.0f * math::pi);
+  float ca = cosf(-impl-&gt;rotation / 180.0f * math::pi);
 
-  float dx = pos.x - impl-&gt;width/2;
-  float dy = pos.y - impl-&gt;height/2;
+  float dx = pos.x - static_cast&lt;float&gt;(impl-&gt;width)  / 2.0f;
+  float dy = pos.y - static_cast&lt;float&gt;(impl-&gt;height) / 2.0f;
 
-  pos.x = impl-&gt;width/2  + (ca * dx - sa * dy);
-  pos.y = impl-&gt;height/2 + (sa * dx + ca * dy);
+  pos.x = static_cast&lt;float&gt;(impl-&gt;width)  / 2.0f + (ca * dx - sa * dy);
+  pos.y = static_cast&lt;float&gt;(impl-&gt;height) / 2.0f + (sa * dx + ca * dy);
 
-  Vector2f p((float(pos.x) / impl-&gt;zoom) - impl-&gt;offset.x, 
-              (float(pos.y) / impl-&gt;zoom) - impl-&gt;offset.y);
-
+  Vector2f p((static_cast&lt;float&gt;(pos.x) / impl-&gt;zoom) - impl-&gt;offset.x, 
+             (static_cast&lt;float&gt;(pos.y) / impl-&gt;zoom) - impl-&gt;offset.y);
+  
   return p;
 }
 

Modified: trunk/windstille/src/display/opengl_state.cpp
===================================================================
--- trunk/windstille/src/display/opengl_state.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/display/opengl_state.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -220,9 +220,9 @@
 }
 
 void
-OpenGLState::color(const Color&amp; color)
+OpenGLState::color(const Color&amp; color_)
 {
-  impl-&gt;color = color;
+  impl-&gt;color = color_;
 }
 
 void
@@ -231,8 +231,8 @@
   // do nothing for now, should be implemented later on
   impl-&gt;was_activated = true;
 
-  OpenGLState* global = OpenGLState::global();
-  assert(global);
+  OpenGLState* global_state = OpenGLState::global();
+  assert(global_state);
 
   // always apply color since it might have got changed between a glBegin/glEnd
   glColor4f(impl-&gt;color.r, impl-&gt;color.g, impl-&gt;color.b, impl-&gt;color.a);
@@ -240,50 +240,50 @@
   for(std::map&lt;GLenum, bool&gt;::iterator i = impl-&gt;state.begin();
       i != impl-&gt;state.end(); ++i)
     {
-      if (global-&gt;get_state(i-&gt;first) != i-&gt;second)
+      if (global_state-&gt;get_state(i-&gt;first) != i-&gt;second)
         {
           if (i-&gt;second)
             glEnable(i-&gt;first);
           else
             glDisable(i-&gt;first);
 
-          global-&gt;set_state(i-&gt;first, i-&gt;second);
+          global_state-&gt;set_state(i-&gt;first, i-&gt;second);
         }
     }
 
   for(std::map&lt;GLenum, bool&gt;::iterator i = impl-&gt;client_state.begin();
       i != impl-&gt;client_state.end(); ++i)
     {
-      if (global-&gt;get_client_state(i-&gt;first) != i-&gt;second)
+      if (global_state-&gt;get_client_state(i-&gt;first) != i-&gt;second)
         {
           if (i-&gt;second)
             glEnableClientState(i-&gt;first);
           else
             glDisableClientState(i-&gt;first);
 
-          global-&gt;set_client_state(i-&gt;first, i-&gt;second);
+          global_state-&gt;set_client_state(i-&gt;first, i-&gt;second);
         }
     }
 
-  if (impl-&gt;blend_sfactor != global-&gt;impl-&gt;blend_sfactor ||
-      impl-&gt;blend_dfactor != global-&gt;impl-&gt;blend_dfactor)
+  if (impl-&gt;blend_sfactor != global_state-&gt;impl-&gt;blend_sfactor ||
+      impl-&gt;blend_dfactor != global_state-&gt;impl-&gt;blend_dfactor)
     {
       glBlendFunc(impl-&gt;blend_sfactor, impl-&gt;blend_dfactor);
 
-      global-&gt;impl-&gt;blend_sfactor = impl-&gt;blend_sfactor;
-      global-&gt;impl-&gt;blend_dfactor = impl-&gt;blend_dfactor;
+      global_state-&gt;impl-&gt;blend_sfactor = impl-&gt;blend_sfactor;
+      global_state-&gt;impl-&gt;blend_dfactor = impl-&gt;blend_dfactor;
     }
 
   for(int i = 0; i &lt; MAX_TEXTURE_UNITS; ++i)
     {
-      if (impl-&gt;texture[i] != global-&gt;impl-&gt;texture[i])
+      if (impl-&gt;texture[i] != global_state-&gt;impl-&gt;texture[i])
         { 
           // FIXME: glActiveTexture() makes the game crash on Matrox
           // G450, without that line it works
           glActiveTexture(GL_TEXTURE0 + i);
           if (impl-&gt;texture[i])
             {
-              global-&gt;impl-&gt;texture[i] = impl-&gt;texture[i];
+              global_state-&gt;impl-&gt;texture[i] = impl-&gt;texture[i];
 
               switch (impl-&gt;texture[i].get_target())
                 {
@@ -317,7 +317,7 @@
               glDisable(GL_TEXTURE_RECTANGLE_ARB);
               glDisable(GL_TEXTURE_2D);
 
-              global-&gt;impl-&gt;texture[i] = impl-&gt;texture[i];
+              global_state-&gt;impl-&gt;texture[i] = impl-&gt;texture[i];
             }
         }
     }

Modified: trunk/windstille/src/display/scene_context.cpp
===================================================================
--- trunk/windstille/src/display/scene_context.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/display/scene_context.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -187,8 +187,8 @@
 
 void draw_disc(int count)
 {
-  float radius = (count)*2.0f;
-  float minradius = 2.0f*count - 164.0f;
+  float radius = static_cast&lt;float&gt;(count) * 2.0f;
+  float minradius = 2.0f * static_cast&lt;float&gt;(count) - 164.0f;
   if (minradius &lt; 0)
     minradius = 0;
   glClear(GL_DEPTH_BUFFER_BIT);
@@ -198,13 +198,13 @@
   glBegin(GL_QUADS);
   for (int i = 0; i &lt; segments; ++i)
     {
-      float angel = (2*M_PI / segments);
+      float angel = 2.0f * math::pi / static_cast&lt;float&gt;(segments);
 
-      float x1 =  sin(angel*i)*radius;
-      float y1 = -cos(angel*i)*radius;
+      float x1 =  sinf(angel * static_cast&lt;float&gt;(i)) * radius;
+      float y1 = -cosf(angel * static_cast&lt;float&gt;(i)) * radius;
 
-      float x2 =  sin(angel*(i+1))*radius;
-      float y2 = -cos(angel*(i+1))*radius;
+      float x2 =  sinf(angel * static_cast&lt;float&gt;(i+1)) * radius;
+      float y2 = -cosf(angel * static_cast&lt;float&gt;(i+1)) * radius;
 
       glColor4f(1.0f, 1.0f, 1.0f, 1.0f);
       glTexCoord2f(x1/512.0f+0.5f, y1/512.0f+0.5f);
@@ -213,13 +213,12 @@
       glTexCoord2f(x2/512.0f+0.5f, y2/512.0f+0.5f);
       glVertex3f(x2+256, y2+256, 0);
 
+      float x3 =  sinf(angel * static_cast&lt;float&gt;(i)) * minradius;
+      float y3 = -cosf(angel * static_cast&lt;float&gt;(i)) * minradius;
 
-      float x3 =  sin(angel*i)*minradius;
-      float y3 = -cos(angel*i)*minradius;
+      float x4 =  sinf(angel * static_cast&lt;float&gt;(i+1)) * minradius;
+      float y4 = -cosf(angel * static_cast&lt;float&gt;(i+1)) * minradius;
 
-      float x4 =  sin(angel*(i+1))*minradius;
-      float y4 = -cos(angel*(i+1))*minradius;
-
       glColor4f(1.0f, 1.0f, 1.0f, 0.0f);
       glTexCoord2f(x4/512.0f+0.5f, y4/512.0f+0.5f);
       glVertex3f(x4+256, y4+256, 0);
@@ -232,7 +231,9 @@
 void
 SceneContext::render_lightmap()
 {
-  Rect uv(0, 0, impl-&gt;framebuffers-&gt;lightmap.get_width(), impl-&gt;framebuffers-&gt;lightmap.get_height());
+  Rectf uv(0, 0,
+           static_cast&lt;float&gt;(impl-&gt;framebuffers-&gt;lightmap.get_width()), 
+           static_cast&lt;float&gt;(impl-&gt;framebuffers-&gt;lightmap.get_height()));
 
   OpenGLState state;
 
@@ -248,14 +249,14 @@
   glVertex2f(0, 0);
 
   glTexCoord2f(uv.right, uv.bottom);
-  glVertex2f(impl-&gt;framebuffers-&gt;lightmap.get_width() * LIGHTMAP_DIV, 0);
+  glVertex2f(static_cast&lt;float&gt;(impl-&gt;framebuffers-&gt;lightmap.get_width() * LIGHTMAP_DIV), 0.0f);
 
   glTexCoord2f(uv.right, uv.top);
-  glVertex2f(impl-&gt;framebuffers-&gt;lightmap.get_width() * LIGHTMAP_DIV,
-             impl-&gt;framebuffers-&gt;lightmap.get_height() * LIGHTMAP_DIV);
+  glVertex2f(static_cast&lt;float&gt;(impl-&gt;framebuffers-&gt;lightmap.get_width()  * LIGHTMAP_DIV),
+             static_cast&lt;float&gt;(impl-&gt;framebuffers-&gt;lightmap.get_height() * LIGHTMAP_DIV));
 
   glTexCoord2f(uv.left, uv.top);
-  glVertex2f(0, impl-&gt;framebuffers-&gt;lightmap.get_height() * LIGHTMAP_DIV);
+  glVertex2f(0.0f, static_cast&lt;float&gt;(impl-&gt;framebuffers-&gt;lightmap.get_height() * LIGHTMAP_DIV));
 
   glEnd();
 }
@@ -273,8 +274,8 @@
       glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
 
       glPushMatrix();
-      glTranslatef(0, Display::get_height()-(Display::get_height()/LIGHTMAP_DIV), 0);
-      glScalef(1.0f/LIGHTMAP_DIV, 1.0f/LIGHTMAP_DIV, 1.0f);
+      glTranslatef(0.0f, static_cast&lt;float&gt;(Display::get_height() - (Display::get_height() / LIGHTMAP_DIV)), 0.0f);
+      glScalef(1.0f / LIGHTMAP_DIV, 1.0f / LIGHTMAP_DIV, 1.0f);
       impl-&gt;light.render(*this);
       glPopMatrix();
 
@@ -313,9 +314,9 @@
       // Render the screen framebuffer to the actual screen 
       OpenGLState state;
 
-      Rectf uv(0.375, 0.375, 
-               impl-&gt;framebuffers-&gt;screen.get_width()  + 0.375,
-               impl-&gt;framebuffers-&gt;screen.get_height() + 0.375);
+      Rectf uv(0.375f, 0.375f, 
+               static_cast&lt;float&gt;(impl-&gt;framebuffers-&gt;screen.get_width())  + 0.375f,
+               static_cast&lt;float&gt;(impl-&gt;framebuffers-&gt;screen.get_height()) + 0.375f);
 
       if (impl-&gt;render_mask &amp; BLURMAP)
         state.bind_texture(impl-&gt;framebuffers-&gt;screen.get_texture(), 0);
@@ -330,13 +331,13 @@
       glVertex2f(0, 0);
 
       glTexCoord2f(uv.right, uv.bottom);
-      glVertex2f(Display::get_width(), 0);
+      glVertex2f(static_cast&lt;float&gt;(Display::get_width()), 0);
 
       glTexCoord2f(uv.right, uv.top);
-      glVertex2f(Display::get_width(), Display::get_height());
+      glVertex2f(static_cast&lt;float&gt;(Display::get_width()), static_cast&lt;float&gt;(Display::get_height()));
 
       glTexCoord2f(uv.left, uv.top);
-      glVertex2f(0, Display::get_height());
+      glVertex2f(0.0f, static_cast&lt;float&gt;(Display::get_height()));
 
       glEnd();
     }
@@ -364,8 +365,8 @@
       glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
 
       glPushMatrix();
-      glTranslatef(0, Display::get_height() - (Display::get_height()/LIGHTMAP_DIV), 0);
-      glScalef(1.0f/LIGHTMAP_DIV, 1.0f/LIGHTMAP_DIV, 1.0f);
+      glTranslatef(0.0f, static_cast&lt;float&gt;(Display::get_height()) - static_cast&lt;float&gt;(Display::get_height()/LIGHTMAP_DIV), 0.0f);
+      glScalef(1.0f / LIGHTMAP_DIV, 1.0f / LIGHTMAP_DIV, 1.0f);
       impl-&gt;light.render(*this);
       glPopMatrix();
 
@@ -379,7 +380,8 @@
         glCopyTexSubImage2D(GL_TEXTURE_2D, 0,
                             0, 0, 
                             0, 0, //Display::get_height() - impl-&gt;lightmap.get_height(),
-                            impl-&gt;lightmap.get_width(), impl-&gt;lightmap.get_height());
+                            static_cast&lt;GLsizei&gt;(impl-&gt;lightmap.get_width()), 
+                            static_cast&lt;GLsizei&gt;(impl-&gt;lightmap.get_height()));
       }
     }
 

Modified: trunk/windstille/src/display/software_surface.cpp
===================================================================
--- trunk/windstille/src/display/software_surface.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/display/software_surface.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -130,9 +130,9 @@
 void
 SoftwareSurface::blit(SoftwareSurface&amp; dst, int x, int y) const
 {
-  SDL_Rect dst_rect;
-  dst_rect.x = x;
-  dst_rect.y = y;
+  SDL_Rect dst_rect; 
+  dst_rect.x = static_cast&lt;Sint16&gt;(x);
+  dst_rect.y = static_cast&lt;Sint16&gt;(y);
 
   SDL_BlitSurface(impl-&gt;surface, 0, dst.impl-&gt;surface, &amp;dst_rect);
 }
@@ -141,14 +141,14 @@
 SoftwareSurface::blit(const Rect&amp; src_rect_, SoftwareSurface&amp; dst, int x, int y) const
 {
   SDL_Rect src_rect;
-  src_rect.x = src_rect_.left;
-  src_rect.y = src_rect_.top;
-  src_rect.w = src_rect_.get_width();
-  src_rect.h = src_rect_.get_height();
+  src_rect.x = static_cast&lt;Sint16&gt;(src_rect_.left);
+  src_rect.y = static_cast&lt;Sint16&gt;(src_rect_.top);
+  src_rect.w = static_cast&lt;Sint16&gt;(src_rect_.get_width());
+  src_rect.h = static_cast&lt;Sint16&gt;(src_rect_.get_height());
 
   SDL_Rect dst_rect;
-  dst_rect.x = x;
-  dst_rect.y = y;
+  dst_rect.x = static_cast&lt;Sint16&gt;(x);
+  dst_rect.y = static_cast&lt;Sint16&gt;(y);
   
   SDL_BlitSurface(impl-&gt;surface, &amp;src_rect, dst.impl-&gt;surface, &amp;dst_rect);
 }

Modified: trunk/windstille/src/display/surface.cpp
===================================================================
--- trunk/windstille/src/display/surface.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/display/surface.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -70,9 +70,9 @@
 
   // FIXME: rounding to power of two shouldn't be needed in OpenGL2.0 or later
   impl-&gt;texture = Texture(GL_TEXTURE_2D, math::round_to_power_of_two(width), math::round_to_power_of_two(height));
-  impl-&gt;uv      = Rectf(0, 0,
-                        impl-&gt;size.width  / impl-&gt;texture.get_width(),
-                        impl-&gt;size.height / impl-&gt;texture.get_height());
+  impl-&gt;uv      = Rectf(0.0f, 0.0f,
+                        impl-&gt;size.width  / static_cast&lt;float&gt;(impl-&gt;texture.get_width()),
+                        impl-&gt;size.height / static_cast&lt;float&gt;(impl-&gt;texture.get_height()));
 }
 
 Surface::Surface(Texture texture, const Rectf&amp; uv, const Sizef&amp; size)

Modified: trunk/windstille/src/display/surface_manager.cpp
===================================================================
--- trunk/windstille/src/display/surface_manager.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/display/surface_manager.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -90,7 +90,9 @@
               throw std::runtime_error(msg.str());
             }
         
-          Surface result(texture, Rectf(0, 0, maxu, maxv), Sizef(image.get_width(), image.get_height()));
+          Surface result(texture, Rectf(0.0f, 0.0f, maxu, maxv),
+                         Sizef(static_cast&lt;float&gt;(image.get_width()),
+                               static_cast&lt;float&gt;(image.get_height())));
           surfaces.insert(std::make_pair(filename, result));
           return result;
         }      
@@ -122,12 +124,15 @@
     {
       for(int x = 0; x &lt;= image.get_width() - width + 1; x += width)
         {
-          float s_min_u = maxu * x / static_cast&lt;float&gt;(image.get_width());
-          float s_max_u = (maxu * (x + width)) / static_cast&lt;float&gt;(image.get_width());
-          float s_min_v = maxv * x / static_cast&lt;float&gt;(image.get_height());
-          float s_max_v = (maxv * (x + height)) / static_cast&lt;float&gt;(image.get_height());
+          float s_min_u = maxu * static_cast&lt;float&gt;(x) / static_cast&lt;float&gt;(image.get_width());
+          float s_min_v = maxv * static_cast&lt;float&gt;(x) / static_cast&lt;float&gt;(image.get_height());
+          float s_max_u = (maxu * (static_cast&lt;float&gt;(x + width)))  / static_cast&lt;float&gt;(image.get_width());
+          float s_max_v = (maxv * (static_cast&lt;float&gt;(x + height))) / static_cast&lt;float&gt;(image.get_height());
 
-          surfaces.push_back(Surface(texture, Rectf(s_min_u, s_min_v, s_max_u, s_max_v), Sizef(width, height)));
+          surfaces.push_back(Surface(texture, 
+                                     Rectf(s_min_u, s_min_v, s_max_u, s_max_v), 
+                                     Sizef(static_cast&lt;float&gt;(width),
+                                           static_cast&lt;float&gt;(height))));
         }
     }
 }

Modified: trunk/windstille/src/display/text_area.cpp
===================================================================
--- trunk/windstille/src/display/text_area.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/display/text_area.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -186,7 +186,9 @@
   state.activate();
 
   glPushMatrix();
-  glTranslatef(impl-&gt;rect.left, impl-&gt;rect.top + impl-&gt;font-&gt;get_height() - impl-&gt;scroll_offset, 0);
+  glTranslatef(impl-&gt;rect.left, 
+               impl-&gt;rect.top + static_cast&lt;float&gt;(impl-&gt;font-&gt;get_height()) - impl-&gt;scroll_offset, 
+               0.0f);
 
   // Voodoo to get non-blurry fonts
   float mx = -0.375;
@@ -266,9 +268,9 @@
             int word_width;
 
             if (is_small)
-              word_width = static_cast&lt;int&gt;(impl-&gt;font-&gt;get_width(i-&gt;content) * 0.6f);
+              word_width = static_cast&lt;int&gt;(static_cast&lt;float&gt;(impl-&gt;font-&gt;get_width(i-&gt;content)) * 0.6f);
             else if (is_large)
-              word_width = static_cast&lt;int&gt;(impl-&gt;font-&gt;get_width(i-&gt;content) * 2.0f);
+              word_width = static_cast&lt;int&gt;(static_cast&lt;float&gt;(impl-&gt;font-&gt;get_width(i-&gt;content)) * 2.0f);
             else
               word_width = impl-&gt;font-&gt;get_width(i-&gt;content);
           

Modified: trunk/windstille/src/display/texture_packer.cpp
===================================================================
--- trunk/windstille/src/display/texture_packer.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/display/texture_packer.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -194,9 +194,11 @@
       texture.put(surface, rect.left+1, rect.top+1);
 
       return Surface(texture,
-                     Rectf(float(rect.left+1)  / texture.get_width(), float(rect.top+1)    / texture.get_height(),
-                           float(rect.right-1) / texture.get_width(), float(rect.bottom-1) / texture.get_height()),
-                     Sizef(surface.get_width(), surface.get_height()));
+                     Rectf(static_cast&lt;float&gt;(rect.left+1)   / static_cast&lt;float&gt;(texture.get_width()),
+                           static_cast&lt;float&gt;(rect.top+1)    / static_cast&lt;float&gt;(texture.get_height()),
+                           static_cast&lt;float&gt;(rect.right-1)  / static_cast&lt;float&gt;(texture.get_width()), 
+                           static_cast&lt;float&gt;(rect.bottom-1) / static_cast&lt;float&gt;(texture.get_height())),
+                     Sizef(static_cast&lt;float&gt;(surface.get_width()), static_cast&lt;float&gt;(surface.get_height())));
     }
 }
 

Modified: trunk/windstille/src/display/vertex_array_drawing_request.cpp
===================================================================
--- trunk/windstille/src/display/vertex_array_drawing_request.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/display/vertex_array_drawing_request.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -147,12 +147,12 @@
 }
 
 void
-VertexArrayDrawingRequest::color(const Color&amp; color)
+VertexArrayDrawingRequest::color(const Color&amp; color_)
 {
-  colors.push_back(static_cast&lt;unsigned char&gt;(color.r * 255));
-  colors.push_back(static_cast&lt;unsigned char&gt;(color.g * 255));
-  colors.push_back(static_cast&lt;unsigned char&gt;(color.b * 255));
-  colors.push_back(static_cast&lt;unsigned char&gt;(color.a * 255));
+  colors.push_back(static_cast&lt;unsigned char&gt;(color_.r * 255));
+  colors.push_back(static_cast&lt;unsigned char&gt;(color_.g * 255));
+  colors.push_back(static_cast&lt;unsigned char&gt;(color_.b * 255));
+  colors.push_back(static_cast&lt;unsigned char&gt;(color_.a * 255));
 }
 
 void

Modified: trunk/windstille/src/engine/squirrel_thread.cpp
===================================================================
--- trunk/windstille/src/engine/squirrel_thread.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/engine/squirrel_thread.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -29,7 +29,7 @@
 {
   std::istream* in = reinterpret_cast&lt;std::istream*&gt; (file);
 
-  char c = in-&gt;get();
+  char c = static_cast&lt;char&gt;(in-&gt;get());
 
   if (in-&gt;eof())
     return 0;

Modified: trunk/windstille/src/gui/list_view.cpp
===================================================================
--- trunk/windstille/src/gui/list_view.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/gui/list_view.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -41,7 +41,7 @@
   TTFFont* font = Fonts::current()-&gt;vera20.get();
 
   float x = rect.left;
-  float y = rect.top + font-&gt;get_height();
+  float y = rect.top + static_cast&lt;float&gt;(font-&gt;get_height());
   float padding = 10;
 
   for(int i = 0; i &lt; int(columns.size()); ++i)
@@ -61,10 +61,10 @@
 
       if (j == current_item)
         Display::fill_rect(Rectf(x, y,
-                                 rect.right, y + font-&gt;get_height()), 
+                                 rect.right, y + static_cast&lt;float&gt;(font-&gt;get_height())), 
                            is_active() ? Color(0.5f, 0.5f, 1.0f, 0.8f) : Color(0.5f, 0.5f, 1.0f, 0.3f));
 
-      y += font-&gt;get_height();
+      y += static_cast&lt;float&gt;(font-&gt;get_height());
           
       for(int i = 0; i &lt; int(items[j].columns.size()) &amp;&amp; i &lt; int(columns.size()); ++i)
         {

Modified: trunk/windstille/src/hud/speech_manager.cpp
===================================================================
--- trunk/windstille/src/hud/speech_manager.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/hud/speech_manager.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -46,7 +46,7 @@
     seconds_passed(0.0f)
 {
   // FIXME: Calculate words by other means, this isn't good for long text
-  float words = 2 + text.size() / 5.0f;
+  float words = 2.0f + static_cast&lt;float&gt;(text.size()) / 5.0f;
   float words_per_minute = 150.0f;
   float words_per_second = words_per_minute / 60.0f;
 

Modified: trunk/windstille/src/input/input_configurator.cpp
===================================================================
--- trunk/windstille/src/input/input_configurator.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/input/input_configurator.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -31,9 +31,10 @@
     wait_for_plus(false),
     minus(),
     out(),
-    area(Rectf(120, 100,
-               Display::get_width()  - 120, 
-               Display::get_height() - 100), 
+    area(Rectf(120.0f,
+               100.0f,
+               static_cast&lt;float&gt;(Display::get_width())  - 120.0f,
+               static_cast&lt;float&gt;(Display::get_height()) - 100.0f), 
          false)
 {
   out &lt;&lt; &quot;Input Configurator\n&quot;
@@ -79,9 +80,9 @@
 void
 InputConfigurator::draw()
 {
-  Rectf rect(100, 75,
-             Display::get_width()  - 100, 
-             Display::get_height() - 75);
+  Rectf rect(100.0f, 75.0f,
+             static_cast&lt;float&gt;(Display::get_width())  - 100.0f, 
+             static_cast&lt;float&gt;(Display::get_height()) - 75.0f);
 
   Display::fill_rounded_rect(rect, 16.0f, Color(0.3f, 0.3f, 0.5f, 0.5f));
   Display::draw_rounded_rect(rect, 16.0f, Color(1.0f, 1.0f, 1.0f, 0.5f)); 

Modified: trunk/windstille/src/lisp/property_iterator.hpp
===================================================================
--- trunk/windstille/src/lisp/property_iterator.hpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/lisp/property_iterator.hpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -8,8 +8,8 @@
 {
 
 struct ListEntry {
-  ListEntry(const lisp::Lisp* lisp)
-    : lisp(lisp), used(false)
+  ListEntry(const lisp::Lisp* lisp_)
+    : lisp(lisp_), used(false)
   {}
   
   const Lisp* lisp;

Modified: trunk/windstille/src/math/matrix.cpp
===================================================================
--- trunk/windstille/src/math/matrix.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/math/matrix.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -175,21 +175,21 @@
 Matrix
 Matrix::scale(float x, float y, float z)
 {
-  Matrix matrix = Matrix::identity();
-  matrix[0]  = x;
-  matrix[5]  = y;
-  matrix[10] = z;
-  return multiply(matrix);
+  Matrix m = Matrix::identity();
+  m[0]  = x;
+  m[5]  = y;
+  m[10] = z;
+  return multiply(m);
 }
 
 Matrix
 Matrix::translate(float x, float y, float z)
 {
-  Matrix matrix = Matrix::identity();
-  matrix[12] = x;
-  matrix[13] = y;
-  matrix[14] = z;
-  return multiply(matrix);
+  Matrix m = Matrix::identity();
+  m[12] = x;
+  m[13] = y;
+  m[14] = z;
+  return multiply(m);
 }
 
 Matrix

Modified: trunk/windstille/src/math/point.hpp
===================================================================
--- trunk/windstille/src/math/point.hpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/math/point.hpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -57,9 +57,9 @@
     : x(0), y(0)
   {}
 
-  Point(int x, int y)
-    : x(x), 
-      y(y)
+  Point(int x_, int y_)
+    : x(x_), 
+      y(y_)
   {}
 
   Point(const Point &amp;p)

Modified: trunk/windstille/src/math/quaternion.hpp
===================================================================
--- trunk/windstille/src/math/quaternion.hpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/math/quaternion.hpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -35,8 +35,8 @@
     : w(0), x(0), y(0), z(0)
   {}
 
-  Quaternion(float w, float x, float y, float z)
-    : w(w), x(x), y(y), z(z)
+  Quaternion(float w_, float x_, float y_, float z_)
+    : w(w_), x(x_), y(y_), z(z_)
   {}
 
   /** Construct a Quaternion representing a rotation 

Modified: trunk/windstille/src/math/size.hpp
===================================================================
--- trunk/windstille/src/math/size.hpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/math/size.hpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -56,8 +56,8 @@
     : width(0), height(0)
   {}
 
-  Size(int width, int height)
-    : width(width), height(height) 
+  Size(int width_, int height_)
+    : width(width_), height(height_) 
   {}
 
   Size(const Size &amp;s)
@@ -121,9 +121,9 @@
       height(static_cast&lt;float&gt;(s.height))
   {}
 
-  Sizef(float width, float height)
-    : width(width), 
-      height(height) 
+  Sizef(float width_, float height_)
+    : width(width_), 
+      height(height_) 
   {}
 
   Sizef(const Sizef &amp;s)

Modified: trunk/windstille/src/math/vector3.hpp
===================================================================
--- trunk/windstille/src/math/vector3.hpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/math/vector3.hpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -36,8 +36,8 @@
     : x(0), y(0), z(0)
   {}
 
-  Vector3(float x, float y, float z)
-    : x(x), y(y), z(z)
+  Vector3(float x_, float y_, float z_)
+    : x(x_), y(y_), z(z_)
   {}
 
   bool operator== (const Vector3&amp; o) const

Modified: trunk/windstille/src/navigation/edge_position.cpp
===================================================================
--- trunk/windstille/src/navigation/edge_position.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/navigation/edge_position.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -86,7 +86,7 @@
 
   Vector2f proj = adv.project(edge_v);
 
-  float angle = atan2(edge_v.y, edge_v.x) - atan2(proj.y, proj.x);
+  float angle = atan2f(edge_v.y, edge_v.x) - atan2f(proj.y, proj.x);
 
   // Check if we are going forward or backward
   float advf;

Modified: trunk/windstille/src/particles/deform_drawer.cpp
===================================================================
--- trunk/windstille/src/particles/deform_drawer.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/particles/deform_drawer.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -116,8 +116,8 @@
 
             if (i-&gt;angle != 0)
               {
-                float s = sinf(M_PI * i-&gt;angle/180.0f);
-                float c = cosf(M_PI * i-&gt;angle/180.0f);
+                float s = sinf(math::pi * i-&gt;angle/180.0f);
+                float c = cosf(math::pi * i-&gt;angle/180.0f);
                 x_rot = (width/2) * c - (height/2) * s;
                 y_rot = (width/2) * s + (height/2) * c;
               }

Modified: trunk/windstille/src/particles/particle_system.cpp
===================================================================
--- trunk/windstille/src/particles/particle_system.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/particles/particle_system.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -260,12 +260,12 @@
   // particle.x   += (parent ? parent-&gt;get_pos().x : 0) + x_pos + spawn_x;
   // particle.y   += (parent ? parent-&gt;get_pos().y : 0) + y_pos + spawn_y;
 
-  float direction = rnd.drand(cone_start, cone_stop);
-  float speed     = rnd.drand(speed_start, speed_stop);
-  particle.v_x    = cos(direction) * speed;
-  particle.v_y    = sin(direction) * speed;
+  float direction = rnd.frand(cone_start, cone_stop);
+  float speed     = rnd.frand(speed_start, speed_stop);
+  particle.v_x    = cosf(direction) * speed;
+  particle.v_y    = sinf(direction) * speed;
 
-  particle.angle = rnd.drand(360);
+  particle.angle = rnd.frand(360.0f);
 
   particle.t   = fmodf(particle.t, life_time);
 }
@@ -309,7 +309,7 @@
       for(Particles::size_type i = old_size; i &lt; particles.size(); ++i)
         {
           spawn(particles[i]);
-          particles[i].t = life_time * bunching * float(i)/particles.size();
+          particles[i].t = life_time * bunching * static_cast&lt;float&gt;(i) / static_cast&lt;float&gt;(particles.size());
         }
     }
 }
@@ -368,8 +368,8 @@
 void
 ParticleSystem::set_cone(float start_angle, float stop_angle)
 {
-  cone_start = start_angle * M_PI/180.0f;
-  cone_stop  = stop_angle  * M_PI/180.0f;
+  cone_start = start_angle * math::pi/180.0f;
+  cone_stop  = stop_angle  * math::pi/180.0f;
 }
 
 void

Modified: trunk/windstille/src/particles/randomizer.hpp
===================================================================
--- trunk/windstille/src/particles/randomizer.hpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/particles/randomizer.hpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -44,8 +44,8 @@
     : rect(rect_) {}
  
   void set_pos(Particle&amp; p) {
-    p.x = rnd.drand(rect.left, rect.right);
-    p.y = rnd.drand(rect.top,  rect.bottom);
+    p.x = rnd.frand(rect.left, rect.right);
+    p.y = rnd.frand(rect.top,  rect.bottom);
   }
 };
 
@@ -58,8 +58,8 @@
 
   void set_pos(Particle&amp; p) {
     // FIXME: BROKEN!!!!!
-    p.x = rnd.drand(-radius, radius);
-    p.y = sqrt((radius*radius) - (p.x*p.x)) * rnd.drand(-1.0f, 1.0f);
+    p.x = rnd.frand(-radius, radius);
+    p.y = sqrtf((radius*radius) - (p.x*p.x)) * rnd.frand(-1.0f, 1.0f);
   }
 };
 
@@ -73,7 +73,7 @@
   {}
 
   void set_pos(Particle&amp; p) {
-    float l = rnd.drand();
+    float l = rnd.frand();
     p.x = x1 + (x2-x1) * l;
     p.y = y1 + (y2-y1) * l;
   }

Modified: trunk/windstille/src/particles/surface_drawer.cpp
===================================================================
--- trunk/windstille/src/particles/surface_drawer.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/particles/surface_drawer.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -121,8 +121,8 @@
 
           if (i-&gt;angle != 0)
             {
-              float s = sin(M_PI * i-&gt;angle/180.0f);
-              float c = cos(M_PI * i-&gt;angle/180.0f);
+              float s = sinf(math::pi * i-&gt;angle/180.0f);
+              float c = cosf(math::pi * i-&gt;angle/180.0f);
               x_rot = (width/2) * c - (height/2) * s;
               y_rot = (width/2) * s + (height/2) * c;
             }

Modified: trunk/windstille/src/screen/sprite3dview.cpp
===================================================================
--- trunk/windstille/src/screen/sprite3dview.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/screen/sprite3dview.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -68,7 +68,7 @@
   sc.color().fill_screen(Color(0.5, 0.0, 0.5));
 
   sc.push_modelview();
-  sc.translate(Display::get_width()/2.0f, Display::get_height()/2.0f);
+  sc.translate(static_cast&lt;float&gt;(Display::get_width())/2.0f, static_cast&lt;float&gt;(Display::get_height())/2.0f);
   sc.scale(scale, scale);
 
   // Rotate
@@ -86,7 +86,7 @@
   sc.render();
   
   float x = 10.0f;
-  float y =  Fonts::current()-&gt;vera12-&gt;get_height() + 5.0f;
+  float y =  static_cast&lt;float&gt;(Fonts::current()-&gt;vera12-&gt;get_height()) + 5.0f;
   int line_height = Fonts::current()-&gt;vera12-&gt;get_height()+5;
 
   for(int i = 0; i &lt; int(actions.size()); ++i)
@@ -99,11 +99,11 @@
                             actions[i], Color(0.7f, 0.7f, 0.7f));
 
 
-      y += line_height;
+      y += static_cast&lt;float&gt;(line_height);
       if (y &gt; 580.0f)
         {
           x += 200.0f;
-          y =  Fonts::current()-&gt;vera12-&gt;get_height() + 5.0f;
+          y =  static_cast&lt;float&gt;(Fonts::current()-&gt;vera12-&gt;get_height()) + 5.0f;
         }
     }
 }

Modified: trunk/windstille/src/screen/title_screen.cpp
===================================================================
--- trunk/windstille/src/screen/title_screen.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/screen/title_screen.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -43,8 +43,8 @@
 void
 TitleScreen::draw()
 {
-  background.draw(Vector2f(Display::get_width() /2  - (background.get_width()  * background.get_scale()/2),
-                           Display::get_height()/2  - (background.get_height() * background.get_scale()/2)));
+  background.draw(Vector2f(Display::get_width()  / 2.0f - (background.get_width()  * background.get_scale() / 2.0f),
+                           Display::get_height() / 2.0f - (background.get_height() * background.get_scale() / 2.0f)));
 }
 
 void

Modified: trunk/windstille/src/sound/stream_sound_source.cpp
===================================================================
--- trunk/windstille/src/sound/stream_sound_source.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/sound/stream_sound_source.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -86,7 +86,7 @@
       if (fade_state == FadingOn) 
         {
           unsigned int ticks = SDL_GetTicks();
-          float time = (ticks - fade_start_ticks) / 1000.0;
+          float time = static_cast&lt;float&gt;(ticks - fade_start_ticks) / 1000.0;
           if (time &gt;= fade_time)
             {
               set_gain(1.0);

Modified: trunk/windstille/src/sprite2d/sprite.cpp
===================================================================
--- trunk/windstille/src/sprite2d/sprite.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/sprite2d/sprite.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -74,8 +74,8 @@
   blend_dfactor = GL_ONE_MINUS_SRC_ALPHA;
 }
 
-Sprite::Sprite(const SpriteDataPtr data)
-  : data(data),
+Sprite::Sprite(const SpriteDataPtr data_)
+  : data(data_),
     current_action(0),
     frame(0),
     speed(0),
@@ -149,8 +149,8 @@
   if(reverse)
     step = -step;
 
-  frame = fmodf(frame + current_action-&gt;surfaces.size() + step,
-                current_action-&gt;surfaces.size());
+  frame = fmodf(frame + static_cast&lt;float&gt;(current_action-&gt;surfaces.size()) + step,
+                static_cast&lt;float&gt;(current_action-&gt;surfaces.size()));
 }
 
 void
@@ -191,9 +191,9 @@
 }
 
 void
-Sprite::set_vflip(bool vflip)
+Sprite::set_vflip(bool vflip_)
 {
-  this-&gt;vflip = vflip;
+  vflip = vflip_;
 }
 
 bool
@@ -203,9 +203,9 @@
 }
 
 void
-Sprite::set_pingpong(bool pingpong)
+Sprite::set_pingpong(bool pingpong_)
 {
-  this-&gt;pingpong = pingpong;
+  pingpong = pingpong_;
 }
 
 bool
@@ -215,9 +215,9 @@
 }
 
 void
-Sprite::set_speed(float speed)
+Sprite::set_speed(float speed_)
 {
-  this-&gt;speed = speed;
+  speed = speed_;
 }
 
 float
@@ -229,7 +229,7 @@
 void
 Sprite::set_alpha(float alpha)
 {
-  this-&gt;color.a = alpha;
+  color.a = alpha;
 }
 
 float
@@ -311,16 +311,16 @@
   return blend_dfactor;
 }
 
-int
+float
 Sprite::get_width() const
 {
-  return current_action-&gt;surfaces[ static_cast&lt;int&gt; (frame) ].get_width();
+  return current_action-&gt;surfaces[ static_cast&lt;int&gt;(frame) ].get_width();
 }
 
-int
+float
 Sprite::get_height() const
 {
-  return current_action-&gt;surfaces[ static_cast&lt;int&gt; (frame) ].get_height();
+  return current_action-&gt;surfaces[ static_cast&lt;int&gt;(frame) ].get_height();
 }
 
 /* EOF */

Modified: trunk/windstille/src/sprite2d/sprite.hpp
===================================================================
--- trunk/windstille/src/sprite2d/sprite.hpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/sprite2d/sprite.hpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -102,8 +102,8 @@
 
   Vector2f get_offset() const;
 
-  int get_width() const;
-  int get_height() const;
+  float get_width() const;
+  float get_height() const;
 
   /** true if the Sprite is valid and usable, false if not */
   operator bool() const;

Modified: trunk/windstille/src/sprite3d/sprite3d.cpp
===================================================================
--- trunk/windstille/src/sprite3d/sprite3d.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/sprite3d/sprite3d.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -217,7 +217,7 @@
   if ((speed &lt;  0.0f &amp;&amp; frame1.speed &gt;= 0.0f) ||
       (speed &gt;= 0.0f &amp;&amp; frame1.speed &lt;  0.0f)) 
     {
-      blend_time = 1.0 - blend_time;
+      blend_time = 1.0f - blend_time;
       std::swap(frame1, frame2);
     }
 
@@ -290,9 +290,9 @@
   const Sprite3D* sprite;
 
 public:
-  Sprite3DDrawingRequest(const Sprite3D* sprite, const Vector2f&amp; pos, float z_pos,
-                       const Matrix&amp; modelview)
-    : DrawingRequest(pos, z_pos, modelview), sprite(sprite)
+  Sprite3DDrawingRequest(const Sprite3D* sprite, 
+                         const Vector2f&amp; pos_, float z_pos_, const Matrix&amp; modelview_)
+    : DrawingRequest(pos_, z_pos_, modelview_), sprite(sprite)
   {}
 
   void draw(const Texture&amp; /*tmp_texture*/)
@@ -343,8 +343,9 @@
   if(frame1.speed &lt; 0)
     time_delta = -time_delta;
   
-  while(blend_time + time_delta &gt;= 1.0) {
-    delta -= (1.0 - blend_time) / (frame1.action-&gt;speed * frame1.speed);
+  while(blend_time + time_delta &gt;= 1.0f)
+  {
+    delta -= (1.0f - blend_time) / (frame1.action-&gt;speed * frame1.speed);
     set_next_frame();
 
     time_delta = delta * frame1.action-&gt;speed * frame1.speed;

Modified: trunk/windstille/src/tile/tile_map.cpp
===================================================================
--- trunk/windstille/src/tile/tile_map.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/tile/tile_map.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -145,16 +145,16 @@
               }
             
             request-&gt;texcoord(tile-&gt;uv.left, tile-&gt;uv.top);
-            request-&gt;vertex(x * TILE_SIZE, y * TILE_SIZE);
+            request-&gt;vertex(static_cast&lt;float&gt;(x * TILE_SIZE), static_cast&lt;float&gt;(y * TILE_SIZE));
 
             request-&gt;texcoord(tile-&gt;uv.right, tile-&gt;uv.top);
-            request-&gt;vertex(x * TILE_SIZE + TILE_SIZE, y * TILE_SIZE);
-
+            request-&gt;vertex(static_cast&lt;float&gt;(x * TILE_SIZE + TILE_SIZE), static_cast&lt;float&gt;(y * TILE_SIZE));
+            
             request-&gt;texcoord(tile-&gt;uv.right, tile-&gt;uv.bottom);
-            request-&gt;vertex(x * TILE_SIZE + TILE_SIZE, y * TILE_SIZE + TILE_SIZE);
+            request-&gt;vertex(static_cast&lt;float&gt;(x * TILE_SIZE + TILE_SIZE), static_cast&lt;float&gt;(y * TILE_SIZE + TILE_SIZE));
             
             request-&gt;texcoord(tile-&gt;uv.left, tile-&gt;uv.bottom);
-            request-&gt;vertex(x * TILE_SIZE, y * TILE_SIZE + TILE_SIZE); 
+            request-&gt;vertex(static_cast&lt;float&gt;(x * TILE_SIZE), static_cast&lt;float&gt;(y * TILE_SIZE + TILE_SIZE)); 
           }
       }
 

Modified: trunk/windstille/src/tile/tile_packer.cpp
===================================================================
--- trunk/windstille/src/tile/tile_packer.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/tile/tile_packer.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -76,16 +76,16 @@
   SoftwareSurface convert(w+2, h+2);
 
   SDL_Rect source_rect;
-  source_rect.x = x;
-  source_rect.y = y;
-  source_rect.w = w;
-  source_rect.h = h;
+  source_rect.x = static_cast&lt;Sint16&gt;(x);
+  source_rect.y = static_cast&lt;Sint16&gt;(y);
+  source_rect.w = static_cast&lt;Sint16&gt;(w);
+  source_rect.h = static_cast&lt;Sint16&gt;(h);
 
   SDL_Rect dest_rect;
-  dest_rect.x = 1;
-  dest_rect.y = 1;
-  dest_rect.w = w;
-  dest_rect.h = h;
+  dest_rect.x = static_cast&lt;Sint16&gt;(1);
+  dest_rect.y = static_cast&lt;Sint16&gt;(1);
+  dest_rect.w = static_cast&lt;Sint16&gt;(w);
+  dest_rect.h = static_cast&lt;Sint16&gt;(h);
 
   SDL_BlitSurface(image.get_surface(), &amp;source_rect, convert.get_surface(), &amp;dest_rect);
 
@@ -95,10 +95,10 @@
   
   assert_gl(&quot;updating tilepacker texture&quot;);
 
-  Rectf rect(Vector2f(static_cast&lt;float&gt;(impl-&gt;x_pos+1)/impl-&gt;width, 
-                    static_cast&lt;float&gt;(impl-&gt;y_pos+1)/impl-&gt;height), 
-             Sizef(static_cast&lt;float&gt;(TILE_RESOLUTION)/impl-&gt;width, 
-                   static_cast&lt;float&gt;(TILE_RESOLUTION)/impl-&gt;height));
+  Rectf rect(Vector2f(static_cast&lt;float&gt;(impl-&gt;x_pos + 1) / impl-&gt;width, 
+                      static_cast&lt;float&gt;(impl-&gt;y_pos + 1) / impl-&gt;height), 
+             Sizef(static_cast&lt;float&gt;(TILE_RESOLUTION) / impl-&gt;width, 
+                   static_cast&lt;float&gt;(TILE_RESOLUTION) / impl-&gt;height));
 
   // we move by TILE_RESOLUTION+1 to avoid tiles bleeding into each other
   // when blending

Modified: trunk/windstille/src/util/baby_xml.cpp
===================================================================
--- trunk/windstille/src/util/baby_xml.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/util/baby_xml.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -152,8 +152,8 @@
           } 
         else if (c == '&amp;') 
           {
-            c += read_entity();
-          } 
+            c += read_entity(); // FIXME: This can't be right
+          }
         else 
           {
             incr_cursor();

Modified: trunk/windstille/src/util/response_curve.cpp
===================================================================
--- trunk/windstille/src/util/response_curve.cpp	2009-08-23 22:43:53 UTC (rev 3024)
+++ trunk/windstille/src/util/response_curve.cpp	2009-08-24 00:21:33 UTC (rev 3025)
@@ -46,11 +46,11 @@
       v = math::mid(i_min, v, i_max);
 
       int   bucket_count = samples.size() - 1;
-      float bucket_size  = (i_max - i_min) / bucket_count;
+      float bucket_size  = (i_max - i_min) / static_cast&lt;float&gt;(bucket_count);
       
       int bucket_index = int((v - i_min) / bucket_size);
 
-      float t = ((v - i_min) - (bucket_index * bucket_size)) / bucket_size;
+      float t = ((v - i_min) - (static_cast&lt;float&gt;(bucket_index) * bucket_size)) / bucket_size;
       
       return ((1.0f - t) * samples[bucket_index]) + (t * samples[bucket_index + 1]);
     }


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002021.html">[Windstille-commit] r3024 - in trunk/windstille/src: app collision	engine hud input lisp objects screen scripting
</A></li>
	<LI>Next message: <A HREF="002023.html">[Windstille-commit] r3026 - in trunk/windstille/src: app collision	screen
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2022">[ date ]</a>
              <a href="thread.html#2022">[ thread ]</a>
              <a href="subject.html#2022">[ subject ]</a>
              <a href="author.html#2022">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/windstille-commit">More information about the Windstille-commit
mailing list</a><br>
</body></html>
