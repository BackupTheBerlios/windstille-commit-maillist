<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Windstille-commit] r3035 - in trunk/windstille/src: collision	engine gui hud input objects physfs
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/windstille-commit/2009-August/index.html" >
   <LINK REL="made" HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r3035%20-%20in%20trunk/windstille/src%3A%20collision%0A%09engine%20gui%20hud%20input%20objects%20physfs&In-Reply-To=%3C200908241159.n7OBxAUG024503%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002031.html">
   <LINK REL="Next"  HREF="002033.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Windstille-commit] r3035 - in trunk/windstille/src: collision	engine gui hud input objects physfs</H1>
    <B>grumbel at BerliOS</B> 
    <A HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r3035%20-%20in%20trunk/windstille/src%3A%20collision%0A%09engine%20gui%20hud%20input%20objects%20physfs&In-Reply-To=%3C200908241159.n7OBxAUG024503%40sheep.berlios.de%3E"
       TITLE="[Windstille-commit] r3035 - in trunk/windstille/src: collision	engine gui hud input objects physfs">grumbel at mail.berlios.de
       </A><BR>
    <I>Mon Aug 24 13:59:10 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002031.html">[Windstille-commit] r3034 - in trunk/windstille/src: objects sound
</A></li>
        <LI>Next message: <A HREF="002033.html">[Windstille-commit] r3036 - trunk/windstille/src/editor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2032">[ date ]</a>
              <a href="thread.html#2032">[ thread ]</a>
              <a href="subject.html#2032">[ subject ]</a>
              <a href="author.html#2032">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: grumbel
Date: 2009-08-24 13:59:04 +0200 (Mon, 24 Aug 2009)
New Revision: 3035

Modified:
   trunk/windstille/src/collision/collision_engine.cpp
   trunk/windstille/src/engine/camera.cpp
   trunk/windstille/src/gui/grid_component.cpp
   trunk/windstille/src/gui/group_component.cpp
   trunk/windstille/src/gui/menu.cpp
   trunk/windstille/src/gui/menu_component.cpp
   trunk/windstille/src/gui/menu_item.cpp
   trunk/windstille/src/gui/slider.cpp
   trunk/windstille/src/gui/tab_component.cpp
   trunk/windstille/src/hud/conversation.cpp
   trunk/windstille/src/hud/dialog_manager.cpp
   trunk/windstille/src/hud/inventory.cpp
   trunk/windstille/src/input/wiimote.cpp
   trunk/windstille/src/objects/bomb.cpp
   trunk/windstille/src/objects/hedgehog.cpp
   trunk/windstille/src/objects/laser_pointer.cpp
   trunk/windstille/src/objects/shockwave.cpp
   trunk/windstille/src/objects/spider_mine.cpp
   trunk/windstille/src/physfs/physfs_sdl.cpp
Log:
Cleaned up a bunch of float/int/double conversion warnings (should be all for the windstille part, editor still to come)

Modified: trunk/windstille/src/collision/collision_engine.cpp
===================================================================
--- trunk/windstille/src/collision/collision_engine.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/collision/collision_engine.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -165,14 +165,14 @@
 
 Rectf get_next_free_rect(TileMap *tilemap, const Rectf &amp;r)
 {
-  int rx = c_round (r.left / TILE_SIZE);
-  int ry = c_round (std::min (r.top, r.bottom)  / TILE_SIZE);
+  int rx = c_round(r.left / static_cast&lt;float&gt;(TILE_SIZE));
+  int ry = c_round(std::min (r.top, r.bottom)  / static_cast&lt;float&gt;(TILE_SIZE));
   
   float fw = r.right - r.left;
   float fh = fabsf(r.bottom   - r.top);
   
-  int rw = c_roundup (fw / TILE_SIZE);
-  int rh = c_roundup (fh / TILE_SIZE);
+  int rw = c_roundup (fw / static_cast&lt;float&gt;(TILE_SIZE));
+  int rh = c_roundup (fh / static_cast&lt;float&gt;(TILE_SIZE));
 
   std::vector&lt;Rectf&gt; rects;
 
@@ -203,8 +203,8 @@
   Rectf nr;
   for (std::vector&lt;Rectf&gt;::iterator i = rects.begin(); i != rects.end(); ++i)
     {
-      dx = i-&gt;left - r.left / TILE_SIZE;
-      dy = i-&gt;top  - r.top  / TILE_SIZE;
+      dx = i-&gt;left - r.left / static_cast&lt;float&gt;(TILE_SIZE);
+      dy = i-&gt;top  - r.top  / static_cast&lt;float&gt;(TILE_SIZE);
       d = sqrtf( dx * dx + dy * dy );
       if (d &lt; distance)
 	{
@@ -232,8 +232,8 @@
 
   Rectf target = get_next_free_rect(a.tilemap, rb);
   
-  target.left   *= TILE_SIZE;
-  target.top    *= TILE_SIZE;
+  target.left   *= static_cast&lt;float&gt;(TILE_SIZE);
+  target.top    *= static_cast&lt;float&gt;(TILE_SIZE);
   target.right  = target.left + (rb.right - rb.left);
   target.bottom = target.top  + (rb.top - rb.bottom);
 
@@ -241,13 +241,13 @@
 
   if(target.top &lt; rb.top)
     {
-      float add = c_roundup (target.bottom / TILE_SIZE) * TILE_SIZE - target.bottom;
+      float add = static_cast&lt;float&gt;(c_roundup(target.bottom / static_cast&lt;float&gt;(TILE_SIZE))) * static_cast&lt;float&gt;(TILE_SIZE) - target.bottom;
       target.top    += add;
       target.bottom += add;
     }
   if(target.left &lt; rb.left)
     {
-      float add = c_roundup (target.right / TILE_SIZE) * TILE_SIZE - target.right;
+      float add = static_cast&lt;float&gt;(c_roundup(target.right / static_cast&lt;float&gt;(TILE_SIZE))) * static_cast&lt;float&gt;(TILE_SIZE) - target.right;
       target.left  += add;
       target.right += add;
     }
@@ -530,10 +530,10 @@
   int miny, maxy;
   int x, y;
 
-  minx = static_cast&lt;int&gt;(r.left   / TILE_SIZE);
-  maxx = static_cast&lt;int&gt;(r.right  / TILE_SIZE);
-  miny = static_cast&lt;int&gt;(r.top    / TILE_SIZE);
-  maxy = static_cast&lt;int&gt;(r.bottom / TILE_SIZE);
+  minx = static_cast&lt;int&gt;(r.left   / static_cast&lt;float&gt;(TILE_SIZE));
+  maxx = static_cast&lt;int&gt;(r.right  / static_cast&lt;float&gt;(TILE_SIZE));
+  miny = static_cast&lt;int&gt;(r.top    / static_cast&lt;float&gt;(TILE_SIZE));
+  maxy = static_cast&lt;int&gt;(r.bottom / static_cast&lt;float&gt;(TILE_SIZE));
 
   assert(maxy&gt;=miny);
   assert(maxx&gt;=minx);
@@ -541,7 +541,7 @@
   for (y = std::max (0, miny); y &lt;= std::min (maxy, tilemap-&gt;get_height() - 1); ++y)
     for (x = std::max (0, minx); x &lt;= std::min (maxx, tilemap-&gt;get_width() - 1); ++x)
       {
-	if(tilemap-&gt;is_ground (x * TILE_SIZE, y * TILE_SIZE ))
+	if(tilemap-&gt;is_ground (static_cast&lt;float&gt;(x * TILE_SIZE), static_cast&lt;float&gt;(y * TILE_SIZE) ))
 	  {
 	    return true;
 	  }
@@ -556,17 +556,20 @@
   int miny, maxy;
   int x, y;
 
-  minx = static_cast&lt;int&gt;(r.left   / TILE_SIZE);
-  maxx = static_cast&lt;int&gt;(r.right  / TILE_SIZE);
-  miny = static_cast&lt;int&gt;(r.top    / TILE_SIZE);
-  maxy = static_cast&lt;int&gt;(r.bottom / TILE_SIZE);
+  minx = static_cast&lt;int&gt;(r.left   / static_cast&lt;float&gt;(TILE_SIZE));
+  maxx = static_cast&lt;int&gt;(r.right  / static_cast&lt;float&gt;(TILE_SIZE));
+  miny = static_cast&lt;int&gt;(r.top    / static_cast&lt;float&gt;(TILE_SIZE));
+  maxy = static_cast&lt;int&gt;(r.bottom / static_cast&lt;float&gt;(TILE_SIZE));
 
   for (y = std::max (0, miny); y &lt;= std::min (maxy, tilemap-&gt;get_height() - 1); ++y)
     for (x = std::max (0, minx); x &lt;= std::min (maxx, tilemap-&gt;get_width() - 1); ++x)
       {
-	if(tilemap-&gt;is_ground (x * TILE_SIZE, y * TILE_SIZE ) == is_ground)
+	if(tilemap-&gt;is_ground (static_cast&lt;float&gt;(x * TILE_SIZE), static_cast&lt;float&gt;(y * TILE_SIZE) ) == is_ground)
 	  {
-	    rect_list.push_back (Rectf (x * TILE_SIZE, y * TILE_SIZE, TILE_SIZE, TILE_SIZE));
+	    rect_list.push_back (Rectf (static_cast&lt;float&gt;(x * TILE_SIZE), 
+                                        static_cast&lt;float&gt;(y * TILE_SIZE), 
+                                        static_cast&lt;float&gt;(TILE_SIZE), 
+                                        static_cast&lt;float&gt;(TILE_SIZE)));
 	  }
       }
   return rect_list;
@@ -640,27 +643,27 @@
 
       if(first_time)
 	{
-	  next_x = get_integer(*x / TILE_SIZE,vel.x) * TILE_SIZE;
-	  next_y = get_integer(*y / TILE_SIZE,vel.y) * TILE_SIZE;
+	  next_x = get_integer(static_cast&lt;float&gt;(*x) / static_cast&lt;float&gt;(TILE_SIZE), vel.x) * TILE_SIZE;
+	  next_y = get_integer(static_cast&lt;float&gt;(*y) / static_cast&lt;float&gt;(TILE_SIZE), vel.y) * TILE_SIZE;
 	  first_time = false;
 	}
       else
 	{
-	  next_x = get_next_integer ((*x / TILE_SIZE), vel.x) * TILE_SIZE;
-	  next_y = get_next_integer ((*y / TILE_SIZE), vel.y) * TILE_SIZE;
+	  next_x = get_next_integer ((static_cast&lt;float&gt;(*x) / static_cast&lt;float&gt;(TILE_SIZE)), vel.x) * TILE_SIZE;
+          next_y = get_next_integer ((static_cast&lt;float&gt;(*y) / static_cast&lt;float&gt;(TILE_SIZE)), vel.y) * TILE_SIZE;
 
 	 
-	  assert ( next_x * c_sign(vel.x) &gt; *x * c_sign(vel.x) || vel.x == 0.0f);
-	  assert ( next_y * c_sign(vel.y) &gt; *y * c_sign(vel.y) || vel.y == 0.0f);
+	  assert ( static_cast&lt;float&gt;(next_x) * static_cast&lt;float&gt;(c_sign(vel.x)) &gt; *x * static_cast&lt;float&gt;(c_sign(vel.x)) || vel.x == 0.0f);
+          assert ( static_cast&lt;float&gt;(next_y) * static_cast&lt;float&gt;(c_sign(vel.y)) &gt; *y * static_cast&lt;float&gt;(c_sign(vel.y)) || vel.y == 0.0f);
 	}
 
       if (vel.x != 0.0f)
-	tx = (next_x - *x) / vel.x;
+	tx = (static_cast&lt;float&gt;(next_x) - *x) / vel.x;
       else
 	tx = 10000.0f;
 
       if (vel.y != 0.0f)
-	ty = (next_y - *y) / vel.y;
+	ty = (static_cast&lt;float&gt;(next_y) - *y) / vel.y;
       else
 	ty = 10000.0f;
 
@@ -704,13 +707,13 @@
 	  
 	  if (tx &lt; ty)
 	    {
-	      tmp.left  += c_sign(vel.x);
-	      tmp.right += c_sign(vel.x);
+	      tmp.left  += static_cast&lt;float&gt;(c_sign(vel.x));
+              tmp.right += static_cast&lt;float&gt;(c_sign(vel.x));
 	    }
 	  else
 	    {
-	      tmp.top    += c_sign(vel.y);
-	      tmp.bottom += c_sign(vel.y);
+	      tmp.top    += static_cast&lt;float&gt;(c_sign(vel.y));
+	      tmp.bottom += static_cast&lt;float&gt;(c_sign(vel.y));
 	    }
 
 	  // check collision with tilemap
@@ -721,9 +724,9 @@
 	      result.col_time = time;
 	      
 	      if (tx &lt; ty)
-		result.direction=Vector2f(c_sign (vel.x), 0);
+		result.direction = Vector2f(static_cast&lt;float&gt;(c_sign(vel.x)), 0.0f);
 	      else
-		result.direction=Vector2f(0, c_sign (vel.y));
+		result.direction = Vector2f(0, static_cast&lt;float&gt;(c_sign(vel.y)));
 	      return result;
 	    }
 	}

Modified: trunk/windstille/src/engine/camera.cpp
===================================================================
--- trunk/windstille/src/engine/camera.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/engine/camera.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -78,8 +78,8 @@
 
     case CAMERA_FOLLOW_PLAYER:
       {
-        int hscroll_threshold = 100;
-        int vscroll_threshold = 150;
+        float hscroll_threshold = 100.0f;
+        float vscroll_threshold  = 150.0f;
 
         Vector2f tpos = Player::current()-&gt;get_pos();
 
@@ -95,11 +95,11 @@
         else if (dist &lt; -vscroll_threshold)
           pos.y = tpos.y + vscroll_threshold;
 
-        float start_x = Display::get_width()/2;
-        float end_x   = Sector::current()-&gt;get_width() - Display::get_width()/2;
+        float start_x = static_cast&lt;float&gt;(Display::get_width()) / 2.0f;
+        float end_x   = static_cast&lt;float&gt;(Sector::current()-&gt;get_width()) - static_cast&lt;float&gt;(Display::get_width()) / 2.0f;
 
-        float start_y = Display::get_height()/2;
-        float end_y   = Sector::current()-&gt;get_height() - Display::get_height()/2;
+        float start_y = static_cast&lt;float&gt;(Display::get_height()) / 2.0f;
+        float end_y   = static_cast&lt;float&gt;(Sector::current()-&gt;get_height()) - static_cast&lt;float&gt;(Display::get_height()) / 2.0f;
 
         if (pos.x &lt; start_x)
           pos.x = start_x;

Modified: trunk/windstille/src/gui/grid_component.cpp
===================================================================
--- trunk/windstille/src/gui/grid_component.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/gui/grid_component.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -226,10 +226,10 @@
       grid(x, y) = ComponentBox(component, Size(colspan, rowspan));
     }
 
-    component-&gt;set_screen_rect(Rectf(Vector2f(rect.left + x * (rect.get_width() /grid.get_width())  + padding,
-                                              rect.top  + y * (rect.get_height()/grid.get_height()) + padding),
-                                     Sizef((rect.get_width()/grid.get_width())   * colspan - 2*padding,
-                                           (rect.get_height()/grid.get_height()) * rowspan - 2*padding)));
+    component-&gt;set_screen_rect(Rectf(Vector2f(rect.left + static_cast&lt;float&gt;(x) * (rect.get_width()  / static_cast&lt;float&gt;(grid.get_width()))  + padding,
+                                              rect.top  + static_cast&lt;float&gt;(y) * (rect.get_height() / static_cast&lt;float&gt;(grid.get_height())) + padding),
+                                     Sizef((rect.get_width()  / static_cast&lt;float&gt;(grid.get_width()))  * static_cast&lt;float&gt;(colspan) - 2.0f * padding,
+                                           (rect.get_height() / static_cast&lt;float&gt;(grid.get_height())) * static_cast&lt;float&gt;(rowspan) - 2.0f * padding)));
   }
 }
 

Modified: trunk/windstille/src/gui/group_component.cpp
===================================================================
--- trunk/windstille/src/gui/group_component.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/gui/group_component.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -45,11 +45,12 @@
   if (!title.empty())
     {
       TTFFont* font = Fonts::current()-&gt;vera20.get();
-      font-&gt;draw_center(Vector2f(rect.left + rect.get_width()/2, rect.top + font-&gt;get_height() + 5), 
+      font-&gt;draw_center(Vector2f(rect.left + static_cast&lt;float&gt;(rect.get_width()) / 2.0f,
+                                 rect.top  + static_cast&lt;float&gt;(font-&gt;get_height()) + 5.0f),
                         title, Color(1.0f, 1.0f, 1.0f));
 
-      Display::fill_rect(Rectf(rect.left  + 8, rect.top + font-&gt;get_height() + 16,
-                               rect.right - 8, rect.top + font-&gt;get_height() + 18),
+      Display::fill_rect(Rectf(rect.left  + 8.0f, rect.top + static_cast&lt;float&gt;(font-&gt;get_height()) + 16.0f,
+                               rect.right - 8.0f, rect.top + static_cast&lt;float&gt;(font-&gt;get_height()) + 18.0f),
                          Color(1.0f, 1.0f, 1.0f, 0.5f));
     }
 
@@ -77,10 +78,10 @@
 Rectf
 GroupComponent::get_child_rect() const
 {
-  int padding = 6;
+  float padding = 6.0f;
 
   return Rectf(rect.left   + padding,
-               rect.top    + padding + (title.empty() ? 0 : Fonts::current()-&gt;vera20-&gt;get_height() + 18),
+               rect.top    + padding + (title.empty() ? 0.0f : static_cast&lt;float&gt;(Fonts::current()-&gt;vera20-&gt;get_height()) + 18.0f),
                rect.right  - padding,
                rect.bottom - padding);
 }

Modified: trunk/windstille/src/gui/menu.cpp
===================================================================
--- trunk/windstille/src/gui/menu.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/gui/menu.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -103,7 +103,7 @@
                     (rect.top + rect.bottom) / 2.0f);
 
     Sizef size(menu-&gt;get_prefered_width(), 
-               menu-&gt;get_prefered_height() + (group-&gt;has_title() ? Fonts::current()-&gt;vera20-&gt;get_height() + 18 : 0.0f));
+               menu-&gt;get_prefered_height() + (group-&gt;has_title() ? static_cast&lt;float&gt;(Fonts::current()-&gt;vera20-&gt;get_height()) + 18.0f : 0.0f));
 
     group-&gt;set_screen_rect(Rectf(Vector2f(center.x - size.width/2.0f,
                                           center.y - size.height/2.0f),

Modified: trunk/windstille/src/gui/menu_component.cpp
===================================================================
--- trunk/windstille/src/gui/menu_component.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/gui/menu_component.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -69,14 +69,14 @@
     { // we can only display a subset of items and have to scroll
       for(int i = 0; i &lt; num_displayable_items; ++i)
         {
-          items[i+scroll_offset]-&gt;draw(Rectf(rect.left, rect.top + i * step + 2.0f, 
-                                             rect.right - 32, rect.top + (i+1) * step - 2.0f), 
+          items[i+scroll_offset]-&gt;draw(Rectf(rect.left, rect.top + static_cast&lt;float&gt;(i) * step + 2.0f, 
+                                             rect.right - 32.0f, rect.top + static_cast&lt;float&gt;(i+1) * step - 2.0f), 
                                        is_active() &amp;&amp; (int(i+scroll_offset) == current_item));
         }
       
       // draw scrollbar
-      float scrollbar_height = (rect.get_height()-4.0f) * num_displayable_items / items.size();
-      float scrollbar_incr   = (rect.get_height()-4.0f) * scroll_offset / items.size();
+      float scrollbar_height = (rect.get_height() - 4.0f) * static_cast&lt;float&gt;(num_displayable_items) / static_cast&lt;float&gt;(items.size());
+      float scrollbar_incr   = (rect.get_height() - 4.0f) * static_cast&lt;float&gt;(scroll_offset) / static_cast&lt;float&gt;(items.size());
 
       Display::fill_rounded_rect(Rectf(rect.right - 24, rect.top + 2.0f + scrollbar_incr,
                                        rect.right - 2,  rect.top + 2.0f + scrollbar_incr + scrollbar_height),
@@ -92,8 +92,8 @@
     { // all items fit on the screen
       for(Items::size_type i = 0; i &lt; items.size(); ++i)
         {
-          items[i]-&gt;draw(Rectf(rect.left, rect.top + i * step + 2.0f, 
-                               rect.right, rect.top + (i+1) * step - 2.0f), 
+          items[i]-&gt;draw(Rectf(rect.left, rect.top + static_cast&lt;float&gt;(i) * step + 2.0f, 
+                               rect.right, rect.top + static_cast&lt;float&gt;(i+1) * step - 2.0f), 
                          is_active() &amp;&amp; (int(i) == current_item));
         }
     }
@@ -206,20 +206,20 @@
 float
 MenuComponent::get_prefered_height() const
 {
-  return item_height() * std::min(10, int(items.size())) + 12.0f;
+  return item_height() * static_cast&lt;float&gt;(std::min(10, int(items.size()))) + 12.0f;
 }
 
 float
 MenuComponent::calc_height()
 {
-  return items.size() * item_height();
+  return static_cast&lt;float&gt;(items.size()) * item_height();
 }
 
 float
 MenuComponent::item_height() const
 {
   float spacing = 10.0f;
-  return font-&gt;get_height() + spacing*2.0f;
+  return static_cast&lt;float&gt;(font-&gt;get_height()) + spacing * 2.0f;
 }
 
 void 

Modified: trunk/windstille/src/gui/menu_item.cpp
===================================================================
--- trunk/windstille/src/gui/menu_item.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/gui/menu_item.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -61,7 +61,8 @@
     }
   }
 
-  font-&gt;draw(Vector2f(rect.left + font-&gt;get_height(), rect.top + font-&gt;get_height()/2.0f + rect.get_height()/2.0f - 2.0f),
+  font-&gt;draw(Vector2f(rect.left + static_cast&lt;float&gt;(font-&gt;get_height()),
+                      rect.top + static_cast&lt;float&gt;(font-&gt;get_height())/2.0f + rect.get_height() / 2.0f - 2.0f),
              label, font_color);
 }
 
@@ -131,8 +132,8 @@
     font_color = Color(0.75f, 0.75f, 0.75f, 1.0f);
   }
 
-  font-&gt;draw(Vector2f(rect.right - font-&gt;get_height() - font-&gt;get_width(labels[index].label),
-                      rect.top + font-&gt;get_height()/2.0f + rect.get_height()/2.0f - 2.0f),
+  font-&gt;draw(Vector2f(rect.right - static_cast&lt;float&gt;(font-&gt;get_height())      - static_cast&lt;float&gt;(font-&gt;get_width(labels[index].label)),
+                      rect.top   + static_cast&lt;float&gt;(font-&gt;get_height())/2.0f + static_cast&lt;float&gt;(rect.get_height())/2.0f - 2.0f),
              labels[index].label,
              font_color);
 }
@@ -175,9 +176,9 @@
 SliderMenuItem::draw(const Rectf&amp; rect, bool is_active)
 {
   MenuItem::draw(rect, is_active);
-  int total_width = 200;
-  int width = total_width * value / (max_value - min_value);
-
+  float total_width = 200.0f;
+  float width = total_width * static_cast&lt;float&gt;(value) / static_cast&lt;float&gt;(max_value - min_value);
+  
   Color color;
   if (is_active)
   {
@@ -188,13 +189,13 @@
     color = Color(0.75f, 0.75f, 0.75f, 1.0f);
   }
 
-  Display::fill_rounded_rect(Rectf(Vector2f(rect.right - 4 - total_width, rect.top + 4),
+  Display::fill_rounded_rect(Rectf(Vector2f(rect.right - 4.0f - total_width, rect.top + 4.0f),
                                    Sizef(width, rect.get_height() - 8)), 
                              5.0f,
                              Color(0.75f*color.r, 0.75f*color.g, 0.75f*color.b, color.a));
 
 
-  Display::draw_rounded_rect(Rectf(Vector2f(rect.right - 4 - total_width, rect.top + 4),
+  Display::draw_rounded_rect(Rectf(Vector2f(rect.right - 4.0f - total_width, rect.top + 4.0f),
                                    Sizef(total_width, rect.get_height() - 8)), 
                              5.0f,
                              color);

Modified: trunk/windstille/src/gui/slider.cpp
===================================================================
--- trunk/windstille/src/gui/slider.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/gui/slider.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -68,10 +68,10 @@
   Display::fill_rect(rect, Color(0.0f, 0.0f, 0.0f, 0.5f));
   Display::draw_rect(rect, Color(1.0f, 1.0f, 1.0f, 0.5f));
   
-  int width = 30;
-  Rectf slider_rect(Vector2f(rect.left + (rect.get_width()-width) * ((pos-min)/float(max - min)),
-                             rect.top + 2),
-                    Sizef(width, rect.get_height()-4));
+  float width = 30.0f;
+  Rectf slider_rect(Vector2f(rect.left + (rect.get_width()-width) * (static_cast&lt;float&gt;(pos-min)/static_cast&lt;float&gt;(max - min)),
+                             rect.top + 2.0f),
+                    Sizef(width, rect.get_height() - 4.0f));
   if (is_active())
     {
       Display::fill_rect(slider_rect, Color(1.0f, 1.0f, 1.0f, 0.5f));

Modified: trunk/windstille/src/gui/tab_component.cpp
===================================================================
--- trunk/windstille/src/gui/tab_component.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/gui/tab_component.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -48,12 +48,12 @@
 {
   if (tabs.empty()) return;
 
-  float tab_width = rect.get_width()/tabs.size();
+  float tab_width = rect.get_width() / static_cast&lt;float&gt;(tabs.size());
   for(int i = 0; i != int(tabs.size()); ++i)
     {
-      Rectf tab_rect(Vector2f(rect.left + tab_width * i + 10,
-                            rect.top),
-                     Sizef(tab_width - 20, Fonts::current()-&gt;vera20-&gt;get_height() + 6));
+      Rectf tab_rect(Vector2f(rect.left + tab_width * static_cast&lt;float&gt;(i) + 10.0f,
+                              rect.top),
+                     Sizef(tab_width - 20.0f, static_cast&lt;float&gt;(Fonts::current()-&gt;vera20-&gt;get_height()) + 6.0f));
 
       if (i == current_tab)
         Display::fill_rounded_rect(tab_rect, 5.0f, Color(1.0f, 1.0f, 1.0f, 0.5f));
@@ -62,8 +62,8 @@
 
       Display::draw_rounded_rect(tab_rect, 5.0f, Color(1.0f, 1.0f, 1.0f, 0.5f));
 
-      Fonts::current()-&gt;vera20-&gt;draw_center(Vector2f(rect.left + tab_width * i + tab_width/2,
-                                                     rect.top + Fonts::current()-&gt;vera20-&gt;get_height()),
+      Fonts::current()-&gt;vera20-&gt;draw_center(Vector2f(rect.left + tab_width * static_cast&lt;float&gt;(i) + tab_width/2,
+                                                     rect.top + static_cast&lt;float&gt;(Fonts::current()-&gt;vera20-&gt;get_height())),
                                             tabs[i].label,
                                             tabs[current_tab].component-&gt;is_active()
                                             ? Color(1.0f, 1.0f, 1.0f, 0.5f) 
@@ -139,9 +139,9 @@
 {
   tabs.push_back(Tab(name, component));
 
-  int padding = 6;
+  float padding = 6.0f;
   component-&gt;set_screen_rect(Rectf(rect.left + padding,
-                                   rect.top  + padding + Fonts::current()-&gt;vera20-&gt;get_height() + 10.0f,
+                                   rect.top  + padding + static_cast&lt;float&gt;(Fonts::current()-&gt;vera20-&gt;get_height()) + 10.0f,
                                    rect.right  - padding,
                                    rect.bottom - padding
                                    ));

Modified: trunk/windstille/src/hud/conversation.cpp
===================================================================
--- trunk/windstille/src/hud/conversation.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/hud/conversation.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -65,22 +65,22 @@
   
   Display::fill_circle(pos, 42.0f, Color(0.5f, 0.5f, 0.5f, 0.75f), 24);
 
-  float segment = 360.0f / choices.size();
+  float segment = 360.0f / static_cast&lt;float&gt;(choices.size());
 
   for(int i = 0; i &lt; (int)choices.size(); ++i)
     { // FIXME:
       Vector2f offset(0.0f, 1.0f);
-      offset = offset.rotate(math::deg2rad(segment*i) - math::pi/2);
+      offset = offset.rotate(math::deg2rad(segment * static_cast&lt;float&gt;(i)) - math::pi/2.0f);
 
-      float start = -segment/2 - 90.0f + segment*i;
-      float end   = -segment/2 - 90.0f + segment*(i+1);
+      float start = -segment / 2.0f - 90.0f + segment * static_cast&lt;float&gt;(i);
+      float end   = -segment / 2.0f - 90.0f + segment * static_cast&lt;float&gt;(i+1);
       
       float distance = 160.0f;
 
       Vector2f textpos = pos + Vector2f(0, 16.0f);
       // FIXME: Doesn't handle multi line text
-      Sizef size(Fonts::current()-&gt;vera20-&gt;get_width(choices[i].topic) + 40.0f,
-                 Fonts::current()-&gt;vera20-&gt;get_height() + 25.0f);
+      Sizef size(static_cast&lt;float&gt;(Fonts::current()-&gt;vera20-&gt;get_width(choices[i].topic)) + 40.0f,
+                 static_cast&lt;float&gt;(Fonts::current()-&gt;vera20-&gt;get_height()) + 25.0f);
       Rectf  rect(textpos + distance * offset - Vector2f(size.width/2, size.height - 15), size);
 
       if (i == selection)
@@ -94,7 +94,7 @@
                                                          textpos.y + distance * offset.y), 
                                                 choices[i].topic, Color(1.0f, 1.0f, 0.0f));
           
-          Fonts::current()-&gt;vera20-&gt;draw_center(Vector2f(400.0f, Display::get_height() - 32.0f),
+          Fonts::current()-&gt;vera20-&gt;draw_center(Vector2f(400.0f, static_cast&lt;float&gt;(Display::get_height()) - 32.0f),
                                                 choices[i].text, Color(1.0f, 1.0f, 1.0f));
           Display::draw_rounded_rect(rect, 5.0f, Color(1.0f, 1.0f, 0.0f));
         }

Modified: trunk/windstille/src/hud/dialog_manager.cpp
===================================================================
--- trunk/windstille/src/hud/dialog_manager.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/hud/dialog_manager.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -73,17 +73,17 @@
   if(alignment &amp; LEFT) {
     pos.x = outer_border_x;
   } else if(alignment &amp; RIGHT) {
-    pos.x = Display::get_width() - dialog_width - outer_border_x;
+    pos.x = static_cast&lt;float&gt;(Display::get_width() - dialog_width - outer_border_x);
   } else {
-    pos.x = (Display::get_width() - dialog_width) / 2;
+    pos.x = static_cast&lt;float&gt;((Display::get_width() - dialog_width) / 2);
   }
 
   if(alignment &amp; TOP) {
-    pos.y = outer_border_y;
+    pos.y = static_cast&lt;float&gt;(outer_border_y);
   } else if(alignment &amp; BOTTOM) {
-    pos.y = Display::get_height() - dialog_height - outer_border_y;
+    pos.y = static_cast&lt;float&gt;(Display::get_height() - dialog_height - outer_border_y);
   } else {
-    pos.y = (Display::get_height() - dialog_height) / 2;
+    pos.y = static_cast&lt;float&gt;((Display::get_height() - dialog_height) / 2);
   }
 
   if (!caption) {
@@ -107,7 +107,8 @@
     {
       const Vector2f&amp; pos = text_area-&gt;get_cursor_pos();
       Rectf cursor(pos.x + 8, pos.y + 8, pos.x + 24, pos.y + 24);
-      Display::fill_rect(cursor, Color(1.0, 1.0, 1.0, fabsf(sinf(SDL_GetTicks() / 1000.0f * math::pi * 3.0f))));
+      Display::fill_rect(cursor, Color(1.0, 1.0, 1.0, 
+                                       fabsf(sinf(static_cast&lt;float&gt;(SDL_GetTicks()) / 1000.0f * math::pi * 3.0f))));
     }
 }
 

Modified: trunk/windstille/src/hud/inventory.cpp
===================================================================
--- trunk/windstille/src/hud/inventory.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/hud/inventory.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -109,7 +109,7 @@
   for(int i = 0; i &lt; int(items.size()); ++i)
     {
       const InventoryItem&amp; item = items[(i+current_item) % items.size()];
-      Vector2f draw_pos = pos + Vector2f(128.0f, 0.0f).rotate(step_angle * i - math::pi/2.0f + add_angle);
+      Vector2f draw_pos = pos + Vector2f(128.0f, 0.0f).rotate(step_angle * static_cast&lt;float&gt;(i) - math::pi/2.0f + add_angle);
 
       if (i == 0 &amp;&amp; moving == 0)
         {

Modified: trunk/windstille/src/input/wiimote.cpp
===================================================================
--- trunk/windstille/src/input/wiimote.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/input/wiimote.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -183,13 +183,13 @@
 {
   assert(num &gt;= 1 &amp;&amp; num &lt;= 4);
   
-  unsigned char new_led_state = m_led_state;
+  unsigned int new_led_state = m_led_state;
   if (state)
-    new_led_state |= (1 &lt;&lt; (num-1));
+    new_led_state |= (1u &lt;&lt; (num-1));
   else // (!state)
-    new_led_state &amp;= ~(1 &lt;&lt; (num-1));
+    new_led_state &amp;= ~(1u &lt;&lt; (num-1));
 
-  set_led(new_led_state);
+  set_led(static_cast&lt;unsigned char&gt;(new_led_state));
 }
 
 void
@@ -295,7 +295,7 @@
 {
 #define CHECK_BTN(btn, num) if (changes &amp; btn) add_button_event(0, num, m_buttons &amp; btn)
 
-  uint16_t changes = m_buttons ^ msg.buttons;
+  uint16_t changes = static_cast&lt;uint16_t&gt;(m_buttons ^ msg.buttons);
   m_buttons = msg.buttons;
  
   CHECK_BTN(CWIID_BTN_A, 0);
@@ -320,9 +320,9 @@
   //printf(&quot;Acc Report: x=%d, y=%d, z=%d\n&quot;, msg.acc[0], msg.acc[1], msg.acc[2]);
 
   add_acc_event(0, 0, 
-                (msg.acc[0] - wiimote_zero.x) / static_cast&lt;float&gt;(wiimote_one.x - wiimote_zero.x),
-                (msg.acc[1] - wiimote_zero.y) / static_cast&lt;float&gt;(wiimote_one.y - wiimote_zero.y),
-                (msg.acc[2] - wiimote_zero.z) / static_cast&lt;float&gt;(wiimote_one.z - wiimote_zero.z));
+                static_cast&lt;float&gt;(msg.acc[0] - wiimote_zero.x) / static_cast&lt;float&gt;(wiimote_one.x - wiimote_zero.x),
+                static_cast&lt;float&gt;(msg.acc[1] - wiimote_zero.y) / static_cast&lt;float&gt;(wiimote_one.y - wiimote_zero.y),
+                static_cast&lt;float&gt;(msg.acc[2] - wiimote_zero.z) / static_cast&lt;float&gt;(wiimote_one.z - wiimote_zero.z));
 }
 
 void
@@ -345,11 +345,11 @@
 {
   if (value &lt; center)
     {
-      return math::mid(-1.0f, -(center - value) / float(center - min), 1.0f);
+      return math::mid(-1.0f, -static_cast&lt;float&gt;(center - value) / static_cast&lt;float&gt;(center - min), 1.0f);
     }
   else if (value &gt; center)
     {
-      return math::mid(-1.0f, (value - center) / float(max - center), 1.0f);
+      return math::mid(-1.0f, static_cast&lt;float&gt;(value - center) / static_cast&lt;float&gt;(max - center), 1.0f);
     }
   else 
     {
@@ -360,7 +360,7 @@
 void
 Wiimote::on_nunchuck(const cwiid_nunchuk_mesg&amp; msg)
 {
-  uint8_t changes = m_nunchuk_btns ^ msg.buttons;
+  uint8_t changes = static_cast&lt;uint8_t&gt;(m_nunchuk_btns ^ msg.buttons);
   m_nunchuk_btns  = msg.buttons;
 
 #define CHECK_NCK_BTN(btn, num) if (changes &amp; btn) add_button_event(0, num, m_nunchuk_btns &amp; btn)
@@ -386,9 +386,9 @@
     }
 
   add_acc_event(0, 1, 
-                (msg.acc[0] - nunchuk_zero.x) / float(nunchuk_one.x - nunchuk_zero.x),
-                (msg.acc[1] - nunchuk_zero.y) / float(nunchuk_one.y - nunchuk_zero.y),
-                (msg.acc[2] - nunchuk_zero.z) / float(nunchuk_one.z - nunchuk_zero.z));
+                static_cast&lt;float&gt;(msg.acc[0] - nunchuk_zero.x) / static_cast&lt;float&gt;(nunchuk_one.x - nunchuk_zero.x),
+                static_cast&lt;float&gt;(msg.acc[1] - nunchuk_zero.y) / static_cast&lt;float&gt;(nunchuk_one.y - nunchuk_zero.y),
+                static_cast&lt;float&gt;(msg.acc[2] - nunchuk_zero.z) / static_cast&lt;float&gt;(nunchuk_one.z - nunchuk_zero.z));
   if (0)
     printf(&quot;Nunchuk Report: btns=%.2X stick=(%3d,%3d) (%5.2f, %5.2f) acc.x=%d acc.y=%d acc.z=%d\n&quot;, 
            msg.buttons,

Modified: trunk/windstille/src/objects/bomb.cpp
===================================================================
--- trunk/windstille/src/objects/bomb.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/objects/bomb.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -26,7 +26,7 @@
     light(Pathname(&quot;images/bomblight.sprite&quot;)),
     highlight(Pathname(&quot;images/bombhighlight.sprite&quot;)),
     explolight(Pathname(&quot;images/explolight.sprite&quot;)),
-    pos(x, static_cast&lt;float&gt;(int(y/TILE_SIZE+1)*TILE_SIZE)),
+    pos(static_cast&lt;float&gt;(x), static_cast&lt;float&gt;((y / TILE_SIZE + 1) * TILE_SIZE)),
     count(2.0f),
     state(COUNTDOWN),
     exploded(false)

Modified: trunk/windstille/src/objects/hedgehog.cpp
===================================================================
--- trunk/windstille/src/objects/hedgehog.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/objects/hedgehog.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -16,6 +16,8 @@
 **  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
 */
 
+#include &lt;math.h&gt;
+
 #include &quot;app/globals.hpp&quot;
 #include &quot;player.hpp&quot;
 #include &quot;engine/sector.hpp&quot;
@@ -78,15 +80,15 @@
       if (on_ground())
         {
           was_on_ground = true;
-          if (velocity.y &gt; 0)
+          if (velocity.y &gt; 0.0f)
             {
-              velocity.y = 0;
-              pos.y = int(pos.y / TILE_SIZE) * TILE_SIZE + TILE_SIZE - 1;
+              velocity.y = 0.0f;
+              pos.y = truncf(pos.y / static_cast&lt;float&gt;(TILE_SIZE)) * static_cast&lt;float&gt;(TILE_SIZE) + static_cast&lt;float&gt;(TILE_SIZE) - 1.0f;
             }
           if (direction_left)
-            velocity.x = -32;
+            velocity.x = -32.0f;
           else
-            velocity.x = 32;
+            velocity.x = 32.0f;
         }
       else
         {

Modified: trunk/windstille/src/objects/laser_pointer.cpp
===================================================================
--- trunk/windstille/src/objects/laser_pointer.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/objects/laser_pointer.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -53,11 +53,11 @@
     }
   else if (v &lt; 0)
     {
-      return fmodf(fmodf(pos, TILE_SIZE) + TILE_SIZE, TILE_SIZE)/fabsf(v);
+      return fmodf(fmodf(pos, static_cast&lt;float&gt;(TILE_SIZE)) + static_cast&lt;float&gt;(TILE_SIZE), static_cast&lt;float&gt;(TILE_SIZE))/fabsf(v);
     }
   else // if (v &gt; 0)
     {
-      return fmodf(fmodf(-pos, TILE_SIZE) + TILE_SIZE, TILE_SIZE)/v;
+      return fmodf(fmodf(-pos, static_cast&lt;float&gt;(TILE_SIZE)) + static_cast&lt;float&gt;(TILE_SIZE), static_cast&lt;float&gt;(TILE_SIZE))/v;
     }
 }
 
@@ -70,8 +70,8 @@
   Vector2f target; // = Sector::current()-&gt;get_collision_engine()-&gt;raycast(pos, angle);
 
   // Ray position in Tile units
-  int x = static_cast&lt;int&gt;(pos.x / TILE_SIZE);
-  int y = static_cast&lt;int&gt;(pos.y / TILE_SIZE);
+  int x = static_cast&lt;int&gt;(pos.x / static_cast&lt;float&gt;(TILE_SIZE));
+  int y = static_cast&lt;int&gt;(pos.y / static_cast&lt;float&gt;(TILE_SIZE));
 
   Vector2f direction(cosf(angle) * 100.0f, sinf(angle) * 100.0f);
 
@@ -81,8 +81,8 @@
   float tMaxX = find_max(pos.x, direction.x);
   float tMaxY = find_max(pos.y, direction.y);
 
-  float tDeltaX = (direction.x == 0) ? 0 : fabsf(TILE_SIZE / direction.x);
-  float tDeltaY = (direction.y == 0) ? 0 : fabsf(TILE_SIZE / direction.y);
+  float tDeltaX = (direction.x == 0) ? 0 : fabsf(static_cast&lt;float&gt;(TILE_SIZE) / direction.x);
+  float tDeltaY = (direction.y == 0) ? 0 : fabsf(static_cast&lt;float&gt;(TILE_SIZE) / direction.y);
 
   float t = 0;
 

Modified: trunk/windstille/src/objects/shockwave.cpp
===================================================================
--- trunk/windstille/src/objects/shockwave.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/objects/shockwave.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -94,11 +94,11 @@
       {
         float angel = 2.0f * math::pi / static_cast&lt;float&gt;(segments);
 
-        float x1 =  sinf(angel*i)*radius;
-        float y1 = -cosf(angel*i)*radius;
+        float x1 =  sinf(angel*static_cast&lt;float&gt;(i))*radius;
+        float y1 = -cosf(angel*static_cast&lt;float&gt;(i))*radius;
 
-        float x2 =  sinf(angel*(i+1))*radius;
-        float y2 = -cosf(angel*(i+1))*radius;
+        float x2 =  sinf(angel*(static_cast&lt;float&gt;(i)+1))*radius;
+        float y2 = -cosf(angel*(static_cast&lt;float&gt;(i)+1))*radius;
 
         glTexCoord2f(x1+256, (y1+256));
         glVertex3f(x1+256, y1+256, 0);
@@ -107,11 +107,11 @@
         glVertex3f(x2+256, y2+256, 0);
 
 
-        float x3 =  sinf(angel*i)*minradius;
-        float y3 = -cosf(angel*i)*minradius;
+        float x3 =  sinf(angel*static_cast&lt;float&gt;(i))*minradius;
+        float y3 = -cosf(angel*static_cast&lt;float&gt;(i))*minradius;
 
-        float x4 =  sinf(angel*(i+1))*minradius;
-        float y4 = -cosf(angel*(i+1))*minradius;
+        float x4 =  sinf(angel*(static_cast&lt;float&gt;(i)+1))*minradius;
+        float y4 = -cosf(angel*(static_cast&lt;float&gt;(i)+1))*minradius;
 
         glTexCoord2f(x4+256, (y4+256));
         glVertex3f(x4+256, y4+256, 0);
@@ -177,8 +177,8 @@
 
   void draw_disc(int count)
   {
-    float radius = (count)*2.0f;
-    float minradius = 2.0f*count - 164.0f;
+    float radius = static_cast&lt;float&gt;(count)*2.0f;
+    float minradius = 2.0f * static_cast&lt;float&gt;(count) - 164.0f;
     if (minradius &lt; 0)
       minradius = 0;
 
@@ -189,11 +189,11 @@
       {
         float angel = 2.0f * math::pi / static_cast&lt;float&gt;(segments);
 
-        float x1 =  sinf(angel*i)*radius;
-        float y1 = -cosf(angel*i)*radius;
+        float x1 =  sinf(angel*static_cast&lt;float&gt;(i))*radius;
+        float y1 = -cosf(angel*static_cast&lt;float&gt;(i))*radius;
 
-        float x2 =  sinf(angel*(i+1))*radius;
-        float y2 = -cosf(angel*(i+1))*radius;
+        float x2 =  sinf(angel*(static_cast&lt;float&gt;(i)+1))*radius;
+        float y2 = -cosf(angel*(static_cast&lt;float&gt;(i)+1))*radius;
 
         glColor4f(1.0f, 1.0f, 1.0f, 1.0f);
         glTexCoord2f(x1/512.0f+0.5f, y1/512.0f+0.5f);
@@ -203,11 +203,11 @@
         glVertex3f(x2+256, y2+256, 0);
 
 
-        float x3 =  sinf(angel*i)*minradius;
-        float y3 = -cosf(angel*i)*minradius;
+        float x3 =  sinf(angel*static_cast&lt;float&gt;(i))*minradius;
+        float y3 = -cosf(angel*static_cast&lt;float&gt;(i))*minradius;
 
-        float x4 =  sinf(angel*(i+1))*minradius;
-        float y4 = -cosf(angel*(i+1))*minradius;
+        float x4 =  sinf(angel*(static_cast&lt;float&gt;(i)+1))*minradius;
+        float y4 = -cosf(angel*(static_cast&lt;float&gt;(i)+1))*minradius;
 
         glColor4f(1.0f, 1.0f, 1.0f, 0.0f);
         glTexCoord2f(x4/512.0f+0.5f, y4/512.0f+0.5f);

Modified: trunk/windstille/src/objects/spider_mine.cpp
===================================================================
--- trunk/windstille/src/objects/spider_mine.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/objects/spider_mine.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -58,7 +58,7 @@
     if (on_ground()) {
       if (velocity.y &gt; 0) {
         velocity.y = 0;
-        pos.y = int(pos.y / static_cast&lt;float&gt;(TILE_SIZE)) * static_cast&lt;float&gt;(TILE_SIZE) + static_cast&lt;float&gt;(TILE_SIZE) - 1.0f;
+        pos.y = truncf(pos.y / static_cast&lt;float&gt;(TILE_SIZE)) * static_cast&lt;float&gt;(TILE_SIZE) + static_cast&lt;float&gt;(TILE_SIZE) - 1.0f;
       }
 
     } else {

Modified: trunk/windstille/src/physfs/physfs_sdl.cpp
===================================================================
--- trunk/windstille/src/physfs/physfs_sdl.cpp	2009-08-24 02:50:48 UTC (rev 3034)
+++ trunk/windstille/src/physfs/physfs_sdl.cpp	2009-08-24 11:59:04 UTC (rev 3035)
@@ -57,7 +57,7 @@
 {
     PHYSFS_file* file = (PHYSFS_file*) context-&gt;hidden.unknown.data1;
 
-    int res = static_cast&lt;PHYSFS_sint64&gt;(PHYSFS_read(file, ptr, size, maxnum));
+    int res = static_cast&lt;int&gt;(PHYSFS_read(file, ptr, size, maxnum));
     return res;
 }
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002031.html">[Windstille-commit] r3034 - in trunk/windstille/src: objects sound
</A></li>
	<LI>Next message: <A HREF="002033.html">[Windstille-commit] r3036 - trunk/windstille/src/editor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2032">[ date ]</a>
              <a href="thread.html#2032">[ thread ]</a>
              <a href="subject.html#2032">[ subject ]</a>
              <a href="author.html#2032">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/windstille-commit">More information about the Windstille-commit
mailing list</a><br>
</body></html>
