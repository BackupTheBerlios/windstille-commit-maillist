<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Windstille-commit] r3103 - in trunk/windstille/src: display engine	objects particles scenegraph sprite3d tile
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/windstille-commit/2009-August/index.html" >
   <LINK REL="made" HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r3103%20-%20in%20trunk/windstille/src%3A%20display%20engine%0A%09objects%20particles%20scenegraph%20sprite3d%20tile&In-Reply-To=%3C200908281551.n7SFpAJZ028636%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002099.html">
   <LINK REL="Next"  HREF="002101.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Windstille-commit] r3103 - in trunk/windstille/src: display engine	objects particles scenegraph sprite3d tile</H1>
    <B>grumbel at BerliOS</B> 
    <A HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r3103%20-%20in%20trunk/windstille/src%3A%20display%20engine%0A%09objects%20particles%20scenegraph%20sprite3d%20tile&In-Reply-To=%3C200908281551.n7SFpAJZ028636%40sheep.berlios.de%3E"
       TITLE="[Windstille-commit] r3103 - in trunk/windstille/src: display engine	objects particles scenegraph sprite3d tile">grumbel at mail.berlios.de
       </A><BR>
    <I>Fri Aug 28 17:51:10 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002099.html">[Windstille-commit] r3102 - in trunk/windstille/src: display	objects particles scenegraph sprite3d tile
</A></li>
        <LI>Next message: <A HREF="002101.html">[Windstille-commit] r3104 - in trunk/windstille/src: editor	scenegraph
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2100">[ date ]</a>
              <a href="thread.html#2100">[ thread ]</a>
              <a href="subject.html#2100">[ subject ]</a>
              <a href="author.html#2100">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: grumbel
Date: 2009-08-28 17:51:08 +0200 (Fri, 28 Aug 2009)
New Revision: 3103

Added:
   trunk/windstille/src/scenegraph/control_drawable.hpp
   trunk/windstille/src/scenegraph/drawable.hpp
   trunk/windstille/src/scenegraph/fill_screen_drawable.hpp
   trunk/windstille/src/scenegraph/fill_screen_pattern_drawable.hpp
   trunk/windstille/src/scenegraph/sprite3d_drawable.hpp
   trunk/windstille/src/scenegraph/surface_drawable.hpp
   trunk/windstille/src/scenegraph/surface_quad_drawable.hpp
   trunk/windstille/src/scenegraph/text_drawable.hpp
   trunk/windstille/src/scenegraph/vertex_array_drawable.cpp
   trunk/windstille/src/scenegraph/vertex_array_drawable.hpp
Removed:
   trunk/windstille/src/scenegraph/control_drawing_request.hpp
   trunk/windstille/src/scenegraph/drawing_request.hpp
   trunk/windstille/src/scenegraph/fill_screen_drawing_request.hpp
   trunk/windstille/src/scenegraph/fill_screen_pattern_drawing_request.hpp
   trunk/windstille/src/scenegraph/sprite3d_drawing_request.hpp
   trunk/windstille/src/scenegraph/surface_drawing_request.hpp
   trunk/windstille/src/scenegraph/surface_quad_drawing_request.hpp
   trunk/windstille/src/scenegraph/text_drawing_request.hpp
   trunk/windstille/src/scenegraph/vertex_array_drawing_request.cpp
   trunk/windstille/src/scenegraph/vertex_array_drawing_request.hpp
Modified:
   trunk/windstille/src/display/compositor.cpp
   trunk/windstille/src/display/compositor.hpp
   trunk/windstille/src/display/drawing_context.cpp
   trunk/windstille/src/display/drawing_context.hpp
   trunk/windstille/src/engine/sector.cpp
   trunk/windstille/src/objects/background_gradient.cpp
   trunk/windstille/src/objects/decal.cpp
   trunk/windstille/src/objects/decal.hpp
   trunk/windstille/src/objects/laser_pointer.cpp
   trunk/windstille/src/objects/liquid.cpp
   trunk/windstille/src/objects/nightvision.cpp
   trunk/windstille/src/objects/player.cpp
   trunk/windstille/src/objects/player.hpp
   trunk/windstille/src/objects/shockwave.cpp
   trunk/windstille/src/objects/swarm.cpp
   trunk/windstille/src/particles/deform_drawer.cpp
   trunk/windstille/src/particles/spark_drawer.cpp
   trunk/windstille/src/particles/surface_drawer.cpp
   trunk/windstille/src/scenegraph/scene_graph.cpp
   trunk/windstille/src/scenegraph/scene_graph.hpp
   trunk/windstille/src/sprite3d/sprite3d.cpp
   trunk/windstille/src/sprite3d/sprite3d.hpp
   trunk/windstille/src/tile/tile_map.cpp
Log:
Renamed DrawingRequest to Drawable

Modified: trunk/windstille/src/display/compositor.cpp
===================================================================
--- trunk/windstille/src/display/compositor.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/display/compositor.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -21,7 +21,7 @@
 #include &lt;GL/glew.h&gt;
 
 #include &quot;display/display.hpp&quot;
-#include &quot;scenegraph/drawing_request.hpp&quot;
+#include &quot;scenegraph/drawable.hpp&quot;
 #include &quot;display/graphic_context_state.hpp&quot;
 #include &quot;display/framebuffer.hpp&quot;
 #include &quot;display/opengl_state.hpp&quot;
@@ -318,7 +318,7 @@
 }
 
 void
-Compositor::eval(DrawingRequest* request)
+Compositor::eval(Drawable* request)
 {
   if (impl-&gt;framebuffers &amp;&amp; request-&gt;needs_prepare())
     {

Modified: trunk/windstille/src/display/compositor.hpp
===================================================================
--- trunk/windstille/src/display/compositor.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/display/compositor.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -22,7 +22,7 @@
 #include &lt;boost/scoped_ptr.hpp&gt;
 
 class CompositorImpl;
-class DrawingRequest;
+class Drawable;
 class GraphicContextState;
 class SceneContext;
 class SceneGraph;
@@ -34,7 +34,7 @@
   ~Compositor();
 
   void render(SceneContext&amp; sc, SceneGraph* sg, const GraphicContextState&amp; state);
-  void eval(DrawingRequest* request);
+  void eval(Drawable* request);
 
 private:
   void render_with_framebuffers(SceneContext&amp; sc, SceneGraph* sg);

Modified: trunk/windstille/src/display/drawing_context.cpp
===================================================================
--- trunk/windstille/src/display/drawing_context.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/display/drawing_context.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -30,18 +30,18 @@
 #include &quot;math/vector3.hpp&quot;
 #include &quot;sprite2d/sprite.hpp&quot;
 
-#include &quot;scenegraph/control_drawing_request.hpp&quot;
-#include &quot;scenegraph/fill_screen_drawing_request.hpp&quot;
-#include &quot;scenegraph/fill_screen_pattern_drawing_request.hpp&quot;
-#include &quot;scenegraph/surface_drawing_request.hpp&quot;
-#include &quot;scenegraph/surface_quad_drawing_request.hpp&quot;
-#include &quot;scenegraph/text_drawing_request.hpp&quot;
-#include &quot;scenegraph/vertex_array_drawing_request.hpp&quot;
-#include &quot;scenegraph/vertex_array_drawing_request.hpp&quot;
+#include &quot;scenegraph/control_drawable.hpp&quot;
+#include &quot;scenegraph/fill_screen_drawable.hpp&quot;
+#include &quot;scenegraph/fill_screen_pattern_drawable.hpp&quot;
+#include &quot;scenegraph/surface_drawable.hpp&quot;
+#include &quot;scenegraph/surface_quad_drawable.hpp&quot;
+#include &quot;scenegraph/text_drawable.hpp&quot;
+#include &quot;scenegraph/vertex_array_drawable.hpp&quot;
+#include &quot;scenegraph/vertex_array_drawable.hpp&quot;
 
-struct DrawingRequestsSorter
+struct DrawablesSorter
 {
-  bool operator()(DrawingRequest* a, DrawingRequest* b) {
+  bool operator()(Drawable* a, Drawable* b) {
     return a-&gt;get_z_pos() &lt; b-&gt;get_z_pos();
   }
 };
@@ -61,9 +61,9 @@
 void
 DrawingContext::render(Compositor&amp; comp)
 {
-  std::stable_sort(drawingrequests.begin(), drawingrequests.end(), DrawingRequestsSorter());
+  std::stable_sort(drawingrequests.begin(), drawingrequests.end(), DrawablesSorter());
   
-  for(DrawingRequests::iterator i = drawingrequests.begin(); i != drawingrequests.end(); ++i)
+  for(Drawables::iterator i = drawingrequests.begin(); i != drawingrequests.end(); ++i)
     {
       comp.eval(*i);
     }
@@ -72,7 +72,7 @@
 void
 DrawingContext::clear()
 {
-  for(DrawingRequests::iterator i = drawingrequests.begin(); i != drawingrequests.end(); ++i)
+  for(Drawables::iterator i = drawingrequests.begin(); i != drawingrequests.end(); ++i)
     {
       delete *i;
     }
@@ -80,7 +80,7 @@
 }
 
 void
-DrawingContext::draw(DrawingRequest* request)
+DrawingContext::draw(Drawable* request)
 {
   drawingrequests.push_back(request);
 }
@@ -101,14 +101,14 @@
 DrawingContext::draw(const Surface surface, const Vector2f&amp; pos, const Quad&amp; quad,
                      const DrawingParameters&amp; params, float z_pos)
 {
-  draw(new SurfaceQuadDrawingRequest(surface, pos, quad, params, z_pos,
+  draw(new SurfaceQuadDrawable(surface, pos, quad, params, z_pos,
                                      modelview_stack.back()));
 }
 
 void
 DrawingContext::draw(const Surface surface, const SurfaceDrawingParameters&amp; params, float z_pos)
 {
-  draw(new SurfaceDrawingRequest(surface, params, z_pos,
+  draw(new SurfaceDrawable(surface, params, z_pos,
                                  modelview_stack.back()));
 }
 
@@ -121,7 +121,7 @@
 void
 DrawingContext::draw(Surface surface, float x, float y, float z, float )
 {
-  draw(new SurfaceDrawingRequest(surface,
+  draw(new SurfaceDrawable(surface,
                                  SurfaceDrawingParameters().set_pos(Vector2f(x, y)),
                                  z, modelview_stack.back()));
 }
@@ -129,25 +129,25 @@
 void
 DrawingContext::draw(const std::string&amp; text, float x, float y, float z)
 { 
-  draw(new TextDrawingRequest(text, Vector2f(x, y), z, modelview_stack.back()));
+  draw(new TextDrawable(text, Vector2f(x, y), z, modelview_stack.back()));
 }
 
 void
 DrawingContext::draw_control(const Surface surface, const Vector2f&amp; pos, float angle, float z_pos)
 {
-  draw(new ControlDrawingRequest(surface, pos, angle, z_pos, modelview_stack.back()));
+  draw(new ControlDrawable(surface, pos, angle, z_pos, modelview_stack.back()));
 }
 
 void
 DrawingContext::fill_screen(const Color&amp; color)
 {
-  draw(new FillScreenDrawingRequest(color));
+  draw(new FillScreenDrawable(color));
 }
 
 void
 DrawingContext::fill_pattern(const Texture&amp; pattern, const Vector2f&amp; offset)
 {
-  draw(new FillScreenPatternDrawingRequest(pattern, offset));
+  draw(new FillScreenPatternDrawable(pattern, offset));
 }
 
 void
@@ -253,7 +253,7 @@
 void
 DrawingContext::draw_line(const Vector2f&amp; pos1, const Vector2f&amp; pos2, const Color&amp; color, float z_pos)
 {
-  VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector2f(0, 0), z_pos, modelview_stack.back());
+  VertexArrayDrawable* array = new VertexArrayDrawable(Vector2f(0, 0), z_pos, modelview_stack.back());
 
   array-&gt;set_mode(GL_LINES);
   array-&gt;set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
@@ -270,7 +270,7 @@
 void
 DrawingContext::draw_quad(const Quad&amp; quad, const Color&amp; color, float z_pos)
 {
-  VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector2f(0, 0), z_pos, modelview_stack.back());
+  VertexArrayDrawable* array = new VertexArrayDrawable(Vector2f(0, 0), z_pos, modelview_stack.back());
 
   array-&gt;set_mode(GL_LINE_LOOP);
   array-&gt;set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
@@ -293,7 +293,7 @@
 void
 DrawingContext::fill_quad(const Quad&amp; quad, const Color&amp; color, float z_pos)
 {
-  VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector2f(0, 0), z_pos, modelview_stack.back());
+  VertexArrayDrawable* array = new VertexArrayDrawable(Vector2f(0, 0), z_pos, modelview_stack.back());
 
   array-&gt;set_mode(GL_QUADS);
   array-&gt;set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
@@ -316,7 +316,7 @@
 void
 DrawingContext::draw_rect(const Rectf&amp; rect, const Color&amp; color, float z_pos)
 {
-  VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector2f(0, 0), z_pos, modelview_stack.back());
+  VertexArrayDrawable* array = new VertexArrayDrawable(Vector2f(0, 0), z_pos, modelview_stack.back());
 
   array-&gt;set_mode(GL_LINE_LOOP);
   array-&gt;set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
@@ -339,7 +339,7 @@
 void
 DrawingContext::fill_rect(const Rectf&amp; rect, const Color&amp; color, float z_pos)
 {
-  VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector2f(0, 0), z_pos, modelview_stack.back());
+  VertexArrayDrawable* array = new VertexArrayDrawable(Vector2f(0, 0), z_pos, modelview_stack.back());
 
   array-&gt;set_mode(GL_QUADS);
   array-&gt;set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

Modified: trunk/windstille/src/display/drawing_context.hpp
===================================================================
--- trunk/windstille/src/display/drawing_context.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/display/drawing_context.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -21,7 +21,7 @@
 
 #include &lt;vector&gt;
 
-#include &quot;scenegraph/drawing_request.hpp&quot;
+#include &quot;scenegraph/drawable.hpp&quot;
 
 class Texture;
 class Surface;
@@ -34,7 +34,7 @@
 class Color;
 class Compositor;
 
-/** The DrawingContext collects all DrawingRequests and allows you to
+/** The DrawingContext collects all Drawables and allows you to
     flush them all down to the graphics card in one run, this has the
     advantage that it is possible to z-sort, texture-id sort or
     otherwise optimize the drawing. In addition to that it also allows
@@ -43,8 +43,8 @@
 class DrawingContext
 {
 private:
-  typedef std::vector&lt;DrawingRequest*&gt; DrawingRequests;
-  DrawingRequests drawingrequests;
+  typedef std::vector&lt;Drawable*&gt; Drawables;
+  Drawables drawingrequests;
 
   std::vector&lt;Matrix&gt; modelview_stack;
 
@@ -59,7 +59,7 @@
   void clear();
 
   /** Fills the screen with a given color, this is different from
-      clear() in that it doesn't remove other DrawingRequest from the
+      clear() in that it doesn't remove other Drawable from the
       queue */
   void fill_screen(const Color&amp; color);
 
@@ -75,7 +75,7 @@
   void fill_quad(const Quad&amp; quad, const Color&amp; color, float z_pos = 0);
 
   /*{ */
-  void draw(DrawingRequest* request);
+  void draw(Drawable* request);
   void draw(const Sprite&amp;   sprite,  const Vector2f&amp; pos, float z = 0);
   void draw(const std::string&amp; text,    float x, float y, float z = 0);
   void draw(const Surface surface, const Vector2f&amp; pos, float z = 0, float alpha = 0);

Modified: trunk/windstille/src/engine/sector.cpp
===================================================================
--- trunk/windstille/src/engine/sector.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/engine/sector.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -280,7 +280,7 @@
         (*i)-&gt;draw(sc);
     }
 
-  //sc.color().draw(new SceneGraphDrawingRequest(*scene_graph, sc.color().get_modelview()));
+  //sc.color().draw(new SceneGraphDrawable(*scene_graph, sc.color().get_modelview()));
 }
 
 void Sector::commit_adds()

Modified: trunk/windstille/src/objects/background_gradient.cpp
===================================================================
--- trunk/windstille/src/objects/background_gradient.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/objects/background_gradient.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -18,7 +18,7 @@
 
 #include &quot;objects/background_gradient.hpp&quot;
 
-#include &quot;scenegraph/vertex_array_drawing_request.hpp&quot;
+#include &quot;scenegraph/vertex_array_drawable.hpp&quot;
 #include &quot;display/display.hpp&quot;
 
 BackgroundGradient::BackgroundGradient(FileReader&amp; props)
@@ -69,7 +69,7 @@
 
   Rectf rect(0.0f, 0.0f, 
              static_cast&lt;float&gt;(Display::get_width()), static_cast&lt;float&gt;(Display::get_height()));
-  VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector2f(0, 0), z_pos, 
+  VertexArrayDrawable* array = new VertexArrayDrawable(Vector2f(0, 0), z_pos, 
                                                                    sc.color().get_modelview());
 
   array-&gt;set_mode(GL_QUAD_STRIP);

Modified: trunk/windstille/src/objects/decal.cpp
===================================================================
--- trunk/windstille/src/objects/decal.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/objects/decal.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -20,7 +20,7 @@
 
 #include &quot;engine/sector.hpp&quot;
 #include &quot;scenegraph/scene_graph.hpp&quot;
-#include &quot;scenegraph/surface_drawing_request.hpp&quot;
+#include &quot;scenegraph/surface_drawable.hpp&quot;
 #include &quot;display/surface_drawing_parameters.hpp&quot;
 #include &quot;display/scene_context.hpp&quot;
 
@@ -60,7 +60,7 @@
   Vector2f center_offset(-surface.get_width() /2,
                          -surface.get_height()/2);
 
-  drawable.reset(new SurfaceDrawingRequest(surface,
+  drawable.reset(new SurfaceDrawable(surface,
                                            params
                                            .set_pos(pos + center_offset)
                                            .set_angle(angle)

Modified: trunk/windstille/src/objects/decal.hpp
===================================================================
--- trunk/windstille/src/objects/decal.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/objects/decal.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -24,12 +24,12 @@
 #include &quot;display/surface.hpp&quot;
 #include &quot;engine/game_object.hpp&quot;
 
-class SurfaceDrawingRequest;
+class SurfaceDrawable;
 
 class Decal : public GameObject
 {
 private:
-  boost::shared_ptr&lt;SurfaceDrawingRequest&gt; drawable;
+  boost::shared_ptr&lt;SurfaceDrawable&gt; drawable;
   Vector2f pos;
 
 public:

Modified: trunk/windstille/src/objects/laser_pointer.cpp
===================================================================
--- trunk/windstille/src/objects/laser_pointer.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/objects/laser_pointer.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -16,7 +16,7 @@
 **  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
 */
 
-#include &quot;scenegraph/vertex_array_drawing_request.hpp&quot;
+#include &quot;scenegraph/vertex_array_drawable.hpp&quot;
 #include &quot;objects/player.hpp&quot;
 #include &quot;engine/sector.hpp&quot;
 #include &quot;tile/tile_map.hpp&quot;
@@ -119,7 +119,7 @@
   
     Vector2f ray = target - pos;
 
-    VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector2f(0,0), 10000,
+    VertexArrayDrawable* array = new VertexArrayDrawable(Vector2f(0,0), 10000,
                                                                      sc.highlight().get_modelview());
     array-&gt;set_mode(GL_LINES);
     array-&gt;set_texture(noise);

Modified: trunk/windstille/src/objects/liquid.cpp
===================================================================
--- trunk/windstille/src/objects/liquid.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/objects/liquid.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -16,7 +16,7 @@
 **  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
 */
 
-#include &quot;scenegraph/vertex_array_drawing_request.hpp&quot;
+#include &quot;scenegraph/vertex_array_drawable.hpp&quot;
 #include &quot;objects/liquid.hpp&quot;
 
 #define SAMPLES 5
@@ -64,7 +64,7 @@
 {
   float texscale = 1.0f/128.0f;
   {
-    VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector2f(pos.x, pos.y), 10000,
+    VertexArrayDrawable* array = new VertexArrayDrawable(Vector2f(pos.x, pos.y), 10000,
                                                                      sc.light().get_modelview());
     array-&gt;set_texture(texture);
     array-&gt;set_mode(GL_QUAD_STRIP);
@@ -93,7 +93,7 @@
     sc.color().draw(array);
   }
   {
-    VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector2f(pos.x, pos.y), 10000,
+    VertexArrayDrawable* array = new VertexArrayDrawable(Vector2f(pos.x, pos.y), 10000,
                                                                      sc.light().get_modelview());
     array-&gt;set_texture(texture);
     array-&gt;set_mode(GL_QUAD_STRIP);

Modified: trunk/windstille/src/objects/nightvision.cpp
===================================================================
--- trunk/windstille/src/objects/nightvision.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/objects/nightvision.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -19,7 +19,7 @@
 #include &quot;objects/nightvision.hpp&quot;
 
 #include &quot;display/display.hpp&quot;
-#include &quot;scenegraph/vertex_array_drawing_request.hpp&quot;
+#include &quot;scenegraph/vertex_array_drawable.hpp&quot;
 #include &quot;math/random.hpp&quot;
 
 Nightvision::Nightvision(FileReader&amp; /*props*/)
@@ -52,7 +52,7 @@
 
   if (1)
     {
-      VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector2f(0, 0), 10000,
+      VertexArrayDrawable* array = new VertexArrayDrawable(Vector2f(0, 0), 10000,
                                                                        sc.light().get_modelview());
       array-&gt;set_mode(GL_QUADS);
       array-&gt;set_texture(noise);

Modified: trunk/windstille/src/objects/player.cpp
===================================================================
--- trunk/windstille/src/objects/player.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/objects/player.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -30,7 +30,7 @@
 #include &quot;tile/tile.hpp&quot;
 #include &quot;tile/tile_map.hpp&quot;
 #include &quot;scenegraph/scene_graph.hpp&quot;
-#include &quot;scenegraph/sprite3d_drawing_request.hpp&quot;
+#include &quot;scenegraph/sprite3d_drawable.hpp&quot;
 
 static const int MAX_ENERGY = 16;
 static const float WALK_SPEED = 100.0;
@@ -79,7 +79,7 @@
   weapon.reset(new Pistol());
   laser_pointer = ((Pistol*)weapon.get())-&gt;laser_pointer;
 
-  m_drawable.reset(new Sprite3DDrawingRequest(&amp;sprite, Vector2f(200, 600), 100.0f, Matrix::identity()));
+  m_drawable.reset(new Sprite3DDrawable(&amp;sprite, Vector2f(200, 600), 100.0f, Matrix::identity()));
   Sector::current()-&gt;get_scene_graph().add_drawable(m_drawable);
 }
 

Modified: trunk/windstille/src/objects/player.hpp
===================================================================
--- trunk/windstille/src/objects/player.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/objects/player.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -35,7 +35,7 @@
 class CollisionObject;
 class CollisionData;
 class Weapon;
-class Sprite3DDrawingRequest;
+class Sprite3DDrawable;
 
 class Player : public Entity,
                public Currenton&lt;Player&gt;
@@ -43,7 +43,7 @@
 private:
   Sprite3D sprite;
 
-  boost::shared_ptr&lt;Sprite3DDrawingRequest&gt; m_drawable;
+  boost::shared_ptr&lt;Sprite3DDrawable&gt; m_drawable;
   //std::auto_ptr&lt;SoundSource&gt; sound_source;
 
   bool jumping;

Modified: trunk/windstille/src/objects/shockwave.cpp
===================================================================
--- trunk/windstille/src/objects/shockwave.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/objects/shockwave.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -20,26 +20,26 @@
 #include &quot;display/shader_object.hpp&quot;
 #include &quot;objects/shockwave.hpp&quot;
 
-class ShockwaveDrawingRequest : public DrawingRequest
+class ShockwaveDrawable : public Drawable
 {
 public:
   Texture       noise;
   ShaderProgram shader_program;
   float radius;
 
-  ShockwaveDrawingRequest(const Vector2f&amp; pos_, 
+  ShockwaveDrawable(const Vector2f&amp; pos_, 
                           const Texture&amp;       noise_,
                           const ShaderProgram&amp; shader_program_,
                           float r,
                           const Matrix&amp; modelview_) 
-    : DrawingRequest(pos_, 500.0f, modelview_),
+    : Drawable(pos_, 500.0f, modelview_),
       noise(noise_),
       shader_program(shader_program_),
       radius(r)
   {
   }
 
-  ~ShockwaveDrawingRequest()
+  ~ShockwaveDrawable()
   {
   }
 
@@ -238,7 +238,7 @@
 void
 Shockwave::draw (SceneContext&amp; sc)
 {
-  sc.highlight().draw(new ShockwaveDrawingRequest(pos,
+  sc.highlight().draw(new ShockwaveDrawable(pos,
                                                    noise,
                                                    shader_program,
                                                    radius,

Modified: trunk/windstille/src/objects/swarm.cpp
===================================================================
--- trunk/windstille/src/objects/swarm.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/objects/swarm.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -16,7 +16,7 @@
 **  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
 */
 
-#include &quot;scenegraph/vertex_array_drawing_request.hpp&quot;
+#include &quot;scenegraph/vertex_array_drawable.hpp&quot;
 #include &quot;math/random.hpp&quot;
 #include &quot;screen/game_session.hpp&quot;
 #include &quot;screen/view.hpp&quot;
@@ -57,7 +57,7 @@
 void
 Swarm::draw(SceneContext&amp; sc)
 {
-  VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector2f(0, 0), 
+  VertexArrayDrawable* array = new VertexArrayDrawable(Vector2f(0, 0), 
                                                                    1000.0f, sc.highlight().get_modelview());
 
   array-&gt;set_mode(GL_QUADS);

Modified: trunk/windstille/src/particles/deform_drawer.cpp
===================================================================
--- trunk/windstille/src/particles/deform_drawer.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/particles/deform_drawer.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -25,7 +25,7 @@
 #include &quot;particles/particle_system.hpp&quot;
 #include &quot;display/opengl_state.hpp&quot;
 
-class DeformDrawerRequest : public DrawingRequest
+class DeformDrawerRequest : public Drawable
 {
 public:
   Framebuffer&amp;      framebuffer;
@@ -36,7 +36,7 @@
   DeformDrawerRequest(const Vector2f&amp; pos_, float z_pos_,  const Matrix&amp; modelview_,
                       Framebuffer&amp; framebuffer_, Surface&amp; surface_, ParticleSystem&amp; psys_,
                       ShaderProgram&amp; shader_program_)
-    : DrawingRequest(pos_, z_pos_, modelview_),
+    : Drawable(pos_, z_pos_, modelview_),
       framebuffer(framebuffer_), surface(surface_), psys(psys_), 
       shader_program(shader_program_)
   {}

Modified: trunk/windstille/src/particles/spark_drawer.cpp
===================================================================
--- trunk/windstille/src/particles/spark_drawer.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/particles/spark_drawer.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -18,7 +18,7 @@
 
 #include &quot;display/drawing_context.hpp&quot;
 #include &quot;util/file_reader.hpp&quot;
-#include &quot;scenegraph/vertex_array_drawing_request.hpp&quot;
+#include &quot;scenegraph/vertex_array_drawable.hpp&quot;
 #include &quot;particles/particle_system.hpp&quot;
 #include &quot;particles/spark_drawer.hpp&quot;
 
@@ -33,7 +33,7 @@
 void
 SparkDrawer::draw(DrawingContext&amp; dc, ParticleSystem&amp; psys) 
 {
-  VertexArrayDrawingRequest* buffer = new VertexArrayDrawingRequest(Vector2f(0, 0), psys.get_z_pos(),
+  VertexArrayDrawable* buffer = new VertexArrayDrawable(Vector2f(0, 0), psys.get_z_pos(),
                                                                     dc.get_modelview());
   if (width == 1.0f)
     {

Modified: trunk/windstille/src/particles/surface_drawer.cpp
===================================================================
--- trunk/windstille/src/particles/surface_drawer.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/particles/surface_drawer.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -17,7 +17,7 @@
 */
 
 #include &quot;util/file_reader.cpp&quot;
-#include &quot;scenegraph/vertex_array_drawing_request.hpp&quot;
+#include &quot;scenegraph/vertex_array_drawable.hpp&quot;
 #include &quot;particles/particle_system.hpp&quot;
 #include &quot;display/surface_manager.hpp&quot;
 #include &quot;display/drawing_context.hpp&quot;
@@ -91,8 +91,8 @@
 void
 SurfaceDrawer::draw(DrawingContext&amp; dc, ParticleSystem&amp; psys) 
 {          
-  VertexArrayDrawingRequest* buffer 
-    = new VertexArrayDrawingRequest(Vector2f(psys.get_x_pos(), psys.get_y_pos()), psys.get_z_pos(),
+  VertexArrayDrawable* buffer 
+    = new VertexArrayDrawable(Vector2f(psys.get_x_pos(), psys.get_y_pos()), psys.get_z_pos(),
                                     dc.get_modelview());
 
   buffer-&gt;set_mode(GL_QUADS);

Copied: trunk/windstille/src/scenegraph/control_drawable.hpp (from rev 3102, trunk/windstille/src/scenegraph/control_drawing_request.hpp)
===================================================================
--- trunk/windstille/src/scenegraph/control_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/control_drawable.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -0,0 +1,60 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#ifndef HEADER_WINDSTILLE_DISPLAY_CONTROL_DRAWING_REQUEST_HPP
+#define HEADER_WINDSTILLE_DISPLAY_CONTROL_DRAWING_REQUEST_HPP
+
+class ControlDrawable : public Drawable
+{
+private:
+  Surface surface;
+  float angle;
+
+public:
+  ControlDrawable(Surface surface_, const Vector2f&amp; pos_, float angle_, float z_pos_,
+                        const Matrix&amp; modelview_)
+    : Drawable(pos_, z_pos_, modelview_), 
+      surface(surface_), 
+      angle(angle_)
+  {}
+
+  virtual ~ControlDrawable() {}
+
+  void draw(const Texture&amp; /*tmp_texture*/)
+  {
+    glPushMatrix();
+
+    // FIXME: This looks badly broken, should modelview.multiply() be enough?
+    glTranslatef(modelview.matrix[12],
+                 modelview.matrix[13],
+                 modelview.matrix[14]);
+
+    Vector3 p = modelview.multiply(Vector3(pos.x, pos.y, 0.0f));
+
+    surface.draw(SurfaceDrawingParameters()
+                 .set_angle(angle)
+                 .set_pos(Vector2f(p.x - surface.get_width()/2,
+                                   p.y - surface.get_height()/2)));
+
+    glPopMatrix();
+  }
+};
+
+#endif
+
+/* EOF */

Deleted: trunk/windstille/src/scenegraph/control_drawing_request.hpp
===================================================================
--- trunk/windstille/src/scenegraph/control_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/control_drawing_request.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -1,60 +0,0 @@
-/*
-**  Windstille - A Sci-Fi Action-Adventure Game
-**  Copyright (C) 2009 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
-**
-**  This program is free software: you can redistribute it and/or modify
-**  it under the terms of the GNU General Public License as published by
-**  the Free Software Foundation, either version 3 of the License, or
-**  (at your option) any later version.
-**  
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-**  
-**  You should have received a copy of the GNU General Public License
-**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
-*/
-
-#ifndef HEADER_WINDSTILLE_DISPLAY_CONTROL_DRAWING_REQUEST_HPP
-#define HEADER_WINDSTILLE_DISPLAY_CONTROL_DRAWING_REQUEST_HPP
-
-class ControlDrawingRequest : public DrawingRequest
-{
-private:
-  Surface surface;
-  float angle;
-
-public:
-  ControlDrawingRequest(Surface surface_, const Vector2f&amp; pos_, float angle_, float z_pos_,
-                        const Matrix&amp; modelview_)
-    : DrawingRequest(pos_, z_pos_, modelview_), 
-      surface(surface_), 
-      angle(angle_)
-  {}
-
-  virtual ~ControlDrawingRequest() {}
-
-  void draw(const Texture&amp; /*tmp_texture*/)
-  {
-    glPushMatrix();
-
-    // FIXME: This looks badly broken, should modelview.multiply() be enough?
-    glTranslatef(modelview.matrix[12],
-                 modelview.matrix[13],
-                 modelview.matrix[14]);
-
-    Vector3 p = modelview.multiply(Vector3(pos.x, pos.y, 0.0f));
-
-    surface.draw(SurfaceDrawingParameters()
-                 .set_angle(angle)
-                 .set_pos(Vector2f(p.x - surface.get_width()/2,
-                                   p.y - surface.get_height()/2)));
-
-    glPopMatrix();
-  }
-};
-
-#endif
-
-/* EOF */

Copied: trunk/windstille/src/scenegraph/drawable.hpp (from rev 3102, trunk/windstille/src/scenegraph/drawing_request.hpp)
===================================================================
--- trunk/windstille/src/scenegraph/drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/drawable.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -0,0 +1,85 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2000,2005 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#ifndef HEADER_WINDSTILLE_DISPLAY_DRAWING_REQUEST_HPP
+#define HEADER_WINDSTILLE_DISPLAY_DRAWING_REQUEST_HPP
+
+#include &quot;math/vector2f.hpp&quot;
+#include &quot;math/rect.hpp&quot;
+#include &quot;math/matrix.hpp&quot;
+#include &quot;display/texture.hpp&quot;
+
+class Drawable
+{
+protected:
+  Vector2f pos;
+  float    z_pos;
+  Matrix   modelview;
+  unsigned int render_mask;
+
+public:
+  Drawable(const Vector2f&amp; pos_, float z_pos_ = 0,  const Matrix&amp; modelview_ = Matrix::identity())
+    : pos(pos_), 
+      z_pos(z_pos_), 
+      modelview(modelview_),
+      render_mask(0)
+  {}
+  virtual ~Drawable() {}
+  
+  /**
+   * The draw() method does the important work in Drawable,
+   * ie. it is the place where you can access the screen with raw
+   * OpenGL methods. The \a tmp_texture provides a texture of the
+   * current framebuffer, you have to copy the \a screen_texture to it
+   * to contain usefull content
+   */
+  virtual void draw(const Texture&amp; tmp_texture) = 0;
+
+  /**
+   * This method is called before draw() to allow the Drawable
+   * to copy content from \a screen_texture, which is the current
+   * framebuffer to a temporary buffer which can then be used in
+   * draw() for deformation effects
+   */
+  virtual void prepare(const Texture&amp; screen_texture) {
+      (void) screen_texture;
+  }
+
+  /**
+   * Override this and let it return true if you need to prepare()
+   * function call
+   */
+  virtual bool needs_prepare() { return false; }
+  
+  /** Returns the position at which the request should be drawn */
+  float get_z_pos() const { return z_pos; }
+
+  Matrix get_modelview() const
+  { return modelview; }
+
+  void set_render_mask(unsigned int mask) { render_mask = mask; }
+  unsigned int get_render_mask() const { return render_mask; }
+
+private:
+  Drawable (const Drawable&amp;);
+  Drawable&amp; operator= (const Drawable&amp;);
+};
+
+#endif
+
+/* EOF */

Deleted: trunk/windstille/src/scenegraph/drawing_request.hpp
===================================================================
--- trunk/windstille/src/scenegraph/drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/drawing_request.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -1,85 +0,0 @@
-/*
-**  Windstille - A Sci-Fi Action-Adventure Game
-**  Copyright (C) 2000,2005 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
-**
-**  This program is free software: you can redistribute it and/or modify
-**  it under the terms of the GNU General Public License as published by
-**  the Free Software Foundation, either version 3 of the License, or
-**  (at your option) any later version.
-**  
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-**  
-**  You should have received a copy of the GNU General Public License
-**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
-*/
-
-#ifndef HEADER_WINDSTILLE_DISPLAY_DRAWING_REQUEST_HPP
-#define HEADER_WINDSTILLE_DISPLAY_DRAWING_REQUEST_HPP
-
-#include &quot;math/vector2f.hpp&quot;
-#include &quot;math/rect.hpp&quot;
-#include &quot;math/matrix.hpp&quot;
-#include &quot;display/texture.hpp&quot;
-
-class DrawingRequest
-{
-protected:
-  Vector2f pos;
-  float    z_pos;
-  Matrix   modelview;
-  unsigned int render_mask;
-
-public:
-  DrawingRequest(const Vector2f&amp; pos_, float z_pos_ = 0,  const Matrix&amp; modelview_ = Matrix::identity())
-    : pos(pos_), 
-      z_pos(z_pos_), 
-      modelview(modelview_),
-      render_mask(0)
-  {}
-  virtual ~DrawingRequest() {}
-  
-  /**
-   * The draw() method does the important work in DrawingRequest,
-   * ie. it is the place where you can access the screen with raw
-   * OpenGL methods. The \a tmp_texture provides a texture of the
-   * current framebuffer, you have to copy the \a screen_texture to it
-   * to contain usefull content
-   */
-  virtual void draw(const Texture&amp; tmp_texture) = 0;
-
-  /**
-   * This method is called before draw() to allow the DrawingRequest
-   * to copy content from \a screen_texture, which is the current
-   * framebuffer to a temporary buffer which can then be used in
-   * draw() for deformation effects
-   */
-  virtual void prepare(const Texture&amp; screen_texture) {
-      (void) screen_texture;
-  }
-
-  /**
-   * Override this and let it return true if you need to prepare()
-   * function call
-   */
-  virtual bool needs_prepare() { return false; }
-  
-  /** Returns the position at which the request should be drawn */
-  float get_z_pos() const { return z_pos; }
-
-  Matrix get_modelview() const
-  { return modelview; }
-
-  void set_render_mask(unsigned int mask) { render_mask = mask; }
-  unsigned int get_render_mask() const { return render_mask; }
-
-private:
-  DrawingRequest (const DrawingRequest&amp;);
-  DrawingRequest&amp; operator= (const DrawingRequest&amp;);
-};
-
-#endif
-
-/* EOF */

Copied: trunk/windstille/src/scenegraph/fill_screen_drawable.hpp (from rev 3102, trunk/windstille/src/scenegraph/fill_screen_drawing_request.hpp)
===================================================================
--- trunk/windstille/src/scenegraph/fill_screen_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/fill_screen_drawable.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -0,0 +1,47 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#ifndef HEADER_WINDSTILLE_DISPLAY_FILL_SCREEN_DRAWING_REQUEST_HPP
+#define HEADER_WINDSTILLE_DISPLAY_FILL_SCREEN_DRAWING_REQUEST_HPP
+
+
+
+class FillScreenDrawable : public Drawable
+{
+private:
+  Color color;
+
+public:
+  FillScreenDrawable(const Color&amp; color_) 
+    : Drawable(Vector2f(0, 0), -1000.0f), color(color_)
+  {
+  }
+  virtual ~FillScreenDrawable() {}
+
+  void draw(const Texture&amp; /*tmp_texture*/) {
+    OpenGLState state;
+    // FIXME: move clear color to opengl_state
+    state.activate();
+    glClearColor(color.r, color.g, color.b, color.a);
+    glClear(GL_COLOR_BUFFER_BIT);
+  }
+};
+
+#endif
+
+/* EOF */

Deleted: trunk/windstille/src/scenegraph/fill_screen_drawing_request.hpp
===================================================================
--- trunk/windstille/src/scenegraph/fill_screen_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/fill_screen_drawing_request.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -1,47 +0,0 @@
-/*
-**  Windstille - A Sci-Fi Action-Adventure Game
-**  Copyright (C) 2009 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
-**
-**  This program is free software: you can redistribute it and/or modify
-**  it under the terms of the GNU General Public License as published by
-**  the Free Software Foundation, either version 3 of the License, or
-**  (at your option) any later version.
-**  
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-**  
-**  You should have received a copy of the GNU General Public License
-**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
-*/
-
-#ifndef HEADER_WINDSTILLE_DISPLAY_FILL_SCREEN_DRAWING_REQUEST_HPP
-#define HEADER_WINDSTILLE_DISPLAY_FILL_SCREEN_DRAWING_REQUEST_HPP
-
-
-
-class FillScreenDrawingRequest : public DrawingRequest
-{
-private:
-  Color color;
-
-public:
-  FillScreenDrawingRequest(const Color&amp; color_) 
-    : DrawingRequest(Vector2f(0, 0), -1000.0f), color(color_)
-  {
-  }
-  virtual ~FillScreenDrawingRequest() {}
-
-  void draw(const Texture&amp; /*tmp_texture*/) {
-    OpenGLState state;
-    // FIXME: move clear color to opengl_state
-    state.activate();
-    glClearColor(color.r, color.g, color.b, color.a);
-    glClear(GL_COLOR_BUFFER_BIT);
-  }
-};
-
-#endif
-
-/* EOF */

Copied: trunk/windstille/src/scenegraph/fill_screen_pattern_drawable.hpp (from rev 3102, trunk/windstille/src/scenegraph/fill_screen_pattern_drawing_request.hpp)
===================================================================
--- trunk/windstille/src/scenegraph/fill_screen_pattern_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/fill_screen_pattern_drawable.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -0,0 +1,74 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#ifndef HEADER_WINDSTILLE_DISPLAY_FILL_SCREEN_PATTERN_DRAWING_REQUEST_HPP
+#define HEADER_WINDSTILLE_DISPLAY_FILL_SCREEN_PATTERN_DRAWING_REQUEST_HPP
+
+
+class FillScreenPatternDrawable : public Drawable
+{
+private:
+  Texture  texture;
+  Vector2f offset;
+public:
+  FillScreenPatternDrawable(const Texture&amp; texture_, const Vector2f&amp; offset_)
+    : Drawable(Vector2f(0, 0), -1000.0f), 
+      texture(texture_),
+      offset(offset_)
+  {}
+
+  virtual ~FillScreenPatternDrawable() {}
+
+  void draw(const Texture&amp; /*tmp_texture*/) 
+  {
+    OpenGLState state;
+    state.enable(GL_BLEND);
+    state.set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
+    state.bind_texture(texture);
+    state.activate();
+
+    float u = static_cast&lt;float&gt;(Display::get_width())  / static_cast&lt;float&gt;(texture.get_width());
+    float v = static_cast&lt;float&gt;(Display::get_height()) / static_cast&lt;float&gt;(texture.get_height());
+
+    float u_start = -offset.x / static_cast&lt;float&gt;(texture.get_width());
+    float v_start = -offset.y / static_cast&lt;float&gt;(texture.get_height());
+
+    u -= offset.x / static_cast&lt;float&gt;(texture.get_width());
+    v -= offset.y / static_cast&lt;float&gt;(texture.get_height());
+
+    glBegin(GL_QUADS);
+    {
+      glTexCoord2f(u_start, v_start);
+      glVertex2f(0, 0);
+    
+      glTexCoord2f(u, v_start);
+      glVertex2f(static_cast&lt;float&gt;(Display::get_width()), 0);
+
+      glTexCoord2f(u, v);
+      glVertex2f(static_cast&lt;float&gt;(Display::get_width()), static_cast&lt;float&gt;(Display::get_height()));
+
+      glTexCoord2f(u_start, v);
+      glVertex2f(0,  static_cast&lt;float&gt;(Display::get_height()));
+    }
+    glEnd();
+  }
+};
+
+#endif
+
+/* EOF */

Deleted: trunk/windstille/src/scenegraph/fill_screen_pattern_drawing_request.hpp
===================================================================
--- trunk/windstille/src/scenegraph/fill_screen_pattern_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/fill_screen_pattern_drawing_request.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -1,74 +0,0 @@
-/*
-**  Windstille - A Sci-Fi Action-Adventure Game
-**  Copyright (C) 2009 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
-**
-**  This program is free software: you can redistribute it and/or modify
-**  it under the terms of the GNU General Public License as published by
-**  the Free Software Foundation, either version 3 of the License, or
-**  (at your option) any later version.
-**  
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-**  
-**  You should have received a copy of the GNU General Public License
-**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
-*/
-
-#ifndef HEADER_WINDSTILLE_DISPLAY_FILL_SCREEN_PATTERN_DRAWING_REQUEST_HPP
-#define HEADER_WINDSTILLE_DISPLAY_FILL_SCREEN_PATTERN_DRAWING_REQUEST_HPP
-
-
-class FillScreenPatternDrawingRequest : public DrawingRequest
-{
-private:
-  Texture  texture;
-  Vector2f offset;
-public:
-  FillScreenPatternDrawingRequest(const Texture&amp; texture_, const Vector2f&amp; offset_)
-    : DrawingRequest(Vector2f(0, 0), -1000.0f), 
-      texture(texture_),
-      offset(offset_)
-  {}
-
-  virtual ~FillScreenPatternDrawingRequest() {}
-
-  void draw(const Texture&amp; /*tmp_texture*/) 
-  {
-    OpenGLState state;
-    state.enable(GL_BLEND);
-    state.set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
-    state.bind_texture(texture);
-    state.activate();
-
-    float u = static_cast&lt;float&gt;(Display::get_width())  / static_cast&lt;float&gt;(texture.get_width());
-    float v = static_cast&lt;float&gt;(Display::get_height()) / static_cast&lt;float&gt;(texture.get_height());
-
-    float u_start = -offset.x / static_cast&lt;float&gt;(texture.get_width());
-    float v_start = -offset.y / static_cast&lt;float&gt;(texture.get_height());
-
-    u -= offset.x / static_cast&lt;float&gt;(texture.get_width());
-    v -= offset.y / static_cast&lt;float&gt;(texture.get_height());
-
-    glBegin(GL_QUADS);
-    {
-      glTexCoord2f(u_start, v_start);
-      glVertex2f(0, 0);
-    
-      glTexCoord2f(u, v_start);
-      glVertex2f(static_cast&lt;float&gt;(Display::get_width()), 0);
-
-      glTexCoord2f(u, v);
-      glVertex2f(static_cast&lt;float&gt;(Display::get_width()), static_cast&lt;float&gt;(Display::get_height()));
-
-      glTexCoord2f(u_start, v);
-      glVertex2f(0,  static_cast&lt;float&gt;(Display::get_height()));
-    }
-    glEnd();
-  }
-};
-
-#endif
-
-/* EOF */

Modified: trunk/windstille/src/scenegraph/scene_graph.cpp
===================================================================
--- trunk/windstille/src/scenegraph/scene_graph.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/scene_graph.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -18,21 +18,21 @@
 
 #include &quot;scenegraph/scene_graph.hpp&quot;
 
-#include &quot;scenegraph/drawing_request.hpp&quot;
+#include &quot;scenegraph/drawable.hpp&quot;
 
 SceneGraph::SceneGraph()
-  : m_drawing_requests()
+  : m_drawables()
 {
 }
 
 void
-SceneGraph::add_drawable(boost::shared_ptr&lt;DrawingRequest&gt; drawable)
+SceneGraph::add_drawable(boost::shared_ptr&lt;Drawable&gt; drawable)
 {
-  m_drawing_requests.push_back(drawable);
+  m_drawables.push_back(drawable);
 }
 
 void
-SceneGraph::remove_drawable(boost::shared_ptr&lt;DrawingRequest&gt; /*drawable*/)
+SceneGraph::remove_drawable(boost::shared_ptr&lt;Drawable&gt; /*drawable*/)
 {
   // FIXME: implement me
 }
@@ -40,7 +40,7 @@
 void
 SceneGraph::draw(const Texture&amp; tmp_texture, unsigned int mask)
 {
-  for(DrawingRequests::reverse_iterator i = m_drawing_requests.rbegin(); i != m_drawing_requests.rend(); ++i)
+  for(Drawables::reverse_iterator i = m_drawables.rbegin(); i != m_drawables.rend(); ++i)
   {
     if ((*i)-&gt;get_render_mask() &amp; mask)
       (*i)-&gt;draw(tmp_texture);

Modified: trunk/windstille/src/scenegraph/scene_graph.hpp
===================================================================
--- trunk/windstille/src/scenegraph/scene_graph.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/scene_graph.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -22,20 +22,20 @@
 #include &lt;boost/shared_ptr.hpp&gt;
 #include &lt;vector&gt;
 
-class DrawingRequest;
+class Drawable;
 class Texture;
 
 class SceneGraph
 {
 private:
-  typedef std::vector&lt;boost::shared_ptr&lt;DrawingRequest&gt; &gt; DrawingRequests;
-  DrawingRequests m_drawing_requests;
+  typedef std::vector&lt;boost::shared_ptr&lt;Drawable&gt; &gt; Drawables;
+  Drawables m_drawables;
 
 public:
   SceneGraph();
 
-  void add_drawable(boost::shared_ptr&lt;DrawingRequest&gt; drawable);
-  void remove_drawable(boost::shared_ptr&lt;DrawingRequest&gt; drawable);
+  void add_drawable(boost::shared_ptr&lt;Drawable&gt; drawable);
+  void remove_drawable(boost::shared_ptr&lt;Drawable&gt; drawable);
 
   void draw(const Texture&amp; tmp_texture, unsigned int mask);
 

Copied: trunk/windstille/src/scenegraph/sprite3d_drawable.hpp (from rev 3102, trunk/windstille/src/scenegraph/sprite3d_drawing_request.hpp)
===================================================================
--- trunk/windstille/src/scenegraph/sprite3d_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/sprite3d_drawable.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -0,0 +1,53 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#ifndef HEADER_WINDSTILLE_SPRITE3D_SPRITE3D_DRAWING_REQUEST_HPP
+#define HEADER_WINDSTILLE_SPRITE3D_SPRITE3D_DRAWING_REQUEST_HPP
+
+#include &quot;sprite3d/sprite3d.hpp&quot;
+#include &quot;scenegraph/drawable.hpp&quot;
+
+class Sprite3DDrawable : public Drawable
+{
+private:
+  const Sprite3D* sprite;
+
+public:
+  Sprite3DDrawable(const Sprite3D* sprite_, 
+                         const Vector2f&amp; pos_, float z_pos_, const Matrix&amp; modelview_)
+    : Drawable(pos_, z_pos_, modelview_), sprite(sprite_)
+  {}
+
+  void draw(const Texture&amp; /*tmp_texture*/)
+  {
+    sprite-&gt;draw(pos, modelview);
+  }
+
+  void set_pos(const Vector2f&amp; pos_)
+  {
+    pos = pos_;
+  }
+
+private:
+  Sprite3DDrawable(const Sprite3DDrawable&amp;);
+  Sprite3DDrawable&amp; operator=(const Sprite3DDrawable&amp;);
+};
+
+#endif
+
+/* EOF */

Deleted: trunk/windstille/src/scenegraph/sprite3d_drawing_request.hpp
===================================================================
--- trunk/windstille/src/scenegraph/sprite3d_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/sprite3d_drawing_request.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -1,53 +0,0 @@
-/*
-**  Windstille - A Sci-Fi Action-Adventure Game
-**  Copyright (C) 2009 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
-**
-**  This program is free software: you can redistribute it and/or modify
-**  it under the terms of the GNU General Public License as published by
-**  the Free Software Foundation, either version 3 of the License, or
-**  (at your option) any later version.
-**  
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-**  
-**  You should have received a copy of the GNU General Public License
-**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
-*/
-
-#ifndef HEADER_WINDSTILLE_SPRITE3D_SPRITE3D_DRAWING_REQUEST_HPP
-#define HEADER_WINDSTILLE_SPRITE3D_SPRITE3D_DRAWING_REQUEST_HPP
-
-#include &quot;sprite3d/sprite3d.hpp&quot;
-#include &quot;scenegraph/drawing_request.hpp&quot;
-
-class Sprite3DDrawingRequest : public DrawingRequest
-{
-private:
-  const Sprite3D* sprite;
-
-public:
-  Sprite3DDrawingRequest(const Sprite3D* sprite_, 
-                         const Vector2f&amp; pos_, float z_pos_, const Matrix&amp; modelview_)
-    : DrawingRequest(pos_, z_pos_, modelview_), sprite(sprite_)
-  {}
-
-  void draw(const Texture&amp; /*tmp_texture*/)
-  {
-    sprite-&gt;draw(pos, modelview);
-  }
-
-  void set_pos(const Vector2f&amp; pos_)
-  {
-    pos = pos_;
-  }
-
-private:
-  Sprite3DDrawingRequest(const Sprite3DDrawingRequest&amp;);
-  Sprite3DDrawingRequest&amp; operator=(const Sprite3DDrawingRequest&amp;);
-};
-
-#endif
-
-/* EOF */

Copied: trunk/windstille/src/scenegraph/surface_drawable.hpp (from rev 3102, trunk/windstille/src/scenegraph/surface_drawing_request.hpp)
===================================================================
--- trunk/windstille/src/scenegraph/surface_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/surface_drawable.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -0,0 +1,59 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#ifndef HEADER_WINDSTILLE_DISPLAY_SURFACE_DRAWING_REQUEST_HPP
+#define HEADER_WINDSTILLE_DISPLAY_SURFACE_DRAWING_REQUEST_HPP
+
+#include &quot;scenegraph/surface_drawable.hpp&quot;
+#include &quot;display/surface_drawing_parameters.hpp&quot;
+
+class SurfaceDrawable : public Drawable
+{
+private:
+  Surface surface;
+  SurfaceDrawingParameters params;
+
+public:
+  SurfaceDrawable(Surface surface_, const SurfaceDrawingParameters&amp; params_,
+                        float z_pos_,
+                        const Matrix&amp; modelview_)
+    : Drawable(pos, z_pos_, modelview_), 
+      surface(surface_), 
+      params(params_)
+  {}
+
+  virtual ~SurfaceDrawable()
+  {}
+  
+  Surface get_surface() const { return surface; }
+  SurfaceDrawingParameters&amp; get_params() { return params; }
+
+  void draw(const Texture&amp; /*tmp_texture*/) 
+  {
+    glPushMatrix();
+    glMultMatrixf(modelview.matrix);
+
+    surface.draw(params);
+
+    glPopMatrix();
+  }
+};
+
+#endif
+
+/* EOF */

Deleted: trunk/windstille/src/scenegraph/surface_drawing_request.hpp
===================================================================
--- trunk/windstille/src/scenegraph/surface_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/surface_drawing_request.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -1,59 +0,0 @@
-/*
-**  Windstille - A Sci-Fi Action-Adventure Game
-**  Copyright (C) 2009 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
-**
-**  This program is free software: you can redistribute it and/or modify
-**  it under the terms of the GNU General Public License as published by
-**  the Free Software Foundation, either version 3 of the License, or
-**  (at your option) any later version.
-**  
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-**  
-**  You should have received a copy of the GNU General Public License
-**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
-*/
-
-#ifndef HEADER_WINDSTILLE_DISPLAY_SURFACE_DRAWING_REQUEST_HPP
-#define HEADER_WINDSTILLE_DISPLAY_SURFACE_DRAWING_REQUEST_HPP
-
-#include &quot;scenegraph/surface_drawing_request.hpp&quot;
-#include &quot;display/surface_drawing_parameters.hpp&quot;
-
-class SurfaceDrawingRequest : public DrawingRequest
-{
-private:
-  Surface surface;
-  SurfaceDrawingParameters params;
-
-public:
-  SurfaceDrawingRequest(Surface surface_, const SurfaceDrawingParameters&amp; params_,
-                        float z_pos_,
-                        const Matrix&amp; modelview_)
-    : DrawingRequest(pos, z_pos_, modelview_), 
-      surface(surface_), 
-      params(params_)
-  {}
-
-  virtual ~SurfaceDrawingRequest()
-  {}
-  
-  Surface get_surface() const { return surface; }
-  SurfaceDrawingParameters&amp; get_params() { return params; }
-
-  void draw(const Texture&amp; /*tmp_texture*/) 
-  {
-    glPushMatrix();
-    glMultMatrixf(modelview.matrix);
-
-    surface.draw(params);
-
-    glPopMatrix();
-  }
-};
-
-#endif
-
-/* EOF */

Copied: trunk/windstille/src/scenegraph/surface_quad_drawable.hpp (from rev 3102, trunk/windstille/src/scenegraph/surface_quad_drawing_request.hpp)
===================================================================
--- trunk/windstille/src/scenegraph/surface_quad_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/surface_quad_drawable.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -0,0 +1,77 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#ifndef HEADER_WINDSTILLE_DISPLAY_SURFACE_QUAD_DRAWING_REQUEST_HPP
+#define HEADER_WINDSTILLE_DISPLAY_SURFACE_QUAD_DRAWING_REQUEST_HPP
+
+#include &quot;math/vector2f.hpp&quot;
+#include &quot;math/quad.hpp&quot;
+#include &quot;scenegraph/drawable.hpp&quot;
+
+class SurfaceQuadDrawable : public Drawable
+{
+private:
+  Surface surface;
+  Quad quad;
+  DrawingParameters params;
+
+public:
+  SurfaceQuadDrawable(Surface surface_, const Vector2f&amp; pos_, const Quad&amp; quad_, 
+                            const DrawingParameters&amp; params_, float z_pos_,
+                            const Matrix&amp; modelview_)
+    : Drawable(pos_, z_pos_, modelview_),
+      surface(surface_),
+      quad(quad_),
+      params(params_)
+  {
+  }
+
+  void draw(const Texture&amp; /*tmp_texture*/) 
+  {
+    OpenGLState state;
+    state.enable(GL_BLEND);
+    state.set_blend_func(params.blendfunc_src, params.blendfunc_dst);
+    state.bind_texture(surface.get_texture());
+    state.activate();
+
+    glPushMatrix();
+    glMultMatrixf(modelview.matrix);
+
+    glBegin(GL_QUADS);
+    {
+      glTexCoord2f(surface.get_uv().left, surface.get_uv().top);
+      glVertex2f(pos.x + quad.p1.x, pos.y + quad.p1.y);
+    
+      glTexCoord2f(surface.get_uv().right, surface.get_uv().top);
+      glVertex2f(pos.x + quad.p2.x, pos.y + quad.p2.y);
+
+      glTexCoord2f(surface.get_uv().right, surface.get_uv().bottom);
+      glVertex2f(pos.x + quad.p3.x, pos.y + quad.p3.y);
+
+      glTexCoord2f(surface.get_uv().left, surface.get_uv().bottom);
+      glVertex2f(pos.x + quad.p4.x, pos.y + quad.p4.y);
+    }
+    glEnd();
+
+    glPopMatrix();    
+  }
+};
+
+#endif
+
+/* EOF */

Deleted: trunk/windstille/src/scenegraph/surface_quad_drawing_request.hpp
===================================================================
--- trunk/windstille/src/scenegraph/surface_quad_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/surface_quad_drawing_request.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -1,77 +0,0 @@
-/*
-**  Windstille - A Sci-Fi Action-Adventure Game
-**  Copyright (C) 2009 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
-**
-**  This program is free software: you can redistribute it and/or modify
-**  it under the terms of the GNU General Public License as published by
-**  the Free Software Foundation, either version 3 of the License, or
-**  (at your option) any later version.
-**  
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-**  
-**  You should have received a copy of the GNU General Public License
-**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
-*/
-
-#ifndef HEADER_WINDSTILLE_DISPLAY_SURFACE_QUAD_DRAWING_REQUEST_HPP
-#define HEADER_WINDSTILLE_DISPLAY_SURFACE_QUAD_DRAWING_REQUEST_HPP
-
-#include &quot;math/vector2f.hpp&quot;
-#include &quot;math/quad.hpp&quot;
-#include &quot;scenegraph/drawing_request.hpp&quot;
-
-class SurfaceQuadDrawingRequest : public DrawingRequest
-{
-private:
-  Surface surface;
-  Quad quad;
-  DrawingParameters params;
-
-public:
-  SurfaceQuadDrawingRequest(Surface surface_, const Vector2f&amp; pos_, const Quad&amp; quad_, 
-                            const DrawingParameters&amp; params_, float z_pos_,
-                            const Matrix&amp; modelview_)
-    : DrawingRequest(pos_, z_pos_, modelview_),
-      surface(surface_),
-      quad(quad_),
-      params(params_)
-  {
-  }
-
-  void draw(const Texture&amp; /*tmp_texture*/) 
-  {
-    OpenGLState state;
-    state.enable(GL_BLEND);
-    state.set_blend_func(params.blendfunc_src, params.blendfunc_dst);
-    state.bind_texture(surface.get_texture());
-    state.activate();
-
-    glPushMatrix();
-    glMultMatrixf(modelview.matrix);
-
-    glBegin(GL_QUADS);
-    {
-      glTexCoord2f(surface.get_uv().left, surface.get_uv().top);
-      glVertex2f(pos.x + quad.p1.x, pos.y + quad.p1.y);
-    
-      glTexCoord2f(surface.get_uv().right, surface.get_uv().top);
-      glVertex2f(pos.x + quad.p2.x, pos.y + quad.p2.y);
-
-      glTexCoord2f(surface.get_uv().right, surface.get_uv().bottom);
-      glVertex2f(pos.x + quad.p3.x, pos.y + quad.p3.y);
-
-      glTexCoord2f(surface.get_uv().left, surface.get_uv().bottom);
-      glVertex2f(pos.x + quad.p4.x, pos.y + quad.p4.y);
-    }
-    glEnd();
-
-    glPopMatrix();    
-  }
-};
-
-#endif
-
-/* EOF */

Copied: trunk/windstille/src/scenegraph/text_drawable.hpp (from rev 3102, trunk/windstille/src/scenegraph/text_drawing_request.hpp)
===================================================================
--- trunk/windstille/src/scenegraph/text_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/text_drawable.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -0,0 +1,43 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#ifndef HEADER_WINDSTILLE_DISPLAY_TEXT_DRAWING_REQUEST_HPP
+#define HEADER_WINDSTILLE_DISPLAY_TEXT_DRAWING_REQUEST_HPP
+
+class TextDrawable : public Drawable
+{
+private:
+  std::string text;
+public:
+  TextDrawable(const std::string&amp; text_, const Vector2f&amp; pos_, float z_pos_, const Matrix&amp; modelview_)
+    : Drawable(pos_, z_pos_, modelview_),
+      text(text_)
+  {}
+  virtual ~TextDrawable() {}
+
+  void draw(const Texture&amp; /*tmp_texture*/) {
+    glPushMatrix();
+    glMultMatrixf(modelview.matrix);
+    Fonts::current()-&gt;ttffont-&gt;draw(pos, text);
+    glPopMatrix();
+  }
+};
+
+#endif
+
+/* EOF */

Deleted: trunk/windstille/src/scenegraph/text_drawing_request.hpp
===================================================================
--- trunk/windstille/src/scenegraph/text_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/text_drawing_request.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -1,43 +0,0 @@
-/*
-**  Windstille - A Sci-Fi Action-Adventure Game
-**  Copyright (C) 2009 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
-**
-**  This program is free software: you can redistribute it and/or modify
-**  it under the terms of the GNU General Public License as published by
-**  the Free Software Foundation, either version 3 of the License, or
-**  (at your option) any later version.
-**  
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-**  
-**  You should have received a copy of the GNU General Public License
-**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
-*/
-
-#ifndef HEADER_WINDSTILLE_DISPLAY_TEXT_DRAWING_REQUEST_HPP
-#define HEADER_WINDSTILLE_DISPLAY_TEXT_DRAWING_REQUEST_HPP
-
-class TextDrawingRequest : public DrawingRequest
-{
-private:
-  std::string text;
-public:
-  TextDrawingRequest(const std::string&amp; text_, const Vector2f&amp; pos_, float z_pos_, const Matrix&amp; modelview_)
-    : DrawingRequest(pos_, z_pos_, modelview_),
-      text(text_)
-  {}
-  virtual ~TextDrawingRequest() {}
-
-  void draw(const Texture&amp; /*tmp_texture*/) {
-    glPushMatrix();
-    glMultMatrixf(modelview.matrix);
-    Fonts::current()-&gt;ttffont-&gt;draw(pos, text);
-    glPopMatrix();
-  }
-};
-
-#endif
-
-/* EOF */

Copied: trunk/windstille/src/scenegraph/vertex_array_drawable.cpp (from rev 3102, trunk/windstille/src/scenegraph/vertex_array_drawing_request.cpp)
===================================================================
--- trunk/windstille/src/scenegraph/vertex_array_drawing_request.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/vertex_array_drawable.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -0,0 +1,183 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2005 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#include &quot;display/opengl_state.hpp&quot;
+#include &quot;scenegraph/vertex_array_drawable.hpp&quot;
+
+VertexArrayDrawable::VertexArrayDrawable(const Vector2f&amp; pos_, float z_pos_, 
+                                                     const Matrix&amp; modelview_)
+  : Drawable(pos_, z_pos_, modelview_),
+    mode(GL_QUADS),
+    blend_sfactor(GL_SRC_ALPHA),
+    blend_dfactor(GL_ONE_MINUS_SRC_ALPHA),
+    texture(),
+    colors(),
+    texcoords(),
+    vertices()
+{
+}
+
+int
+VertexArrayDrawable::num_vertices() const
+{
+  return vertices.size()/3;
+}
+
+void
+VertexArrayDrawable::clear()
+{
+  colors.clear();
+  texcoords.clear();
+  vertices.clear();
+}
+
+void
+VertexArrayDrawable::draw(const Texture&amp; /*tmp_texture*/)
+{
+  draw(0, num_vertices());
+}
+
+void
+VertexArrayDrawable::draw(int start, int end)
+{
+  assert(!vertices.empty());
+  assert(texcoords.empty() || int(texcoords.size()/2) == num_vertices());
+  assert(colors.empty() || int(colors.size()/4) == num_vertices());
+
+  OpenGLState state;
+
+  glClear(GL_DEPTH_BUFFER_BIT);
+  state.disable(GL_DEPTH_TEST);
+  state.enable(GL_BLEND);
+  state.set_blend_func(blend_sfactor, blend_dfactor);
+  
+  if (texture)
+    {
+      state.bind_texture(texture);
+    }
+
+  if (!colors.empty())
+    {
+      state.enable_client_state(GL_COLOR_ARRAY);
+      glColorPointer(4, GL_UNSIGNED_BYTE, 0, &amp;*colors.begin());
+    }
+  else
+    {
+      state.disable_client_state(GL_COLOR_ARRAY);
+      state.color(Color(1.0f, 1.0f, 1.0f));
+    }
+
+  if (!texcoords.empty())
+    {
+      state.enable_client_state(GL_TEXTURE_COORD_ARRAY);
+      glTexCoordPointer(2, GL_FLOAT, 0, &amp;*texcoords.begin());
+    }
+  else
+    {
+      state.disable_client_state(GL_TEXTURE_COORD_ARRAY);
+    }
+
+  // FIXME: Might be worth to not use VertexArrays when we have a pretty small number of vertices
+  state.disable_client_state(GL_NORMAL_ARRAY);
+  state.enable_client_state(GL_VERTEX_ARRAY);
+
+  glVertexPointer(3, GL_FLOAT, 0, &amp;*vertices.begin());
+
+  state.activate();
+
+  glPushMatrix();
+  glMultMatrixf(modelview.matrix);
+
+  glDrawArrays(mode, start, end);
+
+  glPopMatrix();
+}
+
+void
+VertexArrayDrawable::vertex(const Vector2f&amp; vec, float z)
+{
+  vertex(vec.x, vec.y, z);
+}
+
+void
+VertexArrayDrawable::vertex(float x, float y, float z)
+{
+  vertices.push_back(x + pos.x);
+  vertices.push_back(y + pos.y);
+  vertices.push_back(z);
+}
+
+void
+VertexArrayDrawable::texcoord(float u, float v)
+{
+  texcoords.push_back(u);
+  texcoords.push_back(v);
+}
+
+void
+VertexArrayDrawable::add_texcoords(const Rectf&amp; rect)
+{
+  texcoords.push_back(rect.left);
+  texcoords.push_back(rect.top);
+  texcoords.push_back(rect.right);
+  texcoords.push_back(rect.top);
+  texcoords.push_back(rect.right);
+  texcoords.push_back(rect.bottom);
+  texcoords.push_back(rect.left);
+  texcoords.push_back(rect.bottom);
+}
+
+void
+VertexArrayDrawable::add_texcoords(const float* coords, size_t n)
+{
+  assert(n % 2 == 0);
+  for(size_t i = 0; i &lt; n; ++i)
+  {
+    texcoords.push_back(coords[i]);
+  }
+}
+
+void
+VertexArrayDrawable::color(const Color&amp; color_)
+{
+  colors.push_back(static_cast&lt;unsigned char&gt;(color_.r * 255));
+  colors.push_back(static_cast&lt;unsigned char&gt;(color_.g * 255));
+  colors.push_back(static_cast&lt;unsigned char&gt;(color_.b * 255));
+  colors.push_back(static_cast&lt;unsigned char&gt;(color_.a * 255));
+}
+
+void
+VertexArrayDrawable::set_texture(Texture texture_)
+{
+  texture = texture_;
+}
+
+void
+VertexArrayDrawable::set_blend_func(GLenum sfactor, GLenum dfactor)
+{
+  blend_sfactor = sfactor;
+  blend_dfactor = dfactor;
+}
+
+void
+VertexArrayDrawable::set_mode(GLenum mode_)
+{
+  mode = mode_;
+}
+
+/* EOF */

Copied: trunk/windstille/src/scenegraph/vertex_array_drawable.hpp (from rev 3102, trunk/windstille/src/scenegraph/vertex_array_drawing_request.hpp)
===================================================================
--- trunk/windstille/src/scenegraph/vertex_array_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/vertex_array_drawable.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -0,0 +1,71 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2005 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
+*/
+
+#ifndef HEADER_WINDSTILLE_DISPLAY_VERTEX_ARRAY_DRAWING_REQUEST_HPP
+#define HEADER_WINDSTILLE_DISPLAY_VERTEX_ARRAY_DRAWING_REQUEST_HPP
+
+#include &lt;vector&gt;
+
+#include &quot;display/color.hpp&quot;
+#include &quot;scenegraph/drawable.hpp&quot;
+
+/** */
+class VertexArrayDrawable : public Drawable
+{
+private:
+  GLenum mode;
+
+  GLenum blend_sfactor;
+  GLenum blend_dfactor;
+
+  Texture texture;
+  std::vector&lt;unsigned char&gt; colors;
+  std::vector&lt;float&gt; texcoords;
+  std::vector&lt;float&gt; vertices;
+
+public:
+  VertexArrayDrawable(const Vector2f&amp; pos_, float z_pos_, const Matrix&amp; modelview_);
+
+  void draw(const Texture&amp; tmp_texture);
+  void draw(int start, int end);
+
+  void vertex(float x, float y, float z = 0.0f);
+  void vertex(const Vector2f&amp; vec, float z = 0.0f);
+
+  void texcoord(float u, float v);
+  void color(const Color&amp; color);
+  void add_texcoords(const float* coords, size_t n);
+  /**
+   * Add eight texcoords for use with a quad from a given rect. The
+   * coords are clockwise around the rect, ie:
+   * left, top, right, top, right, bottom, left, bottom,
+   */
+  void add_texcoords(const Rectf&amp; coords);
+
+  int num_vertices() const;
+
+  void clear();
+
+  void set_mode(GLenum mode_);
+  void set_texture(Texture texture);
+  void set_blend_func(GLenum sfactor, GLenum dfactor);
+};
+
+#endif
+
+/* EOF */

Deleted: trunk/windstille/src/scenegraph/vertex_array_drawing_request.cpp
===================================================================
--- trunk/windstille/src/scenegraph/vertex_array_drawing_request.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/vertex_array_drawing_request.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -1,183 +0,0 @@
-/*
-**  Windstille - A Sci-Fi Action-Adventure Game
-**  Copyright (C) 2005 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
-**
-**  This program is free software: you can redistribute it and/or modify
-**  it under the terms of the GNU General Public License as published by
-**  the Free Software Foundation, either version 3 of the License, or
-**  (at your option) any later version.
-**  
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-**  
-**  You should have received a copy of the GNU General Public License
-**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
-*/
-
-#include &quot;display/opengl_state.hpp&quot;
-#include &quot;scenegraph/vertex_array_drawing_request.hpp&quot;
-
-VertexArrayDrawingRequest::VertexArrayDrawingRequest(const Vector2f&amp; pos_, float z_pos_, 
-                                                     const Matrix&amp; modelview_)
-  : DrawingRequest(pos_, z_pos_, modelview_),
-    mode(GL_QUADS),
-    blend_sfactor(GL_SRC_ALPHA),
-    blend_dfactor(GL_ONE_MINUS_SRC_ALPHA),
-    texture(),
-    colors(),
-    texcoords(),
-    vertices()
-{
-}
-
-int
-VertexArrayDrawingRequest::num_vertices() const
-{
-  return vertices.size()/3;
-}
-
-void
-VertexArrayDrawingRequest::clear()
-{
-  colors.clear();
-  texcoords.clear();
-  vertices.clear();
-}
-
-void
-VertexArrayDrawingRequest::draw(const Texture&amp; /*tmp_texture*/)
-{
-  draw(0, num_vertices());
-}
-
-void
-VertexArrayDrawingRequest::draw(int start, int end)
-{
-  assert(!vertices.empty());
-  assert(texcoords.empty() || int(texcoords.size()/2) == num_vertices());
-  assert(colors.empty() || int(colors.size()/4) == num_vertices());
-
-  OpenGLState state;
-
-  glClear(GL_DEPTH_BUFFER_BIT);
-  state.disable(GL_DEPTH_TEST);
-  state.enable(GL_BLEND);
-  state.set_blend_func(blend_sfactor, blend_dfactor);
-  
-  if (texture)
-    {
-      state.bind_texture(texture);
-    }
-
-  if (!colors.empty())
-    {
-      state.enable_client_state(GL_COLOR_ARRAY);
-      glColorPointer(4, GL_UNSIGNED_BYTE, 0, &amp;*colors.begin());
-    }
-  else
-    {
-      state.disable_client_state(GL_COLOR_ARRAY);
-      state.color(Color(1.0f, 1.0f, 1.0f));
-    }
-
-  if (!texcoords.empty())
-    {
-      state.enable_client_state(GL_TEXTURE_COORD_ARRAY);
-      glTexCoordPointer(2, GL_FLOAT, 0, &amp;*texcoords.begin());
-    }
-  else
-    {
-      state.disable_client_state(GL_TEXTURE_COORD_ARRAY);
-    }
-
-  // FIXME: Might be worth to not use VertexArrays when we have a pretty small number of vertices
-  state.disable_client_state(GL_NORMAL_ARRAY);
-  state.enable_client_state(GL_VERTEX_ARRAY);
-
-  glVertexPointer(3, GL_FLOAT, 0, &amp;*vertices.begin());
-
-  state.activate();
-
-  glPushMatrix();
-  glMultMatrixf(modelview.matrix);
-
-  glDrawArrays(mode, start, end);
-
-  glPopMatrix();
-}
-
-void
-VertexArrayDrawingRequest::vertex(const Vector2f&amp; vec, float z)
-{
-  vertex(vec.x, vec.y, z);
-}
-
-void
-VertexArrayDrawingRequest::vertex(float x, float y, float z)
-{
-  vertices.push_back(x + pos.x);
-  vertices.push_back(y + pos.y);
-  vertices.push_back(z);
-}
-
-void
-VertexArrayDrawingRequest::texcoord(float u, float v)
-{
-  texcoords.push_back(u);
-  texcoords.push_back(v);
-}
-
-void
-VertexArrayDrawingRequest::add_texcoords(const Rectf&amp; rect)
-{
-  texcoords.push_back(rect.left);
-  texcoords.push_back(rect.top);
-  texcoords.push_back(rect.right);
-  texcoords.push_back(rect.top);
-  texcoords.push_back(rect.right);
-  texcoords.push_back(rect.bottom);
-  texcoords.push_back(rect.left);
-  texcoords.push_back(rect.bottom);
-}
-
-void
-VertexArrayDrawingRequest::add_texcoords(const float* coords, size_t n)
-{
-  assert(n % 2 == 0);
-  for(size_t i = 0; i &lt; n; ++i)
-  {
-    texcoords.push_back(coords[i]);
-  }
-}
-
-void
-VertexArrayDrawingRequest::color(const Color&amp; color_)
-{
-  colors.push_back(static_cast&lt;unsigned char&gt;(color_.r * 255));
-  colors.push_back(static_cast&lt;unsigned char&gt;(color_.g * 255));
-  colors.push_back(static_cast&lt;unsigned char&gt;(color_.b * 255));
-  colors.push_back(static_cast&lt;unsigned char&gt;(color_.a * 255));
-}
-
-void
-VertexArrayDrawingRequest::set_texture(Texture texture_)
-{
-  texture = texture_;
-}
-
-void
-VertexArrayDrawingRequest::set_blend_func(GLenum sfactor, GLenum dfactor)
-{
-  blend_sfactor = sfactor;
-  blend_dfactor = dfactor;
-}
-
-void
-VertexArrayDrawingRequest::set_mode(GLenum mode_)
-{
-  mode = mode_;
-}
-
-/* EOF */

Deleted: trunk/windstille/src/scenegraph/vertex_array_drawing_request.hpp
===================================================================
--- trunk/windstille/src/scenegraph/vertex_array_drawing_request.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/scenegraph/vertex_array_drawing_request.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -1,71 +0,0 @@
-/*
-**  Windstille - A Sci-Fi Action-Adventure Game
-**  Copyright (C) 2005 Ingo Ruhnke &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/windstille-commit">grumbel at gmx.de</A>&gt;
-**
-**  This program is free software: you can redistribute it and/or modify
-**  it under the terms of the GNU General Public License as published by
-**  the Free Software Foundation, either version 3 of the License, or
-**  (at your option) any later version.
-**  
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-**  
-**  You should have received a copy of the GNU General Public License
-**  along with this program.  If not, see &lt;<A HREF="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</A>&gt;.
-*/
-
-#ifndef HEADER_WINDSTILLE_DISPLAY_VERTEX_ARRAY_DRAWING_REQUEST_HPP
-#define HEADER_WINDSTILLE_DISPLAY_VERTEX_ARRAY_DRAWING_REQUEST_HPP
-
-#include &lt;vector&gt;
-
-#include &quot;display/color.hpp&quot;
-#include &quot;scenegraph/drawing_request.hpp&quot;
-
-/** */
-class VertexArrayDrawingRequest : public DrawingRequest
-{
-private:
-  GLenum mode;
-
-  GLenum blend_sfactor;
-  GLenum blend_dfactor;
-
-  Texture texture;
-  std::vector&lt;unsigned char&gt; colors;
-  std::vector&lt;float&gt; texcoords;
-  std::vector&lt;float&gt; vertices;
-
-public:
-  VertexArrayDrawingRequest(const Vector2f&amp; pos_, float z_pos_, const Matrix&amp; modelview_);
-
-  void draw(const Texture&amp; tmp_texture);
-  void draw(int start, int end);
-
-  void vertex(float x, float y, float z = 0.0f);
-  void vertex(const Vector2f&amp; vec, float z = 0.0f);
-
-  void texcoord(float u, float v);
-  void color(const Color&amp; color);
-  void add_texcoords(const float* coords, size_t n);
-  /**
-   * Add eight texcoords for use with a quad from a given rect. The
-   * coords are clockwise around the rect, ie:
-   * left, top, right, top, right, bottom, left, bottom,
-   */
-  void add_texcoords(const Rectf&amp; coords);
-
-  int num_vertices() const;
-
-  void clear();
-
-  void set_mode(GLenum mode_);
-  void set_texture(Texture texture);
-  void set_blend_func(GLenum sfactor, GLenum dfactor);
-};
-
-#endif
-
-/* EOF */

Modified: trunk/windstille/src/sprite3d/sprite3d.cpp
===================================================================
--- trunk/windstille/src/sprite3d/sprite3d.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/sprite3d/sprite3d.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -23,7 +23,7 @@
 #include &quot;util/util.hpp&quot;
 #include &quot;display/opengl_state.hpp&quot;
 #include &quot;sprite3d/manager.hpp&quot;
-#include &quot;scenegraph/sprite3d_drawing_request.hpp&quot;
+#include &quot;scenegraph/sprite3d_drawable.hpp&quot;
 
 using namespace sprite3d;
 
@@ -329,13 +329,13 @@
 void
 Sprite3D::draw(DrawingContext&amp; dc, const Vector2f&amp; pos, float z_pos) const
 {
-  dc.draw(new Sprite3DDrawingRequest(this, pos, z_pos, dc.get_modelview()));
+  dc.draw(new Sprite3DDrawable(this, pos, z_pos, dc.get_modelview()));
 }
 
 void
 Sprite3D::draw(DrawingContext&amp; dc, const Matrix&amp; , float ) const
 {
-  dc.draw(new Sprite3DDrawingRequest(this, Vector2f(0, 0), 0.0f, dc.get_modelview()));
+  dc.draw(new Sprite3DDrawable(this, Vector2f(0, 0), 0.0f, dc.get_modelview()));
 }
 
 static inline float interpolate(float v1, float v2, float t)

Modified: trunk/windstille/src/sprite3d/sprite3d.hpp
===================================================================
--- trunk/windstille/src/sprite3d/sprite3d.hpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/sprite3d/sprite3d.hpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -125,7 +125,7 @@
   void set_blend_func(GLenum sfactor, GLenum dfactor);
   
 private:  
-  friend class Sprite3DDrawingRequest;
+  friend class Sprite3DDrawable;
   void draw(const Vector2f&amp; pos, const Matrix&amp; modelview) const;
   
   struct Frame {

Modified: trunk/windstille/src/tile/tile_map.cpp
===================================================================
--- trunk/windstille/src/tile/tile_map.cpp	2009-08-28 15:42:24 UTC (rev 3102)
+++ trunk/windstille/src/tile/tile_map.cpp	2009-08-28 15:51:08 UTC (rev 3103)
@@ -26,7 +26,7 @@
 #include &quot;tile/tile.hpp&quot;
 #include &quot;tile/tile_factory.hpp&quot;
 #include &quot;screen/view.hpp&quot;
-#include &quot;scenegraph/vertex_array_drawing_request.hpp&quot;
+#include &quot;scenegraph/vertex_array_drawable.hpp&quot;
 
 TileMap::TileMap(FileReader&amp; props)
   : field(),
@@ -92,7 +92,7 @@
             std::min(field.get_width(),  clip_rect.right/TILE_SIZE + 1),
             std::min(field.get_height(), clip_rect.bottom/TILE_SIZE + 1));
   
-  std::vector&lt;VertexArrayDrawingRequest*&gt; requests;
+  std::vector&lt;VertexArrayDrawable*&gt; requests;
   for (int y = rect.top;   y &lt; rect.bottom; ++y)
     for (int x = rect.left; x &lt; rect.right; ++x)
       {
@@ -105,10 +105,10 @@
             if(packer &gt;= int(requests.size()))
               requests.resize(packer+1);
 
-            VertexArrayDrawingRequest*&amp; request = requests[packer];
+            VertexArrayDrawable*&amp; request = requests[packer];
             if (!request)
               {
-                request = new VertexArrayDrawingRequest(Vector2f(0, 0), z_pos,
+                request = new VertexArrayDrawable(Vector2f(0, 0), z_pos,
                                                         sc.color().get_modelview());
                 request-&gt;set_mode(GL_QUADS);
                 request-&gt;set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
@@ -129,7 +129,7 @@
           }
       }
 
-  for(std::vector&lt;VertexArrayDrawingRequest*&gt;::iterator i = requests.begin(); i != requests.end(); ++i)
+  for(std::vector&lt;VertexArrayDrawable*&gt;::iterator i = requests.begin(); i != requests.end(); ++i)
     {
       if (*i)
         sc.color().draw(*i);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002099.html">[Windstille-commit] r3102 - in trunk/windstille/src: display	objects particles scenegraph sprite3d tile
</A></li>
	<LI>Next message: <A HREF="002101.html">[Windstille-commit] r3104 - in trunk/windstille/src: editor	scenegraph
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2100">[ date ]</a>
              <a href="thread.html#2100">[ thread ]</a>
              <a href="subject.html#2100">[ subject ]</a>
              <a href="author.html#2100">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/windstille-commit">More information about the Windstille-commit
mailing list</a><br>
</body></html>
