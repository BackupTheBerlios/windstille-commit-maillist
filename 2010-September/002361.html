<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Windstille-commit] r3364 - in trunk/windstille/src: display gui	objects particles scenegraph sprite2d
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/windstille-commit/2010-September/index.html" >
   <LINK REL="made" HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r3364%20-%20in%20trunk/windstille/src%3A%20display%20gui%0A%09objects%20particles%20scenegraph%20sprite2d&In-Reply-To=%3C20100922101627.25BBD480F56%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002360.html">
   <LINK REL="Next"  HREF="002362.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Windstille-commit] r3364 - in trunk/windstille/src: display gui	objects particles scenegraph sprite2d</H1>
    <B>grumbel at mail.berlios.de</B> 
    <A HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r3364%20-%20in%20trunk/windstille/src%3A%20display%20gui%0A%09objects%20particles%20scenegraph%20sprite2d&In-Reply-To=%3C20100922101627.25BBD480F56%40sheep.berlios.de%3E"
       TITLE="[Windstille-commit] r3364 - in trunk/windstille/src: display gui	objects particles scenegraph sprite2d">grumbel at mail.berlios.de
       </A><BR>
    <I>Wed Sep 22 12:16:27 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002360.html">[Windstille-commit] r3363 - in trunk/windstille/src: armature	display font gui objects particles scenegraph screen sprite3d tile
</A></li>
        <LI>Next message: <A HREF="002362.html">[Windstille-commit] r3365 - in trunk/windstille/src: display font	gui tile
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2361">[ date ]</a>
              <a href="thread.html#2361">[ thread ]</a>
              <a href="subject.html#2361">[ subject ]</a>
              <a href="author.html#2361">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: grumbel
Date: 2010-09-22 12:16:26 +0200 (Wed, 22 Sep 2010)
New Revision: 3364

Modified:
   trunk/windstille/src/display/basic_compositor_impl.cpp
   trunk/windstille/src/display/basic_compositor_impl.hpp
   trunk/windstille/src/display/drawing_context.cpp
   trunk/windstille/src/display/drawing_context.hpp
   trunk/windstille/src/display/surface.cpp
   trunk/windstille/src/display/surface.hpp
   trunk/windstille/src/display/surface_manager.cpp
   trunk/windstille/src/display/surface_manager.hpp
   trunk/windstille/src/display/texture_packer.cpp
   trunk/windstille/src/display/texture_packer.hpp
   trunk/windstille/src/gui/automap.cpp
   trunk/windstille/src/gui/automap.hpp
   trunk/windstille/src/objects/decal.cpp
   trunk/windstille/src/particles/deform_drawer.cpp
   trunk/windstille/src/particles/deform_drawer.hpp
   trunk/windstille/src/particles/surface_drawer.cpp
   trunk/windstille/src/particles/surface_drawer.hpp
   trunk/windstille/src/scenegraph/control_drawable.hpp
   trunk/windstille/src/scenegraph/surface_drawable.hpp
   trunk/windstille/src/scenegraph/surface_quad_drawable.hpp
   trunk/windstille/src/sprite2d/data.cpp
   trunk/windstille/src/sprite2d/data.hpp
   trunk/windstille/src/sprite2d/sprite.cpp
   trunk/windstille/src/sprite2d/sprite.hpp
Log:
Replaced Surface with SurfacePtr


Modified: trunk/windstille/src/display/basic_compositor_impl.cpp
===================================================================
--- trunk/windstille/src/display/basic_compositor_impl.cpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/display/basic_compositor_impl.cpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -30,8 +30,8 @@
 
 BasicCompositorImpl::BasicCompositorImpl(const Size&amp; window, const Size&amp; viewport) :
   CompositorImpl(window, viewport),
-  m_lightmap(m_window.width  / LIGHTMAP_DIV,
-             m_window.height / LIGHTMAP_DIV)
+  m_lightmap(Surface::create(m_window.width  / LIGHTMAP_DIV,
+                             m_window.height / LIGHTMAP_DIV))
 {
 }
 
@@ -39,10 +39,10 @@
 BasicCompositorImpl::render(SceneContext&amp; sc, SceneGraph* sg, const GraphicContextState&amp; gc_state)
 {
   // Resize Lightmap, only needed in the editor, FIXME: move this into a 'set_size()' call
-  if (m_lightmap.get_width()  != m_window.width /LIGHTMAP_DIV ||
-      m_lightmap.get_height() != m_window.height/LIGHTMAP_DIV)
+  if (m_lightmap-&gt;get_width()  != m_window.width /LIGHTMAP_DIV ||
+      m_lightmap-&gt;get_height() != m_window.height/LIGHTMAP_DIV)
   {
-    m_lightmap = Surface(m_window.width / LIGHTMAP_DIV, m_window.height / LIGHTMAP_DIV);
+    m_lightmap = Surface::create(m_window.width / LIGHTMAP_DIV, m_window.height / LIGHTMAP_DIV);
   }
 
   if (sc.get_render_mask() &amp; SceneContext::LIGHTMAPSCREEN)
@@ -68,16 +68,16 @@
     { // Copy lightmap to a texture
       OpenGLState state;
         
-      state.bind_texture(m_lightmap.get_texture());
+      state.bind_texture(m_lightmap-&gt;get_texture());
       state.activate();
 
       glCopyTexSubImage2D(GL_TEXTURE_2D, 
                           0,    // mipmap level
                           0, 0, // xoffset, yoffset
                           0, // x
-                          m_window.height - static_cast&lt;GLsizei&gt;(m_lightmap.get_height()), // y (OpenGL is upside down)
-                          static_cast&lt;GLsizei&gt;(m_lightmap.get_width()), 
-                          static_cast&lt;GLsizei&gt;(m_lightmap.get_height()));
+                          m_window.height - static_cast&lt;GLsizei&gt;(m_lightmap-&gt;get_height()), // y (OpenGL is upside down)
+                          static_cast&lt;GLsizei&gt;(m_lightmap-&gt;get_width()), 
+                          static_cast&lt;GLsizei&gt;(m_lightmap-&gt;get_height()));
     }
   }
 
@@ -102,7 +102,7 @@
   { // Renders the lightmap to the screen     
     OpenGLState state;
 
-    state.bind_texture(m_lightmap.get_texture());
+    state.bind_texture(m_lightmap-&gt;get_texture());
 
     state.enable(GL_BLEND);
     state.set_blend_func(GL_DST_COLOR, GL_ZERO);

Modified: trunk/windstille/src/display/basic_compositor_impl.hpp
===================================================================
--- trunk/windstille/src/display/basic_compositor_impl.hpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/display/basic_compositor_impl.hpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -25,7 +25,7 @@
 class BasicCompositorImpl : public CompositorImpl
 {
 private:
-  Surface m_lightmap;
+  SurfacePtr m_lightmap;
 
 public:
   BasicCompositorImpl(const Size&amp; window, const Size&amp; viewport);

Modified: trunk/windstille/src/display/drawing_context.cpp
===================================================================
--- trunk/windstille/src/display/drawing_context.cpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/display/drawing_context.cpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -99,7 +99,7 @@
 }
 
 void
-DrawingContext::draw(const Surface surface, const Vector2f&amp; pos, const Quad&amp; quad,
+DrawingContext::draw(SurfacePtr surface, const Vector2f&amp; pos, const Quad&amp; quad,
                      const DrawingParameters&amp; params, float z_pos)
 {
   draw(new SurfaceQuadDrawable(surface, pos, quad, params, z_pos,
@@ -107,20 +107,20 @@
 }
 
 void
-DrawingContext::draw(const Surface surface, const SurfaceDrawingParameters&amp; params, float z_pos)
+DrawingContext::draw(SurfacePtr surface, const SurfaceDrawingParameters&amp; params, float z_pos)
 {
   draw(new SurfaceDrawable(surface, params, z_pos,
                            modelview_stack.back()));
 }
 
 void
-DrawingContext::draw(const Surface surface, const Vector2f&amp; pos, float z, float alpha)
+DrawingContext::draw(SurfacePtr surface, const Vector2f&amp; pos, float z, float alpha)
 {
   draw(surface, pos.x, pos.y, z, alpha);
 }
 
 void
-DrawingContext::draw(Surface surface, float x, float y, float z, float )
+DrawingContext::draw(SurfacePtr surface, float x, float y, float z, float )
 {
   draw(new SurfaceDrawable(surface,
                            SurfaceDrawingParameters().set_pos(Vector2f(x, y)),
@@ -134,7 +134,7 @@
 }
 
 void
-DrawingContext::draw_control(const Surface surface, const Vector2f&amp; pos, float angle, float z_pos)
+DrawingContext::draw_control(SurfacePtr surface, const Vector2f&amp; pos, float angle, float z_pos)
 {
   draw(new ControlDrawable(surface, pos, angle, z_pos, modelview_stack.back()));
 }

Modified: trunk/windstille/src/display/drawing_context.hpp
===================================================================
--- trunk/windstille/src/display/drawing_context.hpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/display/drawing_context.hpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -23,6 +23,7 @@
 
 #include &quot;scenegraph/drawable.hpp&quot;
 #include &quot;display/texture.hpp&quot;
+#include &quot;display/surface.hpp&quot;
 
 class Surface;
 class SurfaceDrawingParameters;
@@ -78,12 +79,12 @@
   void draw(Drawable* request);
   void draw(const Sprite&amp;   sprite,  const Vector2f&amp; pos, float z = 0);
   void draw(const std::string&amp; text,    float x, float y, float z = 0);
-  void draw(const Surface surface, const Vector2f&amp; pos, float z = 0, float alpha = 0);
-  void draw(const Surface surface, float x, float y, float z = 0, float alpha = 0);
-  void draw(const Surface surface, const SurfaceDrawingParameters&amp; params, float z_pos = 0);
-  void draw(const Surface surface, const Vector2f&amp; pos, const Quad&amp; quad,
+  void draw(SurfacePtr surface, const Vector2f&amp; pos, float z = 0, float alpha = 0);
+  void draw(SurfacePtr surface, float x, float y, float z = 0, float alpha = 0);
+  void draw(SurfacePtr surface, const SurfaceDrawingParameters&amp; params, float z_pos = 0);
+  void draw(SurfacePtr surface, const Vector2f&amp; pos, const Quad&amp; quad,
             const DrawingParameters&amp; params, float z_pos = 0);
-  void draw_control(const Surface surface, const Vector2f&amp; pos, float angle, float z_pos = 0);
+  void draw_control(SurfacePtr surface, const Vector2f&amp; pos, float angle, float z_pos = 0);
   /*} */
   
   /** Translate the drawing context */

Modified: trunk/windstille/src/display/surface.cpp
===================================================================
--- trunk/windstille/src/display/surface.cpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/display/surface.cpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -23,60 +23,45 @@
 #include &quot;display/surface_drawing_parameters.hpp&quot;
 #include &quot;display/surface_manager.hpp&quot;
 
-class SurfaceImpl
+SurfacePtr
+Surface::create(const Pathname&amp; filename)
 {
-public:
-  /**
-   * Texture on which the surface is located
-   */
-  TexturePtr texture;
+  return SurfaceManager::current()-&gt;get(filename);
+}
 
-  /** 
-   * uv coordinates of the Surface in [0,1] range
-   */
-  Rectf   uv;
-
-  /**
-   * The size of the Surface in pixels
-   */
-  Sizef size;
-
-  SurfaceImpl() :
-    texture(),
-    uv(),
-    size()
-  {}
-};
-
-Surface::Surface() :
-  impl()
+SurfacePtr
+Surface::create(TexturePtr texture, const Rectf&amp; uv, const Sizef&amp; size)
 {
+  return SurfacePtr(new Surface(texture, uv, size));
 }
 
-Surface::Surface(const Pathname&amp; filename) :
-  impl()
+SurfacePtr
+Surface::create(int width, int height)
 {
-  // FIXME: a bit ugly, should move some of the surface_manager code over here
-  *this = SurfaceManager::current()-&gt;get(filename);
+  return SurfacePtr(new Surface(width, height));
 }
-
+
 Surface::Surface(int width, int height) :
-  impl(new SurfaceImpl())
+  m_texture(),
+  m_uv(),
+  m_size()
 {
-  impl-&gt;size  = Size(width, height);
+  m_size  = Size(width, height);
 
-  impl-&gt;texture = Texture::create(GL_TEXTURE_2D, width, height);
-  impl-&gt;uv      = Rectf(0.0f, 0.0f,
-                        impl-&gt;size.width  / static_cast&lt;float&gt;(impl-&gt;texture-&gt;get_width()),
-                        impl-&gt;size.height / static_cast&lt;float&gt;(impl-&gt;texture-&gt;get_height()));
+  m_texture = Texture::create(GL_TEXTURE_2D, width, height);
+  m_uv      = Rectf(0.0f, 0.0f,
+                    m_size.width  / static_cast&lt;float&gt;(m_texture-&gt;get_width()),
+                    m_size.height / static_cast&lt;float&gt;(m_texture-&gt;get_height()));
 }
 
 Surface::Surface(TexturePtr texture, const Rectf&amp; uv, const Sizef&amp; size) :
-  impl(new SurfaceImpl())
+  m_texture(),
+  m_uv(),
+  m_size()
 {
-  impl-&gt;texture = texture;
-  impl-&gt;uv      = uv;
-  impl-&gt;size    = size;
+  m_texture = texture;
+  m_uv      = uv;
+  m_size    = size;
 }
 
 Surface::~Surface()
@@ -86,54 +71,49 @@
 float
 Surface::get_width()  const
 {
-  return impl-&gt;size.width;
+  return m_size.width;
 }
 
 float
 Surface::get_height() const
 { 
-  return impl-&gt;size.height; 
+  return m_size.height; 
 }
 
 TexturePtr
 Surface::get_texture() const
 {
-  return impl-&gt;texture;
+  return m_texture;
 }
 
 Rectf
 Surface::get_uv() const
 {
-  return impl-&gt;uv;
+  return m_uv;
 }
 
-Surface::operator bool() const
-{
-  return impl.get() != 0;
-}
-
 void
 Surface::draw(const Vector2f&amp; pos) const
 {
   OpenGLState state;
   state.enable(GL_BLEND);
   state.set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
-  state.bind_texture(impl-&gt;texture);
+  state.bind_texture(m_texture);
   state.activate();
 
   glBegin(GL_QUADS);
 
-  glTexCoord2f(impl-&gt;uv.left, impl-&gt;uv.top);
+  glTexCoord2f(m_uv.left, m_uv.top);
   glVertex2f(pos.x, pos.y);
 
-  glTexCoord2f(impl-&gt;uv.right, impl-&gt;uv.top);
-  glVertex2f(pos.x + impl-&gt;size.width, pos.y);
+  glTexCoord2f(m_uv.right, m_uv.top);
+  glVertex2f(pos.x + m_size.width, pos.y);
 
-  glTexCoord2f(impl-&gt;uv.right, impl-&gt;uv.bottom);
-  glVertex2f(pos.x + impl-&gt;size.width, pos.y + impl-&gt;size.height);
+  glTexCoord2f(m_uv.right, m_uv.bottom);
+  glVertex2f(pos.x + m_size.width, pos.y + m_size.height);
 
-  glTexCoord2f(impl-&gt;uv.left, impl-&gt;uv.bottom);
-  glVertex2f(pos.x, pos.y + impl-&gt;size.height);
+  glTexCoord2f(m_uv.left, m_uv.bottom);
+  glVertex2f(pos.x, pos.y + m_size.height);
 
   glEnd();
 }
@@ -144,13 +124,13 @@
   OpenGLState state;
   state.enable(GL_BLEND);
   state.set_blend_func(params.blendfunc_src, params.blendfunc_dst);
-  state.bind_texture(impl-&gt;texture);
+  state.bind_texture(m_texture);
   state.color(params.color);
   state.activate();
 
   glBegin(GL_QUADS);
 
-  Rectf uv = impl-&gt;uv;
+  Rectf uv = m_uv;
 
   if (params.hflip)
     std::swap(uv.left, uv.right);
@@ -160,8 +140,8 @@
 
   Quad quad(params.pos.x, 
             params.pos.y,
-            params.pos.x + impl-&gt;size.width  * params.scale.x, 
-            params.pos.y + impl-&gt;size.height * params.scale.y);
+            params.pos.x + m_size.width  * params.scale.x, 
+            params.pos.y + m_size.height * params.scale.y);
 
   quad.rotate(params.angle);
   

Modified: trunk/windstille/src/display/surface.hpp
===================================================================
--- trunk/windstille/src/display/surface.hpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/display/surface.hpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -23,7 +23,8 @@
 #include &quot;display/texture.hpp&quot;
 
 class SurfaceDrawingParameters;
-class SurfaceImpl;
+class Surface;
+typedef boost::shared_ptr&lt;Surface&gt; SurfacePtr;
 
 /**
  * Surface class. This class basically holds a reference to an opengl texture
@@ -34,8 +35,7 @@
 class Surface
 {
 public:
-  Surface();
-  explicit Surface(const Pathname&amp; filename);
+  static SurfacePtr create(const Pathname&amp; filename);
   
   /** 
    * Create a new Surface object from a Texture
@@ -44,10 +44,16 @@
    * @param width  Width of the surface on the screen
    * @param height Height of the surface on the screen
    */
+  static SurfacePtr create(TexturePtr texture, const Rectf&amp; uv, const Sizef&amp; size);
+  static SurfacePtr create(int width, int height);
+
+private:
   Surface(TexturePtr texture, const Rectf&amp; uv, const Sizef&amp; size);
   Surface(int width, int height);
+  
+public:
   ~Surface();
-  
+
   float get_width()  const;
   float get_height() const;
   
@@ -59,13 +65,21 @@
   void draw(const Vector2f&amp; pos) const;
   void draw(const SurfaceDrawingParameters&amp; params) const;
 
-  /** true if the Texture is valid and usable, false if not */
-  operator bool() const;
+private:
+  /**
+   * Texture on which the surface is located
+   */
+  TexturePtr m_texture;
 
-  long use_count() const { return impl.use_count(); }
+  /** 
+   * uv coordinates of the Surface in [0,1] range
+   */
+  Rectf m_uv;
 
-private:
-  boost::shared_ptr&lt;SurfaceImpl&gt; impl;
+  /**
+   * The size of the Surface in pixels
+   */
+  Sizef m_size;
 };
 
 #endif

Modified: trunk/windstille/src/display/surface_manager.cpp
===================================================================
--- trunk/windstille/src/display/surface_manager.cpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/display/surface_manager.cpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -45,7 +45,7 @@
 #endif
 }
 
-Surface
+SurfacePtr
 SurfaceManager::get(const Pathname&amp; filename)
 {
   Surfaces::iterator i = surfaces.find(filename);
@@ -60,7 +60,7 @@
 
     if (texture_packer)
     {
-      Surface result = texture_packer-&gt;upload(software_surface);
+      SurfacePtr result = texture_packer-&gt;upload(software_surface);
       surfaces.insert(std::make_pair(filename, result));
       return result;              
     }
@@ -81,9 +81,9 @@
         throw std::runtime_error(msg.str());
       }
         
-      Surface result(texture, Rectf(0.0f, 0.0f, maxu, maxv),
-                     Sizef(static_cast&lt;float&gt;(software_surface.get_width()),
-                           static_cast&lt;float&gt;(software_surface.get_height())));
+      SurfacePtr result = Surface::create(texture, Rectf(0.0f, 0.0f, maxu, maxv),
+                                          Sizef(static_cast&lt;float&gt;(software_surface.get_width()),
+                                                static_cast&lt;float&gt;(software_surface.get_height())));
       surfaces.insert(std::make_pair(filename, result));
       return result;
     }
@@ -92,7 +92,7 @@
 
 void
 SurfaceManager::load_grid(const Pathname&amp; filename,
-                          std::vector&lt;Surface&gt;&amp; out_surfaces,
+                          std::vector&lt;SurfacePtr&gt;&amp; out_surfaces,
                           int width, int height)
 {
   SoftwareSurface image(filename);
@@ -120,10 +120,10 @@
       float s_max_u = (maxu * (static_cast&lt;float&gt;(x + width)))  / static_cast&lt;float&gt;(image.get_width());
       float s_max_v = (maxv * (static_cast&lt;float&gt;(x + height))) / static_cast&lt;float&gt;(image.get_height());
 
-      out_surfaces.push_back(Surface(texture, 
-                                     Rectf(s_min_u, s_min_v, s_max_u, s_max_v), 
-                                     Sizef(static_cast&lt;float&gt;(width),
-                                           static_cast&lt;float&gt;(height))));
+      out_surfaces.push_back(Surface::create(texture, 
+                                             Rectf(s_min_u, s_min_v, s_max_u, s_max_v), 
+                                             Sizef(static_cast&lt;float&gt;(width),
+                                                   static_cast&lt;float&gt;(height))));
     }
   }
 }

Modified: trunk/windstille/src/display/surface_manager.hpp
===================================================================
--- trunk/windstille/src/display/surface_manager.hpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/display/surface_manager.hpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -27,8 +27,8 @@
 #include &quot;util/pathname.hpp&quot;
 #include &quot;util/currenton.hpp&quot;
 #include &quot;display/texture.hpp&quot;
+#include &quot;display/surface.hpp&quot;
 
-class Surface;
 class TexturePacker;
 
 /**
@@ -39,7 +39,7 @@
 private:
   boost::scoped_ptr&lt;TexturePacker&gt; texture_packer;
   
-  typedef std::map&lt;Pathname, Surface&gt; Surfaces;
+  typedef std::map&lt;Pathname, SurfacePtr&gt; Surfaces;
   Surfaces surfaces;
 
 public:
@@ -47,14 +47,14 @@
   ~SurfaceManager();
 
   /** returns a surface containing the image specified with filename */
-  Surface get(const Pathname&amp; filename);
+  SurfacePtr get(const Pathname&amp; filename);
 
   /**
    * Loads an image and splits it into several Surfaces sized width and height.
    * The created surfaces will be added to the surfaces vector.
    */
   void load_grid(const Pathname&amp; filename,
-                 std::vector&lt;Surface&gt;&amp; surfaces, int width, int height);
+                 std::vector&lt;SurfacePtr&gt;&amp; surfaces, int width, int height);
 
   TexturePtr create_texture(const SoftwareSurface&amp; image,
                             float* maxu, float* maxv);

Modified: trunk/windstille/src/display/texture_packer.cpp
===================================================================
--- trunk/windstille/src/display/texture_packer.cpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/display/texture_packer.cpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -148,7 +148,7 @@
   return textures.back()-&gt;allocate(size, rect, out_texture);
 }
 
-Surface
+SurfacePtr
 TexturePacker::upload(const SoftwareSurface&amp; surface)
 {
   // Add a 1px border around surfaces to avoid blending artifacts
@@ -168,36 +168,36 @@
 
     // top
     texture-&gt;put(surface, Rect(Point(0, 0), Size(surface.get_width(), 1)), 
-                rect.left+1, rect.top);
+                 rect.left+1, rect.top);
     // bottom
     texture-&gt;put(surface, Rect(Point(0, surface.get_height()-1), Size(surface.get_width(), 1)), 
-                rect.left+1, rect.bottom-1);
+                 rect.left+1, rect.bottom-1);
     // left
     texture-&gt;put(surface, Rect(Point(0, 0), Size(1, surface.get_height())), 
-                rect.left, rect.top+1);
+                 rect.left, rect.top+1);
     // right
     texture-&gt;put(surface, Rect(Point(surface.get_width()-1, 0), Size(1, surface.get_height())),
-                rect.right-1, rect.top+1);
+                 rect.right-1, rect.top+1);
 
     // duplicate corner pixels
     texture-&gt;put(surface, Rect(Point(0, 0), Size(1, 1)), 
-                rect.left, rect.top);     
+                 rect.left, rect.top);     
     texture-&gt;put(surface, Rect(Point(surface.get_width()-1, 0), Size(1, 1)), 
-                rect.right-1, rect.top);
+                 rect.right-1, rect.top);
     texture-&gt;put(surface, Rect(Point(surface.get_width()-1, surface.get_height()-1), Size(1, 1)), 
-                rect.right-1, rect.bottom-1);
+                 rect.right-1, rect.bottom-1);
     texture-&gt;put(surface, Rect(Point(0, surface.get_height()-1), Size(1, 1)),
-                rect.left, rect.bottom-1);
+                 rect.left, rect.bottom-1);
 
     // draw the main surface
     texture-&gt;put(surface, rect.left+1, rect.top+1);
 
-    return Surface(texture,
-                   Rectf(static_cast&lt;float&gt;(rect.left+1)   / static_cast&lt;float&gt;(texture-&gt;get_width()),
-                         static_cast&lt;float&gt;(rect.top+1)    / static_cast&lt;float&gt;(texture-&gt;get_height()),
-                         static_cast&lt;float&gt;(rect.right-1)  / static_cast&lt;float&gt;(texture-&gt;get_width()), 
-                         static_cast&lt;float&gt;(rect.bottom-1) / static_cast&lt;float&gt;(texture-&gt;get_height())),
-                   Sizef(static_cast&lt;float&gt;(surface.get_width()), static_cast&lt;float&gt;(surface.get_height())));
+    return Surface::create(texture,
+                           Rectf(static_cast&lt;float&gt;(rect.left+1)   / static_cast&lt;float&gt;(texture-&gt;get_width()),
+                                 static_cast&lt;float&gt;(rect.top+1)    / static_cast&lt;float&gt;(texture-&gt;get_height()),
+                                 static_cast&lt;float&gt;(rect.right-1)  / static_cast&lt;float&gt;(texture-&gt;get_width()), 
+                                 static_cast&lt;float&gt;(rect.bottom-1) / static_cast&lt;float&gt;(texture-&gt;get_height())),
+                           Sizef(static_cast&lt;float&gt;(surface.get_width()), static_cast&lt;float&gt;(surface.get_height())));
   }
 }
 

Modified: trunk/windstille/src/display/texture_packer.hpp
===================================================================
--- trunk/windstille/src/display/texture_packer.hpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/display/texture_packer.hpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -41,8 +41,8 @@
   TexturePacker(const Size&amp; texture_size);
   ~TexturePacker();
   
-  Surface upload(const SoftwareSurface&amp; surface);
-  bool    allocate(const Size&amp; size, Rect&amp; rect, TexturePtr&amp; out_texture);
+  SurfacePtr upload(const SoftwareSurface&amp; surface);
+  bool allocate(const Size&amp; size, Rect&amp; rect, TexturePtr&amp; out_texture);
   
   void save_all_as_png() const;
 

Modified: trunk/windstille/src/gui/automap.cpp
===================================================================
--- trunk/windstille/src/gui/automap.cpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/gui/automap.cpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -26,20 +26,20 @@
 
 namespace gui {
 
-Automap::Automap(Component* parent_)
-  : Component(parent_),
-    surface(),
-    pos(),
-    zoom()
+Automap::Automap(Component* parent_) :
+  Component(parent_),
+  surface(),
+  pos(),
+  zoom()
 {
   assert(0);
 }
 
-Automap::Automap(const Rectf&amp; rect_, Component* parent_)
-  : Component(rect_, parent_),
-    surface(),
-    pos(0.0f, 0.0f),
-    zoom(6.0f)
+Automap::Automap(const Rectf&amp; rect_, Component* parent_) :
+  Component(rect_, parent_),
+  surface(),
+  pos(0.0f, 0.0f),
+  zoom(6.0f)
 {
   TileMap* tilemap = Sector::current()-&gt;get_tilemap();
 
@@ -66,9 +66,9 @@
       }
     }
 
-  surface = Surface(tilemap-&gt;get_width(), tilemap-&gt;get_height());
-  surface.get_texture()-&gt;set_filter(GL_NEAREST);
-  surface.get_texture()-&gt;put(image, 0, 0);
+  surface = Surface::create(tilemap-&gt;get_width(), tilemap-&gt;get_height());
+  surface-&gt;get_texture()-&gt;set_filter(GL_NEAREST);
+  surface-&gt;get_texture()-&gt;put(image, 0, 0);
 }
 
 Automap::~Automap()
@@ -79,10 +79,10 @@
 Automap::draw()
 {
   Display::push_cliprect(Rect(get_screen_rect()));
-  surface.draw(SurfaceDrawingParameters()
-               .set_pos(Vector2f(rect.left, rect.top) + pos)
-               .set_color(Color(1.0f, 1.0f, 1.0f, is_active() ? 0.8f : 0.5f))
-               .set_scale(zoom));
+  surface-&gt;draw(SurfaceDrawingParameters()
+                .set_pos(Vector2f(rect.left, rect.top) + pos)
+                .set_color(Color(1.0f, 1.0f, 1.0f, is_active() ? 0.8f : 0.5f))
+                .set_scale(zoom));
   Display::pop_cliprect();
 }
 

Modified: trunk/windstille/src/gui/automap.hpp
===================================================================
--- trunk/windstille/src/gui/automap.hpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/gui/automap.hpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -28,7 +28,7 @@
 class Automap : public Component
 {
 private:
-  Surface surface;
+  SurfacePtr surface;
   Vector2f  pos;
   float   zoom;
 

Modified: trunk/windstille/src/objects/decal.cpp
===================================================================
--- trunk/windstille/src/objects/decal.cpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/objects/decal.cpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -45,7 +45,7 @@
   reader.get(&quot;vflip&quot;, vflip);
   reader.get(&quot;hflip&quot;, hflip);
 
-  Surface surface = Surface(Pathname(path));
+  SurfacePtr surface = Surface::create(Pathname(path));
 
   SurfaceDrawingParameters params;
 
@@ -57,8 +57,8 @@
     case 2: params.set_blend_func(GL_SRC_ALPHA, GL_ONE); break;
   }
 
-  Vector2f center_offset(-surface.get_width() /2,
-                         -surface.get_height()/2);
+  Vector2f center_offset(-surface-&gt;get_width() /2,
+                         -surface-&gt;get_height()/2);
 
   center_offset.x *= scale.x;
   center_offset.y *= scale.y;
@@ -113,8 +113,8 @@
   { // FIXME: Not going to work with double parenting
     pos += decal-&gt;pos;
 
-    Vector2f center_offset(-drawable-&gt;get_surface().get_width() /2,
-                           -drawable-&gt;get_surface().get_height()/2);
+    Vector2f center_offset(-drawable-&gt;get_surface()-&gt;get_width() /2,
+                           -drawable-&gt;get_surface()-&gt;get_height()/2);
 
     center_offset.x *= drawable-&gt;get_params().scale.x;
     center_offset.y *= drawable-&gt;get_params().scale.y;

Modified: trunk/windstille/src/particles/deform_drawer.cpp
===================================================================
--- trunk/windstille/src/particles/deform_drawer.cpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/particles/deform_drawer.cpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -29,16 +29,16 @@
 {
 public:
   FramebufferPtr    framebuffer;
-  Surface&amp;          surface;
+  SurfacePtr        surface;
   ParticleSystem&amp;   psys;
   ShaderProgram&amp;    shader_program;
 
   DeformDrawerRequest(const Vector2f&amp; pos_, float z_pos_,  const Matrix&amp; modelview_,
-                      FramebufferPtr framebuffer_, Surface&amp; surface_, ParticleSystem&amp; psys_,
-                      ShaderProgram&amp; shader_program_)
-    : Drawable(pos_, z_pos_, modelview_),
-      framebuffer(framebuffer_), surface(surface_), psys(psys_), 
-      shader_program(shader_program_)
+                      FramebufferPtr framebuffer_, SurfacePtr surface_, ParticleSystem&amp; psys_,
+                      ShaderProgram&amp; shader_program_) :
+    Drawable(pos_, z_pos_, modelview_),
+    framebuffer(framebuffer_), surface(surface_), psys(psys_), 
+    shader_program(shader_program_)
   {}
   
   virtual ~DeformDrawerRequest() {}
@@ -89,7 +89,7 @@
     
     OpenGLState state;
     
-    state.bind_texture(surface.get_texture());
+    state.bind_texture(surface-&gt;get_texture());
     state.set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
     state.enable(GL_BLEND);
     state.activate();    
@@ -109,8 +109,8 @@
         float scale  = psys.get_size_start() + 
           psys.get_progress(i-&gt;t) * (psys.get_size_stop() - psys.get_size_start());
           
-        float width  = surface.get_width()  * scale;
-        float height = surface.get_height() * scale;
+        float width  = surface-&gt;get_width()  * scale;
+        float height = surface-&gt;get_height() * scale;
               
         // rotate
         float x_rot = width/2;
@@ -166,7 +166,7 @@
 
 DeformDrawer::DeformDrawer(FileReader&amp; /*props*/) :
   framebuffer(Framebuffer::create_with_texture(GL_TEXTURE_2D, 800, 600)),
-  surface(Pathname(&quot;images/particles/deform2.png&quot;)),
+  surface(Surface::create(Pathname(&quot;images/particles/deform2.png&quot;))),
   shader_program()
 {
   shader_program.attach(ShaderObject(GL_FRAGMENT_SHADER, &quot;data/shader/particledeform.frag&quot;));

Modified: trunk/windstille/src/particles/deform_drawer.hpp
===================================================================
--- trunk/windstille/src/particles/deform_drawer.hpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/particles/deform_drawer.hpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -39,7 +39,7 @@
 {
 private:
   FramebufferPtr framebuffer;
-  Surface        surface;
+  SurfacePtr     surface;
   ShaderProgram  shader_program;
 
 public:

Modified: trunk/windstille/src/particles/surface_drawer.cpp
===================================================================
--- trunk/windstille/src/particles/surface_drawer.cpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/particles/surface_drawer.cpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -23,10 +23,10 @@
 #include &quot;display/drawing_context.hpp&quot;
 #include &quot;particles/surface_drawer.hpp&quot;
 
-SurfaceDrawer::SurfaceDrawer(Surface surface_)
-  : surface(surface_),
-    blendfunc_src(),
-    blendfunc_dest()
+SurfaceDrawer::SurfaceDrawer(SurfacePtr surface_) :
+  surface(surface_),
+  blendfunc_src(),
+  blendfunc_dest()
 {
 }
 
@@ -93,7 +93,7 @@
 }
   
 void
-SurfaceDrawer::set_texture(Surface surface_)
+SurfaceDrawer::set_texture(SurfacePtr surface_)
 {
   surface = surface_;
 }
@@ -112,7 +112,7 @@
   buffer-&gt;set_pos(Vector2f(psys.get_x_pos(), psys.get_y_pos()));
 
   buffer-&gt;set_mode(GL_QUADS);
-  buffer-&gt;set_texture(surface.get_texture());
+  buffer-&gt;set_texture(surface-&gt;get_texture());
   buffer-&gt;set_blend_func(blendfunc_src, blendfunc_dest);
 
   for(ParticleSystem::const_iterator i = psys.begin(); i != psys.end(); ++i)
@@ -129,8 +129,8 @@
       float scale  = psys.get_size_start() + 
         psys.get_progress(i-&gt;t) * (psys.get_size_stop() - psys.get_size_start());
           
-      float width  = surface.get_width()  * scale;
-      float height = surface.get_height() * scale;
+      float width  = surface-&gt;get_width()  * scale;
+      float height = surface-&gt;get_height() * scale;
               
       // rotate
       float x_rot = width/2;
@@ -144,7 +144,7 @@
         y_rot = (width/2) * s + (height/2) * c;
       }
 
-      buffer-&gt;add_texcoords(surface.get_uv());
+      buffer-&gt;add_texcoords(surface-&gt;get_uv());
 
       buffer-&gt;color(color);
       buffer-&gt;vertex(i-&gt;x - x_rot, i-&gt;y - y_rot);

Modified: trunk/windstille/src/particles/surface_drawer.hpp
===================================================================
--- trunk/windstille/src/particles/surface_drawer.hpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/particles/surface_drawer.hpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -27,17 +27,17 @@
 class SurfaceDrawer : public Drawer
 {
 private:
-  Surface surface;
+  SurfacePtr surface;
   GLenum blendfunc_src;
   GLenum blendfunc_dest;
   boost::shared_ptr&lt;VertexArrayDrawable&gt; buffer;
   
 public:
   SurfaceDrawer(FileReader&amp; props);
-  SurfaceDrawer(Surface surface);
+  SurfaceDrawer(SurfacePtr surface);
   virtual ~SurfaceDrawer();
   
-  void set_texture(Surface surface);
+  void set_texture(SurfacePtr surface);
   void set_blendfuncs(GLenum blendfunc_src, GLenum blendfunc_dst);
 
   void draw(const ParticleSystem&amp; psys) const;

Modified: trunk/windstille/src/scenegraph/control_drawable.hpp
===================================================================
--- trunk/windstille/src/scenegraph/control_drawable.hpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/scenegraph/control_drawable.hpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -22,11 +22,11 @@
 class ControlDrawable : public Drawable
 {
 private:
-  Surface surface;
+  SurfacePtr surface;
   float angle;
 
 public:
-  ControlDrawable(Surface surface_, const Vector2f&amp; pos_, float angle_, float z_pos_,
+  ControlDrawable(SurfacePtr surface_, const Vector2f&amp; pos_, float angle_, float z_pos_,
                   const Matrix&amp; modelview_)
     : Drawable(pos_, z_pos_, modelview_), 
       surface(surface_), 
@@ -46,10 +46,10 @@
 
     Vector3 p = modelview.multiply(Vector3(pos.x, pos.y, 0.0f));
 
-    surface.draw(SurfaceDrawingParameters()
+    surface-&gt;draw(SurfaceDrawingParameters()
                  .set_angle(angle)
-                 .set_pos(Vector2f(p.x - surface.get_width()/2,
-                                   p.y - surface.get_height()/2)));
+                 .set_pos(Vector2f(p.x - surface-&gt;get_width()/2,
+                                   p.y - surface-&gt;get_height()/2)));
 
     glPopMatrix();
   }

Modified: trunk/windstille/src/scenegraph/surface_drawable.hpp
===================================================================
--- trunk/windstille/src/scenegraph/surface_drawable.hpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/scenegraph/surface_drawable.hpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -25,11 +25,11 @@
 class SurfaceDrawable : public Drawable
 {
 private:
-  Surface surface;
+  SurfacePtr surface;
   SurfaceDrawingParameters params;
 
 public:
-  SurfaceDrawable(Surface surface_, const SurfaceDrawingParameters&amp; params_,
+  SurfaceDrawable(SurfacePtr surface_, const SurfaceDrawingParameters&amp; params_,
                   float z_pos_,
                   const Matrix&amp; modelview_)
     : Drawable(pos, z_pos_, modelview_), 
@@ -40,7 +40,7 @@
   virtual ~SurfaceDrawable()
   {}
   
-  Surface get_surface() const { return surface; }
+  SurfacePtr get_surface() const { return surface; }
   SurfaceDrawingParameters&amp; get_params() { return params; }
 
   void render(unsigned int mask)
@@ -48,7 +48,7 @@
     glPushMatrix();
     glMultMatrixf(modelview.matrix);
 
-    surface.draw(params);
+    surface-&gt;draw(params);
 
     glPopMatrix();
   }

Modified: trunk/windstille/src/scenegraph/surface_quad_drawable.hpp
===================================================================
--- trunk/windstille/src/scenegraph/surface_quad_drawable.hpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/scenegraph/surface_quad_drawable.hpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -27,12 +27,12 @@
 class SurfaceQuadDrawable : public Drawable
 {
 private:
-  Surface m_surface;
+  SurfacePtr m_surface;
   Quad m_quad;
   DrawingParameters m_params;
 
 public:
-  SurfaceQuadDrawable(Surface surface, const Vector2f&amp; pos_, const Quad&amp; quad, 
+  SurfaceQuadDrawable(SurfacePtr surface, const Vector2f&amp; pos_, const Quad&amp; quad, 
                       const DrawingParameters&amp; params, float z_pos_,
                       const Matrix&amp; modelview_)
     : Drawable(pos_, z_pos_, modelview_),
@@ -49,7 +49,7 @@
     OpenGLState state;
     state.enable(GL_BLEND);
     state.set_blend_func(m_params.blendfunc_src, m_params.blendfunc_dst);
-    state.bind_texture(m_surface.get_texture());
+    state.bind_texture(m_surface-&gt;get_texture());
     state.activate();
 
     glPushMatrix();
@@ -57,16 +57,16 @@
 
     glBegin(GL_QUADS);
     {
-      glTexCoord2f(m_surface.get_uv().left, m_surface.get_uv().top);
+      glTexCoord2f(m_surface-&gt;get_uv().left, m_surface-&gt;get_uv().top);
       glVertex2f(pos.x + m_quad.p1.x, pos.y + m_quad.p1.y);
     
-      glTexCoord2f(m_surface.get_uv().right, m_surface.get_uv().top);
+      glTexCoord2f(m_surface-&gt;get_uv().right, m_surface-&gt;get_uv().top);
       glVertex2f(pos.x + m_quad.p2.x, pos.y + m_quad.p2.y);
 
-      glTexCoord2f(m_surface.get_uv().right, m_surface.get_uv().bottom);
+      glTexCoord2f(m_surface-&gt;get_uv().right, m_surface-&gt;get_uv().bottom);
       glVertex2f(pos.x + m_quad.p3.x, pos.y + m_quad.p3.y);
 
-      glTexCoord2f(m_surface.get_uv().left, m_surface.get_uv().bottom);
+      glTexCoord2f(m_surface-&gt;get_uv().left, m_surface-&gt;get_uv().bottom);
       glVertex2f(pos.x + m_quad.p4.x, pos.y + m_quad.p4.y);
     }
     glEnd();

Modified: trunk/windstille/src/sprite2d/data.cpp
===================================================================
--- trunk/windstille/src/sprite2d/data.cpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/sprite2d/data.cpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -49,7 +49,7 @@
       action-&gt;speed  = 1.0;
       action-&gt;scale  = 1.0f;
       action-&gt;offset = Vector2f(0, 0);
-      action-&gt;surfaces.push_back(Surface(pathname));
+      action-&gt;surfaces.push_back(Surface::create(pathname));
       actions.push_back(action.release());
     }
     else
@@ -72,7 +72,7 @@
       action-&gt;speed  = 1.0;
       action-&gt;scale  = 1.0f;
       action-&gt;offset = Vector2f(0, 0);
-      action-&gt;surfaces.push_back(Surface(pngfile));
+      action-&gt;surfaces.push_back(Surface::create(pngfile));
       actions.push_back(action.release());
     }
     else

Modified: trunk/windstille/src/sprite2d/data.hpp
===================================================================
--- trunk/windstille/src/sprite2d/data.hpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/sprite2d/data.hpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -28,7 +28,7 @@
 
 struct SpriteAction
 {
-  typedef std::vector&lt;Surface&gt; Surfaces;
+  typedef std::vector&lt;SurfacePtr&gt; Surfaces;
 
   std::string name;
   float       speed;

Modified: trunk/windstille/src/sprite2d/sprite.cpp
===================================================================
--- trunk/windstille/src/sprite2d/sprite.cpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/sprite2d/sprite.cpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -225,7 +225,7 @@
   return color.a;
 }
 
-Surface
+SurfacePtr
 Sprite::get_current_surface() const
 {
   return current_action-&gt;surfaces[ static_cast&lt;int&gt; (frame) ];
@@ -240,8 +240,8 @@
 void
 Sprite::draw(const Vector2f&amp; pos) const
 {
-  Surface surface = current_action-&gt;surfaces[ static_cast&lt;int&gt; (frame) ];
-  surface.draw(SurfaceDrawingParameters()
+  SurfacePtr surface = current_action-&gt;surfaces[ static_cast&lt;int&gt; (frame) ];
+  surface-&gt;draw(SurfaceDrawingParameters()
                .set_pos(pos + (current_action-&gt;offset * scale))
                .set_blend_func(blend_sfactor, blend_dfactor)
                .set_scale(scale)
@@ -299,13 +299,13 @@
 float
 Sprite::get_width() const
 {
-  return current_action-&gt;surfaces[ static_cast&lt;int&gt;(frame) ].get_width();
+  return current_action-&gt;surfaces[ static_cast&lt;int&gt;(frame) ]-&gt;get_width();
 }
 
 float
 Sprite::get_height() const
 {
-  return current_action-&gt;surfaces[ static_cast&lt;int&gt;(frame) ].get_height();
+  return current_action-&gt;surfaces[ static_cast&lt;int&gt;(frame) ]-&gt;get_height();
 }
 
 /* EOF */

Modified: trunk/windstille/src/sprite2d/sprite.hpp
===================================================================
--- trunk/windstille/src/sprite2d/sprite.hpp	2010-09-21 21:54:02 UTC (rev 3363)
+++ trunk/windstille/src/sprite2d/sprite.hpp	2010-09-22 10:16:26 UTC (rev 3364)
@@ -92,7 +92,7 @@
   void  set_scale(float s);
   float get_scale() const;
 
-  Surface get_current_surface() const;
+  SurfacePtr get_current_surface() const;
 
   Vector2f get_offset() const;
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002360.html">[Windstille-commit] r3363 - in trunk/windstille/src: armature	display font gui objects particles scenegraph screen sprite3d tile
</A></li>
	<LI>Next message: <A HREF="002362.html">[Windstille-commit] r3365 - in trunk/windstille/src: display font	gui tile
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2361">[ date ]</a>
              <a href="thread.html#2361">[ thread ]</a>
              <a href="subject.html#2361">[ subject ]</a>
              <a href="author.html#2361">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/windstille-commit">More information about the Windstille-commit
mailing list</a><br>
</body></html>
