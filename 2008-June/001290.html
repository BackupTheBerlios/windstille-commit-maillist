<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Windstille-commit] r2271 - in trunk/windstille/src: . scripting
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/windstille-commit/2008-June/index.html" >
   <LINK REL="made" HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r2271%20-%20in%20trunk/windstille/src%3A%20.%20scripting&In-Reply-To=%3C200806271151.m5RBpQmJ022183%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001292.html">
   <LINK REL="Next"  HREF="001291.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Windstille-commit] r2271 - in trunk/windstille/src: . scripting</H1>
    <B>jamesgregory at mail.berlios.de</B> 
    <A HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r2271%20-%20in%20trunk/windstille/src%3A%20.%20scripting&In-Reply-To=%3C200806271151.m5RBpQmJ022183%40sheep.berlios.de%3E"
       TITLE="[Windstille-commit] r2271 - in trunk/windstille/src: . scripting">jamesgregory at mail.berlios.de
       </A><BR>
    <I>Fri Jun 27 13:51:26 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001292.html">[Windstille-commit] r2270 - in trunk/windstille/lib: . SQUIRREL2	SQUIRREL2/doc SQUIRREL2/etc SQUIRREL2/include	SQUIRREL2/samples SQUIRREL2/sq SQUIRREL2/sqstdlib SQUIRREL2/squirrel
</A></li>
        <LI>Next message: <A HREF="001291.html">[Windstille-commit] r2272 - trunk/windstille/contrib/vs2003build
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1290">[ date ]</a>
              <a href="thread.html#1290">[ thread ]</a>
              <a href="subject.html#1290">[ subject ]</a>
              <a href="author.html#1290">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: jamesgregory
Date: 2008-06-27 13:51:22 +0200 (Fri, 27 Jun 2008)
New Revision: 2271

Modified:
   trunk/windstille/src/script_manager.cpp
   trunk/windstille/src/scripting/util.cpp
   trunk/windstille/src/scripting/wrapper.cpp
   trunk/windstille/src/sector.cpp
   trunk/windstille/src/util.cpp
   trunk/windstille/src/util.hpp
Log:
revert changesets 2267, 2268, and a bit of 2265


Modified: trunk/windstille/src/script_manager.cpp
===================================================================
--- trunk/windstille/src/script_manager.cpp	2008-06-27 10:49:53 UTC (rev 2270)
+++ trunk/windstille/src/script_manager.cpp	2008-06-27 11:51:22 UTC (rev 2271)
@@ -17,28 +17,20 @@
 #include &quot;scripting/util.hpp&quot;
 #include &quot;scripting/squirrel_error.hpp&quot;
 #include &quot;physfs/physfs_stream.hpp&quot;
-#include &quot;util.hpp&quot;
 
 using namespace Scripting;
 
 ScriptManager* script_manager = 0;
 
-
-
-static void printfunc(HSQUIRRELVM, const SQChar *str, ...)
+static void printfunc(HSQUIRRELVM, const char* str, ...)
 {
-  std::wostringstream ss;
-	wchar_t buf[4096];
-
-	va_list arglist;
-	va_start(arglist, str);
-	vswprintf(buf, str, arglist);
-	ss &lt;&lt; (const wchar_t*) buf &lt;&lt; std::flush;
-	va_end(arglist);
-
-  std::string to_print = wstring_to_string(ss.str());
-  console &lt;&lt; ss.str().c_str();
-  std::cout &lt;&lt; to_print.c_str();
+  char buf[4096];
+  va_list arglist; 
+  va_start(arglist, str); 
+  vsprintf(buf, str, arglist);
+  console &lt;&lt; (char*)buf;
+  puts(buf);
+  va_end(arglist); 
 }
 
 ScriptManager::ScriptManager()
@@ -116,7 +108,7 @@
   sq_addref(v, &amp;vm_obj);
   sq_pop(v, 1);
   
-  if(sq_compile(vm, squirrel_read_char, &amp;in, string_to_wstring(sourcename).c_str(), true) &lt; 0)
+  if(sq_compile(vm, squirrel_read_char, &amp;in, sourcename.c_str(), true) &lt; 0)
     throw SquirrelError(vm, &quot;Couldn't parse script&quot;);
 	
   squirrel_vms.push_back(SquirrelVM(sourcename, vm, vm_obj));

Modified: trunk/windstille/src/scripting/util.cpp
===================================================================
--- trunk/windstille/src/scripting/util.cpp	2008-06-27 10:49:53 UTC (rev 2270)
+++ trunk/windstille/src/scripting/util.cpp	2008-06-27 11:51:22 UTC (rev 2271)
@@ -32,8 +32,8 @@
 #include &quot;lisp/parser.hpp&quot;
 #include &quot;lisp/properties.hpp&quot;
 #include &quot;lisp/writer.hpp&quot;
+
 #include &quot;util.hpp&quot;
-#include &quot;../util.hpp&quot;
 
 namespace Scripting {
 
@@ -63,9 +63,9 @@
       break;
     }
     case OT_STRING: {
-      const wchar_t* str;
+      const char* str;
       sq_getstring(v, -1, &amp;str);      
-      entries.push_back(new lisp::Lisp(lisp::Lisp::TYPE_STRING, wstring_to_string(str)));
+      entries.push_back(new lisp::Lisp(lisp::Lisp::TYPE_STRING, str));
       break;
     }                                                    
     case OT_BOOL: {
@@ -101,9 +101,9 @@
         continue;
       }
 
-      const wchar_t* key;
+      const char* key;
       sq_getstring(v, -2, &amp;key);
-      std::string lisp_key = sq_to_lisp_string(wstring_to_string(key));
+      std::string lisp_key = sq_to_lisp_string(key);
 
       std::vector&lt;lisp::Lisp*&gt; childs;
       childs.push_back(new lisp::Lisp(lisp::Lisp::TYPE_SYMBOL, lisp_key));
@@ -150,7 +150,7 @@
       break;
     }
     case OT_STRING: {
-      const wchar_t* val;
+      const char* val;
       sq_getstring(v, i, &amp;val);
       os &lt;&lt; &quot;\&quot;&quot; &lt;&lt; val &lt;&lt; &quot;\&quot;&quot;;
       break;    
@@ -252,7 +252,7 @@
                 break;
             }
             case OT_STRING: {
-                const wchar_t* val;
+                const char* val;
                 sq_getstring(v, i, &amp;val);
                 printf(&quot;string (%s)&quot;, val);
                 break;    
@@ -303,7 +303,7 @@
   Properties props(lisp);
   PropertyIterator&lt;const lisp::Lisp*&gt; iter = props.get_iter();
   while(iter.next()) {
-    sq_pushstring(v, string_to_wstring(iter.item()).c_str(), iter.item().size());
+    sq_pushstring(v, iter.item().c_str(), iter.item().size());
     switch((*iter)-&gt;get_type()) {
       case lisp::Lisp::TYPE_LIST:
         sq_newtable(v);
@@ -316,7 +316,7 @@
         sq_pushfloat(v, (*iter)-&gt;get_float());
         break;
       case lisp::Lisp::TYPE_STRING:
-        sq_pushstring(v, string_to_wstring((*iter)-&gt;get_string()).c_str(), -1);
+        sq_pushstring(v, (*iter)-&gt;get_string(), -1);
         break;
       case lisp::Lisp::TYPE_BOOL:
         sq_pushbool(v, (*iter)-&gt;get_bool());
@@ -363,9 +363,8 @@
       std::cerr &lt;&lt; &quot;Table contains non-string key\n&quot;;
       continue;
     }
-    const wchar_t* wkey;
-    sq_getstring(v, -2, &amp;wkey);
-    std::string key = wstring_to_string(wkey);
+    const char* key;
+    sq_getstring(v, -2, &amp;key);
 
     switch(sq_gettype(v, -1)) {
       case OT_INTEGER: {
@@ -387,9 +386,9 @@
         break;
       }
       case OT_STRING: {
-        const wchar_t* str;
+        const char* str;
         sq_getstring(v, -1, &amp;str);
-        writer.write_string(key, wstring_to_string(str));
+        writer.write_string(key, str);
         break;
       }
       case OT_TABLE: {

Modified: trunk/windstille/src/scripting/wrapper.cpp
===================================================================
--- trunk/windstille/src/scripting/wrapper.cpp	2008-06-27 10:49:53 UTC (rev 2270)
+++ trunk/windstille/src/scripting/wrapper.cpp	2008-06-27 11:51:22 UTC (rev 2271)
@@ -13,8 +13,6 @@
 #include &quot;squirrel_error.hpp&quot;
 #include &quot;wrapper.interface.hpp&quot;
 
-#include &quot;../util.hpp&quot;
-
 namespace Scripting
 {
 namespace Wrapper
@@ -39,11 +37,11 @@
   try {
     const std::string&amp; return_value = _this-&gt;get_name();
   
-    sq_pushstring(vm, string_to_wstring(return_value).c_str(), return_value.size());
+    sq_pushstring(vm, return_value.c_str(), return_value.size());
     return 1;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'get_name'&quot;));
@@ -67,7 +65,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'remove'&quot;));
@@ -96,7 +94,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'set_active'&quot;));
@@ -120,12 +118,12 @@
   }
   
   try {
-    _this-&gt;set_parent(wstring_to_string(arg0));
+    _this-&gt;set_parent(arg0);
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'set_parent'&quot;));
@@ -156,12 +154,12 @@
   }
   
   try {
-    _this-&gt;set_sprite(wstring_to_string(arg0));
+    _this-&gt;set_sprite(arg0);
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'set_sprite'&quot;));
@@ -185,12 +183,12 @@
   }
   
   try {
-    _this-&gt;set_action(wstring_to_string(arg0));
+    _this-&gt;set_action(arg0);
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'set_action'&quot;));
@@ -224,7 +222,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'set_pos'&quot;));
@@ -253,7 +251,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'set_vflip'&quot;));
@@ -282,12 +280,12 @@
   }
   
   try {
-    _this-&gt;attach(wstring_to_string(arg0), wstring_to_string(arg1));
+    _this-&gt;attach(arg0, arg1);
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'attach'&quot;));
@@ -318,7 +316,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'start_listening'&quot;));
@@ -342,7 +340,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'stop_listening'&quot;));
@@ -393,7 +391,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'move_to'&quot;));
@@ -422,7 +420,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'start_flash'&quot;));
@@ -440,12 +438,12 @@
   }
   
   try {
-    Scripting::set_sector(wstring_to_string(arg0));
+    Scripting::set_sector(arg0);
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'set_sector'&quot;));
@@ -463,12 +461,12 @@
   }
   
   try {
-    Scripting::play_music(wstring_to_string(arg0));
+    Scripting::play_music(arg0);
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'play_music'&quot;));
@@ -491,7 +489,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'stop_music'&quot;));
@@ -509,12 +507,12 @@
   }
   
   try {
-    Scripting::play_sound(wstring_to_string(arg0));
+    Scripting::play_sound(arg0);
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'play_sound'&quot;));
@@ -537,12 +535,12 @@
   }
   
   try {
-    Scripting::caption_add(static_cast&lt;int&gt; (arg0), wstring_to_string(arg1));
+    Scripting::caption_add(static_cast&lt;int&gt; (arg0), arg1);
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'caption_add'&quot;));
@@ -561,7 +559,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'caption_clear'&quot;));
@@ -580,7 +578,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'caption_end'&quot;));
@@ -603,7 +601,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'camera_set_active'&quot;));
@@ -622,7 +620,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'camera_continue_path'&quot;));
@@ -641,7 +639,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'camera_begin_path'&quot;));
@@ -674,7 +672,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'camera_add_point'&quot;));
@@ -693,7 +691,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'camera_end_path'&quot;));
@@ -721,7 +719,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'camera_set_pos'&quot;));
@@ -744,7 +742,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'camera_set_zoom'&quot;));
@@ -767,7 +765,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'set_controller_help_active'&quot;));
@@ -800,12 +798,12 @@
   }
   
   try {
-    Scripting::dialog_show(static_cast&lt;int&gt; (arg0), wstring_to_string(arg1), wstring_to_string(arg2), wstring_to_string(arg3));
+    Scripting::dialog_show(static_cast&lt;int&gt; (arg0), arg1, arg2, arg3);
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'dialog_show'&quot;));
@@ -824,7 +822,7 @@
     return sq_suspendvm(vm);
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'wait_for_dialog'&quot;));
@@ -843,7 +841,7 @@
     return sq_suspendvm(vm);
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'wait_for_fade'&quot;));
@@ -862,7 +860,7 @@
     return sq_suspendvm(vm);
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'wait_for_camera'&quot;));
@@ -880,12 +878,12 @@
   }
   
   try {
-    Scripting::conversation_add(wstring_to_string(arg0));
+    Scripting::conversation_add(arg0);
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'conversation_add'&quot;));
@@ -908,12 +906,12 @@
   }
   
   try {
-    Scripting::conversation_add2(wstring_to_string(arg0), wstring_to_string(arg1));
+    Scripting::conversation_add2(arg0, arg1);
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'conversation_add2'&quot;));
@@ -932,7 +930,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'conversation_show'&quot;));
@@ -951,7 +949,7 @@
     return 1;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'conversation_get_selection'&quot;));
@@ -970,7 +968,7 @@
     return sq_suspendvm(vm);
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'wait_for_conversation'&quot;));
@@ -993,12 +991,12 @@
   }
   
   try {
-    Scripting::add_objective(wstring_to_string(arg0), wstring_to_string(arg1));
+    Scripting::add_objective(arg0, arg1);
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'add_objective'&quot;));
@@ -1016,12 +1014,12 @@
   }
   
   try {
-    Scripting::objective_complete(wstring_to_string(arg0));
+    Scripting::objective_complete(arg0);
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'objective_complete'&quot;));
@@ -1039,13 +1037,13 @@
   }
   
   try {
-    bool return_value = Scripting::is_objective_given(wstring_to_string(arg0));
+    bool return_value = Scripting::is_objective_given(arg0);
   
     sq_pushbool(vm, return_value);
     return 1;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'is_objective_given'&quot;));
@@ -1063,13 +1061,13 @@
   }
   
   try {
-    bool return_value = Scripting::is_objective_complete(wstring_to_string(arg0));
+    bool return_value = Scripting::is_objective_complete(arg0);
   
     sq_pushbool(vm, return_value);
     return 1;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'is_objective_complete'&quot;));
@@ -1089,7 +1087,7 @@
     return 1;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'run_before'&quot;));
@@ -1108,12 +1106,12 @@
   }
   
   try {
-    Scripting::save_state(arg0, wstring_to_string(arg1));
+    Scripting::save_state(arg0, arg1);
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'save_state'&quot;));
@@ -1132,12 +1130,12 @@
   }
   
   try {
-    Scripting::load_state(arg0, wstring_to_string(arg1));
+    Scripting::load_state(arg0, arg1);
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'load_state'&quot;));
@@ -1156,7 +1154,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'list_objects'&quot;));
@@ -1179,7 +1177,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'set_debug'&quot;));
@@ -1198,7 +1196,7 @@
     return 1;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'get_debug'&quot;));
@@ -1217,7 +1215,7 @@
     return 1;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'get_game_speed'&quot;));
@@ -1240,7 +1238,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'set_game_speed'&quot;));
@@ -1264,7 +1262,7 @@
     return sq_suspendvm(vm);
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'wait'&quot;));
@@ -1297,12 +1295,12 @@
   }
   
   try {
-    Scripting::set_console_font(wstring_to_string(arg0), static_cast&lt;int&gt; (arg1));
+    Scripting::set_console_font(arg0, static_cast&lt;int&gt; (arg1));
   
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'set_console_font'&quot;));
@@ -1325,7 +1323,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'set_gamma'&quot;));
@@ -1358,7 +1356,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'set_gamma_rgb'&quot;));
@@ -1377,7 +1375,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'show_config'&quot;));
@@ -1396,7 +1394,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'cutscene_begin'&quot;));
@@ -1415,7 +1413,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'cutscene_end'&quot;));
@@ -1453,7 +1451,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'internal_fadeout_rgb'&quot;));
@@ -1476,7 +1474,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'internal_fadein'&quot;));
@@ -1495,7 +1493,7 @@
     return 1;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'render_mask_get'&quot;));
@@ -1518,7 +1516,7 @@
     return 0;
   
   } catch(std::exception&amp; e) {
-    sq_throwerror(vm, string_to_wstring(e.what()).c_str());
+    sq_throwerror(vm, e.what());
     return SQ_ERROR;
   } catch(...) {
     sq_throwerror(vm, _SC(&quot;Unexpected exception while executing function 'render_mask_set'&quot;));
@@ -1539,7 +1537,7 @@
   using namespace Wrapper;
 
   sq_pushroottable(v);
-  sq_pushstring(v, _SC(&quot;GameObject&quot;), -1);
+  sq_pushstring(v, &quot;GameObject&quot;, -1);
   if(SQ_FAILED(sq_get(v, -2))) {
     std::ostringstream msg;
     msg &lt;&lt; &quot;Couldn't resolved squirrel type 'GameObject'&quot;;
@@ -1565,7 +1563,7 @@
   using namespace Wrapper;
 
   sq_pushroottable(v);
-  sq_pushstring(v, _SC(&quot;TestObject&quot;), -1);
+  sq_pushstring(v, &quot;TestObject&quot;, -1);
   if(SQ_FAILED(sq_get(v, -2))) {
     std::ostringstream msg;
     msg &lt;&lt; &quot;Couldn't resolved squirrel type 'TestObject'&quot;;
@@ -1591,7 +1589,7 @@
   using namespace Wrapper;
 
   sq_pushroottable(v);
-  sq_pushstring(v, _SC(&quot;Player&quot;), -1);
+  sq_pushstring(v, &quot;Player&quot;, -1);
   if(SQ_FAILED(sq_get(v, -2))) {
     std::ostringstream msg;
     msg &lt;&lt; &quot;Couldn't resolved squirrel type 'Player'&quot;;
@@ -1617,7 +1615,7 @@
   using namespace Wrapper;
 
   sq_pushroottable(v);
-  sq_pushstring(v, _SC(&quot;ScriptableObject&quot;), -1);
+  sq_pushstring(v, &quot;ScriptableObject&quot;, -1);
   if(SQ_FAILED(sq_get(v, -2))) {
     std::ostringstream msg;
     msg &lt;&lt; &quot;Couldn't resolved squirrel type 'ScriptableObject'&quot;;
@@ -1642,368 +1640,368 @@
 {
   using namespace Wrapper;
 
-  sq_pushstring(v, _SC(&quot;VCENTER&quot;), -1);
+  sq_pushstring(v, &quot;VCENTER&quot;, -1);
   sq_pushinteger(v, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register constant 'VCENTER'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;LEFT&quot;), -1);
+  sq_pushstring(v, &quot;LEFT&quot;, -1);
   sq_pushinteger(v, 1);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register constant 'LEFT'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;RIGHT&quot;), -1);
+  sq_pushstring(v, &quot;RIGHT&quot;, -1);
   sq_pushinteger(v, 2);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register constant 'RIGHT'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;HCENTER&quot;), -1);
+  sq_pushstring(v, &quot;HCENTER&quot;, -1);
   sq_pushinteger(v, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register constant 'HCENTER'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;TOP&quot;), -1);
+  sq_pushstring(v, &quot;TOP&quot;, -1);
   sq_pushinteger(v, 16);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register constant 'TOP'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;BOTTOM&quot;), -1);
+  sq_pushstring(v, &quot;BOTTOM&quot;, -1);
   sq_pushinteger(v, 32);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register constant 'BOTTOM'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;set_sector&quot;), -1);
+  sq_pushstring(v, &quot;set_sector&quot;, -1);
   sq_newclosure(v, &amp;set_sector_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'set_sector'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;play_music&quot;), -1);
+  sq_pushstring(v, &quot;play_music&quot;, -1);
   sq_newclosure(v, &amp;play_music_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'play_music'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;stop_music&quot;), -1);
+  sq_pushstring(v, &quot;stop_music&quot;, -1);
   sq_newclosure(v, &amp;stop_music_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'stop_music'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;play_sound&quot;), -1);
+  sq_pushstring(v, &quot;play_sound&quot;, -1);
   sq_newclosure(v, &amp;play_sound_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'play_sound'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;caption_add&quot;), -1);
+  sq_pushstring(v, &quot;caption_add&quot;, -1);
   sq_newclosure(v, &amp;caption_add_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'caption_add'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;caption_clear&quot;), -1);
+  sq_pushstring(v, &quot;caption_clear&quot;, -1);
   sq_newclosure(v, &amp;caption_clear_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'caption_clear'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;caption_end&quot;), -1);
+  sq_pushstring(v, &quot;caption_end&quot;, -1);
   sq_newclosure(v, &amp;caption_end_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'caption_end'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;camera_set_active&quot;), -1);
+  sq_pushstring(v, &quot;camera_set_active&quot;, -1);
   sq_newclosure(v, &amp;camera_set_active_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'camera_set_active'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;camera_continue_path&quot;), -1);
+  sq_pushstring(v, &quot;camera_continue_path&quot;, -1);
   sq_newclosure(v, &amp;camera_continue_path_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'camera_continue_path'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;camera_begin_path&quot;), -1);
+  sq_pushstring(v, &quot;camera_begin_path&quot;, -1);
   sq_newclosure(v, &amp;camera_begin_path_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'camera_begin_path'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;camera_add_point&quot;), -1);
+  sq_pushstring(v, &quot;camera_add_point&quot;, -1);
   sq_newclosure(v, &amp;camera_add_point_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'camera_add_point'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;camera_end_path&quot;), -1);
+  sq_pushstring(v, &quot;camera_end_path&quot;, -1);
   sq_newclosure(v, &amp;camera_end_path_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'camera_end_path'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;camera_set_pos&quot;), -1);
+  sq_pushstring(v, &quot;camera_set_pos&quot;, -1);
   sq_newclosure(v, &amp;camera_set_pos_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'camera_set_pos'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;camera_set_zoom&quot;), -1);
+  sq_pushstring(v, &quot;camera_set_zoom&quot;, -1);
   sq_newclosure(v, &amp;camera_set_zoom_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'camera_set_zoom'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;set_controller_help_active&quot;), -1);
+  sq_pushstring(v, &quot;set_controller_help_active&quot;, -1);
   sq_newclosure(v, &amp;set_controller_help_active_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'set_controller_help_active'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;dialog_show&quot;), -1);
+  sq_pushstring(v, &quot;dialog_show&quot;, -1);
   sq_newclosure(v, &amp;dialog_show_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'dialog_show'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;wait_for_dialog&quot;), -1);
+  sq_pushstring(v, &quot;wait_for_dialog&quot;, -1);
   sq_newclosure(v, &amp;wait_for_dialog_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'wait_for_dialog'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;wait_for_fade&quot;), -1);
+  sq_pushstring(v, &quot;wait_for_fade&quot;, -1);
   sq_newclosure(v, &amp;wait_for_fade_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'wait_for_fade'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;wait_for_camera&quot;), -1);
+  sq_pushstring(v, &quot;wait_for_camera&quot;, -1);
   sq_newclosure(v, &amp;wait_for_camera_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'wait_for_camera'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;conversation_add&quot;), -1);
+  sq_pushstring(v, &quot;conversation_add&quot;, -1);
   sq_newclosure(v, &amp;conversation_add_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'conversation_add'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;conversation_add2&quot;), -1);
+  sq_pushstring(v, &quot;conversation_add2&quot;, -1);
   sq_newclosure(v, &amp;conversation_add2_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'conversation_add2'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;conversation_show&quot;), -1);
+  sq_pushstring(v, &quot;conversation_show&quot;, -1);
   sq_newclosure(v, &amp;conversation_show_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'conversation_show'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;conversation_get_selection&quot;), -1);
+  sq_pushstring(v, &quot;conversation_get_selection&quot;, -1);
   sq_newclosure(v, &amp;conversation_get_selection_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'conversation_get_selection'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;wait_for_conversation&quot;), -1);
+  sq_pushstring(v, &quot;wait_for_conversation&quot;, -1);
   sq_newclosure(v, &amp;wait_for_conversation_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'wait_for_conversation'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;add_objective&quot;), -1);
+  sq_pushstring(v, &quot;add_objective&quot;, -1);
   sq_newclosure(v, &amp;add_objective_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'add_objective'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;objective_complete&quot;), -1);
+  sq_pushstring(v, &quot;objective_complete&quot;, -1);
   sq_newclosure(v, &amp;objective_complete_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'objective_complete'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;is_objective_given&quot;), -1);
+  sq_pushstring(v, &quot;is_objective_given&quot;, -1);
   sq_newclosure(v, &amp;is_objective_given_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'is_objective_given'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;is_objective_complete&quot;), -1);
+  sq_pushstring(v, &quot;is_objective_complete&quot;, -1);
   sq_newclosure(v, &amp;is_objective_complete_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'is_objective_complete'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;run_before&quot;), -1);
+  sq_pushstring(v, &quot;run_before&quot;, -1);
   sq_newclosure(v, &amp;run_before_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'run_before'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;save_state&quot;), -1);
+  sq_pushstring(v, &quot;save_state&quot;, -1);
   sq_newclosure(v, &amp;save_state_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'save_state'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;load_state&quot;), -1);
+  sq_pushstring(v, &quot;load_state&quot;, -1);
   sq_newclosure(v, &amp;load_state_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'load_state'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;list_objects&quot;), -1);
+  sq_pushstring(v, &quot;list_objects&quot;, -1);
   sq_newclosure(v, &amp;list_objects_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'list_objects'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;set_debug&quot;), -1);
+  sq_pushstring(v, &quot;set_debug&quot;, -1);
   sq_newclosure(v, &amp;set_debug_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'set_debug'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;get_debug&quot;), -1);
+  sq_pushstring(v, &quot;get_debug&quot;, -1);
   sq_newclosure(v, &amp;get_debug_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'get_debug'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;get_game_speed&quot;), -1);
+  sq_pushstring(v, &quot;get_game_speed&quot;, -1);
   sq_newclosure(v, &amp;get_game_speed_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'get_game_speed'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;set_game_speed&quot;), -1);
+  sq_pushstring(v, &quot;set_game_speed&quot;, -1);
   sq_newclosure(v, &amp;set_game_speed_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'set_game_speed'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;wait&quot;), -1);
+  sq_pushstring(v, &quot;wait&quot;, -1);
   sq_newclosure(v, &amp;wait_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'wait'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;display&quot;), -1);
+  sq_pushstring(v, &quot;display&quot;, -1);
   sq_newclosure(v, &amp;display_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'display'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;println&quot;), -1);
+  sq_pushstring(v, &quot;println&quot;, -1);
   sq_newclosure(v, &amp;println_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'println'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;set_console_font&quot;), -1);
+  sq_pushstring(v, &quot;set_console_font&quot;, -1);
   sq_newclosure(v, &amp;set_console_font_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'set_console_font'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;set_gamma&quot;), -1);
+  sq_pushstring(v, &quot;set_gamma&quot;, -1);
   sq_newclosure(v, &amp;set_gamma_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'set_gamma'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;set_gamma_rgb&quot;), -1);
+  sq_pushstring(v, &quot;set_gamma_rgb&quot;, -1);
   sq_newclosure(v, &amp;set_gamma_rgb_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'set_gamma_rgb'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;show_config&quot;), -1);
+  sq_pushstring(v, &quot;show_config&quot;, -1);
   sq_newclosure(v, &amp;show_config_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'show_config'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;cutscene_begin&quot;), -1);
+  sq_pushstring(v, &quot;cutscene_begin&quot;, -1);
   sq_newclosure(v, &amp;cutscene_begin_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'cutscene_begin'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;cutscene_end&quot;), -1);
+  sq_pushstring(v, &quot;cutscene_end&quot;, -1);
   sq_newclosure(v, &amp;cutscene_end_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'cutscene_end'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;internal_fadeout_rgb&quot;), -1);
+  sq_pushstring(v, &quot;internal_fadeout_rgb&quot;, -1);
   sq_newclosure(v, &amp;internal_fadeout_rgb_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'internal_fadeout_rgb'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;internal_fadein&quot;), -1);
+  sq_pushstring(v, &quot;internal_fadein&quot;, -1);
   sq_newclosure(v, &amp;internal_fadein_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'internal_fadein'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;render_mask_get&quot;), -1);
+  sq_pushstring(v, &quot;render_mask_get&quot;, -1);
   sq_newclosure(v, &amp;render_mask_get_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'render_mask_get'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;render_mask_set&quot;), -1);
+  sq_pushstring(v, &quot;render_mask_set&quot;, -1);
   sq_newclosure(v, &amp;render_mask_set_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'render_mask_set'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;spawn_object&quot;), -1);
+  sq_pushstring(v, &quot;spawn_object&quot;, -1);
   sq_newclosure(v, &amp;spawn_object_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'spawn_object'&quot;);
   }
 
   // Register class GameObject
-  sq_pushstring(v, _SC(&quot;GameObject&quot;), -1);
+  sq_pushstring(v, &quot;GameObject&quot;, -1);
   if(sq_newclass(v, SQFalse) &lt; 0) {
     std::ostringstream msg;
     msg &lt;&lt; &quot;Couldn't create new class 'GameObject'&quot;;
     throw SquirrelError(v, msg.str());
   }
-  sq_pushstring(v, _SC(&quot;get_name&quot;), -1);
+  sq_pushstring(v, &quot;get_name&quot;, -1);
   sq_newclosure(v, &amp;GameObject_get_name_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'get_name'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;remove&quot;), -1);
+  sq_pushstring(v, &quot;remove&quot;, -1);
   sq_newclosure(v, &amp;GameObject_remove_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'remove'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;set_active&quot;), -1);
+  sq_pushstring(v, &quot;set_active&quot;, -1);
   sq_newclosure(v, &amp;GameObject_set_active_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'set_active'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;set_parent&quot;), -1);
+  sq_pushstring(v, &quot;set_parent&quot;, -1);
   sq_newclosure(v, &amp;GameObject_set_parent_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'set_parent'&quot;);
@@ -2014,39 +2012,39 @@
   }
 
   // Register class TestObject
-  sq_pushstring(v, _SC(&quot;TestObject&quot;), -1);
-  sq_pushstring(v, _SC(&quot;GameObject&quot;), -1);
+  sq_pushstring(v, &quot;TestObject&quot;, -1);
+  sq_pushstring(v, &quot;GameObject&quot;, -1);
   sq_get(v, -3);
   if(sq_newclass(v, SQTrue) &lt; 0) {
     std::ostringstream msg;
     msg &lt;&lt; &quot;Couldn't create new class 'TestObject'&quot;;
     throw SquirrelError(v, msg.str());
   }
-  sq_pushstring(v, _SC(&quot;set_sprite&quot;), -1);
+  sq_pushstring(v, &quot;set_sprite&quot;, -1);
   sq_newclosure(v, &amp;TestObject_set_sprite_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'set_sprite'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;set_action&quot;), -1);
+  sq_pushstring(v, &quot;set_action&quot;, -1);
   sq_newclosure(v, &amp;TestObject_set_action_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'set_action'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;set_pos&quot;), -1);
+  sq_pushstring(v, &quot;set_pos&quot;, -1);
   sq_newclosure(v, &amp;TestObject_set_pos_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'set_pos'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;set_vflip&quot;), -1);
+  sq_pushstring(v, &quot;set_vflip&quot;, -1);
   sq_newclosure(v, &amp;TestObject_set_vflip_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'set_vflip'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;attach&quot;), -1);
+  sq_pushstring(v, &quot;attach&quot;, -1);
   sq_newclosure(v, &amp;TestObject_attach_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'attach'&quot;);
@@ -2057,21 +2055,21 @@
   }
 
   // Register class Player
-  sq_pushstring(v, _SC(&quot;Player&quot;), -1);
-  sq_pushstring(v, _SC(&quot;GameObject&quot;), -1);
+  sq_pushstring(v, &quot;Player&quot;, -1);
+  sq_pushstring(v, &quot;GameObject&quot;, -1);
   sq_get(v, -3);
   if(sq_newclass(v, SQTrue) &lt; 0) {
     std::ostringstream msg;
     msg &lt;&lt; &quot;Couldn't create new class 'Player'&quot;;
     throw SquirrelError(v, msg.str());
   }
-  sq_pushstring(v, _SC(&quot;start_listening&quot;), -1);
+  sq_pushstring(v, &quot;start_listening&quot;, -1);
   sq_newclosure(v, &amp;Player_start_listening_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'start_listening'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;stop_listening&quot;), -1);
+  sq_pushstring(v, &quot;stop_listening&quot;, -1);
   sq_newclosure(v, &amp;Player_stop_listening_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'stop_listening'&quot;);
@@ -2082,21 +2080,21 @@
   }
 
   // Register class ScriptableObject
-  sq_pushstring(v, _SC(&quot;ScriptableObject&quot;), -1);
-  sq_pushstring(v, _SC(&quot;GameObject&quot;), -1);
+  sq_pushstring(v, &quot;ScriptableObject&quot;, -1);
+  sq_pushstring(v, &quot;GameObject&quot;, -1);
   sq_get(v, -3);
   if(sq_newclass(v, SQTrue) &lt; 0) {
     std::ostringstream msg;
     msg &lt;&lt; &quot;Couldn't create new class 'ScriptableObject'&quot;;
     throw SquirrelError(v, msg.str());
   }
-  sq_pushstring(v, _SC(&quot;move_to&quot;), -1);
+  sq_pushstring(v, &quot;move_to&quot;, -1);
   sq_newclosure(v, &amp;ScriptableObject_move_to_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'move_to'&quot;);
   }
 
-  sq_pushstring(v, _SC(&quot;start_flash&quot;), -1);
+  sq_pushstring(v, &quot;start_flash&quot;, -1);
   sq_newclosure(v, &amp;ScriptableObject_start_flash_wrapper, 0);
   if(SQ_FAILED(sq_createslot(v, -3))) {
     throw SquirrelError(v, &quot;Couldn't register function 'start_flash'&quot;);

Modified: trunk/windstille/src/sector.cpp
===================================================================
--- trunk/windstille/src/sector.cpp	2008-06-27 10:49:53 UTC (rev 2270)
+++ trunk/windstille/src/sector.cpp	2008-06-27 11:51:22 UTC (rev 2271)
@@ -49,7 +49,6 @@
 #include &quot;scriptable_object.hpp&quot;
 #include &quot;navigation/navigation_graph.hpp&quot;
 #include &quot;scripting/squirrel_error.hpp&quot;
-#include &quot;util.hpp&quot;
 
 // The table (works like a namespace here) where the game objects will appear
 #define OBJECTS_TABLE &quot;objects&quot;
@@ -269,7 +268,7 @@
   // get objects table
   HSQUIRRELVM v = script_manager-&gt;get_vm();
   sq_pushroottable(v);
-  sq_pushstring(v, string_to_wstring(OBJECTS_TABLE).c_str(), -1);
+  sq_pushstring(v, OBJECTS_TABLE, -1);
   if(SQ_FAILED(sq_get(v, -2)))
   {
     std::ostringstream msg;
@@ -278,7 +277,7 @@
   }
 
   // remove object from table
-  sq_pushstring(v, string_to_wstring(object-&gt;get_name()).c_str(), object-&gt;get_name().size());
+  sq_pushstring(v, object-&gt;get_name().c_str(), object-&gt;get_name().size());
   if(SQ_FAILED(sq_deleteslot(v, -2, SQFalse) &lt; 0)) {
     std::ostringstream msg;
     msg &lt;&lt; &quot;Couldn't remove squirrel object for '&quot; &lt;&lt; object-&gt;get_name()
@@ -324,7 +323,7 @@
   // get objects table
   HSQUIRRELVM v = script_manager-&gt;get_vm();
   sq_pushroottable(v);
-  sq_pushstring(v, string_to_wstring(OBJECTS_TABLE).c_str(), -1);
+  sq_pushstring(v, OBJECTS_TABLE, -1);
   if(SQ_FAILED(sq_get(v, -2)))
   {
     std::ostringstream msg;
@@ -333,7 +332,7 @@
   }
   
   // create squirrel instance and register in table
-  sq_pushstring(v, string_to_wstring(object-&gt;get_name()).c_str(), object-&gt;get_name().size());
+  sq_pushstring(v, object-&gt;get_name().c_str(), object-&gt;get_name().size());
   create_squirrel_instance(v, object);
   if(SQ_FAILED(sq_createslot(v, -3)))
   {

Modified: trunk/windstille/src/util.cpp
===================================================================
--- trunk/windstille/src/util.cpp	2008-06-27 10:49:53 UTC (rev 2270)
+++ trunk/windstille/src/util.cpp	2008-06-27 11:51:22 UTC (rev 2271)
@@ -47,14 +47,4 @@
   return out;
 }
 
-const std::wstring string_to_wstring(const std::string&amp; str) {
-	std::wstring tmp(str.begin(), str.end());
-	return tmp;
-}
-
-const std::string wstring_to_string(const std::wstring&amp; str) {
-	std::string tmp(str.begin(), str.end());
-	return tmp;
-}
-
 /* EOF */

Modified: trunk/windstille/src/util.hpp
===================================================================
--- trunk/windstille/src/util.hpp	2008-06-27 10:49:53 UTC (rev 2270)
+++ trunk/windstille/src/util.hpp	2008-06-27 11:51:22 UTC (rev 2271)
@@ -39,8 +39,5 @@
 #endif
 }
 
-const std::wstring string_to_wstring(const std::string&amp; str);
-const std::string wstring_to_string(const std::wstring&amp; str);
-
 #endif
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001292.html">[Windstille-commit] r2270 - in trunk/windstille/lib: . SQUIRREL2	SQUIRREL2/doc SQUIRREL2/etc SQUIRREL2/include	SQUIRREL2/samples SQUIRREL2/sq SQUIRREL2/sqstdlib SQUIRREL2/squirrel
</A></li>
	<LI>Next message: <A HREF="001291.html">[Windstille-commit] r2272 - trunk/windstille/contrib/vs2003build
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1290">[ date ]</a>
              <a href="thread.html#1290">[ thread ]</a>
              <a href="subject.html#1290">[ subject ]</a>
              <a href="author.html#1290">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/windstille-commit">More information about the Windstille-commit
mailing list</a><br>
</body></html>
