<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Windstille-commit] r986 - trunk/src
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/windstille-commit/2005-August/index.html" >
   <LINK REL="made" HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r986%20-%20trunk/src&In-Reply-To=%3C200508191353.j7JDre3T025984%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000638.html">
   <LINK REL="Next"  HREF="000640.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Windstille-commit] r986 - trunk/src</H1>
    <B>Ingo Ruhnke at BerliOS</B> 
    <A HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r986%20-%20trunk/src&In-Reply-To=%3C200508191353.j7JDre3T025984%40sheep.berlios.de%3E"
       TITLE="[Windstille-commit] r986 - trunk/src">grumbel at berlios.de
       </A><BR>
    <I>Fri Aug 19 15:53:40 CEST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000638.html">[Windstille-commit] r985 - in trunk/src: . collision scripting
</A></li>
        <LI>Next message: <A HREF="000640.html">[Windstille-commit] r987 - in trunk: data/images src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#639">[ date ]</a>
              <a href="thread.html#639">[ thread ]</a>
              <a href="subject.html#639">[ subject ]</a>
              <a href="author.html#639">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: grumbel
Date: 2005-08-19 15:53:37 +0200 (Fri, 19 Aug 2005)
New Revision: 986

Modified:
   trunk/src/tile_map.cpp
Log:
- added not yet really working raycasting for the laserpointer

Modified: trunk/src/tile_map.cpp
===================================================================
--- trunk/src/tile_map.cpp	2005-08-19 13:46:03 UTC (rev 985)
+++ trunk/src/tile_map.cpp	2005-08-19 13:53:37 UTC (rev 986)
@@ -192,27 +192,28 @@
   float tDeltaX = (direction.x == 0) ? 0 : (TILE_SIZE / direction.x);
   float tDeltaY = (direction.y == 0) ? 0 : (TILE_SIZE / direction.y);
 
+  float t = 0;
+
   while(x &gt;= 0 &amp;&amp; x &lt; get_width() &amp;&amp;
         y &gt;= 0 &amp;&amp; y &lt; get_height())
     {
       Tile* tile = field(x, y);  
       if (tile &amp;&amp; tile-&gt;colmap)
         {
-          if ((tMaxX - tDeltaX) &lt; (tMaxY - tDeltaY))
-            return pos + Vector((tMaxX - tDeltaX) * direction.x, (tMaxX - tDeltaX) * direction.y);
-          else
-            return pos + Vector((tMaxY - tDeltaY) * direction.x, (tMaxY - tDeltaY) * direction.y);
+          return pos + Vector(t * direction.x, t * direction.y);
           //return Vector(x * TILE_SIZE, y * TILE_SIZE);
         }
 
       // move one tile
       if (tMaxX &lt; tMaxY) 
         {
+          t = tMaxX;
           tMaxX += tDeltaX;
           x = x + step_x;
         }
       else 
         {
+          t = tMaxY;
           tMaxY += tDeltaY;
           y = y + step_y;
         }


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000638.html">[Windstille-commit] r985 - in trunk/src: . collision scripting
</A></li>
	<LI>Next message: <A HREF="000640.html">[Windstille-commit] r987 - in trunk: data/images src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#639">[ date ]</a>
              <a href="thread.html#639">[ thread ]</a>
              <a href="subject.html#639">[ subject ]</a>
              <a href="author.html#639">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/windstille-commit">More information about the Windstille-commit
mailing list</a><br>
</body></html>
