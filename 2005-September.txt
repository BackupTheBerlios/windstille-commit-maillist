From grumbel at berlios.de  Thu Sep  1 02:39:16 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Thu, 1 Sep 2005 02:39:16 +0200
Subject: [Windstille-commit] r1052 - trunk/src/collision
Message-ID: <200509010039.j810dGgM012393@sheep.berlios.de>

Author: grumbel
Date: 2005-09-01 02:39:01 +0200 (Thu, 01 Sep 2005)
New Revision: 1052

Added:
   trunk/src/collision/ladder_contact.cpp
   trunk/src/collision/ladder_contact.hpp
Modified:
   trunk/src/collision/Jamfile
Log:
- placeholder for LadderContact

Modified: trunk/src/collision/Jamfile
===================================================================
--- trunk/src/collision/Jamfile	2005-08-31 21:55:04 UTC (rev 1051)
+++ trunk/src/collision/Jamfile	2005-09-01 00:39:01 UTC (rev 1052)
@@ -12,6 +12,8 @@
   contact.hpp
   stair_contact.hpp
   stair_contact.cpp
+  ladder_contact.hpp
+  ladder_contact.cpp
 ;
 
 TRANSLATABLE_SOURCES += [ SearchSource $(sources) ] ;

Added: trunk/src/collision/ladder_contact.cpp
===================================================================
--- trunk/src/collision/ladder_contact.cpp	2005-08-31 21:55:04 UTC (rev 1051)
+++ trunk/src/collision/ladder_contact.cpp	2005-09-01 00:39:01 UTC (rev 1052)
@@ -0,0 +1,54 @@
+/*  $Id$
+**   __      __ __             ___        __   __ __   __
+**  /  \    /  \__| ____    __| _/_______/  |_|__|  | |  |   ____
+**  \   \/\/   /  |/    \  / __ |/  ___/\   __\  |  | |  | _/ __ \
+**   \        /|  |   |  \/ /_/ |\___ \  |  | |  |  |_|  |_\  ___/
+**    \__/\  / |__|___|  /\____ /____  > |__| |__|____/____/\___  >
+**         \/          \/      \/    \/                         \/
+**  Copyright (C) 2005 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software; you can redistribute it and/or
+**  modify it under the terms of the GNU General Public License
+**  as published by the Free Software Foundation; either version 2
+**  of the License, or (at your option) any later version.
+**
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+** 
+**  You should have received a copy of the GNU General Public License
+**  along with this program; if not, write to the Free Software
+**  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+**  02111-1307, USA.
+*/
+
+#include "ladder_contact.hpp"
+
+LadderContact::LadderContact()
+{
+}
+
+void
+LadderContact::update(float delta)
+{
+}
+
+void
+LadderContact::advance(float s)
+{
+}
+
+bool
+LadderContact::is_active() const
+{
+  return true;
+}
+
+Vector
+LadderContact::get_pos() const
+{
+  return Vector();
+}
+
+/* EOF */

Added: trunk/src/collision/ladder_contact.hpp
===================================================================
--- trunk/src/collision/ladder_contact.hpp	2005-08-31 21:55:04 UTC (rev 1051)
+++ trunk/src/collision/ladder_contact.hpp	2005-09-01 00:39:01 UTC (rev 1052)
@@ -0,0 +1,50 @@
+/*  $Id$
+**   __      __ __             ___        __   __ __   __
+**  /  \    /  \__| ____    __| _/_______/  |_|__|  | |  |   ____
+**  \   \/\/   /  |/    \  / __ |/  ___/\   __\  |  | |  | _/ __ \
+**   \        /|  |   |  \/ /_/ |\___ \  |  | |  |  |_|  |_\  ___/
+**    \__/\  / |__|___|  /\____ /____  > |__| |__|____/____/\___  >
+**         \/          \/      \/    \/                         \/
+**  Copyright (C) 2005 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software; you can redistribute it and/or
+**  modify it under the terms of the GNU General Public License
+**  as published by the Free Software Foundation; either version 2
+**  of the License, or (at your option) any later version.
+**
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+** 
+**  You should have received a copy of the GNU General Public License
+**  along with this program; if not, write to the Free Software
+**  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+**  02111-1307, USA.
+*/
+
+#ifndef HEADER_WINDSTILLE_COLLISION_LADDER_CONTACT_HPP
+#define HEADER_WINDSTILLE_COLLISION_LADDER_CONTACT_HPP
+
+#include "math/vector.hpp"
+#include "contact.hpp"
+
+/** */
+class LadderContact : public Contact
+{
+private:
+public:
+  LadderContact();
+
+  void update(float delta);
+  void advance(float s);
+  bool is_active() const;
+  Vector get_pos() const;
+private:
+  LadderContact (const LadderContact&);
+  LadderContact& operator= (const LadderContact&);
+};
+
+#endif
+
+/* EOF */



From grumbel at berlios.de  Fri Sep  2 22:20:19 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Fri, 2 Sep 2005 22:20:19 +0200
Subject: [Windstille-commit] r1053 - in trunk/src: display particles
Message-ID: <200509022020.j82KKJCp024810@sheep.berlios.de>

Author: grumbel
Date: 2005-09-02 22:20:16 +0200 (Fri, 02 Sep 2005)
New Revision: 1053

Modified:
   trunk/src/display/scene_context.cpp
   trunk/src/display/scene_context.hpp
   trunk/src/particles/drawer.hpp
   trunk/src/particles/particle_system.cpp
   trunk/src/particles/particle_system.hpp
   trunk/src/particles/spark_drawer.cpp
   trunk/src/particles/spark_drawer.hpp
   trunk/src/particles/surface_drawer.cpp
   trunk/src/particles/surface_drawer.hpp
Log:
- added layer support to the ParticleSystem

Modified: trunk/src/display/scene_context.cpp
===================================================================
--- trunk/src/display/scene_context.cpp	2005-09-01 00:39:01 UTC (rev 1052)
+++ trunk/src/display/scene_context.cpp	2005-09-02 20:20:16 UTC (rev 1053)
@@ -217,4 +217,23 @@
   return impl->render_mask;
 }
 
+DrawingContext&
+SceneContext::get_layer(unsigned int type)
+{
+  switch(type)
+    {
+    case COLORMAP:
+      return impl->color;
+
+    case LIGHTMAP:
+      return impl->light;
+
+    case HIGHLIGHTMAP:
+      return impl->highlight;
+
+    default:
+      assert(!"SceneContext::get_layer(): Unknown type");
+    }
+}
+
 /* EOF */

Modified: trunk/src/display/scene_context.hpp
===================================================================
--- trunk/src/display/scene_context.hpp	2005-09-01 00:39:01 UTC (rev 1052)
+++ trunk/src/display/scene_context.hpp	2005-09-02 20:20:16 UTC (rev 1053)
@@ -79,6 +79,9 @@
 
   void set_render_mask(unsigned int mask);
   unsigned int get_render_mask();
+
+  DrawingContext& get_layer(unsigned int t);
+
 private:
   SceneContextImpl* impl;
 

Modified: trunk/src/particles/drawer.hpp
===================================================================
--- trunk/src/particles/drawer.hpp	2005-09-01 00:39:01 UTC (rev 1052)
+++ trunk/src/particles/drawer.hpp	2005-09-02 20:20:16 UTC (rev 1053)
@@ -20,14 +20,14 @@
 #ifndef HEADER_PARTICLES_DRAWER_HXX
 #define HEADER_PARTICLES_DRAWER_HXX
 
-class SceneContext;
+class DrawingContext;
 class ParticleSystem;
 
 class Drawer
 {
 public:
   virtual ~Drawer() {}
-  virtual void draw(SceneContext& sc, ParticleSystem& psys) =0;
+  virtual void draw(DrawingContext& sc, ParticleSystem& psys) =0;
 };
 
 #endif

Modified: trunk/src/particles/particle_system.cpp
===================================================================
--- trunk/src/particles/particle_system.cpp	2005-09-01 00:39:01 UTC (rev 1052)
+++ trunk/src/particles/particle_system.cpp	2005-09-02 20:20:16 UTC (rev 1053)
@@ -57,6 +57,8 @@
   color_start = Color(1.0f, 1.0f, 1.0f, 1.0f);
   color_stop  = Color(   0,    0,    0,    0);
 
+  layer = SceneContext::COLORMAP;
+
   // Set stuff from Lisp
   lisp::Properties props(lisp);
 
@@ -112,6 +114,21 @@
     set_velocity(p_speed.x, p_speed.y);
 
   {
+    std::string layer_str;
+    if (props.get("layer", layer_str))
+      {
+        if (layer_str == "highlight")
+          layer = SceneContext::HIGHLIGHTMAP;
+        else if (layer_str == "light")
+          layer = SceneContext::LIGHTMAP;
+        else if (layer_str == "color")
+          layer = SceneContext::COLORMAP;
+        else
+          std::cout << "ParticleSystem: Unknown layer type: '" << layer_str << "'" << std::endl;
+      }
+  }
+
+  {
     const lisp::Lisp* drawer_lisp = 0;
     if (props.get("drawer", drawer_lisp))
       {
@@ -223,7 +240,7 @@
 {
   if (drawer)
     {
-      drawer->draw(sc, *this);
+      drawer->draw(sc.get_layer(layer), *this);
     }
   else
     {

Modified: trunk/src/particles/particle_system.hpp
===================================================================
--- trunk/src/particles/particle_system.hpp	2005-09-01 00:39:01 UTC (rev 1052)
+++ trunk/src/particles/particle_system.hpp	2005-09-02 20:20:16 UTC (rev 1053)
@@ -56,6 +56,7 @@
 public:
   typedef std::vector<Particle> Particles;
   typedef Particles::iterator iterator;
+
 private:
   Particles particles;
 
@@ -80,6 +81,9 @@
 
   float bunching;
 
+  /** Type of layer to which this particle system gets drawn */
+  unsigned int layer;
+
 public:
   float size_start;
   float size_stop;

Modified: trunk/src/particles/spark_drawer.cpp
===================================================================
--- trunk/src/particles/spark_drawer.cpp	2005-09-01 00:39:01 UTC (rev 1052)
+++ trunk/src/particles/spark_drawer.cpp	2005-09-02 20:20:16 UTC (rev 1053)
@@ -35,10 +35,10 @@
 }
 
 void
-SparkDrawer::draw(SceneContext& sc, ParticleSystem& psys) 
+SparkDrawer::draw(DrawingContext& dc, ParticleSystem& psys) 
 {
   VertexArrayDrawingRequest* buffer = new VertexArrayDrawingRequest(Vector(0, 0), psys.get_z_pos(),
-                                                                    sc.color().get_modelview());
+                                                                    dc.get_modelview());
   if (width == 1.0f)
     {
       buffer->set_mode(GL_LINES);
@@ -76,7 +76,7 @@
         }
     }
 
-  sc.color().draw(buffer);
+  dc.draw(buffer);
 }
 
 /* EOF */

Modified: trunk/src/particles/spark_drawer.hpp
===================================================================
--- trunk/src/particles/spark_drawer.hpp	2005-09-01 00:39:01 UTC (rev 1052)
+++ trunk/src/particles/spark_drawer.hpp	2005-09-02 20:20:16 UTC (rev 1053)
@@ -30,9 +30,10 @@
 private:
   Color color;
   float width;
+
 public:
   SparkDrawer(const lisp::Lisp* lisp);
-  void draw(SceneContext& sc, ParticleSystem& psys);
+  void draw(DrawingContext& dc, ParticleSystem& psys);
 };
 
 #endif

Modified: trunk/src/particles/surface_drawer.cpp
===================================================================
--- trunk/src/particles/surface_drawer.cpp	2005-09-01 00:39:01 UTC (rev 1052)
+++ trunk/src/particles/surface_drawer.cpp	2005-09-02 20:20:16 UTC (rev 1053)
@@ -88,11 +88,11 @@
 }
 
 void
-SurfaceDrawer::draw(SceneContext& sc, ParticleSystem& psys) 
+SurfaceDrawer::draw(DrawingContext& dc, ParticleSystem& psys) 
 {          
   VertexArrayDrawingRequest* buffer 
     = new VertexArrayDrawingRequest(Vector(psys.get_x_pos(), psys.get_y_pos()), psys.get_z_pos(),
-                                    sc.color().get_modelview());
+                                    dc.get_modelview());
 
   buffer->set_mode(GL_QUADS);
   buffer->set_texture(surface.get_texture());
@@ -142,7 +142,7 @@
         }
     }
 
-  sc.color().draw(buffer);
+  dc.draw(buffer);
 }
 
 /* EOF */

Modified: trunk/src/particles/surface_drawer.hpp
===================================================================
--- trunk/src/particles/surface_drawer.hpp	2005-09-01 00:39:01 UTC (rev 1052)
+++ trunk/src/particles/surface_drawer.hpp	2005-09-02 20:20:16 UTC (rev 1053)
@@ -38,7 +38,7 @@
   
   void set_texture(Surface surface);
   void set_blendfuncs(GLenum blendfunc_src, GLenum blendfunc_dst);
-  void draw(SceneContext& sc, ParticleSystem& psys);
+  void draw(DrawingContext& sc, ParticleSystem& psys);
 };
 
 #endif



From grumbel at berlios.de  Fri Sep  2 23:48:15 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Fri, 2 Sep 2005 23:48:15 +0200
Subject: [Windstille-commit] r1054 - trunk/data/images/objects
Message-ID: <200509022148.j82LmFrf029495@sheep.berlios.de>

Author: grumbel
Date: 2005-09-02 23:48:13 +0200 (Fri, 02 Sep 2005)
New Revision: 1054

Added:
   trunk/data/images/objects/cabinet.png
   trunk/data/images/objects/plant.png
   trunk/data/images/objects/shower.xcf
   trunk/data/images/objects/showerdoors.png
Log:
- some more objects


Added: trunk/data/images/objects/cabinet.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/cabinet.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/plant.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/plant.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/shower.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/shower.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/showerdoors.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/showerdoors.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From grumbel at berlios.de  Fri Sep  2 23:49:08 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Fri, 2 Sep 2005 23:49:08 +0200
Subject: [Windstille-commit] r1055 - trunk/data/images/tiles
Message-ID: <200509022149.j82Ln8VO029559@sheep.berlios.de>

Author: grumbel
Date: 2005-09-02 23:49:07 +0200 (Fri, 02 Sep 2005)
New Revision: 1055

Modified:
   trunk/data/images/tiles/apartment-foreground.png
Log:
- some more tiles

Modified: trunk/data/images/tiles/apartment-foreground.png
===================================================================
(Binary files differ)



From grumbel at berlios.de  Fri Sep  2 23:49:52 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Fri, 2 Sep 2005 23:49:52 +0200
Subject: [Windstille-commit] r1056 - trunk/data/levels
Message-ID: <200509022149.j82LnqDD029605@sheep.berlios.de>

Author: grumbel
Date: 2005-09-02 23:49:50 +0200 (Fri, 02 Sep 2005)
New Revision: 1056

Modified:
   trunk/data/levels/apartment.wst
Log:
- some more objects

Modified: trunk/data/levels/apartment.wst
===================================================================
--- trunk/data/levels/apartment.wst	2005-09-02 21:49:07 UTC (rev 1055)
+++ trunk/data/levels/apartment.wst	2005-09-02 21:49:50 UTC (rev 1056)
@@ -4,16 +4,16 @@
   (ambient-color .666 .666 .666)  (name   "")
   (music  "")
   (objects
-  (tilemap (name "background") (width 100) (height 30) (z-pos -100)
+  (tilemap (name "background") (width 100) (height 30) (z-pos -1000)
     (data
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      1765 1766 1767 1768 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1863 1864 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1863 1864 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1865 1866 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1863 1864 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1863 1864 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1865 1866 
-      1781 1782 1783 1784 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1879 1880 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1879 1880 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1881 1882 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1879 1880 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1879 1880 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1881 1882 
-      1797 1798 1799 1800 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1895 1896 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1895 1896 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1897 1898 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1895 1896 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1895 1896 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1897 1898 
-      1813 1814 1815 1816 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1911 1912 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1911 1912 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1913 1914 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1911 1912 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1911 1912 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1913 1914 
-      1829 1830 1831 1832 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1927 1928 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1927 1928 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1929 1930 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1927 1928 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1927 1928 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1929 1930 
-      1845 1846 1847 1848 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1943 1944 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1943 1944 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1945 1946 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1943 1944 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1943 1944 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1945 1946 
+      1765 1766 1767 1768 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1767 1768 1769 1766 1765 1766 1863 1864 1769 1770 1863 1864 1863 1864 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1863 1864 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1865 1866 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1863 1864 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1863 1864 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1865 1866 
+      1781 1782 1783 1784 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1783 1784 1785 1782 1781 1782 1879 1880 1785 1786 1879 1880 1879 1880 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1879 1880 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1881 1882 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1879 1880 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1879 1880 1785 1786 1781 1782 1783 1784 1785 1786 1781 1782 1881 1882 
+      1797 1798 1799 1800 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1799 1800 1801 1773 1774 1773 1773 1798 1801 1802 1895 1896 1895 1896 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1895 1896 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1897 1898 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1895 1896 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1895 1896 1801 1802 1797 1798 1799 1800 1801 1802 1797 1798 1897 1898 
+      1813 1814 1815 1816 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1815 1816 1817 1771 1773 1773 1771 1814 1817 1818 1911 1912 1911 1912 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1911 1912 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1913 1914 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1911 1912 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1911 1912 1817 1818 1813 1814 1815 1816 1817 1818 1813 1814 1913 1914 
+      1829 1830 1831 1832 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1831 1832 1833 1771 1773 1773 1771 1830 1833 1834 1927 1928 1927 1928 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1927 1928 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1929 1930 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1927 1928 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1927 1928 1833 1834 1829 1830 1831 1832 1833 1834 1829 1830 1929 1930 
+      1845 1846 1847 1848 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1847 1848 1849 1771 1773 1773 1771 1846 1849 1850 1943 1944 1943 1944 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1943 1944 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1945 1946 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1943 1944 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1943 1944 1849 1850 1845 1846 1847 1848 1849 1850 1845 1846 1945 1946 
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
       1861 1862 1767 1768 1865 1866 1765 1766 1861 1862 1769 1863 1864 1864 1767 1768 1769 1770 1765 1766 1863 1864 1769 1770 1865 1866 1767 1768 1769 1770 1765 1766 1863 1864 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1863 1864 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1865 1866 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1863 1864 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1863 1864 1769 1770 1765 1766 1767 1768 1769 1770 1765 1766 1865 1866 1769 1770 1765 1766 1767 1768 
@@ -70,7 +70,7 @@
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
      ))
-  (tilemap (name "interactive") (width 100) (height 30) (z-pos 10)
+  (tilemap (name "interactive") (width 100) (height 30) (z-pos 0)
     (data
       1655 1656 1657 1658 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 
       1671 1672 1673 1674 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 
@@ -103,13 +103,20 @@
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
      ))
+
+(scriptable-object (sprite "images/objects/plant.sprite") (pos 650 160) (z-pos 0))
+(scriptable-object (sprite "images/objects/plant.sprite") (pos 210 160) (z-pos 0))
+(scriptable-object (sprite "images/objects/cabinet.sprite") (pos 700 148) (z-pos 0))
+(scriptable-object (sprite "images/objects/cabinet.sprite") (pos 764 148) (z-pos 0))
+(scriptable-object (sprite "images/objects/cabinet.sprite") (pos 828 148) (z-pos 0))
+(scriptable-object (sprite "images/objects/showerdoors.sprite") (pos 919 120) (z-pos 0))
 (scriptable-object (sprite "images/objects/apartmentlamp.sprite") (highlight "images/objects/apartmentlamp_highlight.sprite") (light "images/objects/apartmentlamp_light.sprite") (pos 1280 64))
 (scriptable-object (sprite "images/objects/apartmentlamp.sprite") (highlight "images/objects/apartmentlamp_highlight.sprite") (light "images/objects/apartmentlamp_light.sprite") (pos 768 64))
 (scriptable-object (sprite "images/objects/apartmentlamp.sprite") (highlight "images/objects/apartmentlamp_highlight.sprite") (light "images/objects/apartmentlamp_light.sprite") (pos 256 64))
-(scriptable-object (name "Painting1") (pos 72 135) (z-pos 100) (sprite "images/objects/painting1.sprite") (active true))
-(scriptable-object (name "Painting1") (pos 72 135) (z-pos 100) (sprite "images/objects/painting1.sprite") (active true))
-(scriptable-object (name "Painting2") (pos 336 125) (z-pos 100) (sprite "images/objects/painting2.sprite") (active true))
-(scriptable-object (name "Painting3") (pos 563 131) (z-pos 100) (sprite "images/objects/painting3.sprite") (active true))
+(scriptable-object (name "Painting1") (pos 72 135) (z-pos  -100) (sprite "images/objects/painting1.sprite") (active true))
+(scriptable-object (name "Painting1") (pos 72 135) (z-pos  -100) (sprite "images/objects/painting1.sprite") (active true))
+(scriptable-object (name "Painting2") (pos 336 125) (z-pos -100) (sprite "images/objects/painting2.sprite") (active true))
+(scriptable-object (name "Painting3") (pos 563 131) (z-pos -100) (sprite "images/objects/painting3.sprite") (active true))
    )
  )
 



From grumbel at berlios.de  Sat Sep  3 04:45:39 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Sat, 3 Sep 2005 04:45:39 +0200
Subject: [Windstille-commit] r1057 - in trunk/data/images: . portraits
Message-ID: <200509030245.j832jdrM028469@sheep.berlios.de>

Author: grumbel
Date: 2005-09-03 04:45:30 +0200 (Sat, 03 Sep 2005)
New Revision: 1057

Added:
   trunk/data/images/portraits/
   trunk/data/images/portraits/bob.png
   trunk/data/images/portraits/jane.png
   trunk/data/images/portraits/monster.png
   trunk/data/images/portraits/powersuit.png
   trunk/data/images/portraits/sophie.png
   trunk/data/images/portraits/worker.png
   trunk/data/images/portraits/yagor.png
Log:
- added some portraits, mostly just placeholders

Added: trunk/data/images/portraits/bob.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/portraits/bob.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/portraits/jane.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/portraits/jane.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/portraits/monster.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/portraits/monster.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/portraits/powersuit.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/portraits/powersuit.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/portraits/sophie.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/portraits/sophie.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/portraits/worker.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/portraits/worker.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/portraits/yagor.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/portraits/yagor.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From matzebraun at berlios.de  Sat Sep  3 15:50:25 2005
From: matzebraun at berlios.de (Matthias Braun at BerliOS)
Date: Sat, 3 Sep 2005 15:50:25 +0200
Subject: [Windstille-commit] r1058 - in trunk/src: . scripting
Message-ID: <200509031350.j83DoPlI032326@sheep.berlios.de>

Author: matzebraun
Date: 2005-09-03 15:50:24 +0200 (Sat, 03 Sep 2005)
New Revision: 1058

Added:
   trunk/src/grenade.cpp
   trunk/src/grenade.hpp
Modified:
   trunk/src/Jamfile
   trunk/src/physics.cpp
   trunk/src/player.cpp
   trunk/src/screen.hpp
   trunk/src/scripting/wrapper.cpp
   trunk/src/scripting/wrapper.hpp
Log:
not working testr iof physics class

Modified: trunk/src/Jamfile
===================================================================
--- trunk/src/Jamfile	2005-09-03 02:45:30 UTC (rev 1057)
+++ trunk/src/Jamfile	2005-09-03 13:50:24 UTC (rev 1058)
@@ -53,12 +53,8 @@
         entity.hpp
         elevator.hpp
         elevator.cpp
+        field.hpp
         font_effect.hpp
-        inventory.cpp
-        inventory.hpp
-        ttf_font.cpp
-        ttf_font.hpp
-        field.hpp
         fonts.cpp
         fonts.hpp
         gameconfig.hpp
@@ -71,6 +67,10 @@
         globals.hpp
         graphic_context_state.cpp
         graphic_context_state.hpp
+        grenade.cpp
+        grenade.hpp
+        inventory.cpp
+        inventory.hpp        
         laser_pointer.hpp
         laser_pointer.cpp
         math.hpp
@@ -113,6 +113,8 @@
         timer.cpp
         trigger.cpp
         trigger.hpp
+        ttf_font.cpp
+        ttf_font.hpp        
         util.cpp
         util.hpp
         view.cpp

Added: trunk/src/grenade.cpp
===================================================================
--- trunk/src/grenade.cpp	2005-09-03 02:45:30 UTC (rev 1057)
+++ trunk/src/grenade.cpp	2005-09-03 13:50:24 UTC (rev 1058)
@@ -0,0 +1,63 @@
+/*  $Id$
+**   __      __ __             ___        __   __ __   __
+**  /  \    /  \__| ____    __| _/_______/  |_|__|  | |  |   ____
+**  \   \/\/   /  |/    \  / __ |/  ___/\   __\  |  | |  | _/ __ \
+**   \        /|  |   |  \/ /_/ |\___ \  |  | |  |  |_|  |_\  ___/
+**    \__/\  / |__|___|  /\____ /____  > |__| |__|____/____/\___  >
+**         \/          \/      \/    \/                         \/
+**  Copyright (C) 2005 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software; you can redistribute it and/or
+**  modify it under the terms of the GNU General Public License
+**  as published by the Free Software Foundation; either version 2
+**  of the License, or (at your option) any later version.
+**
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+** 
+**  You should have received a copy of the GNU General Public License
+**  along with this program; if not, write to the Free Software
+**  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+**  02111-1307, USA.
+*/
+#include <config.h>
+
+#include "grenade.hpp"
+#include "sector.hpp"
+#include "collision/collision_engine.hpp"
+
+Grenade::Grenade()
+  : sprite("3dsprites/grenade.wsprite"), physics(this)
+{
+  c_object.reset(new CollisionObject(this, Rectf(0, 0, 32, 32)));
+  physics.register_collobj(*c_object);
+
+  Sector::current()->get_collision_engine()->add(c_object.get());
+}
+
+Grenade::~Grenade()
+{
+}
+
+void
+Grenade::draw(SceneContext& sc)
+{
+  sprite.draw(sc.color(), pos, 0);
+}
+
+void
+Grenade::update(float elapsed_time)
+{
+  sprite.update(elapsed_time);
+  physics.update(elapsed_time);
+  c_object->set_pos(pos);
+  c_object->set_velocity(velocity);
+}
+
+void
+Grenade::set_velocity(const Vector& velocity)
+{
+  this->velocity = velocity;
+}

Added: trunk/src/grenade.hpp
===================================================================
--- trunk/src/grenade.hpp	2005-09-03 02:45:30 UTC (rev 1057)
+++ trunk/src/grenade.hpp	2005-09-03 13:50:24 UTC (rev 1058)
@@ -0,0 +1,50 @@
+/*  $Id$
+**   __      __ __             ___        __   __ __   __
+**  /  \    /  \__| ____    __| _/_______/  |_|__|  | |  |   ____
+**  \   \/\/   /  |/    \  / __ |/  ___/\   __\  |  | |  | _/ __ \
+**   \        /|  |   |  \/ /_/ |\___ \  |  | |  |  |_|  |_\  ___/
+**    \__/\  / |__|___|  /\____ /____  > |__| |__|____/____/\___  >
+**         \/          \/      \/    \/                         \/
+**  Copyright (C) 2005 Matthias Braun <matze at braunis.de>
+**
+**  This program is free software; you can redistribute it and/or
+**  modify it under the terms of the GNU General Public License
+**  as published by the Free Software Foundation; either version 2
+**  of the License, or (at your option) any later version.
+**
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+** 
+**  You should have received a copy of the GNU General Public License
+**  along with this program; if not, write to the Free Software
+**  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+**  02111-1307, USA.
+*/
+#ifndef __GRENADE_HPP__
+#define __GRENADE_HPP__
+
+#include "entity.hpp"
+#include "physics.hpp"
+#include "sprite3d/sprite3d.hpp"
+#include <memory>
+
+class Grenade : public Entity
+{
+public:
+  Grenade();
+  virtual ~Grenade();
+
+  void draw(SceneContext& sc);
+  void update(float delta);
+  void set_velocity(const Vector& vel);
+
+private:
+  Sprite3D sprite;
+  Physics physics;
+  std::auto_ptr<CollisionObject> c_object;
+};
+
+#endif
+

Modified: trunk/src/physics.cpp
===================================================================
--- trunk/src/physics.cpp	2005-09-03 02:45:30 UTC (rev 1057)
+++ trunk/src/physics.cpp	2005-09-03 13:50:24 UTC (rev 1058)
@@ -18,19 +18,24 @@
 void
 Physics::register_collobj(CollisionObject& object)
 {
+  printf("RegisterObject: %p\n", &object);
   slots.push_back(object.sig_collision().connect(this, &Physics::collision));
 }
 
 void
 Physics::collision(const CollisionData& data)
 {
+  printf("collision %p - %p\n", data.object1, data.object2);
   GameObject* other_object = data.object2->get_game_object();
+  
+  // XXX just for testing, to avoid all the collisions
+  data.object1->set_velocity(data.object1->get_velocity() * -1);
+  //data.object2->set_velocity(data.object2->get_velocity() * -1);
   if(other_object == 0)
     return;
+  
+  return;
 
-  data.object1->set_velocity(Vector(0, 0));
-  data.object2->set_velocity(Vector(0, 0));
-
   const Physics* physics = dynamic_cast<const Physics*> (other_object);
   if(physics)
   {
@@ -89,6 +94,7 @@
   
   Vector acceleration = force / mass;
   velocity() += acceleration * elapsed_time;
+  pos() += velocity() * elapsed_time;
 
   force = Vector(0, 0);
 }

Modified: trunk/src/player.cpp
===================================================================
--- trunk/src/player.cpp	2005-09-03 02:45:30 UTC (rev 1057)
+++ trunk/src/player.cpp	2005-09-03 13:50:24 UTC (rev 1058)
@@ -35,6 +35,7 @@
 #include "collision/stair_contact.hpp"
 #include "game_session.hpp"
 #include "console.hpp"
+#include "grenade.hpp"
 
 static const int MAX_ENERGY = 16;
 static const float WALK_SPEED = 128.0;
@@ -338,6 +339,12 @@
     } 
   else if (controller.button_was_pressed(AIM_BUTTON))
     {
+      // TODO remove me later, just here for testing
+      Grenade* grenade = new Grenade();
+      grenade->set_pos(get_pos() + Vector(50, -300));
+      grenade->set_velocity(Vector(20, -10));
+      Sector::current()->add(grenade);
+      
       sprite.set_action("PullGun");
       state = PULL_GUN;
     }

Modified: trunk/src/screen.hpp
===================================================================
--- trunk/src/screen.hpp	2005-09-03 02:45:30 UTC (rev 1057)
+++ trunk/src/screen.hpp	2005-09-03 13:50:24 UTC (rev 1058)
@@ -40,7 +40,7 @@
   virtual void update(float delta, const Controller& controller) =0;
 
   /** Called once a new SDL_Event arrives */
-  virtual void handle_event(const SDL_Event& event) {}
+  virtual void handle_event(const SDL_Event& ) {}
 };
 
 #endif

Modified: trunk/src/scripting/wrapper.cpp
===================================================================
--- trunk/src/scripting/wrapper.cpp	2005-09-03 02:45:30 UTC (rev 1057)
+++ trunk/src/scripting/wrapper.cpp	2005-09-03 13:50:24 UTC (rev 1058)
@@ -1,6 +1,6 @@
 /**
  * WARNING: This file is automatically generated from:
- *  'scripting/wrapper.interface.hpp'
+ *  'src/scripting/wrapper.interface.hpp'
  * DO NOT CHANGE
  */
 #include <config.h>

Modified: trunk/src/scripting/wrapper.hpp
===================================================================
--- trunk/src/scripting/wrapper.hpp	2005-09-03 02:45:30 UTC (rev 1057)
+++ trunk/src/scripting/wrapper.hpp	2005-09-03 13:50:24 UTC (rev 1058)
@@ -1,6 +1,6 @@
 /**
  * WARNING: This file is automatically generated from:
- *  'scripting/wrapper.interface.hpp'
+ *  'src/scripting/wrapper.interface.hpp'
  * DO NOT CHANGE
  */
 #ifndef __windstille_WRAPPER_H__



From matzebraun at berlios.de  Tue Sep  6 23:16:25 2005
From: matzebraun at berlios.de (Matthias Braun at BerliOS)
Date: Tue, 6 Sep 2005 23:16:25 +0200
Subject: [Windstille-commit] r1059 - trunk
Message-ID: <200509062116.j86LGPes025180@sheep.berlios.de>

Author: matzebraun
Date: 2005-09-06 23:16:24 +0200 (Tue, 06 Sep 2005)
New Revision: 1059

Modified:
   trunk/configure.ac
Log:
fix for broken physfs 1.1.0 header

Modified: trunk/configure.ac
===================================================================
--- trunk/configure.ac	2005-09-03 13:50:24 UTC (rev 1058)
+++ trunk/configure.ac	2005-09-06 21:16:24 UTC (rev 1059)
@@ -135,7 +135,9 @@
 AC_CHECK_FT2(,,AC_MSG_ERROR([Please install freetype2]))
 
 NP_FINDLIB([PHYSFS], [physfs], [physfs >= 1.0.0],
-        NP_LANG_PROGRAM([#include <physfs.h>
+        NP_LANG_PROGRAM([
+#include <stdio.h>
+#include <physfs.h>
 #if PHYSFS_VER_MAJOR < 1
 # error PHYSFS is too old
 #endif]),



From matzebraun at berlios.de  Tue Sep  6 23:30:14 2005
From: matzebraun at berlios.de (Matthias Braun at BerliOS)
Date: Tue, 6 Sep 2005 23:30:14 +0200
Subject: [Windstille-commit] r1060 - trunk/src/physfs
Message-ID: <200509062130.j86LUEcL025931@sheep.berlios.de>

Author: matzebraun
Date: 2005-09-06 23:30:10 +0200 (Tue, 06 Sep 2005)
New Revision: 1060

Modified:
   trunk/src/physfs/physfs_stream.hpp
Log:
fix for physfs 1.1.0

Modified: trunk/src/physfs/physfs_stream.hpp
===================================================================
--- trunk/src/physfs/physfs_stream.hpp	2005-09-06 21:16:24 UTC (rev 1059)
+++ trunk/src/physfs/physfs_stream.hpp	2005-09-06 21:30:10 UTC (rev 1060)
@@ -18,6 +18,7 @@
 #ifndef __PHYSFSSTREAM_HPP__
 #define __PHYSFSSTREAM_HPP__
 
+#include <stdio.h>
 #include <physfs.h>
 #include <string>
 #include <streambuf>



From matzebraun at berlios.de  Tue Sep  6 23:32:24 2005
From: matzebraun at berlios.de (Matthias Braun at BerliOS)
Date: Tue, 6 Sep 2005 23:32:24 +0200
Subject: [Windstille-commit] r1061 - trunk/src
Message-ID: <200509062132.j86LWOtT025993@sheep.berlios.de>

Author: matzebraun
Date: 2005-09-06 23:32:23 +0200 (Tue, 06 Sep 2005)
New Revision: 1061

Modified:
   trunk/src/windstille_main.cpp
Log:
another one

Modified: trunk/src/windstille_main.cpp
===================================================================
--- trunk/src/windstille_main.cpp	2005-09-06 21:30:10 UTC (rev 1060)
+++ trunk/src/windstille_main.cpp	2005-09-06 21:32:23 UTC (rev 1061)
@@ -22,7 +22,9 @@
 **  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
 **  02111-1307, USA.
 */
+#include <config.h>
 
+#include <stdio.h>
 #include <physfs.h>
 
 #include "globals.hpp"



From grumbel at berlios.de  Sun Sep 11 02:13:44 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Sun, 11 Sep 2005 02:13:44 +0200
Subject: [Windstille-commit] r1062 - in trunk/data/images: . objects tiles
Message-ID: <200509110013.j8B0DioN019956@sheep.berlios.de>

Author: grumbel
Date: 2005-09-11 02:12:32 +0200 (Sun, 11 Sep 2005)
New Revision: 1062

Added:
   trunk/data/images/cryo.xcf
   trunk/data/images/gun.xcf
   trunk/data/images/objects/blackboard.xcf
   trunk/data/images/objects/door1.xcf
   trunk/data/images/objects/door1_bg.xcf
   trunk/data/images/objects/subway.xcf
   trunk/data/images/plasmagranate.xcf
   trunk/data/images/rifle.xcf
   trunk/data/images/satchel.xcf
   trunk/data/images/sketchmu.xcf
   trunk/data/images/stairs.xcf
   trunk/data/images/stuff.xcf
   trunk/data/images/tiles/workerwall.xcf
   trunk/data/images/windstille-logosmall.xcf
Modified:
   trunk/data/images/flashlighthighlight.sprite
   trunk/data/images/flashlightlight.sprite
   trunk/data/images/laserpointer.png
   trunk/data/images/laserpointer.sprite
   trunk/data/images/noise2.png
   trunk/data/images/objects/apartmentlamp_light.png
   trunk/data/images/objects/apartmentlamp_light.sprite
   trunk/data/images/tiles/apartment-foreground.png
Log:
- some new images

Added: trunk/data/images/cryo.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/cryo.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/data/images/flashlighthighlight.sprite
===================================================================
--- trunk/data/images/flashlighthighlight.sprite	2005-09-06 21:32:23 UTC (rev 1061)
+++ trunk/data/images/flashlighthighlight.sprite	2005-09-11 00:12:32 UTC (rev 1062)
@@ -3,6 +3,6 @@
     (name "default")
     (images "flashlighthighlight.png")
     (offset 0 -128)
-        
+    (scale 1.5)
   )
 )

Modified: trunk/data/images/flashlightlight.sprite
===================================================================
--- trunk/data/images/flashlightlight.sprite	2005-09-06 21:32:23 UTC (rev 1061)
+++ trunk/data/images/flashlightlight.sprite	2005-09-11 00:12:32 UTC (rev 1062)
@@ -3,6 +3,6 @@
     (name "default")
     (images "flashlightlight.png")
     (offset 0 -128)
-        
+    (scale 2.0)        
   )
 )

Added: trunk/data/images/gun.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/gun.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/data/images/laserpointer.png
===================================================================
(Binary files differ)

Modified: trunk/data/images/laserpointer.sprite
===================================================================
--- trunk/data/images/laserpointer.sprite	2005-09-06 21:32:23 UTC (rev 1061)
+++ trunk/data/images/laserpointer.sprite	2005-09-11 00:12:32 UTC (rev 1062)
@@ -2,6 +2,6 @@
   (action
     (name "default")
     (images "laserpointer.png")
-    (offset -7 -7)
+    (offset -4 -4)
   )
 )

Modified: trunk/data/images/noise2.png
===================================================================
(Binary files differ)

Modified: trunk/data/images/objects/apartmentlamp_light.png
===================================================================
(Binary files differ)

Modified: trunk/data/images/objects/apartmentlamp_light.sprite
===================================================================
--- trunk/data/images/objects/apartmentlamp_light.sprite	2005-09-06 21:32:23 UTC (rev 1061)
+++ trunk/data/images/objects/apartmentlamp_light.sprite	2005-09-11 00:12:32 UTC (rev 1062)
@@ -2,6 +2,6 @@
   (action
     (name "default")
     (images "apartmentlamp_light.png")
-    (offset -400 -90)
+    (offset -400 -100)
   )
 )

Added: trunk/data/images/objects/blackboard.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/blackboard.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/door1.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/door1.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/door1_bg.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/door1_bg.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/subway.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/subway.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/plasmagranate.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/plasmagranate.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/rifle.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/rifle.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/satchel.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/satchel.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/sketchmu.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/sketchmu.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/stairs.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/stairs.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/stuff.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/stuff.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/data/images/tiles/apartment-foreground.png
===================================================================
(Binary files differ)

Added: trunk/data/images/tiles/workerwall.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/tiles/workerwall.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/windstille-logosmall.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/windstille-logosmall.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From grumbel at berlios.de  Sun Sep 11 03:12:19 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Sun, 11 Sep 2005 03:12:19 +0200
Subject: [Windstille-commit] r1063 - trunk/data/images/objects
Message-ID: <200509110112.j8B1CJEd024453@sheep.berlios.de>

Author: grumbel
Date: 2005-09-11 03:11:46 +0200 (Sun, 11 Sep 2005)
New Revision: 1063

Added:
   trunk/data/images/objects/terminal.xcf
   trunk/data/images/objects/terminal_broken.xcf
Log:
- some new images

Added: trunk/data/images/objects/terminal.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/terminal.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/terminal_broken.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/terminal_broken.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From grumbel at berlios.de  Sun Sep 11 04:04:31 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Sun, 11 Sep 2005 04:04:31 +0200
Subject: [Windstille-commit] r1064 - trunk/data/images/objects
Message-ID: <200509110204.j8B24Vsi003491@sheep.berlios.de>

Author: grumbel
Date: 2005-09-11 04:03:54 +0200 (Sun, 11 Sep 2005)
New Revision: 1064

Added:
   trunk/data/images/objects/bed.xcf
Log:
- some new images

Added: trunk/data/images/objects/bed.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/bed.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From grumbel at berlios.de  Sun Sep 11 04:27:02 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Sun, 11 Sep 2005 04:27:02 +0200
Subject: [Windstille-commit] r1065 - trunk/data/images/objects
Message-ID: <200509110227.j8B2R2vS029432@sheep.berlios.de>

Author: grumbel
Date: 2005-09-11 04:26:44 +0200 (Sun, 11 Sep 2005)
New Revision: 1065

Added:
   trunk/data/images/objects/locker.xcf
Log:
- some new images

Added: trunk/data/images/objects/locker.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/locker.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From grumbel at berlios.de  Sun Sep 11 04:56:51 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Sun, 11 Sep 2005 04:56:51 +0200
Subject: [Windstille-commit] r1066 - trunk/data/images/tiles
Message-ID: <200509110256.j8B2upQh002646@sheep.berlios.de>

Author: grumbel
Date: 2005-09-11 04:56:37 +0200 (Sun, 11 Sep 2005)
New Revision: 1066

Added:
   trunk/data/images/tiles/workerapartment.xcf
Log:
- some new images

Added: trunk/data/images/tiles/workerapartment.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/tiles/workerapartment.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From grumbel at berlios.de  Sun Sep 11 20:55:16 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Sun, 11 Sep 2005 20:55:16 +0200
Subject: [Windstille-commit] r1067 - trunk/data/images/objects
Message-ID: <200509111855.j8BItG01012562@sheep.berlios.de>

Author: grumbel
Date: 2005-09-11 20:55:15 +0200 (Sun, 11 Sep 2005)
New Revision: 1067

Added:
   trunk/data/images/objects/northernstar.svg
   trunk/data/images/objects/northernstarjoinnow.png
   trunk/data/images/objects/northernstarjoinnow.xcf
Modified:
   trunk/data/images/objects/door1.xcf
Log:
- some new images

Modified: trunk/data/images/objects/door1.xcf
===================================================================
(Binary files differ)

Added: trunk/data/images/objects/northernstar.svg
===================================================================
--- trunk/data/images/objects/northernstar.svg	2005-09-11 02:56:37 UTC (rev 1066)
+++ trunk/data/images/objects/northernstar.svg	2005-09-11 18:55:15 UTC (rev 1067)
@@ -0,0 +1,122 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no"?>
+<!-- Created with Inkscape (http://www.inkscape.org/) -->
+<svg
+   xmlns:dc="http://purl.org/dc/elements/1.1/"
+   xmlns:cc="http://web.resource.org/cc/"
+   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
+   xmlns:svg="http://www.w3.org/2000/svg"
+   xmlns="http://www.w3.org/2000/svg"
+   xmlns:sodipodi="http://inkscape.sourceforge.net/DTD/sodipodi-0.dtd"
+   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
+   width="744.09448819"
+   height="1052.3622047"
+   id="svg2"
+   sodipodi:version="0.32"
+   inkscape:version="0.42.2"
+   sodipodi:docbase="/home/ingo/projects/windstille/trunk/data/images"
+   sodipodi:docname="northernstar.svg"
+   inkscape:export-filename="/tmp/northernstar.png"
+   inkscape:export-xdpi="75.000000"
+   inkscape:export-ydpi="75.000000">
+  <defs
+     id="defs4" />
+  <sodipodi:namedview
+     id="base"
+     pagecolor="#ffffff"
+     bordercolor="#666666"
+     borderopacity="1.0"
+     inkscape:pageopacity="0.0"
+     inkscape:pageshadow="2"
+     inkscape:zoom="0.42958766"
+     inkscape:cx="602.80110"
+     inkscape:cy="562.18938"
+     inkscape:document-units="px"
+     inkscape:current-layer="layer1"
+     showguides="true"
+     inkscape:guide-bbox="true"
+     inkscape:window-width="1150"
+     inkscape:window-height="791"
+     inkscape:window-x="0"
+     inkscape:window-y="26" />
+  <metadata
+     id="metadata7">
+    <rdf:RDF>
+      <cc:Work
+         rdf:about="">
+        <dc:format>image/svg+xml</dc:format>
+        <dc:type
+           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
+      </cc:Work>
+    </rdf:RDF>
+  </metadata>
+  <g
+     inkscape:label="Layer 1"
+     inkscape:groupmode="layer"
+     id="layer1">
+    <path
+       d="M 581.09836 487.01175 A 365.35181 365.35181 0 1 1  -149.60526,487.01175 A 365.35181 365.35181 0 1 1  581.09836 487.01175 z"
+       sodipodi:ry="365.35181"
+       sodipodi:rx="365.35181"
+       sodipodi:cy="487.01175"
+       sodipodi:cx="215.74655"
+       id="path2063"
+       style="fill:#00429b;fill-opacity:1.0000000;stroke:#5881ff;stroke-width:8.8496907;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4.0000000;stroke-dasharray:none;stroke-opacity:1.0000000"
+       sodipodi:type="arc"
+       transform="matrix(1.129983,0.000000,0.000000,1.129983,11.25825,-63.30301)" />
+    <path
+       sodipodi:type="arc"
+       style="fill:#ffffff;fill-opacity:1.0000000;stroke:none;stroke-width:1.9119999;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4.0000000;stroke-dasharray:none;stroke-opacity:0.85628742"
+       id="path1329"
+       sodipodi:cx="215.74655"
+       sodipodi:cy="487.01175"
+       sodipodi:rx="365.35181"
+       sodipodi:ry="365.35181"
+       d="M 581.09836 487.01175 A 365.35181 365.35181 0 1 1  -149.60526,487.01175 A 365.35181 365.35181 0 1 1  581.09836 487.01175 z" />
+    <path
+       style="fill:#ffff70;fill-opacity:1.0000000;stroke:#838100;stroke-width:10.612000;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4.0000000;stroke-dasharray:none;stroke-opacity:1.0000000"
+       d="M 109.27447,43.809561 L 64.473855,456.97746 L -333.31314,494.49262 L 64.473855,550.95117 L 105.15705,1012.3576 L 151.55215,550.95117 L 1111.2378,494.49262 L 151.55215,456.97746 L 109.27447,43.809561 z "
+       id="path1318"
+       sodipodi:nodetypes="ccccccccc" />
+    <path
+       sodipodi:type="arc"
+       style="fill:#f7ff7c;fill-opacity:1.0000000;stroke:#4e4d21;stroke-width:20.209757;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4.0000000;stroke-dasharray:none;stroke-opacity:0.73214287"
+       id="path2079"
+       sodipodi:cx="109.40724"
+       sodipodi:cy="493.68692"
+       sodipodi:rx="200.19197"
+       sodipodi:ry="200.19197"
+       d="M 309.59921 493.68692 A 200.19197 200.19197 0 1 1  -90.784729,493.68692 A 200.19197 200.19197 0 1 1  309.59921 493.68692 z"
+       transform="matrix(0.742216,0.000000,0.000000,0.742216,25.36846,132.9347)" />
+    <text
+       xml:space="preserve"
+       style="font-size:238.37126;font-style:oblique;font-variant:normal;font-weight:bold;font-stretch:normal;text-align:start;line-height:124.99997%;writing-mode:lr;text-anchor:start;fill-opacity:1.0000000;stroke:#000000;stroke-width:9.9999979;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1.0000000;font-family:Bitstream Vera Sans Mono;stroke-miterlimit:4.0000000;stroke-dasharray:none;fill:#b0c4ff"
+       x="-200.99107"
+       y="418.77078"
+       id="text1310"
+       sodipodi:linespacing="125%"
+       transform="scale(0.908193,1.101088)"><tspan
+         sodipodi:role="line"
+         id="tspan1312"
+         x="-200.99107"
+         y="418.77078"
+         style="fill-opacity:1.0000000;fill:#b0c4ff;stroke-width:9.9999979;stroke-miterlimit:4.0000000;stroke-dasharray:none;font-family:Bitstream Vera Sans Mono;font-weight:bold;font-style:oblique;font-stretch:normal;font-variant:normal;font-size:238.37126;text-anchor:start;text-align:start;writing-mode:lr;line-height:124.99997%">Northern</tspan><tspan
+         sodipodi:role="line"
+         x="-200.99107"
+         y="716.73477"
+         id="tspan1314"
+         style="fill-opacity:1.0000000;fill:#b0c4ff;stroke-width:9.9999979;stroke-miterlimit:4.0000000;stroke-dasharray:none;font-family:Bitstream Vera Sans Mono;font-weight:bold;font-style:oblique;font-stretch:normal;font-variant:normal;font-size:238.37126;text-anchor:start;text-align:start;writing-mode:lr;line-height:124.99997%"></tspan></text>
+    <text
+       transform="scale(0.908193,1.101088)"
+       sodipodi:linespacing="125.00000%"
+       id="text2057"
+       y="697.38251"
+       x="-208.92873"
+       style="font-size:332.15982px;font-style:oblique;font-variant:normal;font-weight:bold;font-stretch:normal;text-align:start;line-height:125.00000%;writing-mode:lr-tb;text-anchor:start;fill:#b0c4ff;fill-opacity:1.0000000;stroke:#000000;stroke-width:10.000004;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4.0000000;stroke-dasharray:none;stroke-opacity:1.0000000;font-family:Bitstream Vera Sans"
+       xml:space="preserve"><tspan
+         id="tspan2061"
+         y="697.38251"
+         x="-208.92873"
+         sodipodi:role="line"
+         style="font-size:332.15982px;font-style:oblique;font-variant:normal;font-weight:bold;font-stretch:normal;text-align:start;line-height:124.99996%;writing-mode:lr-tb;text-anchor:start;fill:#b0c4ff;fill-opacity:1.0000000;stroke-width:10.000004;stroke-miterlimit:4.0000000;stroke-dasharray:none;font-family:Bitstream Vera Sans">Star</tspan></text>
+  </g>
+</svg>

Added: trunk/data/images/objects/northernstarjoinnow.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/northernstarjoinnow.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/northernstarjoinnow.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/northernstarjoinnow.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From grumbel at berlios.de  Sun Sep 11 23:20:17 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Sun, 11 Sep 2005 23:20:17 +0200
Subject: [Windstille-commit] r1068 - trunk/data/images/objects
Message-ID: <200509112120.j8BLKH06023491@sheep.berlios.de>

Author: grumbel
Date: 2005-09-11 23:20:16 +0200 (Sun, 11 Sep 2005)
New Revision: 1068

Added:
   trunk/data/images/objects/cabinet2.xcf
   trunk/data/images/objects/elevatordoor.png
   trunk/data/images/objects/elevatordoor_left.png
   trunk/data/images/objects/elevatordoor_right.png
   trunk/data/images/objects/objects.xcf
Log:
- some new images

Added: trunk/data/images/objects/cabinet2.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/cabinet2.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/elevatordoor.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/elevatordoor.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/elevatordoor_left.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/elevatordoor_left.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/elevatordoor_right.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/elevatordoor_right.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/objects.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/objects.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From grumbel at berlios.de  Mon Sep 12 16:08:45 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Mon, 12 Sep 2005 16:08:45 +0200
Subject: [Windstille-commit] r1069 - trunk/data/images/objects
Message-ID: <200509121408.j8CE8iDH018880@sheep.berlios.de>

Author: grumbel
Date: 2005-09-12 16:08:43 +0200 (Mon, 12 Sep 2005)
New Revision: 1069

Added:
   trunk/data/images/objects/barstool.xcf
   trunk/data/images/objects/bobsbar.xcf
   trunk/data/images/objects/woodendoor.xcf
Log:
- some new images

Added: trunk/data/images/objects/barstool.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/barstool.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/bobsbar.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/bobsbar.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/woodendoor.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/woodendoor.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From grumbel at berlios.de  Mon Sep 12 23:18:56 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Mon, 12 Sep 2005 23:18:56 +0200
Subject: [Windstille-commit] r1070 - trunk/data/images/objects
Message-ID: <200509122118.j8CLIu6O013583@sheep.berlios.de>

Author: grumbel
Date: 2005-09-12 23:18:55 +0200 (Mon, 12 Sep 2005)
New Revision: 1070

Added:
   trunk/data/images/objects/doorborder.xcf
   trunk/data/images/objects/rooflamp.xcf
   trunk/data/images/objects/shelf.xcf
Modified:
   trunk/data/images/objects/objects.xcf
Log:
- some new images

Added: trunk/data/images/objects/doorborder.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/doorborder.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/data/images/objects/objects.xcf
===================================================================
(Binary files differ)

Added: trunk/data/images/objects/rooflamp.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/rooflamp.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/shelf.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/shelf.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From grumbel at berlios.de  Wed Sep 14 14:52:40 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Wed, 14 Sep 2005 14:52:40 +0200
Subject: [Windstille-commit] r1071 - trunk/data/images/tiles
Message-ID: <200509141252.j8ECqeFS028115@sheep.berlios.de>

Author: grumbel
Date: 2005-09-14 14:52:38 +0200 (Wed, 14 Sep 2005)
New Revision: 1071

Added:
   trunk/data/images/tiles/bar.xcf
Modified:
   trunk/data/images/tiles/workerapartment.xcf
Log:
- some new images

Added: trunk/data/images/tiles/bar.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/tiles/bar.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/data/images/tiles/workerapartment.xcf
===================================================================
(Binary files differ)



From grumbel at berlios.de  Wed Sep 14 14:54:11 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Wed, 14 Sep 2005 14:54:11 +0200
Subject: [Windstille-commit] r1072 - trunk/data/images/objects
Message-ID: <200509141254.j8ECsB7t028212@sheep.berlios.de>

Author: grumbel
Date: 2005-09-14 14:54:08 +0200 (Wed, 14 Sep 2005)
New Revision: 1072

Added:
   trunk/data/images/objects/shelf2.xcf
   trunk/data/images/objects/woodendoor2.xcf
Log:
- some new images

Added: trunk/data/images/objects/shelf2.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/shelf2.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/images/objects/woodendoor2.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/woodendoor2.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From grumbel at berlios.de  Fri Sep 16 22:03:55 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Fri, 16 Sep 2005 22:03:55 +0200
Subject: [Windstille-commit] r1073 - trunk/src
Message-ID: <200509162003.j8GK3tVY004677@sheep.berlios.de>

Author: grumbel
Date: 2005-09-16 22:03:54 +0200 (Fri, 16 Sep 2005)
New Revision: 1073

Modified:
   trunk/src/tile_factory.cpp
Log:
- little fix in size handling

Modified: trunk/src/tile_factory.cpp
===================================================================
--- trunk/src/tile_factory.cpp	2005-09-14 12:54:08 UTC (rev 1072)
+++ trunk/src/tile_factory.cpp	2005-09-16 20:03:54 UTC (rev 1073)
@@ -133,7 +133,7 @@
     }
  
   try {
-    int num_tiles = (image->w/TILE_RESOLUTION) * (image->h/TILE_RESOLUTION);
+    int num_tiles = width * height; //(image->w/TILE_RESOLUTION) * (image->h/TILE_RESOLUTION);
     if (int(colmap.size()) != num_tiles)
       {
         std::ostringstream str;
@@ -151,9 +151,9 @@
       }
     
     int i = 0;
-    for (int y = 0; y < image->h; y += TILE_RESOLUTION)
+    for (int y = 0; y < height*TILE_RESOLUTION; y += TILE_RESOLUTION)
       {
-        for (int x = 0; x < image->w; x += TILE_RESOLUTION)
+        for (int x = 0; x < width*TILE_RESOLUTION; x += TILE_RESOLUTION)
           {
             int id = ids[i];
             int collider = colmap[i];
@@ -163,7 +163,7 @@
             if(id < (int) tiles.size() && tiles[id] != 0)
               {
                 std::ostringstream msg;
-                msg << "Dusplicate tile id: " << id;
+                msg << "Duplicate tile id: " << filename << " " << id;
                 throw std::runtime_error(msg.str());
               } 
             if (id >= int(tiles.size()))



From grumbel at berlios.de  Fri Sep 16 22:04:35 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Fri, 16 Sep 2005 22:04:35 +0200
Subject: [Windstille-commit] r1074 - trunk/src/particles
Message-ID: <200509162004.j8GK4ZKf004760@sheep.berlios.de>

Author: grumbel
Date: 2005-09-16 22:04:33 +0200 (Fri, 16 Sep 2005)
New Revision: 1074

Modified:
   trunk/src/particles/particle_system.cpp
   trunk/src/particles/particle_system.hpp
Log:
- removed spawnpoint and replaced it by pos, no need to have both

Modified: trunk/src/particles/particle_system.cpp
===================================================================
--- trunk/src/particles/particle_system.cpp	2005-09-16 20:03:54 UTC (rev 1073)
+++ trunk/src/particles/particle_system.cpp	2005-09-16 20:04:33 UTC (rev 1074)
@@ -86,10 +86,6 @@
   if (props.get("cycles",  p_cycles))
     set_cycles(p_cycles);
 
-  Vector p_spawn_point;
-  if (props.get("spawn-point", p_spawn_point))
-    set_spawn_point(p_spawn_point.x, p_spawn_point.y);
-
   Vector p_pos;
   if (props.get("pos", p_pos))
     set_pos(p_pos.x, p_pos.y);
@@ -253,8 +249,8 @@
 {
   randomizer->set_pos(particle);
 
-  particle.x   += (parent ? parent->get_pos().x : 0) + spawn_x_pos;
-  particle.y   += (parent ? parent->get_pos().y : 0) + spawn_y_pos;
+  particle.x   += (parent ? parent->get_pos().x : 0) + x_pos;
+  particle.y   += (parent ? parent->get_pos().y : 0) + y_pos;
 
   float direction = rnd.drand(cone_start, cone_stop);
   float speed     = rnd.drand(speed_start, speed_stop);
@@ -321,13 +317,6 @@
 }
 
 void
-ParticleSystem::set_spawn_point(float x, float y)
-{
-  spawn_x_pos = x;
-  spawn_y_pos = y;
-}
-
-void
 ParticleSystem::set_point_distribution()
 {
   delete randomizer;

Modified: trunk/src/particles/particle_system.hpp
===================================================================
--- trunk/src/particles/particle_system.hpp	2005-09-16 20:03:54 UTC (rev 1073)
+++ trunk/src/particles/particle_system.hpp	2005-09-16 20:04:33 UTC (rev 1074)
@@ -70,9 +70,6 @@
   float y_pos;
   float z_pos;
 
-  float spawn_x_pos;
-  float spawn_y_pos;
-
   float gravity_x;
   float gravity_y;
   
@@ -123,8 +120,6 @@
 
   /** The position from which the particles spawn, x,y are in world
       coordinates */
-  void set_spawn_point(float x, float y);
-
   void set_pos(float x, float y);
   
   /** Causes all particles to spawn from a single point */



From grumbel at berlios.de  Fri Sep 16 22:05:08 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Fri, 16 Sep 2005 22:05:08 +0200
Subject: [Windstille-commit] r1075 - trunk/src
Message-ID: <200509162005.j8GK58Ec004824@sheep.berlios.de>

Author: grumbel
Date: 2005-09-16 22:05:04 +0200 (Fri, 16 Sep 2005)
New Revision: 1075

Modified:
   trunk/src/character.cpp
Log:
zpos support

Modified: trunk/src/character.cpp
===================================================================
--- trunk/src/character.cpp	2005-09-16 20:04:33 UTC (rev 1074)
+++ trunk/src/character.cpp	2005-09-16 20:05:04 UTC (rev 1075)
@@ -37,6 +37,7 @@
 {
   set_useable(true);
   use_verb = "Talk";
+  z_pos = 100.0f;
 
   std::string sprite3d_filename = "3dsprites/heroken.wsprite";
   std::string action_name;
@@ -44,6 +45,7 @@
   lisp::Properties props(lisp);
   props.get("name", name);
   props.get("pos", pos);
+  props.get("z-pos", z_pos);
   props.get("sprite3d", sprite3d_filename);
   props.get("action", action_name);
   props.print_unused_warnings("character");
@@ -67,7 +69,7 @@
 void
 Character::draw (SceneContext& sc)
 {
-  sprite.draw(sc.color(), pos, 100);
+  sprite.draw(sc.color(), pos, z_pos);
 }
 
 void



From grumbel at berlios.de  Fri Sep 16 22:06:47 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Fri, 16 Sep 2005 22:06:47 +0200
Subject: [Windstille-commit] r1077 - trunk/src
Message-ID: <200509162006.j8GK6l8R005018@sheep.berlios.de>

Author: grumbel
Date: 2005-09-16 22:06:46 +0200 (Fri, 16 Sep 2005)
New Revision: 1077

Modified:
   trunk/src/character.hpp
Log:
zpos support

Modified: trunk/src/character.hpp
===================================================================
--- trunk/src/character.hpp	2005-09-16 20:05:58 UTC (rev 1076)
+++ trunk/src/character.hpp	2005-09-16 20:06:46 UTC (rev 1077)
@@ -28,6 +28,7 @@
 {
 private:
   Sprite3D sprite;
+  float z_pos;
     
 public:
   Character(const lisp::Lisp* lisp);



From grumbel at berlios.de  Fri Sep 16 22:05:59 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Fri, 16 Sep 2005 22:05:59 +0200
Subject: [Windstille-commit] r1076 - trunk/src
Message-ID: <200509162005.j8GK5xbB004935@sheep.berlios.de>

Author: grumbel
Date: 2005-09-16 22:05:58 +0200 (Fri, 16 Sep 2005)
New Revision: 1076

Modified:
   trunk/src/player.cpp
Log:
- some more tollerance for the object using (more temporary hack then a fix)

Modified: trunk/src/player.cpp
===================================================================
--- trunk/src/player.cpp	2005-09-16 20:05:04 UTC (rev 1075)
+++ trunk/src/player.cpp	2005-09-16 20:05:58 UTC (rev 1076)
@@ -311,7 +311,7 @@
         {
           //FIXME use proper collision detection
           if (object->get_pos().x > pos.x - 32 && object->get_pos().x < pos.x + 32
-              && object->get_pos().y > pos.y - 128 && object->get_pos().y < pos.y + 32)
+              && object->get_pos().y > pos.y - 256 && object->get_pos().y < pos.y + 256)
             {
               return object;
             }



From grumbel at berlios.de  Fri Sep 16 22:07:26 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Fri, 16 Sep 2005 22:07:26 +0200
Subject: [Windstille-commit] r1078 - trunk/src
Message-ID: <200509162007.j8GK7Q3W005070@sheep.berlios.de>

Author: grumbel
Date: 2005-09-16 22:07:25 +0200 (Fri, 16 Sep 2005)
New Revision: 1078

Modified:
   trunk/src/dialog_manager.cpp
Log:
- proper scaling of the portrait

Modified: trunk/src/dialog_manager.cpp
===================================================================
--- trunk/src/dialog_manager.cpp	2005-09-16 20:06:46 UTC (rev 1077)
+++ trunk/src/dialog_manager.cpp	2005-09-16 20:07:25 UTC (rev 1078)
@@ -47,6 +47,7 @@
   delay     = 0.0;
   alignment = alignment_;
   portrait  = Sprite(portrait_);
+  portrait.set_scale(0.65f);
   text      = text_;
   caption = false;
   



From grumbel at berlios.de  Fri Sep 16 22:08:16 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Fri, 16 Sep 2005 22:08:16 +0200
Subject: [Windstille-commit] r1079 - trunk/src
Message-ID: <200509162008.j8GK8GF0005171@sheep.berlios.de>

Author: grumbel
Date: 2005-09-16 22:08:15 +0200 (Fri, 16 Sep 2005)
New Revision: 1079

Modified:
   trunk/src/scriptable_object.cpp
Log:
- some checking for handling to allow scriptable object not have a sprite

Modified: trunk/src/scriptable_object.cpp
===================================================================
--- trunk/src/scriptable_object.cpp	2005-09-16 20:07:25 UTC (rev 1078)
+++ trunk/src/scriptable_object.cpp	2005-09-16 20:08:15 UTC (rev 1079)
@@ -58,18 +58,20 @@
   if (use_verb != "")
     set_useable(true);
   
-  if(spritename == "")
-    throw std::runtime_error("No sprite name specified in ScriptableObject");
-  sprite = Sprite(spritename);
+  if(spritename != "")
+    sprite = Sprite(spritename);
   
   if (highlightname != "")
-    highlight = Sprite(highlightname);
+    {
+      highlight = Sprite(highlightname);
+      highlight.set_blend_func(GL_SRC_ALPHA, GL_ONE);
+    }
 
   if (lightname != "")
-    light = Sprite(lightname);
-
-  highlight.set_blend_func(GL_SRC_ALPHA, GL_ONE);
-  light.set_blend_func(GL_SRC_ALPHA, GL_ONE);
+    {
+      light = Sprite(lightname);
+      light.set_blend_func(GL_SRC_ALPHA, GL_ONE);
+    }
     
   flash_delta = game_time;
   target_x = pos.x;
@@ -83,25 +85,32 @@
 void
 ScriptableObject::draw(SceneContext& sc)
 {
+  Vector tmp_pos = pos;
+
+  if (parent)
+    tmp_pos += parent->get_pos();
+
   if (flash_speed != 0)
     flash();
 
   if (sprite)
-    sc.color().draw(sprite, pos, z_pos);
+    sc.color().draw(sprite, tmp_pos, z_pos);
   
   if (highlight) 
-    sc.highlight().draw(highlight, pos, z_pos);
+    sc.highlight().draw(highlight, tmp_pos, z_pos);
 
   if (light) 
     {
-      sc.light().draw(light, pos, z_pos);
+      sc.light().draw(light, tmp_pos, z_pos);
     }
 }
 
 void
 ScriptableObject::update(float delta)
 {
-  sprite.update(delta);
+  if (sprite)
+    sprite.update(delta);
+
   if (highlight)
     highlight.update(delta);
 



From grumbel at berlios.de  Fri Sep 16 22:51:20 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Fri, 16 Sep 2005 22:51:20 +0200
Subject: [Windstille-commit] r1080 - in trunk/src: . font
Message-ID: <200509162051.j8GKpKTU010562@sheep.berlios.de>

Author: grumbel
Date: 2005-09-16 22:51:18 +0200 (Fri, 16 Sep 2005)
New Revision: 1080

Added:
   trunk/src/font/
   trunk/src/font/Jamfile
   trunk/src/font/border_font_effect.cpp
   trunk/src/font/border_font_effect.hpp
   trunk/src/font/font_effect.hpp
   trunk/src/font/fonts.cpp
   trunk/src/font/fonts.hpp
   trunk/src/font/ttf_font.cpp
   trunk/src/font/ttf_font.hpp
Removed:
   trunk/src/border_font_effect.cpp
   trunk/src/border_font_effect.hpp
   trunk/src/font_effect.hpp
   trunk/src/fonts.cpp
   trunk/src/fonts.hpp
   trunk/src/ttf_font.cpp
   trunk/src/ttf_font.hpp
Modified:
   trunk/src/Jamfile
   trunk/src/box.hpp
   trunk/src/game_session.cpp
   trunk/src/text_area.cpp
   trunk/src/tile_map.cpp
   trunk/src/tile_map.hpp
   trunk/src/util.cpp
   trunk/src/windstille_getters.cpp
   trunk/src/windstille_getters.hpp
   trunk/src/windstille_main.cpp
Log:
moved font stuff into subdirectory

Modified: trunk/src/Jamfile
===================================================================
--- trunk/src/Jamfile	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/Jamfile	2005-09-16 20:51:18 UTC (rev 1080)
@@ -3,6 +3,7 @@
 SubInclude TOP src badguy ;
 SubInclude TOP src collision ;
 SubInclude TOP src display ;
+SubInclude TOP src font ;
 SubInclude TOP src glutil ;
 SubInclude TOP src gui ;
 SubInclude TOP src input ;
@@ -27,8 +28,6 @@
         bomb.hpp
 	box.cpp
  	box.hpp
-        border_font_effect.hpp
-        border_font_effect.cpp
         camera.cpp
         camera.hpp
         character.cpp
@@ -54,9 +53,6 @@
         elevator.hpp
         elevator.cpp
         field.hpp
-        font_effect.hpp
-        fonts.cpp
-        fonts.hpp
         gameconfig.hpp
         gameconfig.cpp
         game_object.cpp
@@ -113,8 +109,6 @@
         timer.cpp
         trigger.cpp
         trigger.hpp
-        ttf_font.cpp
-        ttf_font.hpp        
         util.cpp
         util.hpp
         view.cpp
@@ -132,6 +126,8 @@
     
         $(display_objects)
 
+        $(font_objects)
+
         $(glutil_objects)
 
         $(gui_objects)

Deleted: trunk/src/border_font_effect.cpp
===================================================================
--- trunk/src/border_font_effect.cpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/border_font_effect.cpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -1,87 +0,0 @@
-/*  $Id$
-**   __      __ __             ___        __   __ __   __
-**  /  \    /  \__| ____    __| _/_______/  |_|__|  | |  |   ____
-**  \   \/\/   /  |/    \  / __ |/  ___/\   __\  |  | |  | _/ __ \
-**   \        /|  |   |  \/ /_/ |\___ \  |  | |  |  |_|  |_\  ___/
-**    \__/\  / |__|___|  /\____ /____  > |__| |__|____/____/\___  >
-**         \/          \/      \/    \/                         \/
-**  Copyright (C) 2005 Ingo Ruhnke <grumbel at gmx.de>
-**
-**  This program is free software; you can redistribute it and/or
-**  modify it under the terms of the GNU General Public License
-**  as published by the Free Software Foundation; either version 2
-**  of the License, or (at your option) any later version.
-**
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-** 
-**  You should have received a copy of the GNU General Public License
-**  along with this program; if not, write to the Free Software
-**  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-**  02111-1307, USA.
-*/
-
-#include <algorithm>
-#include "border_font_effect.hpp"
-
-BorderFontEffect::BorderFontEffect(int size_)
-  : size(size_)
-{
-}
-
-BorderFontEffect::~BorderFontEffect()
-{
-}
-  
-int
-BorderFontEffect::get_height(int orig_font_size) const
-{
-  return orig_font_size + 2*size ;
-}
-  
-int
-BorderFontEffect::get_glyph_width(int orig_glyph_width) const
-{
-  return orig_glyph_width + 2*size ;
-}
-
-int
-BorderFontEffect::get_glyph_height(int orig_glyph_height) const
-{
-  return orig_glyph_height + 2*size ;
-}
-  
-void
-BorderFontEffect::blit(SDL_Surface* target, const FT_Bitmap& brush, int x_pos, int y_pos) const
-{
-  SDL_LockSurface(target);
-  
-  int start_x = std::max(0, -x_pos);
-  int start_y = std::max(0, -y_pos);
-  
-  int end_x = std::min(brush.width, target->w  - x_pos);
-  int end_y = std::min(brush.rows,  target->h - y_pos);
-
-  unsigned char* target_buf = static_cast<unsigned char*>(target->pixels);
-
-  int target_pitch = target->pitch;
-
-  for (int y = start_y; y < end_y; ++y)
-    for (int x = start_x; x < end_x; ++x)
-      {
-        int target_pos = (y + y_pos) * target_pitch + 4*(x + x_pos);
-        int brush_pos  = y * brush.pitch + x;
-            
-        target_buf[target_pos + 0] = int(float(y)/brush.width * 255);
-        target_buf[target_pos + 1] = int(float(y)/brush.width * 255);
-        target_buf[target_pos + 2] = 255;
-        target_buf[target_pos + 3] = brush.buffer[brush_pos];
-      }
-    
-  SDL_UnlockSurface(target);
-
-}
-
-/* EOF */

Deleted: trunk/src/border_font_effect.hpp
===================================================================
--- trunk/src/border_font_effect.hpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/border_font_effect.hpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -1,54 +0,0 @@
-/*  $Id$
-**   __      __ __             ___        __   __ __   __
-**  /  \    /  \__| ____    __| _/_______/  |_|__|  | |  |   ____
-**  \   \/\/   /  |/    \  / __ |/  ___/\   __\  |  | |  | _/ __ \
-**   \        /|  |   |  \/ /_/ |\___ \  |  | |  |  |_|  |_\  ___/
-**    \__/\  / |__|___|  /\____ /____  > |__| |__|____/____/\___  >
-**         \/          \/      \/    \/                         \/
-**  Copyright (C) 2005 Ingo Ruhnke <grumbel at gmx.de>
-**
-**  This program is free software; you can redistribute it and/or
-**  modify it under the terms of the GNU General Public License
-**  as published by the Free Software Foundation; either version 2
-**  of the License, or (at your option) any later version.
-**
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-** 
-**  You should have received a copy of the GNU General Public License
-**  along with this program; if not, write to the Free Software
-**  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-**  02111-1307, USA.
-*/
-
-#ifndef HEADER_WINDSTILLE_BORDER_FONT_EFFECT_HPP
-#define HEADER_WINDSTILLE_BORDER_FONT_EFFECT_HPP
-
-#include "font_effect.hpp"
-
-/** */
-class BorderFontEffect : public FontEffect
-{
-private:
-  int size;
-public:
-  BorderFontEffect(int size);
-  ~BorderFontEffect();
-  
-  int get_height(int orig_font_size) const;
-  
-  int get_glyph_width(int orig_glyph_width) const;
-  int get_glyph_height(int orig_glyph_height) const;
-  
-  void blit(SDL_Surface* target, const FT_Bitmap& brush, int x_pos, int y_pos) const;
-
-private:
-  BorderFontEffect (const BorderFontEffect&);
-  BorderFontEffect& operator= (const BorderFontEffect&);
-};
-
-#endif
-
-/* EOF */

Modified: trunk/src/box.hpp
===================================================================
--- trunk/src/box.hpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/box.hpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -17,8 +17,8 @@
 //  along with this program; if not, write to the Free Software
 //  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
 
-#ifndef BOX_HXX
-#define BOX_HXX
+#ifndef HEADER_WINDSTILLE_BOX_HXX
+#define HEADER_WINDSTILLE_BOX_HXX
 
 #include "entity.hpp"
 #include "lisp/lisp.hpp"

Added: trunk/src/font/Jamfile
===================================================================
--- trunk/src/font/Jamfile	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/font/Jamfile	2005-09-16 20:51:18 UTC (rev 1080)
@@ -0,0 +1,14 @@
+SubDir TOP src font ;
+
+sources = 
+  border_font_effect.hpp
+  border_font_effect.cpp
+  fonts.hpp
+  fonts.cpp
+  font_effect.hpp
+  ttf_font.cpp
+  ttf_font.hpp
+;
+
+TRANSLATABLE_SOURCES = [ SearchSource $(sources) ] ;
+font_objects = [ CompileObjects $(sources) ] ;

Copied: trunk/src/font/border_font_effect.cpp (from rev 1058, trunk/src/border_font_effect.cpp)

Copied: trunk/src/font/border_font_effect.hpp (from rev 1058, trunk/src/border_font_effect.hpp)

Copied: trunk/src/font/font_effect.hpp (from rev 1058, trunk/src/font_effect.hpp)
===================================================================
--- trunk/src/font_effect.hpp	2005-09-03 13:50:24 UTC (rev 1058)
+++ trunk/src/font/font_effect.hpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -0,0 +1,57 @@
+/*  $Id$
+**   __      __ __             ___        __   __ __   __
+**  /  \    /  \__| ____    __| _/_______/  |_|__|  | |  |   ____
+**  \   \/\/   /  |/    \  / __ |/  ___/\   __\  |  | |  | _/ __ \
+**   \        /|  |   |  \/ /_/ |\___ \  |  | |  |  |_|  |_\  ___/
+**    \__/\  / |__|___|  /\____ /____  > |__| |__|____/____/\___  >
+**         \/          \/      \/    \/                         \/
+**  Copyright (C) 2005 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software; you can redistribute it and/or
+**  modify it under the terms of the GNU General Public License
+**  as published by the Free Software Foundation; either version 2
+**  of the License, or (at your option) any later version.
+**
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+** 
+**  You should have received a copy of the GNU General Public License
+**  along with this program; if not, write to the Free Software
+**  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+**  02111-1307, USA.
+*/
+
+#ifndef HEADER_WINDSTILLE_FONT_EFFECT_HPP
+#define HEADER_WINDSTILLE_FONT_EFFECT_HPP
+
+#include <SDL.h>
+#include <ft2build.h>
+#include FT_FREETYPE_H
+#include FT_GLYPH_H
+
+/** */
+class FontEffect
+{
+private:
+public:
+  FontEffect() {}
+  virtual ~FontEffect() {}
+  
+  /** Returns the new height of the font after its transformation */
+  virtual int get_height(int orig_font_size) const =0;
+
+  virtual int get_glyph_width(int orig_glyph_width) const =0;
+  virtual int get_glyph_height(int orig_glyph_height) const =0;
+
+  virtual void blit(SDL_Surface* target, const FT_Bitmap& brush, int x_pos, int y_pos) const =0;
+
+private:
+  FontEffect (const FontEffect&);
+  FontEffect& operator= (const FontEffect&);
+};
+
+#endif
+
+/* EOF */

Copied: trunk/src/font/fonts.cpp (from rev 1058, trunk/src/fonts.cpp)

Copied: trunk/src/font/fonts.hpp (from rev 1058, trunk/src/fonts.hpp)

Copied: trunk/src/font/ttf_font.cpp (from rev 1058, trunk/src/ttf_font.cpp)

Copied: trunk/src/font/ttf_font.hpp (from rev 1058, trunk/src/ttf_font.hpp)

Deleted: trunk/src/font_effect.hpp
===================================================================
--- trunk/src/font_effect.hpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/font_effect.hpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -1,57 +0,0 @@
-/*  $Id$
-**   __      __ __             ___        __   __ __   __
-**  /  \    /  \__| ____    __| _/_______/  |_|__|  | |  |   ____
-**  \   \/\/   /  |/    \  / __ |/  ___/\   __\  |  | |  | _/ __ \
-**   \        /|  |   |  \/ /_/ |\___ \  |  | |  |  |_|  |_\  ___/
-**    \__/\  / |__|___|  /\____ /____  > |__| |__|____/____/\___  >
-**         \/          \/      \/    \/                         \/
-**  Copyright (C) 2005 Ingo Ruhnke <grumbel at gmx.de>
-**
-**  This program is free software; you can redistribute it and/or
-**  modify it under the terms of the GNU General Public License
-**  as published by the Free Software Foundation; either version 2
-**  of the License, or (at your option) any later version.
-**
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-** 
-**  You should have received a copy of the GNU General Public License
-**  along with this program; if not, write to the Free Software
-**  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-**  02111-1307, USA.
-*/
-
-#ifndef HEADER_FONT_EFFECT_HPP
-#define HEADER_FONT_EFFECT_HPP
-
-#include <SDL.h>
-#include <ft2build.h>
-#include FT_FREETYPE_H
-#include FT_GLYPH_H
-
-/** */
-class FontEffect
-{
-private:
-public:
-  FontEffect() {}
-  virtual ~FontEffect() {}
-  
-  /** Returns the new height of the font after its transformation */
-  virtual int get_height(int orig_font_size) const =0;
-
-  virtual int get_glyph_width(int orig_glyph_width) const =0;
-  virtual int get_glyph_height(int orig_glyph_height) const =0;
-
-  virtual void blit(SDL_Surface* target, const FT_Bitmap& brush, int x_pos, int y_pos) const =0;
-
-private:
-  FontEffect (const FontEffect&);
-  FontEffect& operator= (const FontEffect&);
-};
-
-#endif
-
-/* EOF */

Deleted: trunk/src/fonts.cpp
===================================================================
--- trunk/src/fonts.cpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/fonts.cpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -1,46 +0,0 @@
-//  $Id$
-//
-//  Pingus - A free Lemmings clone
-//  Copyright (C) 2002 Ingo Ruhnke <grumbel at gmx.de>
-//
-//  This program is free software; you can redistribute it and/or
-//  modify it under the terms of the GNU General Public License
-//  as published by the Free Software Foundation; either version 2
-//  of the License, or (at your option) any later version.
-//
-//  This program is distributed in the hope that it will be useful,
-//  but WITHOUT ANY WARRANTY; without even the implied warranty of
-//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-//  GNU General Public License for more details.
-//
-//  You should have received a copy of the GNU General Public License
-//  along with this program; if not, write to the Free Software
-//  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
-
-#include "globals.hpp"
-#include "border_font_effect.hpp"
-#include "fonts.hpp"
-
-TTFFont* Fonts::ttffont = 0;
-
-TTFFont* Fonts::ttfdialog = 0;
-
-void
-Fonts::init()
-{
-  BorderFontEffect* border_effect = new BorderFontEffect(1);
-
-  ttffont   = new TTFFont("fonts/VeraMono.ttf", 12);
-  ttfdialog = new TTFFont("fonts/Vera.ttf", 20);
-
-  delete border_effect;
-}
-
-void
-Fonts::deinit()
-{
-  delete ttffont;
-  delete ttfdialog;
-}
-
-/* EOF */

Deleted: trunk/src/fonts.hpp
===================================================================
--- trunk/src/fonts.hpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/fonts.hpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -1,38 +0,0 @@
-//  $Id$
-// 
-//  Pingus - A free Lemmings clone
-//  Copyright (C) 2002 Ingo Ruhnke <grumbel at gmx.de>
-//
-//  This program is free software; you can redistribute it and/or
-//  modify it under the terms of the GNU General Public License
-//  as published by the Free Software Foundation; either version 2
-//  of the License, or (at your option) any later version.
-//
-//  This program is distributed in the hope that it will be useful,
-//  but WITHOUT ANY WARRANTY; without even the implied warranty of
-//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-//  GNU General Public License for more details.
-// 
-//  You should have received a copy of the GNU General Public License
-//  along with this program; if not, write to the Free Software
-//  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
-
-#ifndef HEADER_FONTS_HXX
-#define HEADER_FONTS_HXX
-
-#include "ttf_font.hpp"
-
-namespace Fonts {
-
-extern TTFFont* ttffont;
-
-extern TTFFont* ttfdialog;
-
-void init();
-void deinit();
-
-} // namespace Fonts
-
-#endif
-
-/* EOF */

Modified: trunk/src/game_session.cpp
===================================================================
--- trunk/src/game_session.cpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/game_session.cpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -31,7 +31,7 @@
 #include <sqstdio.h> 
 #include <sqstdaux.h> 
 
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "sector.hpp"
 #include "console.hpp"
 #include "game_object.hpp"

Modified: trunk/src/text_area.cpp
===================================================================
--- trunk/src/text_area.cpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/text_area.cpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -26,10 +26,10 @@
 #include <assert.h>
 
 #include "glutil/opengl_state.hpp"
-#include "ttf_font.hpp"
+#include "font/ttf_font.hpp"
 #include "text_area.hpp"
 #include "baby_xml.hpp"
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "text_area.hpp"
 
 struct TextAreaCommand 

Modified: trunk/src/tile_map.cpp
===================================================================
--- trunk/src/tile_map.cpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/tile_map.cpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -222,6 +222,10 @@
 Vector
 TileMap::raycast(const Vector& pos, float angle)
 {
+  ////////////////////////////////////////////
+  // FIXME: This code is buggy, use code from LaserPointer instead
+  ///////////////////////////////////////////////
+  
   // Ray position in Tile units
   int x = static_cast<int>(pos.x / TILE_SIZE);
   int y = static_cast<int>(pos.y / TILE_SIZE);

Modified: trunk/src/tile_map.hpp
===================================================================
--- trunk/src/tile_map.hpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/tile_map.hpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -17,8 +17,8 @@
 //  along with this program; if not, write to the Free Software
 //  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
 
-#ifndef TILEMAP_HXX
-#define TILEMAP_HXX
+#ifndef HEADER_WINDSTILLE_TILEMAP_HXX
+#define HEADER_WINDSTILLE_TILEMAP_HXX
 
 #include <string>
 

Deleted: trunk/src/ttf_font.cpp
===================================================================
--- trunk/src/ttf_font.cpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/ttf_font.cpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -1,262 +0,0 @@
-/*  $Id$
-**   __      __ __             ___        __   __ __   __
-**  /  \    /  \__| ____    __| _/_______/  |_|__|  | |  |   ____
-**  \   \/\/   /  |/    \  / __ |/  ___/\   __\  |  | |  | _/ __ \
-**   \        /|  |   |  \/ /_/ |\___ \  |  | |  |  |_|  |_\  ___/
-**    \__/\  / |__|___|  /\____ /____  > |__| |__|____/____/\___  >
-**         \/          \/      \/    \/                         \/
-**  Copyright (C) 2005 Ingo Ruhnke <grumbel at gmx.de>
-**
-**  This program is free software; you can redistribute it and/or
-**  modify it under the terms of the GNU General Public License
-**  as published by the Free Software Foundation; either version 2
-**  of the License, or (at your option) any later version.
-**
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-** 
-**  You should have received a copy of the GNU General Public License
-**  along with this program; if not, write to the Free Software
-**  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
-*/
-
-#include <assert.h>
-#include <vector>
-#include <stdexcept>
-#include <sstream>
-
-#include <ft2build.h>
-#include FT_FREETYPE_H
-#include FT_GLYPH_H
-
-#include "glutil/opengl_state.hpp"
-#include "physfs/physfs_stream.hpp"
-#include "glutil/texture_manager.hpp"
-#include "blitter.hpp"
-#include "ttf_font.hpp"
-#include "font_effect.hpp"
-#include "util.hpp"
-
-TTFCharacter::TTFCharacter(const Rect& pos_,
-                           const Rectf& uv_, 
-                           int advance_)
-  : pos(pos_),
-    uv(uv_), 
-    advance(advance_)
-{
-}
-
-class TTFFontImpl
-{
-public:
-  /// the global FreeType library handle
-  static FT_Library      library;
-
-  /** Array of characters available in this font, current limited to
-      256 characters, no full unicode */
-  std::vector<TTFCharacter> characters;
-
-  /** The original size of the font in pixels */
-  int size;
-
-  /** The amount of pixels to advance in y direction after a finished
-      line, this can be transformed by FontEffect */
-  int height;
-
-  /** OpenGL Texture which holds all the characters */
-  Texture texture;
-};
-
-FT_Library TTFFontImpl::library;
-
-TTFFont::TTFFont(const std::string& filename, int size_, FontEffect* effect)
-  : impl(new TTFFontImpl())
-{
-  assert(size_ > 0);
-
-  impl->size = size_;
-
-  IFileStream fin(filename);
-  std::istreambuf_iterator<char> first(fin), last;
-  std::vector<char> buffer(first, last); 
-
-  FT_Face face;
-  if (FT_New_Memory_Face(TTFFontImpl::library, 
-                         reinterpret_cast<FT_Byte*>(&*buffer.begin()), buffer.size(), 
-                         0, &face))
-    {
-      throw std::runtime_error("Couldn't load font: '" + filename + "'");
-    }
-  
-  FT_Set_Pixel_Sizes(face, impl->size, impl->size);
-
-  FT_Select_Charmap(face,  FT_ENCODING_UNICODE);
-
-  // FIXME: should calculate texture size, based on font size
-#if SDL_BYTEORDER == SDL_BIG_ENDIAN
-  SDL_Surface* pixelbuffer = SDL_CreateRGBSurface(SDL_SWSURFACE,
-                                              1024, 1024, 32,
-                                              0xff000000, 0x00ff0000, 0x0000ff00, 0x000000ff);
-#else
-  SDL_Surface* pixelbuffer = SDL_CreateRGBSurface(SDL_SWSURFACE,
-                                              1024, 1024, 32,
-                                              0x000000ff, 0x0000ff00, 0x00ff0000, 0xff000000);
-#endif
-  SDL_SetAlpha(pixelbuffer, 0, 0);
-
-  int x_pos = 1;
-  int y_pos = 1;
-
-  impl->height = effect ? effect->get_height(impl->size) : impl->size;
-
-  // We limit ourself to 256 characters for the momemnt
-  for(int glyph_index = 0; glyph_index < 256; glyph_index += 1)
-    {
-      if (FT_Load_Char( face,  glyph_index, FT_LOAD_RENDER))
-        {
-          // FIXME: happens when character is not in font, should be handled more gentle
-          throw std::runtime_error("couldn't load char");
-        }
-      
-      if (!effect)
-        blit_ftbitmap(pixelbuffer, face->glyph->bitmap, x_pos, y_pos);
-      else
-        effect->blit(pixelbuffer, face->glyph->bitmap, x_pos, y_pos);
-
-      int glyph_width  = effect ? effect->get_glyph_width(face->glyph->bitmap.width) : face->glyph->bitmap.width;
-      int glyph_height = effect ? effect->get_glyph_height(face->glyph->bitmap.rows) : face->glyph->bitmap.rows;
-
-      generate_border(pixelbuffer, x_pos, y_pos, glyph_width, glyph_height);
-
-      Rect pos(Point(face->glyph->bitmap_left,  -face->glyph->bitmap_top), 
-               Size(glyph_width, glyph_height));
-
-      Rectf uv(x_pos/float(pixelbuffer->w),
-               y_pos/float(pixelbuffer->h),
-               (x_pos + glyph_width)/float(pixelbuffer->w),
-               (y_pos + glyph_height)/float(pixelbuffer->h));
-      
-      impl->characters.push_back(TTFCharacter(pos, uv,
-                                              face->glyph->advance.x >> 6));
-
-      // we leave a one pixel border around the letters which we fill with generate_border
-      x_pos += glyph_width + 2;
-      if (x_pos + impl->height + 2 > pixelbuffer->w)
-        {
-          y_pos += impl->height + 2;
-          x_pos = 1;
-        }
-
-      if (y_pos + impl->height + 2 > pixelbuffer->h)
-        throw std::runtime_error("Font Texture to small");
-    }
-  FT_Done_Face(face);
-
-  try {
-    impl->texture = Texture(pixelbuffer);
-  } catch(...) {
-    SDL_FreeSurface(pixelbuffer);
-    throw;
-  }
-  SDL_FreeSurface(pixelbuffer);
-}
-
-TTFFont::~TTFFont()
-{
-  delete impl;
-}
-
-const TTFCharacter&
-TTFFont::get_character(int c) const
-{
-  assert(c >= 0 && c < 256);
-  return impl->characters[c];
-}
-
-int
-TTFFont::get_height() const
-{
-  return impl->size;
-}
-
-void
-TTFFont::draw(float x_pos, float y_pos, const std::string& str, const Color& color)
-{
-  OpenGLState state;
-
-  state.enable(GL_BLEND);
-  state.set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
-  state.enable(GL_TEXTURE_2D);
-  state.bind_texture(impl->texture);
-  state.color(color);
-  state.activate();
-
-  // Voodoo to get non-blurry fonts
-  float mx = -0.375;
-  float my = -0.375; 
-  glBegin(GL_QUADS);
-  for(std::string::const_iterator i = str.begin(); i != str.end(); ++i)
-    {
-      const TTFCharacter& character = impl->characters[*i];
-      
-      glTexCoord2f(character.uv.left, character.uv.top);
-      glVertex2f(x_pos + character.pos.left + mx,
-                 y_pos + character.pos.top  + my);
-
-      glTexCoord2f(character.uv.right, character.uv.top);
-      glVertex2f(x_pos + character.pos.right + mx, 
-                 y_pos + character.pos.top   + my);
-
-      glTexCoord2f(character.uv.right, character.uv.bottom);
-      glVertex2f(x_pos + character.pos.right  + mx, 
-                 y_pos + character.pos.bottom + my);
-
-      glTexCoord2f(character.uv.left, character.uv.bottom);
-      glVertex2f(x_pos + character.pos.left   + mx, 
-                 y_pos + character.pos.bottom + my);
-
-      x_pos += character.advance;       
-    }
-  glEnd();
-}
-
-void
-TTFFont::draw_center(float x_pos, float y_pos, const std::string& str, const Color& color)
-{
-  draw(x_pos - get_width(str)/2, y_pos, str, color);
-}
-
-int
-TTFFont::get_width(const std::string& text) const
-{
-  int width = 0;
-  for(std::string::const_iterator i = text.begin(); i != text.end(); ++i)
-    width += impl->characters[*i].advance;
-  return width;
-}
-
-Texture
-TTFFont::get_texture() const
-{
-  return impl->texture;
-}
-
-void
-TTFFont::init()
-{
-  FT_Error  error;
-  
-  error = FT_Init_FreeType( &TTFFontImpl::library );
-  if ( error )
-    throw std::runtime_error( "could not initialize FreeType" );
-}
-
-void
-TTFFont::deinit()
-{
-  FT_Done_FreeType( TTFFontImpl::library );
-}
-
-/* EOF */

Deleted: trunk/src/ttf_font.hpp
===================================================================
--- trunk/src/ttf_font.hpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/ttf_font.hpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -1,90 +0,0 @@
-/*  $Id$
-**   __      __ __             ___        __   __ __   __
-**  /  \    /  \__| ____    __| _/_______/  |_|__|  | |  |   ____
-**  \   \/\/   /  |/    \  / __ |/  ___/\   __\  |  | |  | _/ __ \
-**   \        /|  |   |  \/ /_/ |\___ \  |  | |  |  |_|  |_\  ___/
-**    \__/\  / |__|___|  /\____ /____  > |__| |__|____/____/\___  >
-**         \/          \/      \/    \/                         \/
-**  Copyright (C) 2005 Ingo Ruhnke <grumbel at gmx.de>
-**
-**  This program is free software; you can redistribute it and/or
-**  modify it under the terms of the GNU General Public License
-**  as published by the Free Software Foundation; either version 2
-**  of the License, or (at your option) any later version.
-**
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-** 
-**  You should have received a copy of the GNU General Public License
-**  along with this program; if not, write to the Free Software
-**  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-**  02111-1307, USA.
-*/
-
-#ifndef HEADER_TTF_FONT_HXX
-#define HEADER_TTF_FONT_HXX
-
-#include <string>
-#include <GL/gl.h>
-#include "color.hpp"
-#include "math/rect.hpp"
-#include "glutil/texture.hpp"
-
-class FontEffect;
-
-class TTFCharacter
-{
-public:
-  /** The position of the image, relative to the current cursor
-      position in screen coordinates */
-  Rect pos;
-
-  /** The position of the character in a OpenGL texture, given in
-      uv-coordinates */
-  Rectf uv;
-
-  /** Amount of pixels that the cursor will advance after having
-      printed this character */
-  int advance;
-
-  TTFCharacter(const Rect& pos, const Rectf& uv, int advance);
-};
-
-class TTFFontImpl;
-
-/** */
-class TTFFont
-{
-public:
-  static void init();
-  static void deinit();
-
-  TTFFont(const std::string& file, int size, FontEffect* effect = 0);
-  ~TTFFont();
-
-  /** */
-  int get_height() const;
-
-  /** Returns the width of a given piece of text, doesn't take
-      newlines into account */
-  int get_width(const std::string& text) const;
-
-  /** Returns the height as given in the constructor, this does *not*
-      take into account any possible resize effects done by
-      FontEffoct */
-  int get_size() const;
-
-  Texture get_texture() const;
-
-  const TTFCharacter& get_character(int c) const;
-  void draw(float x_pos, float y_pos, const std::string& str, const Color& color = Color(1.0f, 1.0f, 1.0f));
-  void draw_center(float x_pos, float y_pos, const std::string& str, const Color& color = Color(1.0f, 1.0f, 1.0f));
-private:
-  TTFFontImpl* impl;
-};
-
-#endif
-
-/* EOF */

Modified: trunk/src/util.cpp
===================================================================
--- trunk/src/util.cpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/util.cpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -31,3 +31,4 @@
     }
 }
 
+/* EOF */

Modified: trunk/src/windstille_getters.cpp
===================================================================
--- trunk/src/windstille_getters.cpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/windstille_getters.cpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -1,3 +1,28 @@
+/*  $Id$
+**   __      __ __             ___        __   __ __   __
+**  /  \    /  \__| ____    __| _/_______/  |_|__|  | |  |   ____
+**  \   \/\/   /  |/    \  / __ |/  ___/\   __\  |  | |  | _/ __ \
+**   \        /|  |   |  \/ /_/ |\___ \  |  | |  |  |_|  |_\  ___/
+**    \__/\  / |__|___|  /\____ /____  > |__| |__|____/____/\___  >
+**         \/          \/      \/    \/                         \/
+**  Copyright (C) 2000,2005 Matthias Braun <matze at braunis.de>
+**
+**  This program is free software; you can redistribute it and/or
+**  modify it under the terms of the GNU General Public License
+**  as published by the Free Software Foundation; either version 2
+**  of the License, or (at your option) any later version.
+**
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+** 
+**  You should have received a copy of the GNU General Public License
+**  along with this program; if not, write to the Free Software
+**  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+**  02111-1307, USA.
+*/
+
 #include <config.h>
 
 #include "lisp/lisp.hpp"
@@ -37,3 +62,5 @@
 }
 
 }
+
+/* EOF */

Modified: trunk/src/windstille_getters.hpp
===================================================================
--- trunk/src/windstille_getters.hpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/windstille_getters.hpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -1,3 +1,28 @@
+/*  $Id$
+**   __      __ __             ___        __   __ __   __
+**  /  \    /  \__| ____    __| _/_______/  |_|__|  | |  |   ____
+**  \   \/\/   /  |/    \  / __ |/  ___/\   __\  |  | |  | _/ __ \
+**   \        /|  |   |  \/ /_/ |\___ \  |  | |  |  |_|  |_\  ___/
+**    \__/\  / |__|___|  /\____ /____  > |__| |__|____/____/\___  >
+**         \/          \/      \/    \/                         \/
+**  Copyright (C) 2000,2005 Matthias Braun <matze at braunis.de>
+**
+**  This program is free software; you can redistribute it and/or
+**  modify it under the terms of the GNU General Public License
+**  as published by the Free Software Foundation; either version 2
+**  of the License, or (at your option) any later version.
+**
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+** 
+**  You should have received a copy of the GNU General Public License
+**  along with this program; if not, write to the Free Software
+**  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+**  02111-1307, USA.
+*/
+
 #ifndef __WINDSTILLE_GETTERS_HPP__
 #define __WINDSTILLE_GETTERS_HPP__
 

Modified: trunk/src/windstille_main.cpp
===================================================================
--- trunk/src/windstille_main.cpp	2005-09-16 20:08:15 UTC (rev 1079)
+++ trunk/src/windstille_main.cpp	2005-09-16 20:51:18 UTC (rev 1080)
@@ -30,7 +30,7 @@
 #include "globals.hpp"
 #include "screen.hpp"
 #include "windstille_main.hpp"
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "game_session.hpp"
 #include "sector.hpp"
 #include "input/input_manager.hpp"
@@ -40,7 +40,7 @@
 #include "tinygettext/gettext.hpp"
 #include "gameconfig.hpp"
 #include "util.hpp"
-#include "ttf_font.hpp"
+#include "font/ttf_font.hpp"
 #include "display/display.hpp"
 #include "glutil/surface_manager.hpp"
 #include "glutil/texture_manager.hpp"



From matzebraun at berlios.de  Sat Sep 17 12:11:00 2005
From: matzebraun at berlios.de (Matthias Braun at BerliOS)
Date: Sat, 17 Sep 2005 12:11:00 +0200
Subject: [Windstille-commit] r1081 - in trunk/src: . glutil scripting
Message-ID: <200509171011.j8HAB0QN021777@sheep.berlios.de>

Author: matzebraun
Date: 2005-09-17 12:10:59 +0200 (Sat, 17 Sep 2005)
New Revision: 1081

Modified:
   trunk/src/console.cpp
   trunk/src/controller_help_window.cpp
   trunk/src/conversation.cpp
   trunk/src/dialog_manager.cpp
   trunk/src/glutil/texture.cpp
   trunk/src/inventory.cpp
   trunk/src/pda.cpp
   trunk/src/physics.cpp
   trunk/src/screen.cpp
   trunk/src/screen_manager.cpp
   trunk/src/scripting/interface.cpp
Log:
fix more font includes (jam unfortunately doesn't rebuild if header files have been removed)

Modified: trunk/src/console.cpp
===================================================================
--- trunk/src/console.cpp	2005-09-16 20:51:18 UTC (rev 1080)
+++ trunk/src/console.cpp	2005-09-17 10:10:59 UTC (rev 1081)
@@ -24,7 +24,7 @@
 
 #include <assert.h>
 #include "math/rect.hpp"
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "game_session.hpp"
 #include "input/input_manager.hpp"
 #include "script_manager.hpp"

Modified: trunk/src/controller_help_window.cpp
===================================================================
--- trunk/src/controller_help_window.cpp	2005-09-16 20:51:18 UTC (rev 1080)
+++ trunk/src/controller_help_window.cpp	2005-09-17 10:10:59 UTC (rev 1081)
@@ -26,7 +26,7 @@
 #include "input/input_manager.hpp"
 #include "display/display.hpp"
 #include "text_area.hpp"
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "controller_help_window.hpp"
 
 ControllerHelpWindow* ControllerHelpWindow::current_ = 0;

Modified: trunk/src/conversation.cpp
===================================================================
--- trunk/src/conversation.cpp	2005-09-16 20:51:18 UTC (rev 1080)
+++ trunk/src/conversation.cpp	2005-09-17 10:10:59 UTC (rev 1081)
@@ -19,7 +19,7 @@
 
 #include "input/controller.hpp"
 #include "input/input_manager.hpp"
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "math/rect.hpp"
 #include "script_manager.hpp"
 #include "display/display.hpp"

Modified: trunk/src/dialog_manager.cpp
===================================================================
--- trunk/src/dialog_manager.cpp	2005-09-16 20:51:18 UTC (rev 1080)
+++ trunk/src/dialog_manager.cpp	2005-09-17 10:10:59 UTC (rev 1081)
@@ -18,7 +18,7 @@
 //  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
 
 #include <iostream>
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "game_session.hpp"
 #include "input/controller.hpp"
 #include "input/input_manager.hpp"

Modified: trunk/src/glutil/texture.cpp
===================================================================
--- trunk/src/glutil/texture.cpp	2005-09-16 20:51:18 UTC (rev 1080)
+++ trunk/src/glutil/texture.cpp	2005-09-17 10:10:59 UTC (rev 1081)
@@ -43,6 +43,7 @@
   TextureImpl()
   {
     glGenTextures(1, &handle);
+    assert_gl("creating texture handle."); 
   }
 
   TextureImpl::~TextureImpl()
@@ -99,15 +100,12 @@
   if(format->BitsPerPixel != 24 && format->BitsPerPixel != 32)
     throw std::runtime_error("image has not 24 or 32 bit color depth");
 
-  assert_gl("creating texture handle.");
-
   try 
     {
       GLint maxt;
       glGetIntegerv(GL_MAX_TEXTURE_SIZE, &maxt);
       if(image->w > maxt || image->h > maxt)
         {
-          
           throw std::runtime_error("Texture size not supported");
         }
 

Modified: trunk/src/inventory.cpp
===================================================================
--- trunk/src/inventory.cpp	2005-09-16 20:51:18 UTC (rev 1080)
+++ trunk/src/inventory.cpp	2005-09-17 10:10:59 UTC (rev 1081)
@@ -27,7 +27,7 @@
 #include <vector>
 #include "game_session.hpp"
 #include "sprite2d/sprite.hpp"
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "input/input_manager.hpp"
 #include "input/controller.hpp"
 #include "inventory.hpp"

Modified: trunk/src/pda.cpp
===================================================================
--- trunk/src/pda.cpp	2005-09-16 20:51:18 UTC (rev 1080)
+++ trunk/src/pda.cpp	2005-09-17 10:10:59 UTC (rev 1081)
@@ -26,7 +26,7 @@
 #include "input/input_manager.hpp"
 #include "display/display.hpp"
 #include "text_area.hpp"
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "pda.hpp"
 
 DialogEntry::DialogEntry(const std::string& arg_character, const std::string& arg_text)

Modified: trunk/src/physics.cpp
===================================================================
--- trunk/src/physics.cpp	2005-09-16 20:51:18 UTC (rev 1080)
+++ trunk/src/physics.cpp	2005-09-17 10:10:59 UTC (rev 1081)
@@ -28,23 +28,20 @@
   printf("collision %p - %p\n", data.object1, data.object2);
   GameObject* other_object = data.object2->get_game_object();
   
-  // XXX just for testing, to avoid all the collisions
-  data.object1->set_velocity(data.object1->get_velocity() * -1);
-  //data.object2->set_velocity(data.object2->get_velocity() * -1);
   if(other_object == 0)
     return;
-  
-  return;
 
   const Physics* physics = dynamic_cast<const Physics*> (other_object);
   if(physics)
   {
     elastic_collision(data, *physics);
+    data.object1->set_velocity(velocity());
     return;
   }
 
   // assume fix object...
   bounce_collision(data);
+  data.object1->set_velocity(velocity());
 }
 
 void

Modified: trunk/src/screen.cpp
===================================================================
--- trunk/src/screen.cpp	2005-09-16 20:51:18 UTC (rev 1080)
+++ trunk/src/screen.cpp	2005-09-17 10:10:59 UTC (rev 1081)
@@ -22,7 +22,7 @@
 #include "display/display.hpp"
 #include "windstille_main.hpp"
 #include "screen.hpp"
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "globals.hpp"
 #include "console.hpp"
 #include "gameconfig.hpp"

Modified: trunk/src/screen_manager.cpp
===================================================================
--- trunk/src/screen_manager.cpp	2005-09-16 20:51:18 UTC (rev 1080)
+++ trunk/src/screen_manager.cpp	2005-09-17 10:10:59 UTC (rev 1081)
@@ -29,7 +29,7 @@
 #include "display/display.hpp"
 #include "globals.hpp"
 #include "screen.hpp"
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "gameconfig.hpp"
 #include "input/input_manager.hpp"
 #include "input/input_configurator.hpp"

Modified: trunk/src/scripting/interface.cpp
===================================================================
--- trunk/src/scripting/interface.cpp	2005-09-16 20:51:18 UTC (rev 1080)
+++ trunk/src/scripting/interface.cpp	2005-09-17 10:10:59 UTC (rev 1081)
@@ -7,7 +7,7 @@
 #include "conversation.hpp"
 #include "script_manager.hpp"
 #include "sector.hpp"
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "serialize.hpp"
 #include "camera.hpp"
 #include "pda.hpp"



From matzebraun at berlios.de  Sat Sep 17 14:05:05 2005
From: matzebraun at berlios.de (Matthias Braun at BerliOS)
Date: Sat, 17 Sep 2005 14:05:05 +0200
Subject: [Windstille-commit] r1082 - trunk/data/3dsprites
Message-ID: <200509171205.j8HC55U7012410@sheep.berlios.de>

Author: matzebraun
Date: 2005-09-17 14:05:03 +0200 (Sat, 17 Sep 2005)
New Revision: 1082

Added:
   trunk/data/3dsprites/barkeeper.wsprite
Log:
barkeeper was missing

Added: trunk/data/3dsprites/barkeeper.wsprite
===================================================================
(Binary files differ)


Property changes on: trunk/data/3dsprites/barkeeper.wsprite
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From grumbel at berlios.de  Sat Sep 17 14:05:48 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Sat, 17 Sep 2005 14:05:48 +0200
Subject: [Windstille-commit] r1083 - trunk/data
Message-ID: <200509171205.j8HC5mje012570@sheep.berlios.de>

Author: grumbel
Date: 2005-09-17 14:05:47 +0200 (Sat, 17 Sep 2005)
New Revision: 1083

Modified:
   trunk/data/tiles.scm
Log:
- some collision info

Modified: trunk/data/tiles.scm
===================================================================
--- trunk/data/tiles.scm	2005-09-17 12:05:03 UTC (rev 1082)
+++ trunk/data/tiles.scm	2005-09-17 12:05:47 UTC (rev 1083)
@@ -446,10 +446,10 @@
          0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 7
          0 0 0 0 0 0 0 0 0 0 0 0 0 0 7 0     
          
-         0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0        
-         0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0        
-         0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0        
-         0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
+         0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0        
+         0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0        
+         0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0        
+         0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
          ))
 
  (tiles (image "images/tiles/apartment-background.png")



From grumbel at berlios.de  Sat Sep 17 14:08:45 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Sat, 17 Sep 2005 14:08:45 +0200
Subject: [Windstille-commit] r1084 - in trunk/data: blender blender/bob blender/hand blender/hero blender/monster blender/pistol blender/shuttle blender/sophie blender/weapon blender/worker blender/yagor levels models/characters/yagor scripts/newformat2
Message-ID: <200509171208.j8HC8jJu012848@sheep.berlios.de>

Author: grumbel
Date: 2005-09-17 14:08:44 +0200 (Sat, 17 Sep 2005)
New Revision: 1084

Added:
   trunk/data/models/characters/yagor/clothtexture.png
   trunk/data/models/characters/yagor/facetexture.png
   trunk/data/models/characters/yagor/yagor.wsprite
Removed:
   trunk/data/blender/barkeeper/
Modified:
   trunk/data/blender/bob/bob.blend
   trunk/data/blender/hand/
   trunk/data/blender/hand/hand.blend
   trunk/data/blender/hero/
   trunk/data/blender/hero/hero.blend
   trunk/data/blender/monster/v2.blend
   trunk/data/blender/pistol/pistol.blend
   trunk/data/blender/shuttle/shuttle.blend
   trunk/data/blender/sophie/sophie.blend
   trunk/data/blender/weapon/weapon.blend
   trunk/data/blender/worker/
   trunk/data/blender/worker/worker.blend
   trunk/data/blender/yagor/yagor.blend
   trunk/data/levels/apartment.wst
   trunk/data/levels/industrial.wst
   trunk/data/levels/newformat2.wst
   trunk/data/scripts/newformat2/bob.nut
   trunk/data/scripts/newformat2/frank.nut
Log:
- lots of misc stuff

Modified: trunk/data/blender/bob/bob.blend
===================================================================
(Binary files differ)


Property changes on: trunk/data/blender/hand
___________________________________________________________________
Name: svn:ignore
   + hand.blend1


Modified: trunk/data/blender/hand/hand.blend
===================================================================
(Binary files differ)


Property changes on: trunk/data/blender/hero
___________________________________________________________________
Name: svn:ignore
   + 
hero.blend1
heroken-1.blend1
herosingle1.blend1
herosingle.blend1
old


Modified: trunk/data/blender/hero/hero.blend
===================================================================
(Binary files differ)

Modified: trunk/data/blender/monster/v2.blend
===================================================================
(Binary files differ)

Modified: trunk/data/blender/pistol/pistol.blend
===================================================================
(Binary files differ)

Modified: trunk/data/blender/shuttle/shuttle.blend
===================================================================
(Binary files differ)

Modified: trunk/data/blender/sophie/sophie.blend
===================================================================
(Binary files differ)

Modified: trunk/data/blender/weapon/weapon.blend
===================================================================
(Binary files differ)


Property changes on: trunk/data/blender/worker
___________________________________________________________________
Name: svn:ignore
   + worker.blend1


Modified: trunk/data/blender/worker/worker.blend
===================================================================
(Binary files differ)

Modified: trunk/data/blender/yagor/yagor.blend
===================================================================
(Binary files differ)

Modified: trunk/data/levels/apartment.wst
===================================================================
--- trunk/data/levels/apartment.wst	2005-09-17 12:05:47 UTC (rev 1083)
+++ trunk/data/levels/apartment.wst	2005-09-17 12:08:44 UTC (rev 1084)
@@ -1,10 +1,10 @@
 ;; Generated by Flexlay Editor
 (windstille-sector
   (version 2)
-  (ambient-color .666 .666 .666)  (name   "")
+  (ambient-color .3 .3 .3)  (name   "")
   (music  "")
   (objects
-  (tilemap (name "background") (width 100) (height 30) (z-pos -1000)
+  (tilemap (name "background") (width 100) (height 30) (z-pos -2000)
     (data
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
@@ -44,79 +44,170 @@
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1667 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1667 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1667 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 0 0 0 1643 1644 1667 1668 1699 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1643 1651 1667 1668 1699 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1651 1667 1668 1699 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 1684 1715 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 1684 1715 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1651 1652 1683 1684 1715 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1667 1668 1699 1700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1667 1668 1699 1700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1668 1699 1700 1731 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 1684 1715 1716 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 1684 1715 1716 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1668 1699 1715 1716 0 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 1651 1667 1668 1699 1700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1667 1668 1699 1700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1667 1668 1699 1715 1716 0 0 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 1652 1683 1684 1715 1716 0 0 1651 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1652 1683 1684 1715 1716 0 0 1651 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1652 1683 1699 1715 1716 0 0 0 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 1668 1699 1700 1731 1732 0 1651 1667 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1668 1699 1700 1731 1732 0 1651 1667 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1668 1699 1700 1731 0 0 1651 1667 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 1699 1715 1716 0 0 1651 1652 1683 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1699 1715 1716 0 0 1651 1652 1683 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1699 1715 1716 0 0 1651 1652 1683 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 0 0 0 1643 1644 1667 1668 1699 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1643 1644 1667 1668 1699 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1651 1667 1668 1699 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 1684 1715 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 1684 1715 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1651 1652 1683 1684 1715 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1667 1668 1699 1700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1667 1668 1699 1700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1668 1699 1700 1731 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 1684 1715 1716 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 1684 1715 1716 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1668 1699 1715 1716 0 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 1651 1667 1668 1699 1700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1667 1668 1699 1700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1667 1668 1699 1715 1716 0 0 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 1652 1683 1684 1715 1716 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1652 1683 1684 1715 1716 0 0 1651 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1652 1683 1699 1715 1716 0 0 0 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 1668 1699 1700 1731 1732 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1668 1699 1700 1731 1732 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1668 1699 1700 1731 0 0 0 0 0 0 0 0 
+      0 0 0 0 0 0 0 0 0 0 0 1699 1715 1716 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1699 1715 1716 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1699 1715 1716 0 0 0 0 0 0 0 0 0 
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1667 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 1643 1644 1667 1668 1699 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 1684 1715 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 1667 1668 1699 1700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 1684 1715 1716 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 1667 1668 1699 1700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 1652 1683 1684 1715 1716 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 1668 1699 1700 1731 1732 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 1699 1715 1716 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
      ))
   (tilemap (name "interactive") (width 100) (height 30) (z-pos 0)
     (data
       1655 1656 1657 1658 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 
-      1671 1672 1673 1674 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1667 1668 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
+      1671 1672 1673 1674 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1672 1673 1674 1675 1676 1671 1672 1673 1674 1671 1676 1671 1672 1673 1674 
+      1702 1703 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1702 1703 
+      1718 1719 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1718 1719 
+      1734 1735 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1734 1735 
+      1750 1751 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1750 1751 
+      1734 1735 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1734 1735 
+      1750 1751 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1750 1751 
       1655 1656 1657 1658 1655 1656 1657 1658 1659 1660 1655 1658 1659 1660 1655 1656 1657 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 
       1671 1672 1673 1674 1671 1672 1673 1674 1675 1676 1671 1674 1675 1676 1671 1672 1673 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 
-      0 0 0 0 0 0 0 0 0 0 1651 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 1684 1700 1731 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1667 1668 1699 1700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 1651 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 1684 1715 1716 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1667 1668 1699 1700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1683 1684 1715 1716 0 0 1651 1652 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 1732 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1699 1700 1731 1732 0 1651 1667 1668 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
+      1702 1703 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1702 1703 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1702 1703 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1702 1703 
+      1718 1719 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1718 1719 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1718 1719 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1718 1719 
+      1734 1735 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1734 1735 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1734 1735 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1734 1735 
+      1750 1751 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1750 1751 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1750 1751 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1750 1751 
+      1734 1735 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1734 1735 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1734 1735 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1734 1735 
+      1750 1751 0 0 0 0 0 0 0 0 0 1732 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1750 1751 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1750 1751 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1750 1751 
       1655 1656 1657 1658 1659 1660 1655 1656 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 
       1671 1672 1673 1674 1675 1676 1671 1672 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 1684 1700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1667 1668 1699 1700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1651 1652 1683 1684 1715 1716 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1667 1668 1699 1700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1683 1684 1715 1716 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1699 1700 1731 1732 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
+      1702 1703 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1702 1703 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1702 1703 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1702 1703 
+      1718 1719 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1718 1719 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1718 1719 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1718 1719 
+      1734 1735 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1734 1735 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1734 1735 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1734 1735 
+      1750 1751 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1750 1751 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1750 1751 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1750 1751 
+      1734 1735 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1734 1735 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1734 1735 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1734 1735 
+      1750 1751 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1750 1751 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1750 1751 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1750 1751 
       1655 1656 1657 1658 1659 1660 1655 1656 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1656 1657 1658 1659 1660 1655 1656 1657 1658 1659 1660 1655 1656 1657 1658 
       1671 1672 1673 1674 1675 1676 1671 1672 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1672 1673 1674 1675 1676 1671 1672 1673 1674 1675 1676 1671 1672 1673 1674 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
-      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
+      1702 1703 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1702 1703 
+      1718 1719 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1718 1719 
+      1734 1735 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1734 1735 
+      1750 1751 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1750 1751 
      ))
+    (scriptable-object
+      (sprite "images/objects/plant.sprite")
+      (pos 650 160)
+      (z-pos -100)
+    )
+    (scriptable-object
+      (sprite "images/objects/plant.sprite")
+      (pos 210 160)
+      (z-pos -100)
+    )
+    (scriptable-object
+      (sprite "images/objects/cabinet.sprite")
+      (pos 700 148)
+      (z-pos -100)
+    )
+    (scriptable-object
+      (sprite "images/objects/cabinet.sprite")
+      (pos 764 148)
+      (z-pos -100)
+    )
+    (scriptable-object
+      (sprite "images/objects/cabinet.sprite")
+      (pos 828 148)
+      (z-pos -100)
+    )
+    (scriptable-object
+      (sprite "images/objects/showerdoors.sprite")
+      (pos 919 120)
+      (z-pos -100)
+    )
+    (scriptable-object
+      (sprite "images/objects/apartmentlamp.sprite")
+      (highlight "images/objects/apartmentlamp_highlight.sprite")
+      (light "images/objects/apartmentlamp_light.sprite")
+      (pos 1280 64)
+    )
+    (scriptable-object
+      (sprite "images/objects/apartmentlamp.sprite")
+      (highlight "images/objects/apartmentlamp_highlight.sprite")
+      (light "images/objects/apartmentlamp_light.sprite")
+      (pos 768 64)
+    )
+    (scriptable-object
+      (sprite "images/objects/apartmentlamp.sprite")
+      (highlight "images/objects/apartmentlamp_highlight.sprite")
+      (light "images/objects/apartmentlamp_light.sprite")
+      (pos 256 64)
+    )
+    (scriptable-object
+      (name "Painting1")
+      (pos 72 135)
+      (z-pos -100)
+      (sprite "images/objects/painting1.sprite")
+      (active true)
+      (script "")
+      (use-verb "Look")
+    )
+    (scriptable-object
+      (name "Painting1")
+      (pos 72 135)
+      (z-pos -100)
+      (sprite "images/objects/painting1.sprite")
+      (active true)
+      (script "")
+      (use-verb "Look")
+    )
+    (scriptable-object
+      (name "Painting2")
+      (pos 336 125)
+      (z-pos -100)
+      (sprite "images/objects/painting2.sprite")
+      (active true)
+      (script "")
+      (use-verb "Look")
+    )
+    (scriptable-object
+      (name "Painting3")
+      (pos 563 131)
+      (z-pos -100)
+      (sprite "images/objects/painting3.sprite")
+      (active true)
+      (script "")
+      (use-verb "Look")
+    )
+    (character
+      (name "bob")
+      (pos 320 544)
+      (z-pos -1050)
+      (sprite3d "models/vehicles/train/train.wsprite")
+    )
+    (character
+      (name "yagor")
+      (pos 180 256)
+      (z-pos -150)
+      (sprite3d "models/characters/yagor/yagor.wsprite")
+    )
+    
+    (scriptable-object      
+     (name "flashlight")
+     (active #f)
+     (light  "images/flashlightlight.sprite")
+     (highlight "images/flashlighthighlight.sprite")
+     (pos -40 -80)
+     )
 
-(scriptable-object (sprite "images/objects/plant.sprite") (pos 650 160) (z-pos 0))
-(scriptable-object (sprite "images/objects/plant.sprite") (pos 210 160) (z-pos 0))
-(scriptable-object (sprite "images/objects/cabinet.sprite") (pos 700 148) (z-pos 0))
-(scriptable-object (sprite "images/objects/cabinet.sprite") (pos 764 148) (z-pos 0))
-(scriptable-object (sprite "images/objects/cabinet.sprite") (pos 828 148) (z-pos 0))
-(scriptable-object (sprite "images/objects/showerdoors.sprite") (pos 919 120) (z-pos 0))
-(scriptable-object (sprite "images/objects/apartmentlamp.sprite") (highlight "images/objects/apartmentlamp_highlight.sprite") (light "images/objects/apartmentlamp_light.sprite") (pos 1280 64))
-(scriptable-object (sprite "images/objects/apartmentlamp.sprite") (highlight "images/objects/apartmentlamp_highlight.sprite") (light "images/objects/apartmentlamp_light.sprite") (pos 768 64))
-(scriptable-object (sprite "images/objects/apartmentlamp.sprite") (highlight "images/objects/apartmentlamp_highlight.sprite") (light "images/objects/apartmentlamp_light.sprite") (pos 256 64))
-(scriptable-object (name "Painting1") (pos 72 135) (z-pos  -100) (sprite "images/objects/painting1.sprite") (active true))
-(scriptable-object (name "Painting1") (pos 72 135) (z-pos  -100) (sprite "images/objects/painting1.sprite") (active true))
-(scriptable-object (name "Painting2") (pos 336 125) (z-pos -100) (sprite "images/objects/painting2.sprite") (active true))
-(scriptable-object (name "Painting3") (pos 563 131) (z-pos -100) (sprite "images/objects/painting3.sprite") (active true))
    )
  )
 

Modified: trunk/data/levels/industrial.wst
===================================================================
--- trunk/data/levels/industrial.wst	2005-09-17 12:05:47 UTC (rev 1083)
+++ trunk/data/levels/industrial.wst	2005-09-17 12:08:44 UTC (rev 1084)
@@ -17,10 +17,9 @@
     (particle-system
      (lifetime   2.0)
      (count      35)
-     (pos       0 0)
 
      (z-pos  1000)
-     (spawn-point 386 736)
+     (pos 386 736)
      (velocity    50 60)
      (cone   -110 -80)
      (gravity -1.5 0.5)
@@ -34,10 +33,9 @@
     (particle-system
      (lifetime   1.5)
      (count      35)
-     (pos       0 0)
 
      (z-pos  1000)
-     (spawn-point 900 736)
+     (pos 900 736)
      (velocity    150 160)
      (cone   -110 -80)
      (gravity -1.5 0.5)
@@ -57,7 +55,7 @@
 
    (character
       (name "bob")
-      (sprite3d "3dsprites/barkeeper.wsprite")
+      (sprite3d "models/characters/bob/bob.wsprite")
       (pos 768 736)
     )
  

Modified: trunk/data/levels/newformat2.wst
===================================================================
--- trunk/data/levels/newformat2.wst	2005-09-17 12:05:47 UTC (rev 1083)
+++ trunk/data/levels/newformat2.wst	2005-09-17 12:08:44 UTC (rev 1084)
@@ -27,11 +27,10 @@
     (particle-system
      (lifetime   1.0)
      (count      15)
-     (pos       0 0)
      (bunching 0.8)
 
      (z-pos  1000)
-     (spawn-point 128 800)
+     (pos 128 800)
      (velocity    150 200)
      (cone   -10 10)
      (gravity -0.5 -1.5)
@@ -44,9 +43,8 @@
     (particle-system
      (lifetime   0.6)
      (count      250)
-     (pos       0 0)
      (z-pos  1000)
-     (spawn-point 532 640)
+     (pos 532 640)
      (velocity    150 200)
      (cone   70 110)
      (gravity 0 5)
@@ -59,9 +57,8 @@
     (particle-system
      (lifetime   .2)
      (count      50)
-     (pos       0 0)
      (z-pos  1000)
-     (spawn-point 532 836)
+     (pos 532 836)
      (velocity    50 100)
      (cone   -110 -70)
      (gravity 0 5)
@@ -73,9 +70,8 @@
     ;; Fire sparks
     (particle-system
      (drawer (spark-drawer (color 1.0 0.5 0.5)))
-     (pos 0 0)
      (z-pos 900)
-     (spawn-point 768 832)
+     (pos 768 832)
      (velocity 300 550)
      (cone -115 -65)
      (gravity 0  5)
@@ -83,14 +79,13 @@
     
     ;; Fire smoke
     (particle-system
-     (spawn-point 768 832)
+     (pos 768 832)
      (lifetime 8)
      (count 30)
      (z-pos -200)
      (drawer (surface-drawer (image "images/particles/smoke2.png")
                              (blendfunc-src "src_alpha")
                              (blendfunc-dst "one_minus_src_alpha")))
-     (pos 0 0)
      (velocity 70 100)
      (cone -115 -65)
      (gravity 0 -1)
@@ -100,11 +95,10 @@
     ;; Burning player
     (particle-system
      (name "player_flames")
-     (spawn-point 0 0)
+     (pos 0 0)
      (count 40)
      (z-pos 1000)
      (lifetime   .5)
-     (pos 0 0)
      (velocity 100 200)
      (color-begin 1.0 1.0 1.0 0.5)
      (cone -95 -85)
@@ -118,10 +112,9 @@
     (particle-system
      (name "player_flames2")
      (lifetime   .5)
-     (spawn-point 0 0)
+     (pos 0 0)
      (count 40)
      (z-pos -100)
-     (pos 0 0)
      (velocity 100 200)
      (cone -95 -85)
      (gravity 0 0)
@@ -132,13 +125,27 @@
                              (blendfunc-src "src_alpha")
                              (blendfunc-dst "one"))))
 
+    ;; Fire Light
+    (particle-system
+     (pos 768 800)
+     (lifetime 1.0)
+     (count 20)
+     (layer "light")
+     (z-pos 1000)
+     (velocity 200 300)
+     (cone -95 -85)
+     (gravity 0 0)
+     (distribution (line-distribution (x1 -50) (y1 0) (x2 50) (y2 0)))
+     (drawer (surface-drawer (image "images/particles/fire_light.png")
+                             (blendfunc-src "src_alpha")
+                             (blendfunc-dst "one"))))
     
     ;; Fire itself
     (particle-system
-     (spawn-point 768 832)
+     (pos 768 832)
      (count 50)
      (z-pos 1000)
-     (pos 0 0)
+     (layer "highlight")
      (velocity 200 300)
      (cone -95 -85)
      (gravity 0 0)
@@ -148,10 +155,9 @@
                              (blendfunc-dst "one"))))
 
     (particle-system
-     (spawn-point 768 832)
+     (pos 768 832)
      (count 50)
      (z-pos -10)
-     (pos 0 0)
      (velocity 200 300)
      (cone -95 -85)
      (gravity 0 0)
@@ -224,7 +230,7 @@
       (sprite "images/objects/vrdoor-color.sprite")
       (highlight "images/objects/vrdoor-highlight.sprite")
       (pos 384 704)
-      (script "set_sector(\"levels/newformat2.wst\")")
+      (script "set_sector(\"levels/industrial.wst\")")
       (use-verb "Enter")
     )
 

Copied: trunk/data/models/characters/yagor/clothtexture.png (from rev 1006, trunk/data/3dsprites/clothtexture.png)

Copied: trunk/data/models/characters/yagor/facetexture.png (from rev 1006, trunk/data/3dsprites/facetexture.png)

Copied: trunk/data/models/characters/yagor/yagor.wsprite (from rev 1006, trunk/data/3dsprites/yagor.wsprite)

Modified: trunk/data/scripts/newformat2/bob.nut
===================================================================
--- trunk/data/scripts/newformat2/bob.nut	2005-09-17 12:05:47 UTC (rev 1083)
+++ trunk/data/scripts/newformat2/bob.nut	2005-09-17 12:08:44 UTC (rev 1084)
@@ -65,7 +65,7 @@
     dialog.show("See you again some time");
 }
 
-dialog <- Dialog(0, "Bob", "images/portrait.sprite");
+dialog <- Dialog(0, "Bob", "images/portraits/bob.sprite");
 if (is_objective_given("Kill spider"))
   explain_job();
 else if (bob_knows_you_mercenary)

Modified: trunk/data/scripts/newformat2/frank.nut
===================================================================
--- trunk/data/scripts/newformat2/frank.nut	2005-09-17 12:05:47 UTC (rev 1083)
+++ trunk/data/scripts/newformat2/frank.nut	2005-09-17 12:08:44 UTC (rev 1084)
@@ -1,7 +1,7 @@
 
 /* play_sound("sounds/speech/vr_intro.ogg"); */
 println("Dislaying dialog");
-add_dialog(TOP, "Frank", "images/portrait.sprite", 
+add_dialog(TOP, "Frank", "images/portraits/sophie.sprite", 
        "<sin>Welcome</sin> to the <large>VR training program</large>. Here you " +
        "will learn the <sin>basic manoeuvering</sin> abilities of <large>your</large> " +
        "powersuit,<sleep> jumping,<sleep> running, <sleep> climbing<sleep> and shooting. " +



From matzebraun at berlios.de  Sat Sep 17 14:08:58 2005
From: matzebraun at berlios.de (Matthias Braun at BerliOS)
Date: Sat, 17 Sep 2005 14:08:58 +0200
Subject: [Windstille-commit] r1085 - trunk/data/controller
Message-ID: <200509171208.j8HC8wXu012870@sheep.berlios.de>

Author: matzebraun
Date: 2005-09-17 14:08:50 +0200 (Sat, 17 Sep 2005)
New Revision: 1085

Modified:
   trunk/data/controller/keyboard.scm
Log:
define an aim button (k is a totally random choice)

Modified: trunk/data/controller/keyboard.scm
===================================================================
--- trunk/data/controller/keyboard.scm	2005-09-17 12:08:44 UTC (rev 1084)
+++ trunk/data/controller/keyboard.scm	2005-09-17 12:08:50 UTC (rev 1085)
@@ -25,7 +25,7 @@
   (joystick-button (device 0)  (button 0)))
 
  (aim-button
-  (keyboard-button (key "shift"))
+  (keyboard-button (key "k"))
   (joystick-button (device 0)  (button 7)))
  
  (pause-button
@@ -37,4 +37,4 @@
  )
 
 
-;; EOF ;;
\ No newline at end of file
+;; EOF ;;



From matzebraun at berlios.de  Sat Sep 17 14:23:28 2005
From: matzebraun at berlios.de (Matthias Braun at BerliOS)
Date: Sat, 17 Sep 2005 14:23:28 +0200
Subject: [Windstille-commit] r1086 - trunk/src
Message-ID: <200509171223.j8HCNSnh013881@sheep.berlios.de>

Author: matzebraun
Date: 2005-09-17 14:23:25 +0200 (Sat, 17 Sep 2005)
New Revision: 1086

Modified:
   trunk/src/physics.cpp
   trunk/src/windstille_main.cpp
Log:
fix physics class, don't forget to call SDL_Quit

Modified: trunk/src/physics.cpp
===================================================================
--- trunk/src/physics.cpp	2005-09-17 12:08:50 UTC (rev 1085)
+++ trunk/src/physics.cpp	2005-09-17 12:23:25 UTC (rev 1086)
@@ -25,11 +25,7 @@
 void
 Physics::collision(const CollisionData& data)
 {
-  printf("collision %p - %p\n", data.object1, data.object2);
   GameObject* other_object = data.object2->get_game_object();
-  
-  if(other_object == 0)
-    return;
 
   const Physics* physics = dynamic_cast<const Physics*> (other_object);
   if(physics)
@@ -60,8 +56,8 @@
   new_v += other_collision_vel * (2 * other.mass);
   new_v /= mass + other.mass;
 
-  // velocity += new_v - collision_vel
-  force += (new_v - collision_vel) * mass / data.delta;
+  velocity() += new_v - collision_vel;  
+  //force += (new_v - collision_vel) * mass / data.delta;
 
   // TODO apply friction here?
 }
@@ -73,8 +69,8 @@
   Vector collision_vel
     = data.direction * (velocity() * data.direction);
 
-  // velocity -= collision_vel * (1.0 + bounciness)
-  force -= collision_vel * (1.0f + bounciness) * mass / data.delta;
+  velocity() -= collision_vel * (1.0 + bounciness);
+  //force -= collision_vel * (1.0f + bounciness) * mass / data.delta;
 
   // TODO apply friction
 }
@@ -82,8 +78,6 @@
 void
 Physics::update(float elapsed_time)
 {
-  // take a look at verlet integration, might work better than euler here
- 
   // add gravity force (TODO make it configurable per Sector)
   force += Vector(0, 9.81 * mass);
 

Modified: trunk/src/windstille_main.cpp
===================================================================
--- trunk/src/windstille_main.cpp	2005-09-17 12:08:50 UTC (rev 1085)
+++ trunk/src/windstille_main.cpp	2005-09-17 12:23:25 UTC (rev 1086)
@@ -240,6 +240,7 @@
   delete dictionaryManager;
   dictionaryManager = 0;
   
+  SDL_Quit();
   PHYSFS_deinit();
 
   return 0;



From grumbel at berlios.de  Sat Sep 17 18:35:35 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Sat, 17 Sep 2005 18:35:35 +0200
Subject: [Windstille-commit] r1087 - trunk/data/images/particles
Message-ID: <200509171635.j8HGZZqC009245@sheep.berlios.de>

Author: grumbel
Date: 2005-09-17 18:34:47 +0200 (Sat, 17 Sep 2005)
New Revision: 1087

Added:
   trunk/data/images/particles/fire_light.png
Log:
- missing image

Added: trunk/data/images/particles/fire_light.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/particles/fire_light.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From grumbel at berlios.de  Sun Sep 18 00:53:03 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Sun, 18 Sep 2005 00:53:03 +0200
Subject: [Windstille-commit] r1088 - trunk/data/images/objects
Message-ID: <200509172253.j8HMr3eR030432@sheep.berlios.de>

Author: grumbel
Date: 2005-09-18 00:52:45 +0200 (Sun, 18 Sep 2005)
New Revision: 1088

Added:
   trunk/data/images/objects/plants.xcf
Log:
- some more images

Added: trunk/data/images/objects/plants.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/plants.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From grumbel at berlios.de  Sun Sep 18 01:08:40 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Sun, 18 Sep 2005 01:08:40 +0200
Subject: [Windstille-commit] r1089 - trunk/data/images/objects
Message-ID: <200509172308.j8HN8erZ007404@sheep.berlios.de>

Author: grumbel
Date: 2005-09-18 01:07:24 +0200 (Sun, 18 Sep 2005)
New Revision: 1089

Added:
   trunk/data/images/objects/dirt.xcf
Log:
- some more images

Added: trunk/data/images/objects/dirt.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/objects/dirt.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From matzebraun at berlios.de  Thu Sep 22 13:07:13 2005
From: matzebraun at berlios.de (Matthias Braun at BerliOS)
Date: Thu, 22 Sep 2005 13:07:13 +0200
Subject: [Windstille-commit] r1090 - in trunk: data/3dsprites docs src src/collision src/display src/gui src/input src/math src/sprite3d tools
Message-ID: <200509221107.j8MB7D9S003070@sheep.berlios.de>

Author: matzebraun
Date: 2005-09-22 13:06:50 +0200 (Thu, 22 Sep 2005)
New Revision: 1090

Added:
   trunk/src/math/quaternion.cpp
   trunk/src/math/quaternion.hpp
   trunk/src/math/vector3.hpp
   trunk/src/pistol.cpp
   trunk/src/pistol.hpp
   trunk/src/weapon.hpp
Modified:
   trunk/data/3dsprites/heroken.wsprite
   trunk/docs/models.txt
   trunk/docs/wsprite_fileformat.txt
   trunk/src/Jamfile
   trunk/src/collision/stair_contact.cpp
   trunk/src/controller_help_window.cpp
   trunk/src/display/display.cpp
   trunk/src/display/drawing_context.cpp
   trunk/src/display/drawing_context.hpp
   trunk/src/display/scene_context.cpp
   trunk/src/display/scene_context.hpp
   trunk/src/energy_bar.cpp
   trunk/src/game_object.hpp
   trunk/src/game_session.cpp
   trunk/src/gui/button.cpp
   trunk/src/gui/list_view.cpp
   trunk/src/gui/tab_component.cpp
   trunk/src/input/input_configurator.cpp
   trunk/src/laser_pointer.cpp
   trunk/src/laser_pointer.hpp
   trunk/src/math/Jamfile
   trunk/src/math/vector.cpp
   trunk/src/math/vector.hpp
   trunk/src/physics.cpp
   trunk/src/player.cpp
   trunk/src/player.hpp
   trunk/src/screen_manager.cpp
   trunk/src/sprite3d/data.cpp
   trunk/src/sprite3d/data.hpp
   trunk/src/sprite3d/sprite3d.cpp
   trunk/tools/windstille_export.py
Log:
- Fixed exporter to export attachement-points correctly
- Fixed coordinate system inconsistencies in exporter and windstille
- added a new quaternion class that does slerp correctly now
- added a weapon class and tried to attach a pistol to the hero,
    works in principle but the rotation is 180degrees of for some reason...



Modified: trunk/data/3dsprites/heroken.wsprite
===================================================================
(Binary files differ)

Modified: trunk/docs/models.txt
===================================================================
--- trunk/docs/models.txt	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/docs/models.txt	2005-09-22 11:06:50 UTC (rev 1090)
@@ -10,20 +10,15 @@
 - When looking at a character turned left from the side, coordinate axes are:
     z -> up
     y -> right
-    x -> back
+    x -> front
   (the exporter will convert these to windstille coordinates which are
    x->right, y -> down, z -> back)
-- Each blender object should use exactly 1 texture on all it's faces.
+- Each blender object should use the same texture on all it's faces.
+   (you can have multiple objects per model of course)
 - You should animate your models with armatures. The exporter will grab all
   defined actions for the armature and export these. You are only allowed to
-  have 1 armature object in the scene at the moment (but this armature can have
-  multiple bones of course)
-- Only for information you don't have to care about this: UVs in blender are
-    u -> right
-    v -> up
-  UVs in windstille are
-    u -> right
-    v -> down
+  have 1 armature object in the scene at the moment
+- Empty Objects whose names start with A: are exported as attachement points
 - Take a look at the console output to see warnings and errors from the script
 - You should specify additional attributes for the actions by creating a blender
   textobject with name "actionconfig". You can then specify lines like this
@@ -52,3 +47,10 @@
 
     So you can easily zoom in and watch your animation in slow motion with
     these keys.
+
+(- Only for information you don't have to care about this: UVs in blender are
+    u -> right
+    v -> up
+  UVs in windstille are
+    u -> right
+    v -> down)

Modified: trunk/docs/wsprite_fileformat.txt
===================================================================
--- trunk/docs/wsprite_fileformat.txt	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/docs/wsprite_fileformat.txt	2005-09-22 11:06:50 UTC (rev 1090)
@@ -1,39 +1,39 @@
 Header
-char magic[4] (= W3DS)
-uint16_t format_version      (=2 at the moment)
-uint16_t mesh_count
-uint16_t attachement_point_count
-uint16_t action_count
+    char magic[4] (= W3DS)
+    uint16_t format_version      (=2 at the moment)
+    uint16_t mesh_count
+    uint16_t attachement_point_count
+    uint16_t action_count
 
 Mesh Header
-char texturename[64]
-uint16_t triangle_count
-uint16_t vertex_count
+    char texturename[64]
+    uint16_t triangle_count
+    uint16_t vertex_count
 
 Data after mesh header:
-uint16_t vertexnum, edge per triangle
-float normal[3] per triangle
-float texcoord[2] per vertex
+    uint16_t vertexnum, edge per triangle
+    float normal[3] per triangle
+    float texcoord[2] per vertex
 
 Attachement Point Header
-char name[64]
+    char name[64]
 
 Action Header
-char name[64]
-float speed
-uint16_t marker_count
-uint16_t frame_count
+    char name[64]
+    float speed
+    uint16_t marker_count
+    uint16_t frame_count
 
 Data per marker:
-char name[64]
-uint16_t frame
+    char name[64]
+    uint16_t frame
 
 Data per action:
-for all frames:
-  for all meshes:
-    for all vertices:
-      float x, y, z
-  for all attachement points:
-    float locX, locY, locZ
-    float rotW, rotX, rotY, rotZ (it's a quaternion)
+    for all frames:
+      for all meshes:
+        for all vertices:
+          float x, y, z
+      for all attachement points:
+        float locX, locY, locZ
+        float rotW, rotX, rotY, rotZ (it's a quaternion)
 

Modified: trunk/src/Jamfile
===================================================================
--- trunk/src/Jamfile	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/Jamfile	2005-09-22 11:06:50 UTC (rev 1090)
@@ -76,6 +76,8 @@
         physics.hpp
         pda.cpp
         pda.hpp
+        pistol.cpp
+        pistol.hpp
         player.cpp
         player.hpp
         random.cpp

Modified: trunk/src/collision/stair_contact.cpp
===================================================================
--- trunk/src/collision/stair_contact.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/collision/stair_contact.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -39,7 +39,7 @@
 }
 
 void
-StairContact::update(float delta)
+StairContact::update(float )
 {
   // shouldn't be needed!?
 }

Modified: trunk/src/controller_help_window.cpp
===================================================================
--- trunk/src/controller_help_window.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/controller_help_window.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -107,7 +107,7 @@
 }
 
 void
-ControllerHelpWindow::update(float delta, const Controller& controller)
+ControllerHelpWindow::update(float delta, const Controller& )
 {
   impl->text_area->update(delta);
 }

Modified: trunk/src/display/display.cpp
===================================================================
--- trunk/src/display/display.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/display/display.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -29,6 +29,7 @@
 #include "gameconfig.hpp"
 #include "glutil/opengl_state.hpp"
 #include "display.hpp"
+#include "util.hpp"
 #include <GL/glext.h>
 
 SDL_Surface* Display::window       = 0;
@@ -231,7 +232,7 @@
 #define cl_pixelcenter_constant 0.375
 
   //glOrtho(0.0, window->w, window->h, 0.0, -1000.0, 1000.0);
-  glOrtho(0.0, 800, 600, 0.0, -1000.0, 1000.0);
+  glOrtho(0.0, 800, 600, 0.0, 1000.0, -1000.0);
   glMatrixMode(GL_MODELVIEW);
   glLoadIdentity();
   glTranslated(cl_pixelcenter_constant, cl_pixelcenter_constant, 0.0);
@@ -239,6 +240,8 @@
   if (config->antialiasing)
     glEnable(GL_MULTISAMPLE_ARB); 
 
+  assert_gl("setup projection");
+
   OpenGLState::init();
 }
 

Modified: trunk/src/display/drawing_context.cpp
===================================================================
--- trunk/src/display/drawing_context.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/display/drawing_context.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -21,7 +21,7 @@
 #include <iostream>
 #include <iosfwd>
 #include <GL/gl.h>
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "sprite2d/sprite.hpp"
 #include "drawing_context.hpp"
 #include "glutil/opengl_state.hpp"
@@ -157,7 +157,7 @@
 }
 
 void
-DrawingContext::draw(Surface surface, float x, float y, float z, float a)
+DrawingContext::draw(Surface surface, float x, float y, float z, float )
 {
   draw(new SurfaceDrawingRequest(surface,
                                  SurfaceDrawingParameters().set_pos(Vector(x, y)),
@@ -230,6 +230,12 @@
 }
 
 void
+DrawingContext::mult(const Matrix& matrix)
+{
+  modelview_stack.back() = modelview_stack.back().multiply(matrix);
+}
+
+void
 DrawingContext::push_modelview()
 {
   modelview_stack.push_back(modelview_stack.back());

Modified: trunk/src/display/drawing_context.hpp
===================================================================
--- trunk/src/display/drawing_context.hpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/display/drawing_context.hpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -82,6 +82,9 @@
   /** Set the scaling of the drawing context */
   void scale(float x, float y, float z = 1.0f);
 
+  /** multiply the modelview of the context */
+  void mult(const Matrix& matrix);
+
   void push_modelview();
   void pop_modelview();
   void reset_modelview();

Modified: trunk/src/display/scene_context.cpp
===================================================================
--- trunk/src/display/scene_context.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/display/scene_context.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -102,6 +102,14 @@
 }
 
 void
+SceneContext::mult_modelview(const Matrix& matrix)
+{
+  impl->color.mult(matrix);
+  impl->light.mult(matrix);
+  impl->highlight.mult(matrix);
+}
+
+void
 SceneContext::push_modelview()
 {
   impl->color.push_modelview();

Modified: trunk/src/display/scene_context.hpp
===================================================================
--- trunk/src/display/scene_context.hpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/display/scene_context.hpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -63,6 +63,8 @@
   /** Set the scaling of the drawing context */
   void scale(float x, float y);
 
+  void mult_modelview(const Matrix& matrix);
+
   void push_modelview();
   void pop_modelview();
   void reset_modelview();

Modified: trunk/src/energy_bar.cpp
===================================================================
--- trunk/src/energy_bar.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/energy_bar.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -53,7 +53,7 @@
 }
 
 void
-EnergyBar::update(float delta, const Controller& controller)
+EnergyBar::update(float delta, const Controller& )
 {
   bar.update(delta);
 }

Modified: trunk/src/game_object.hpp
===================================================================
--- trunk/src/game_object.hpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/game_object.hpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -26,13 +26,17 @@
 
 class Sector;
 
+/**
+ * This is the base class for all in-game objects. The sector class keeps a list
+ * of all GameObject and periodically calls draw() and update() for them.
+ */
 class GameObject : public RefCounter
 {
 private:
   static Sector* world;
   
 protected:
-  bool removable;
+  bool remove_flag;
 
   /**
    * name of the GameObject. Note: You should not change it anymore once the
@@ -43,28 +47,55 @@
   /** If a object is 'active = false' it will neither be drawn or updated */
   bool active;
 public:
-  GameObject() : removable(false), active(true) {}
+  GameObject() : remove_flag(false), active(true) {}
   virtual ~GameObject() {}
 
-
+  /**
+   * Set the remove flag to true which will result in the object being removed
+   * from the world till the next frame
+   */
   void remove()
   {
-    removable = true;
+    remove_flag = true;
   }
+  /**
+   * Returns the state of the remove flag
+   */
   bool is_removable() const
   {
-    return removable;
+    return remove_flag;
   }
 
+  /**
+   * return the name of the object
+   * The name is guaranteed to stay the same during the whole lifetime of
+   * the object
+   */
   const std::string& get_name() const
   {
     return name;
   }
 
+  /**
+   * Activate or Deactivate an object. A deactivated object is not updated
+   * or drawn until it is activated again
+   */
   void set_active(bool a) { active = a; }
+  /**
+   * Returns true if the object is active, false if it is inactive
+   */
   bool is_active() const { return active; }
 
+  /**
+   * The object should draw itself when this function is called
+   */
   virtual void draw (SceneContext& context) = 0;
+  /**
+   * This function is called from time to time to give the object a chance to
+   * update it's state. elapsed_time is the time that elapsed since the last
+   * update call in seconds. It is possible that there are multiple objects
+   * between 2 draw() calls or multiple draw() calls between 2 updates
+   */
   virtual void update (float elapsed_time) = 0;
     
   static void set_world (Sector* w) { world = w; }

Modified: trunk/src/game_session.cpp
===================================================================
--- trunk/src/game_session.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/game_session.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -276,7 +276,7 @@
 }
 
 void
-GameSession::set_sector(const std::string& arg_filename)
+GameSession::set_sector(const std::string& )
 {
   delete impl->sector;
   impl->sector = new Sector(impl->filename);

Modified: trunk/src/gui/button.cpp
===================================================================
--- trunk/src/gui/button.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/gui/button.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -24,7 +24,7 @@
 */
 
 #include "display/display.hpp"
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "input/controller.hpp"
 #include "button.hpp"
 
@@ -53,7 +53,7 @@
 }
 
 void
-Button::update(float delta, const Controller& controller)
+Button::update(float , const Controller& controller)
 {
   for(InputEventLst::const_iterator i = controller.get_events().begin(); i != controller.get_events().end(); ++i) 
     {

Modified: trunk/src/gui/list_view.cpp
===================================================================
--- trunk/src/gui/list_view.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/gui/list_view.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -25,7 +25,7 @@
 
 #include "display/display.hpp"
 #include "input/controller.hpp"
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "list_view.hpp"
 
 namespace GUI {
@@ -81,7 +81,7 @@
 }
 
 void
-ListView::update(float delta, const Controller& controller)
+ListView::update(float , const Controller& controller)
 {
    for(InputEventLst::const_iterator i = controller.get_events().begin(); 
        i != controller.get_events().end(); ++i) 

Modified: trunk/src/gui/tab_component.cpp
===================================================================
--- trunk/src/gui/tab_component.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/gui/tab_component.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -24,7 +24,7 @@
 */
 
 #include "input/controller.hpp"
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "display/display.hpp"
 #include "tab_component.hpp"
 

Modified: trunk/src/input/input_configurator.cpp
===================================================================
--- trunk/src/input/input_configurator.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/input/input_configurator.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -26,7 +26,7 @@
 #include "display/display.hpp"
 #include "math/rect.hpp"
 #include "controller_def.hpp"
-#include "fonts.hpp"
+#include "font/fonts.hpp"
 #include "screen_manager.hpp"
 #include "input/input_manager_sdl.hpp"
 #include "input_configurator.hpp"
@@ -90,7 +90,7 @@
 }
 
 void
-InputConfigurator::update(float delta, const Controller& controller)
+InputConfigurator::update(float , const Controller& )
 {
   
 }

Modified: trunk/src/laser_pointer.cpp
===================================================================
--- trunk/src/laser_pointer.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/laser_pointer.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -125,7 +125,7 @@
   array->vertex(pos.x, pos.y);
 
   array->color(Color(1.0f, 0.0f, 0.0f, 1.0f));
-  array->texcoord((target - pos).norm()/256.0f, progress);
+  array->texcoord((target - pos).magnitude()/256.0f, progress);
   array->vertex(target.x, target.y);
 
   sc.highlight().draw(array);

Modified: trunk/src/laser_pointer.hpp
===================================================================
--- trunk/src/laser_pointer.hpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/laser_pointer.hpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -26,6 +26,8 @@
 #ifndef HEADER_WINDSTILLE_LASER_POINTER_HPP
 #define HEADER_WINDSTILLE_LASER_POINTER_HPP
 
+#include "sprite2d/sprite.hpp"
+#include "glutil/texture.hpp"
 #include "game_object.hpp"
 
 /** Simple class that generates a laser for pointing at objects */

Modified: trunk/src/math/Jamfile
===================================================================
--- trunk/src/math/Jamfile	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/math/Jamfile	2005-09-22 11:06:50 UTC (rev 1090)
@@ -10,6 +10,8 @@
           origin.hpp
           origin.cpp
           point.hpp
+          quaternion.hpp
+          quaternion.cpp
 ;
 
 TRANSLATABLE_SOURCES = [ SearchSource $(sources) ] ;

Added: trunk/src/math/quaternion.cpp
===================================================================
--- trunk/src/math/quaternion.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/math/quaternion.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -0,0 +1,105 @@
+//  $Id$
+// 
+//  Windstille - A Jump'n Shoot Game
+//  Copyright (C) 2005 Matthias Braun <matze at braunis.de>
+//
+//  This program is free software; you can redistribute it and/or
+//  modify it under the terms of the GNU General Public License
+//  as published by the Free Software Foundation; either version 2
+//  of the License, or (at your option) any later version.
+//
+//  This program is distributed in the hope that it will be useful,
+//  but WITHOUT ANY WARRANTY; without even the implied warranty of
+//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+//  GNU General Public License for more details.
+// 
+//  You should have received a copy of the GNU General Public License
+//  along with this program; if not, write to the Free Software
+//  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+#include <config.h>
+
+#include "quaternion.hpp"
+
+#include <math.h>
+
+float
+Quaternion::magnitude() const
+{
+  return sqrt(w*w + x*x + y*y + z*z);
+}
+
+void
+Quaternion::normalize()
+{
+  float mag = magnitude();
+  w /= mag;
+  x /= mag;
+  y /= mag;
+  z /= mag;
+}
+
+Matrix
+Quaternion::to_matrix() const
+{
+  Matrix r;
+  r.matrix[0]  = 1.0f - 2.0f * (y*y + z*z);
+  r.matrix[4]  =        2.0f * (x*y - z*w);
+  r.matrix[8]  =        2.0f * (x*z + y*w);
+  r.matrix[12] = 0.0f;
+
+  r.matrix[1]  =        2.0f * (x*y + z*w);
+  r.matrix[5]  = 1.0f - 2.0f * (x*x + z*z);
+  r.matrix[9]  =        2.0f * (y*z - x*w);
+  r.matrix[13] = 0.0f;
+  
+  r.matrix[2]  =        2.0f * (x*z - y*w);
+  r.matrix[6]  =        2.0f * (y*z + x*w);
+  r.matrix[10] = 1.0f - 2.0f * (x*x + y*y);
+  r.matrix[14] = 0.0f;
+
+  r.matrix[3]  = 0.0f;
+  r.matrix[7]  = 0.0f;
+  r.matrix[11] = 0.0f;
+  r.matrix[15] = 1.0f;
+
+  return r;
+}
+
+static float clamp(float val, float min, float max)
+{
+  if(val < min)
+    val = min;
+  else if(val > max)
+    val = max;
+
+  return val;
+}
+
+Quaternion
+Quaternion::slerp(const Quaternion& o, float t) const
+{
+  /** Matze: I don't understand this code :-/ It's from
+   * http://number-none.com/product/Understanding%20Slerp,%20Then%20Not%20Using%20It/
+   * Though the article recommends not to use slerp I see no code for the other
+   * methods so I'll use slerp anyway
+   */
+  float dot = dot_product(o);
+
+  const float DOT_THRESHOLD = 0.995;
+  if(dot > DOT_THRESHOLD) {
+    // quaternions are too close, lineary interpolate them
+    Quaternion result = *this + (o - *this)*t;
+    result.normalize();
+    return result;
+  }
+  
+  dot = clamp(dot, -1 ,1); // robustness
+  float theta_O = acos(dot);
+  float theta = theta_O * t;
+
+  Quaternion v2 = o - (*this * dot);
+  v2.normalize();
+
+  return (*this * cos(theta)) + (v2 * sin(theta));
+}
+

Added: trunk/src/math/quaternion.hpp
===================================================================
--- trunk/src/math/quaternion.hpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/math/quaternion.hpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -0,0 +1,82 @@
+//  $Id$
+// 
+//  Windstille - A Jump'n Shoot Game
+//  Copyright (C) 2005 Matthias Braun <matze at braunis.de>
+//
+//  This program is free software; you can redistribute it and/or
+//  modify it under the terms of the GNU General Public License
+//  as published by the Free Software Foundation; either version 2
+//  of the License, or (at your option) any later version.
+//
+//  This program is distributed in the hope that it will be useful,
+//  but WITHOUT ANY WARRANTY; without even the implied warranty of
+//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+//  GNU General Public License for more details.
+// 
+//  You should have received a copy of the GNU General Public License
+//  along with this program; if not, write to the Free Software
+//  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+#ifndef __QUATERNION_HPP__
+#define __QUATERNION_HPP__
+
+#include "matrix.hpp"
+
+class Quaternion
+{
+public:
+  float w;
+  float x;
+  float y;
+  float z;
+
+  Quaternion()
+    : w(0), x(0), y(0), z(0)
+  {}
+
+  Quaternion(float w, float x, float y, float z)
+    : w(w), x(x), y(y), z(z)
+  {}
+
+  float magnitude() const;
+  void normalize();
+
+  Quaternion operator* (const Quaternion& o) const
+  {
+    return Quaternion(
+      w*o.w - x*o.x - y*o.y - z*o.z,
+      w*o.x + x*o.w + y*o.z - z*o.y,
+      w*o.y + y*o.w + z*o.x - x*o.z,
+      w*o.z + z*o.w + x*o.y - y*o.x);
+  }
+
+  Quaternion operator- (const Quaternion& o) const
+  {
+    return Quaternion(w-o.w, x-o.x, y-o.y, z-o.z);
+  }
+
+  Quaternion operator+ (const Quaternion& o) const
+  {
+    return Quaternion(w+o.w, x+o.x, y+o.y, z+o.z);
+  }
+
+  Quaternion operator* (float s) const
+  {
+    return Quaternion(w*s, x*s, y*s, z*s);
+  }
+
+  float dot_product(const Quaternion& o) const
+  {
+    return x*o.x + y*o.y + z*o.z + w*o.w;
+  }
+
+  Matrix to_matrix() const;
+  /**
+   * spherical linear interpolation
+   * Returns this quaternion rotation added with t* the way from this quaternion
+   * to the o quaternion (so t should be between 0 and 1 usually)
+   */
+  Quaternion slerp(const Quaternion& o, float t) const;
+};
+
+#endif
+

Modified: trunk/src/math/vector.cpp
===================================================================
--- trunk/src/math/vector.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/math/vector.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -22,12 +22,21 @@
 #include <iostream>
 #include "math/vector.hpp"
 
+void
+Vector::normalize()
+{
+  float mag = magnitude();
+  x /= mag;
+  y /= mag;
+}
+
 Vector Vector::unit() const
 {
-  return *this / norm();
+  return *this / magnitude();
 }
 
-float Vector::norm() const
+float
+Vector::magnitude() const
 {
   return sqrt(x*x + y*y);
 }
@@ -41,7 +50,7 @@
 Vector
 Vector::rotate(float angle) const
 {
-  float len = norm();
+  float len = magnitude();
   return Vector(len * cos(angle), len * sin(angle));
 }
 

Modified: trunk/src/math/vector.hpp
===================================================================
--- trunk/src/math/vector.hpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/math/vector.hpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -116,8 +116,9 @@
       return x*other.x + y*other.y;
     }
 
-  float norm() const;
+  float magnitude() const;
   Vector unit() const;
+  void normalize();
 
   // ... add the other operators as needed, I'm too lazy now ...
 

Added: trunk/src/math/vector3.hpp
===================================================================
--- trunk/src/math/vector3.hpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/math/vector3.hpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -0,0 +1,107 @@
+//  $Id$
+// 
+//  Windstille - A Jump'n Shoot Game
+//  Copyright (C) 2005 Matthias Braun <matze at braunis.de>
+//
+//  This program is free software; you can redistribute it and/or
+//  modify it under the terms of the GNU General Public License
+//  as published by the Free Software Foundation; either version 2
+//  of the License, or (at your option) any later version.
+//
+//  This program is distributed in the hope that it will be useful,
+//  but WITHOUT ANY WARRANTY; without even the implied warranty of
+//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+//  GNU General Public License for more details.
+// 
+//  You should have received a copy of the GNU General Public License
+//  along with this program; if not, write to the Free Software
+//  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+#ifndef __VECTOR3_HPP__
+#define __VECTOR3_HPP__
+
+#include "math/matrix.hpp"
+
+/**
+ * A 3-dimensional vector
+ */
+class Vector3
+{
+public:
+  float x;
+  float y;
+  float z;
+
+  Vector3()
+    : x(0), y(0), z(0)
+  {}
+
+  Vector3(float x, float y, float z)
+    : x(x), y(y), z(z)
+  {}
+
+  bool operator== (const Vector3& o) const
+  {
+    return x == o.x && y == o.y && z == o.z;
+  }
+
+  bool operator !=(const Vector3& o) const
+  {
+    return x != o.x || y != o.y || z != o.z;
+  }
+
+  Vector3 operator- () const
+  {
+    return Vector3(-x, -y, -z);
+  }
+
+  Vector3 operator+ (const Vector3& o) const
+  {
+    return Vector3( x+o.x, y+o.y, z+o.z );
+  }
+
+  Vector3 operator- (const Vector3& o) const
+  {
+    return Vector3( x-o.x, y-o.y, z-o.z );
+  }
+
+  Vector3 operator* (float s) const
+  {
+    return Vector3(x * s, y * s, z * s);
+  }
+
+  const Vector3& operator+= (const Vector3& o)
+  {
+    x += o.x;
+    y += o.y;
+    z += o.z;
+    return *this;
+  }
+
+  const Vector3& operator-= (const Vector3& o)
+  {
+    x -= o.x;
+    y -= o.y;
+    z -= o.z;
+    return *this;
+  }
+
+  const Vector3& operator*= (const Vector3& o)
+  {
+    x *= o.x;
+    y *= o.y;
+    z *= o.z;
+    return *this;
+  }
+
+  Matrix to_matrix() const
+  {
+    Matrix result = Matrix::identity();
+    result.matrix[12] = x;
+    result.matrix[13] = y;
+    result.matrix[14] = z;
+    return result;
+  }
+};
+
+#endif
+

Modified: trunk/src/physics.cpp
===================================================================
--- trunk/src/physics.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/physics.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -5,8 +5,8 @@
 Physics::Physics(Entity* entity)
   : entity(entity)
 {
-  mass = 1.0;
-  bounciness = 0.0;
+  mass = 200.0;
+  bounciness = 1.0;
   air_friction = 0.0;
   contact_friction = 0.0;
 }
@@ -18,7 +18,6 @@
 void
 Physics::register_collobj(CollisionObject& object)
 {
-  printf("RegisterObject: %p\n", &object);
   slots.push_back(object.sig_collision().connect(this, &Physics::collision));
 }
 
@@ -81,7 +80,7 @@
   // add gravity force (TODO make it configurable per Sector)
   force += Vector(0, 9.81 * mass);
 
-  force -= velocity() * air_friction;
+  //force -= velocity() * air_friction;
   
   Vector acceleration = force / mass;
   velocity() += acceleration * elapsed_time;

Added: trunk/src/pistol.cpp
===================================================================
--- trunk/src/pistol.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/pistol.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -0,0 +1,56 @@
+//  $Id$
+// 
+//  Windstille - A Jump'n Shoot Game
+//  Copyright (C) 2005 Matthias Braun <matze at braunis.de>
+//
+//  This program is free software; you can redistribute it and/or
+//  modify it under the terms of the GNU General Public License
+//  as published by the Free Software Foundation; either version 2
+//  of the License, or (at your option) any later version.
+//
+//  This program is distributed in the hope that it will be useful,
+//  but WITHOUT ANY WARRANTY; without even the implied warranty of
+//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+//  GNU General Public License for more details.
+// 
+//  You should have received a copy of the GNU General Public License
+//  along with this program; if not, write to the Free Software
+//  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+#include <config.h>
+
+#include "laser_pointer.hpp"
+#include "pistol.hpp"
+
+Pistol::Pistol()
+  : laser_pointer(0)
+{
+  laser_pointer = new LaserPointer();
+  sprite = Sprite3D("models/objects/pistol/pistol.wsprite");
+}
+
+Pistol::~Pistol()
+{
+  delete laser_pointer;
+}
+
+void
+Pistol::draw(SceneContext& sc)
+{
+  sprite.draw(sc.color(), Vector(0, 0), 1000);
+  if(laser_pointer)
+    laser_pointer->draw(sc);
+}
+
+void
+Pistol::update(float elapsed_time)
+{
+  if(laser_pointer)
+    laser_pointer->update(elapsed_time);
+
+  sprite.update(elapsed_time);
+}
+
+void
+Pistol::fire(bool )
+{
+}

Added: trunk/src/pistol.hpp
===================================================================
--- trunk/src/pistol.hpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/pistol.hpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -0,0 +1,46 @@
+//  $Id$
+// 
+//  Windstille - A Jump'n Shoot Game
+//  Copyright (C) 2005 Matthias Braun <matze at braunis.de>
+//
+//  This program is free software; you can redistribute it and/or
+//  modify it under the terms of the GNU General Public License
+//  as published by the Free Software Foundation; either version 2
+//  of the License, or (at your option) any later version.
+//
+//  This program is distributed in the hope that it will be useful,
+//  but WITHOUT ANY WARRANTY; without even the implied warranty of
+//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+//  GNU General Public License for more details.
+// 
+//  You should have received a copy of the GNU General Public License
+//  along with this program; if not, write to the Free Software
+//  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+#ifndef PISTOL_HPP
+#define PISTOL_HPP
+
+#include "sprite3d/sprite3d.hpp"
+#include "weapon.hpp"
+
+class LaserPointer;
+
+class Pistol : public Weapon
+{
+private:
+  Sprite3D sprite;
+  //LaserPointer* laser_pointer;
+
+public:
+  LaserPointer* laser_pointer;
+  
+  Pistol();
+  virtual ~Pistol();
+  
+  void draw(SceneContext& context);
+  void update(float elapsed_time);
+
+  void fire(bool enable);
+};
+
+#endif
+

Modified: trunk/src/player.cpp
===================================================================
--- trunk/src/player.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/player.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -16,6 +16,7 @@
 //  You should have received a copy of the GNU General Public License
 //  along with this program; if not, write to the Free Software
 //  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+#include <config.h>
 
 #include "tile_map.hpp"
 #include "sector.hpp"
@@ -36,6 +37,7 @@
 #include "game_session.hpp"
 #include "console.hpp"
 #include "grenade.hpp"
+#include "pistol.hpp"
 
 static const int MAX_ENERGY = 16;
 static const float WALK_SPEED = 128.0;
@@ -47,11 +49,9 @@
   light("images/light3.sprite"),
   flashlight("images/flashlightlight.sprite"),
   flashlighthighlight("images/flashlighthighlight.sprite"),
-  //sprite ("3dsprites/heroken.wsprite"),
-  grenade("3dsprites/grenade.wsprite"),
   state(STAND)
 {
-  laser_pointer = new LaserPointer();
+  //laser_pointer = new LaserPointer();
   sprite = Sprite3D("3dsprites/heroken.wsprite");
   pos.x = 320;
   pos.y = 200;
@@ -77,11 +77,13 @@
   z_pos = 100.0f;
 
   contact = 0;
+  weapon = new Pistol();
+  laser_pointer = ((Pistol*) weapon)->laser_pointer;
 }
 
 Player::~Player()
 {
-  delete laser_pointer;
+  //delete laser_pointer;
 }
 
 void
@@ -114,9 +116,14 @@
       sc.highlight().draw(use_str, obj->get_pos().x, obj->get_pos().y - 150, 1000);
     }
   
-  //BoneID id = sprite.get_bone_id("Hand.R");
-  //grenade->draw(sc, sprite.get_bone_matrix(id));
-  laser_pointer->draw(sc);
+  Sprite3D::PointID id = sprite.get_attachement_point_id("Weapon");
+  sc.push_modelview();
+  sc.translate(pos.x, pos.y);
+  sc.mult_modelview(sprite.get_attachement_point_matrix(id));
+
+  weapon->draw(sc);
+
+  sc.pop_modelview();
 }
 
 void
@@ -140,6 +147,7 @@
 void 
 Player::update(float delta)
 {
+  weapon->update(delta);
   laser_pointer->update(delta);
 
   controller = InputManager::get_controller();
@@ -206,7 +214,6 @@
   velocity.y += GRAVITY * delta;
 
   sprite.update(delta);
-  grenade.update(delta);
 
   c_object->set_velocity (velocity);
 

Modified: trunk/src/player.hpp
===================================================================
--- trunk/src/player.hpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/player.hpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -16,7 +16,6 @@
 //  You should have received a copy of the GNU General Public License
 //  along with this program; if not, write to the Free Software
 //  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
-
 #ifndef PLAYER_HXX
 #define PLAYER_HXX
 
@@ -32,6 +31,7 @@
 class Controller;
 class Contact;
 class LaserPointer;
+class Weapon;
 
 class Player : public Entity
 {
@@ -42,7 +42,6 @@
   Sprite   flashlight;
   Sprite   flashlighthighlight;
   Sprite3D sprite;
-  Sprite3D grenade;
 
   bool jumping;
   bool bomb_placed;
@@ -54,6 +53,7 @@
 
   LaserPointer* laser_pointer;
   Contact* contact;
+  Weapon* weapon;
 
 public:
   enum State

Modified: trunk/src/screen_manager.cpp
===================================================================
--- trunk/src/screen_manager.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/screen_manager.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -70,7 +70,7 @@
     {
       /// Amount of time the world moves forward each update(), this is
       /// independed of the number of frames and always constant
-      static const float step = 10/1000.0f;
+      static const float step = .001;
 
       Uint32 now = SDL_GetTicks();
       float delta = static_cast<float>(now - ticks) / 1000.0f + overlap_delta;

Modified: trunk/src/sprite3d/data.cpp
===================================================================
--- trunk/src/sprite3d/data.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/sprite3d/data.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -156,10 +156,16 @@
           = new AttachementPointPosition[attachement_point_count];
         for(uint16_t a = 0; a < attachement_point_count; ++a) {
           AttachementPointPosition& point = frame.attachement_points[a];
-          for(int i = 0; i < 3; ++i)
-            point.pos[i] = read_float(file);
-          for(int i = 0; i < 4; ++i)
-            point.quat[i] = read_float(file);
+
+          point.pos.x = read_float(file);
+          point.pos.y = read_float(file);
+          point.pos.z = read_float(file);
+
+          point.quat.w = -read_float(file);
+          point.quat.x = read_float(file);
+          point.quat.y = read_float(file);
+          point.quat.z = read_float(file);
+          point.quat.normalize();
         }
       }
     }

Modified: trunk/src/sprite3d/data.hpp
===================================================================
--- trunk/src/sprite3d/data.hpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/sprite3d/data.hpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -23,6 +23,8 @@
 #include <GL/gl.h>
 #include "ref.hpp"
 #include "glutil/texture.hpp"
+#include "math/vector3.hpp"
+#include "math/quaternion.hpp"
 
 namespace sprite3d
 {
@@ -88,8 +90,8 @@
 
 struct AttachementPointPosition
 {
-  float pos[3]; // x, y, z
-  float quat[4]; // w, x, y, z
+  Vector3 pos; // x, y, z
+  Quaternion quat; // w, x, y, z
 };
 
 struct ActionFrame

Modified: trunk/src/sprite3d/sprite3d.cpp
===================================================================
--- trunk/src/sprite3d/sprite3d.cpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/sprite3d/sprite3d.cpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -15,8 +15,8 @@
 //  You should have received a copy of the GNU General Public License
 //  along with this program; if not, write to the Free Software
 //  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
-
 #include <config.h>
+
 #include "sprite3d/sprite3d.hpp"
 
 #include <vector>
@@ -182,72 +182,21 @@
   return data->get_attachement_point_id(name); 
 }
 
-static inline void set_matrix_from_quat(Matrix& m, float w,
-    float x, float y, float z)
-{
-  //row1
-  m.matrix[0] = 1.0f - 2*y*y - 2*z*z;
-  m.matrix[4] = 2*x*y - 2*w*z;
-  m.matrix[8] = 2*x*z + 2*w*y;
-  m.matrix[12] = 0.0f;
-
-  //row2
-  m.matrix[1] = 2*x*y + 2*w*z;
-  m.matrix[5] = 1.0f - 2*x*x - 2*z*z;
-  m.matrix[9] = 2*y*z - 2*w*x;
-  m.matrix[13] = 0.0f;
-
-  //row3
-  m.matrix[2] = 2*x*z - 2*w*y;
-  m.matrix[6] = 2*y*z + 2*w*x;
-  m.matrix[10] = 1.0f - 2*x*x - 2*y*y;
-  m.matrix[14] = 0.0f;
-
-  //row4
-  m.matrix[3] = 0.0f;
-  m.matrix[7] = 0.0f;
-  m.matrix[11] = 0.0f;
-  m.matrix[15] = 1.0f;
-}
-
 Matrix
 Sprite3D::get_attachement_point_matrix(PointID id) const
 {
-  float t_1 = 1.0 - blend_time;
   const AttachementPointPosition& point1 
 	  = frame1.action->frames[frame1.frame].attachement_points[id];
   const AttachementPointPosition& point2 
 	  = frame2.action->frames[frame2.frame].attachement_points[id];
 
-  float pos[3];
-  float quat[4];
-  if(frame1.rot) {
-    pos[0] = -point1.pos[0] * t_1;
-    pos[1] = point1.pos[1] * t_1;
-    pos[2] = -point1.pos[2] * t_1;   
-  } else {
-    for(int i = 0; i < 3; ++i)
-      pos[i] = point1.pos[i] * t_1;
-    for(int i = 0; i < 4; ++i)
-      quat[i] = point1.quat[i] * t_1;
-  }
-  if(frame2.rot) {
-    pos[0] += -point2.pos[0] * blend_time;
-    pos[1] += point2.pos[1] * blend_time;
-    pos[2] += -point2.pos[2] * blend_time;
-  } else {
-    for(int i = 0; i < 3; ++i)
-      pos[i] += point2.pos[i] * blend_time;
-    for(int i = 0; i < 4; ++i)
-      quat[i] += point2.quat[i] * blend_time;
-  }
+  Vector3 pos = point1.pos + (point2.pos - point1.pos) * blend_time;
+  Quaternion quat = point1.quat.slerp(point2.quat, blend_time);
+  
+  Matrix result = pos.to_matrix();
+  result = result.multiply(quat.to_matrix());
 
-  Matrix m      = Matrix::identity();
-  m.matrix[12] += pos[0];
-  m.matrix[13] += pos[1];
-  m.matrix[14] += pos[2];
-
-  return m;
+  return result;
 }
 
 class Sprite3DDrawingRequest : public DrawingRequest
@@ -324,11 +273,16 @@
 }
 
 void
-Sprite3D::draw(DrawingContext& dc, const Matrix& matrix, float z_pos) const
+Sprite3D::draw(DrawingContext& dc, const Matrix& , float ) const
 {
   dc.draw(new Sprite3DDrawingRequest(this, Vector(0, 0), 0.0f, dc.get_modelview()));
 }
 
+static inline float interpolate(float v1, float v2, float t)
+{
+  return v1 + (v2 - v1) * t;
+}
+
 void
 Sprite3D::draw(const Vector& pos, const Matrix& modelview) const
 {
@@ -362,7 +316,6 @@
   const ActionFrame& aframe1 = frame1.action->frames[frame1.frame];
   const ActionFrame& aframe2 = frame2.action->frames[frame2.frame];
   
-  float t_1 = 1.0 - blend_time;
   for(uint16_t m = 0; m < data->mesh_count; ++m) 
     {
       const Mesh& mesh = data->meshs[m];
@@ -376,22 +329,26 @@
       float verts[mesh.vertex_count * 3];
       if(frame1.rot == frame2.rot) {
         for(uint16_t v = 0; v < mesh.vertex_count*3; ++v) {
-          verts[v] 
-            = vertices1.vertices[v] * t_1 + vertices2.vertices[v] * blend_time;
+          float v1 = vertices1.vertices[v];
+          float v2 = vertices2.vertices[v];
+          verts[v] = interpolate(v1, v2, blend_time);
         }
       } else {
         // need to manually rotate 180 degree here because frames have different
         // rot values (=> x=-x, y=y, z=-z)
-        for(uint16_t v = 0; v < mesh.vertex_count; ++v) {
-          verts[v*3] 
-            = vertices1.vertices[v*3] * t_1 
-            - vertices2.vertices[v*3] * blend_time;
-          verts[v*3+1]
-            = vertices1.vertices[v*3+1] * t_1 
-            + vertices2.vertices[v*3+1] * blend_time;
-          verts[v*3+2]
-            = vertices1.vertices[v*3+2] * t_1
-            - vertices2.vertices[v*3+2] * blend_time;
+        for(uint16_t v = 0; v < mesh.vertex_count*3; ) {
+          // X coord
+          float v1 = vertices1.vertices[v];
+          float v2 = -vertices2.vertices[v];
+          verts[v++] = interpolate(v1, v2, blend_time);
+          // Y coord
+          v1 = vertices1.vertices[v];
+          v2 = vertices2.vertices[v];
+          verts[v++] = interpolate(v1, v2, blend_time);
+          // Z coord
+          v1 = vertices1.vertices[v];
+          v2 = -vertices2.vertices[v];                            
+          verts[v++] = interpolate(v1, v2, blend_time);          
         }
       }
 

Added: trunk/src/weapon.hpp
===================================================================
--- trunk/src/weapon.hpp	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/src/weapon.hpp	2005-09-22 11:06:50 UTC (rev 1090)
@@ -0,0 +1,39 @@
+//  $Id$
+// 
+//  Windstille - A Jump'n Shoot Game
+//  Copyright (C) 2005 Matthias Braun <matze at braunis.de>
+//
+//  This program is free software; you can redistribute it and/or
+//  modify it under the terms of the GNU General Public License
+//  as published by the Free Software Foundation; either version 2
+//  of the License, or (at your option) any later version.
+//
+//  This program is distributed in the hope that it will be useful,
+//  but WITHOUT ANY WARRANTY; without even the implied warranty of
+//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+//  GNU General Public License for more details.
+// 
+//  You should have received a copy of the GNU General Public License
+//  along with this program; if not, write to the Free Software
+//  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+#ifndef WEAPON_HPP
+#define WEAPON_HPP
+
+/**
+ * Base class for all weapons. This is not a GameObject because it will be
+ * attached and handled by the Player object, not by the sector
+ */
+class Weapon
+{
+public:
+  virtual ~Weapon()
+  {}
+  
+  virtual void draw(SceneContext& context) = 0;
+  virtual void update(float elapsed_time) = 0;
+
+  virtual void fire(bool enable) = 0;
+};
+
+#endif
+

Modified: trunk/tools/windstille_export.py
===================================================================
--- trunk/tools/windstille_export.py	2005-09-17 23:07:24 UTC (rev 1089)
+++ trunk/tools/windstille_export.py	2005-09-22 11:06:50 UTC (rev 1090)
@@ -47,19 +47,37 @@
 FORMAT_VERSION = 2
 
 def matrix2quaternion(m):
-  s = math.sqrt(abs(m[0][0] + m[1][1] + m[2][2] + m[3][3]))
-  if s == 0.0:
-    x = abs(m[2][1] - m[1][2])
-    y = abs(m[0][2] - m[2][0])
-    z = abs(m[1][0] - m[0][1])
-    if   (x >= y) and (x >= z): return 1.0, 0.0, 0.0, 0.0
-    elif (y >= x) and (y >= z): return 0.0, 1.0, 0.0, 0.0
-    else:                       return 0.0, 0.0, 1.0, 0.0
-  return quaternion_normalize([
-    -(m[2][1] - m[1][2]) / (2.0 * s),     -(m[0][2] - m[2][0]) / (2.0 * s),
-    -(m[1][0] - m[0][1]) / (2.0 * s),
-    0.5 * s,
-    ])
+  tr = 1.0 + m[0][0] + m[1][1] + m[2][2]
+  if tr > .00001:
+    s = math.sqrt(tr)
+    w = s / 2.0
+    s = 0.5 / s
+    x = (m[1][2] - m[2][1]) * s
+    y = (m[2][0] - m[0][2]) * s
+    z = (m[0][1] - m[1][0]) * s
+  elif m[0][0] > m[1][1] and m[0][0] > m[2][2]:
+    s = math.sqrt(1.0 + m[0][0] - m[1][1] - m[2][2])
+    x = s / 2.0
+    s = 0.5 / s
+    y = (m[0][1] + m[1][0]) * s
+    z = (m[2][0] + m[0][2]) * s
+    w = (m[1][2] - m[2][1]) * s
+  elif m[1][1] > m[2][2]:
+    s = math.sqrt(1.0 + m[1][1] - m[0][0] - m[2][2])
+    y = s / 2.0
+    s = 0.5 / s
+    x = (m[0][1] + m[1][0]) * s
+    z = (m[1][2] + m[2][1]) * s
+    w = (m[2][0] - m[0][2]) * s
+  else:
+    s = math.sqrt(1.0 + m[2][2] - m[0][0] - m[1][1])
+    z = s / 2.0
+    s = 0.5 / s
+    x = (m[2][0] + m[0][2]) * s
+    y = (m[1][2] + m[2][1]) * s
+    w = (m[0][1] - m[1][0]) * s
+    
+  return w, x, y, z
 
 def quaternion_normalize(q):
   l = math.sqrt(q[0] * q[0] + q[1] * q[1] + q[2] * q[2] + q[3] * q[3])
@@ -211,13 +229,13 @@
           t[0] *= ZOOM
           t[1] *= ZOOM
           t[2] *= ZOOM
-          self.file.write(struct.pack("=fff", t[1], -t[2], t[0]))
+          self.file.write(struct.pack("=fff", t[1], -t[2], -t[0]))
 
       # attachement points
       for obj in self.attachement_objects:
         m = obj.matrixWorld
         loc = (m[3][0] * ZOOM, m[3][1] * ZOOM, m[3][2] * ZOOM)
-        self.file.write(struct.pack("=fff", loc[0], loc[1], loc[2]))
+        self.file.write(struct.pack("=fff", loc[1], -loc[2], -loc[0]))
         quat = matrix2quaternion(m)
         self.file.write(struct.pack("=ffff", quat[0], quat[1], quat[2], quat[3]))
 
@@ -313,9 +331,9 @@
 
     # normals
     for face in data.faces:
-      bodydata += struct.pack("=fff", face.normal[1], -face.normal[2], face.normal[0])
+      bodydata += struct.pack("=fff", face.normal[1], -face.normal[2], -face.normal[0])
       if len(face.v) == 4:
-        bodydata += struct.pack("=fff", face.normal[1], -face.normal[2], face.normal[0])
+        bodydata += struct.pack("=fff", face.normal[1], -face.normal[2], -face.normal[0])
 
     # uv coords per vertex
     for uv in uvs:



From matzebraun at berlios.de  Thu Sep 22 13:27:47 2005
From: matzebraun at berlios.de (Matthias Braun at BerliOS)
Date: Thu, 22 Sep 2005 13:27:47 +0200
Subject: [Windstille-commit] r1091 - in trunk/data/models: . objects objects/pistol
Message-ID: <200509221127.j8MBRlqP018985@sheep.berlios.de>

Author: matzebraun
Date: 2005-09-22 13:27:43 +0200 (Thu, 22 Sep 2005)
New Revision: 1091

Added:
   trunk/data/models/objects/
   trunk/data/models/objects/pistol/
   trunk/data/models/objects/pistol/pistol.wsprite
   trunk/data/models/objects/pistol/pistoltexture.png
   trunk/data/models/objects/pistol/testcubetexture.png
Log:
commit pistol sprite

Added: trunk/data/models/objects/pistol/pistol.wsprite
===================================================================
(Binary files differ)


Property changes on: trunk/data/models/objects/pistol/pistol.wsprite
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/models/objects/pistol/pistoltexture.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/models/objects/pistol/pistoltexture.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/models/objects/pistol/testcubetexture.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/models/objects/pistol/testcubetexture.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From matzebraun at berlios.de  Thu Sep 22 15:49:43 2005
From: matzebraun at berlios.de (Matthias Braun at BerliOS)
Date: Thu, 22 Sep 2005 15:49:43 +0200
Subject: [Windstille-commit] r1092 - in trunk/data/blender: . testcube
Message-ID: <200509221349.j8MDnhvZ004285@sheep.berlios.de>

Author: matzebraun
Date: 2005-09-22 15:49:42 +0200 (Thu, 22 Sep 2005)
New Revision: 1092

Added:
   trunk/data/blender/testcube/
   trunk/data/blender/testcube/testcube.blend
   trunk/data/blender/testcube/testcubetexture.png
Log:
usefull for testing 3d model code and exporter

Added: trunk/data/blender/testcube/testcube.blend
===================================================================
(Binary files differ)


Property changes on: trunk/data/blender/testcube/testcube.blend
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/blender/testcube/testcubetexture.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/blender/testcube/testcubetexture.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From matzebraun at berlios.de  Thu Sep 22 16:36:42 2005
From: matzebraun at berlios.de (Matthias Braun at BerliOS)
Date: Thu, 22 Sep 2005 16:36:42 +0200
Subject: [Windstille-commit] r1093 - in trunk: data/3dsprites data/blender/testcube data/models/objects/pistol docs src tools
Message-ID: <200509221436.j8MEagHw008234@sheep.berlios.de>

Author: matzebraun
Date: 2005-09-22 16:36:41 +0200 (Thu, 22 Sep 2005)
New Revision: 1093

Removed:
   trunk/data/models/objects/pistol/testcubetexture.png
Modified:
   trunk/data/3dsprites/heroken.wsprite
   trunk/data/blender/testcube/testcube.blend
   trunk/data/models/objects/pistol/pistol.wsprite
   trunk/docs/models.txt
   trunk/src/test_object.cpp
   trunk/tools/windstille_export.py
Log:
- exporter has to swap coordinates for the rotation quaternion too,
  the attachement seems to work nicely now

TODO: shrink that pistol ;-)



/usr/local/bin/commit-email.pl: `/usr/bin/svnlook diff /svnroot/repos/windstille -r 1093' failed with this output:
Modified: trunk/data/3dsprites/heroken.wsprite
===================================================================
(Binary files differ)

Modified: trunk/data/blender/testcube/testcube.blend
===================================================================
(Binary files differ)

Modified: trunk/data/models/objects/pistol/pistol.wsprite
===================================================================
(Binary files differ)

Deleted: trunk/data/models/objects/pistol/testcubetexture.png
===================================================================
(Binary files differ)

Modified: trunk/docs/models.txt
===================================================================


From matzebraun at berlios.de  Thu Sep 22 17:03:32 2005
From: matzebraun at berlios.de (Matthias Braun at BerliOS)
Date: Thu, 22 Sep 2005 17:03:32 +0200
Subject: [Windstille-commit] r1094 - in trunk/src: math sprite3d
Message-ID: <200509221503.j8MF3WlT010865@sheep.berlios.de>

Author: matzebraun
Date: 2005-09-22 17:03:30 +0200 (Thu, 22 Sep 2005)
New Revision: 1094

Modified:
   trunk/src/math/quaternion.hpp
   trunk/src/sprite3d/sprite3d.cpp
Log:
nearly fixed attachement point problems with rotated models (just interpolation from frame without rotation to rotate frame leads to interpolation in the wrong direction :-/)

/usr/local/bin/commit-email.pl: `/usr/bin/svnlook diff /svnroot/repos/windstille -r 1094' failed with this output:
Modified: trunk/src/math/quaternion.hpp
===================================================================


From matzebraun at berlios.de  Thu Sep 22 17:13:23 2005
From: matzebraun at berlios.de (Matthias Braun at BerliOS)
Date: Thu, 22 Sep 2005 17:13:23 +0200
Subject: [Windstille-commit] r1095 - trunk/src
Message-ID: <200509221513.j8MFDNLq011781@sheep.berlios.de>

Author: matzebraun
Date: 2005-09-22 17:13:22 +0200 (Thu, 22 Sep 2005)
New Revision: 1095

Modified:
   trunk/src/laser_pointer.cpp
Log:
work a bit on laserpointer, it's on screen again, but doesn't respect the pistols position and rotation which makes it seem odd

/usr/local/bin/commit-email.pl: `/usr/bin/svnlook diff /svnroot/repos/windstille -r 1095' failed with this output:
Modified: trunk/src/laser_pointer.cpp
===================================================================


From matzebraun at berlios.de  Thu Sep 22 17:40:26 2005
From: matzebraun at berlios.de (Matthias Braun at BerliOS)
Date: Thu, 22 Sep 2005 17:40:26 +0200
Subject: [Windstille-commit] r1096 - in trunk/src: . display
Message-ID: <200509221540.j8MFeQRE015111@sheep.berlios.de>

Author: matzebraun
Date: 2005-09-22 17:40:23 +0200 (Thu, 22 Sep 2005)
New Revision: 1096

Modified:
   trunk/src/display/display.cpp
   trunk/src/display/scene_context.cpp
   trunk/src/tile_map.cpp
Log:
some missing #includes pointed out by wolfgang

/usr/local/bin/commit-email.pl: `/usr/bin/svnlook diff /svnroot/repos/windstille -r 1096' failed with this output:
Modified: trunk/src/display/display.cpp
===================================================================


From grumbel at berlios.de  Fri Sep 23 18:02:27 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Fri, 23 Sep 2005 18:02:27 +0200
Subject: [Windstille-commit] r1097 - in trunk: data/levels src
Message-ID: <200509231602.j8NG2RIB022716@sheep.berlios.de>

Author: grumbel
Date: 2005-09-23 18:01:59 +0200 (Fri, 23 Sep 2005)
New Revision: 1097

Added:
   trunk/src/liquid.cpp
   trunk/src/liquid.hpp
Modified:
   trunk/data/levels/newformat2.wst
   trunk/src/Jamfile
   trunk/src/baby_xml.hpp
   trunk/src/sector.cpp
   trunk/src/windstille_main.hpp
Log:
- added some light effects to the water, improved speed a bit

Modified: trunk/data/levels/newformat2.wst
===================================================================
--- trunk/data/levels/newformat2.wst	2005-09-22 15:40:23 UTC (rev 1096)
+++ trunk/data/levels/newformat2.wst	2005-09-23 16:01:59 UTC (rev 1097)
@@ -11,6 +11,11 @@
     (pos 300 650)
   )
   (objects
+   (liquid
+    (pos 128 768)
+    (width 20)
+    )
+
    (vrdummy
     (name "VRDummy")
     (pos 600 600)

Modified: trunk/src/Jamfile
===================================================================
--- trunk/src/Jamfile	2005-09-22 15:40:23 UTC (rev 1096)
+++ trunk/src/Jamfile	2005-09-23 16:01:59 UTC (rev 1097)
@@ -69,6 +69,8 @@
         inventory.hpp        
         laser_pointer.hpp
         laser_pointer.cpp
+        liquid.hpp
+        liquid.cpp
         math.hpp
         nightvision.cpp
         nightvision.hpp

Modified: trunk/src/baby_xml.hpp
===================================================================
--- trunk/src/baby_xml.hpp	2005-09-22 15:40:23 UTC (rev 1096)
+++ trunk/src/baby_xml.hpp	2005-09-23 16:01:59 UTC (rev 1097)
@@ -23,8 +23,8 @@
 **  02111-1307, USA.
 */
 
-#ifndef HEADER_BABY_XML_HXX
-#define HEADER_BABY_XML_HXX
+#ifndef HEADER_WINDSTILLE_BABY_XML_HXX
+#define HEADER_WINDSTILLE_BABY_XML_HXX
 
 #include <string>
 #include <vector>

Added: trunk/src/liquid.cpp
===================================================================
--- trunk/src/liquid.cpp	2005-09-22 15:40:23 UTC (rev 1096)
+++ trunk/src/liquid.cpp	2005-09-23 16:01:59 UTC (rev 1097)
@@ -0,0 +1,135 @@
+/*  $Id$
+**   __      __ __             ___        __   __ __   __
+**  /  \    /  \__| ____    __| _/_______/  |_|__|  | |  |   ____
+**  \   \/\/   /  |/    \  / __ |/  ___/\   __\  |  | |  | _/ __ \
+**   \        /|  |   |  \/ /_/ |\___ \  |  | |  |  |_|  |_\  ___/
+**    \__/\  / |__|___|  /\____ /____  > |__| |__|____/____/\___  >
+**         \/          \/      \/    \/                         \/
+**  Copyright (C) 2005 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software; you can redistribute it and/or
+**  modify it under the terms of the GNU General Public License
+**  as published by the Free Software Foundation; either version 2
+**  of the License, or (at your option) any later version.
+**
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+** 
+**  You should have received a copy of the GNU General Public License
+**  along with this program; if not, write to the Free Software
+**  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+**  02111-1307, USA.
+*/
+
+#include "lisp/properties.hpp"
+#include "windstille_getters.hpp"
+#include "display/vertex_array_drawing_request.hpp"
+#include "random.hpp"
+#include "liquid.hpp"
+
+Liquid::Liquid(const lisp::Lisp* lisp)
+{
+  int width = 10;
+
+  lisp::Properties props(lisp);
+  props.get("pos",    pos);
+  props.get("width",  width);
+  props.print_unused_warnings("Liquid");
+
+  heightfield1 = &heightfield_store1;
+  heightfield2 = &heightfield_store2;
+
+  heightfield1->resize(width * 10, 0);
+  heightfield2->resize(width * 10, 0);
+  
+  for(std::vector<float>::size_type i = 2; i < heightfield1->size()-2; ++i)
+    {
+      (*heightfield1)[i] = sin(i/float(heightfield1->size()) * 10.0f) * 0.5f
+        + sin(i/float(heightfield1->size()) * 5.0f) * .5f;
+      (*heightfield2)[i] = (*heightfield1)[i];
+    }
+
+  (*heightfield1)[49] += 0.0025f;
+  (*heightfield1)[50] += 0.005f;
+  (*heightfield1)[51] += 0.0025f;
+}
+
+Liquid::~Liquid()
+{
+}
+
+void
+Liquid::draw(SceneContext& sc)
+{
+  {
+    VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector(pos.x, pos.y), 10000,
+                                                                     sc.light().get_modelview());
+    array->set_mode(GL_QUAD_STRIP);
+    array->set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
+
+    for(std::vector<float>::size_type i = 0; i < heightfield1->size(); ++i)
+      {
+        float c = 0.5f;
+        if (i > 0)
+          {
+            float angle = atan2(32.0f* ((*heightfield1)[i] - (*heightfield1)[i-1]), 3.2f);
+            c = std::min(1.0f, std::max(0.5f, 8.0f * (angle/float(M_PI)) + 0.5f));
+          }
+
+        array->color(Color(0.5f, 0.5f, 1.0f, 0.5f));
+        array->vertex(i * 32.0f/10.0f, -32.0f * (*heightfield1)[i] + 8.0f);
+
+        array->color(Color(c, c, 1.0f, 1.0f));
+        array->vertex(i * 32.0f/10.0f, -32.0f * (*heightfield1)[i]);
+      }
+
+    sc.color().draw(array);
+  }
+  {
+    VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector(pos.x, pos.y), 10000,
+                                                                     sc.light().get_modelview());
+    array->set_mode(GL_QUAD_STRIP);
+    array->set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
+
+    for(std::vector<float>::size_type i = 0; i < heightfield1->size(); ++i)
+      {
+        array->color(Color(0.0f, 0.0f, 0.5f, 0.5f));
+        array->vertex(i * 32.0f/10.0f, 64.0f);
+
+        array->color(Color(0.5f, 0.5f, 1.0f, 0.5f));
+        array->vertex(i * 32.0f/10.0f, -32.0f * (*heightfield1)[i] + 8.0f);
+      }
+
+    sc.color().draw(array);
+  }
+}
+
+void
+Liquid::update(float delta)
+{
+  float factor = 0.01f * delta;
+
+  for(int samples = 0; samples < 3; ++samples)
+    {
+      for(std::vector<float>::size_type i = 2; i < heightfield1->size()-2; ++i)
+        {
+          float value = 
+            factor * ((*heightfield1)[i-3] +
+                      (*heightfield1)[i-2] +
+                      (*heightfield1)[i-1] +
+                      (*heightfield1)[i+1] +
+                      (*heightfield1)[i+2] +
+                      (*heightfield1)[i+3])
+            - (factor * 6 * (*heightfield1)[i])
+            + (2*(*heightfield1)[i])
+            - (*heightfield2)[i];
+      
+          (*heightfield2)[i] = value * 0.99999f;
+        }
+      std::swap(heightfield2, heightfield1);
+    }
+}
+
+/* EOF */

Added: trunk/src/liquid.hpp
===================================================================
--- trunk/src/liquid.hpp	2005-09-22 15:40:23 UTC (rev 1096)
+++ trunk/src/liquid.hpp	2005-09-23 16:01:59 UTC (rev 1097)
@@ -0,0 +1,57 @@
+/*  $Id$
+**   __      __ __             ___        __   __ __   __
+**  /  \    /  \__| ____    __| _/_______/  |_|__|  | |  |   ____
+**  \   \/\/   /  |/    \  / __ |/  ___/\   __\  |  | |  | _/ __ \
+**   \        /|  |   |  \/ /_/ |\___ \  |  | |  |  |_|  |_\  ___/
+**    \__/\  / |__|___|  /\____ /____  > |__| |__|____/____/\___  >
+**         \/          \/      \/    \/                         \/
+**  Copyright (C) 2005 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software; you can redistribute it and/or
+**  modify it under the terms of the GNU General Public License
+**  as published by the Free Software Foundation; either version 2
+**  of the License, or (at your option) any later version.
+**
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+** 
+**  You should have received a copy of the GNU General Public License
+**  along with this program; if not, write to the Free Software
+**  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+**  02111-1307, USA.
+*/
+
+#ifndef HEADER_WINDSTILLE_LIQUID_HPP
+#define HEADER_WINDSTILLE_LIQUID_HPP
+
+#include <vector>
+#include "lisp/lisp.hpp"
+#include "entity.hpp"
+
+/** */
+class Liquid : public Entity
+{
+private:
+  std::vector<float> heightfield_store1;
+  std::vector<float> heightfield_store2;
+
+  std::vector<float>* heightfield1;
+  std::vector<float>* heightfield2;
+
+public:
+  Liquid(const lisp::Lisp* lisp);
+  ~Liquid();
+
+  void draw(SceneContext& sc);
+  void update(float delta);
+
+private:
+  Liquid (const Liquid&);
+  Liquid& operator= (const Liquid&);
+};
+
+#endif
+
+/* EOF */

Modified: trunk/src/sector.cpp
===================================================================
--- trunk/src/sector.cpp	2005-09-22 15:40:23 UTC (rev 1096)
+++ trunk/src/sector.cpp	2005-09-23 16:01:59 UTC (rev 1097)
@@ -44,6 +44,7 @@
 #include "character.hpp"
 #include "laser_pointer.hpp"
 #include "badguy/swarm.hpp"
+#include "liquid.hpp"
 #include "badguy/hedgehog.hpp"
 #include "badguy/spider_mine.hpp"
 #include "box.hpp"
@@ -185,6 +186,8 @@
     add(new Swarm(lisp));
   } else if (name == "laserpointer") {
     add(new LaserPointer());
+  } else if (name == "liquid") {
+    add(new Liquid(lisp));
   } else {
     std::cout << "Skipping unknown Object: " << name << "\n";
   }

Modified: trunk/src/windstille_main.hpp
===================================================================
--- trunk/src/windstille_main.hpp	2005-09-22 15:40:23 UTC (rev 1096)
+++ trunk/src/windstille_main.hpp	2005-09-23 16:01:59 UTC (rev 1097)
@@ -23,8 +23,8 @@
 **  02111-1307, USA.
 */
 
-#ifndef WINDSTILLEMAIN_HPP
-#define WINDSTILLEMAIN_HPP
+#ifndef HEADER_WINDSTILLE_WINDSTILLE_MAIN_HPP
+#define HEADER_WINDSTILLE_WINDSTILLE_MAIN_HPP
 
 #include "screen.hpp"
 



From grumbel at berlios.de  Wed Sep 28 23:38:23 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Wed, 28 Sep 2005 23:38:23 +0200
Subject: [Windstille-commit] r1098 - in trunk/data/images: . textures
Message-ID: <200509282138.j8SLcNC8009328@sheep.berlios.de>

Author: grumbel
Date: 2005-09-28 23:38:21 +0200 (Wed, 28 Sep 2005)
New Revision: 1098

Added:
   trunk/data/images/textures/
   trunk/data/images/textures/water.png
Log:
- water texture

Added: trunk/data/images/textures/water.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/images/textures/water.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From grumbel at berlios.de  Wed Sep 28 23:38:44 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Wed, 28 Sep 2005 23:38:44 +0200
Subject: [Windstille-commit] r1099 - trunk/src
Message-ID: <200509282138.j8SLciEI009372@sheep.berlios.de>

Author: grumbel
Date: 2005-09-28 23:38:44 +0200 (Wed, 28 Sep 2005)
New Revision: 1099

Modified:
   trunk/src/liquid.cpp
   trunk/src/liquid.hpp
Log:
- added water texture, doesn't look much good

Modified: trunk/src/liquid.cpp
===================================================================
--- trunk/src/liquid.cpp	2005-09-28 21:38:21 UTC (rev 1098)
+++ trunk/src/liquid.cpp	2005-09-28 21:38:44 UTC (rev 1099)
@@ -29,9 +29,12 @@
 #include "random.hpp"
 #include "liquid.hpp"
 
+#define SAMPLES 5
+
 Liquid::Liquid(const lisp::Lisp* lisp)
 {
   int width = 10;
+  t = 0;
 
   lisp::Properties props(lisp);
   props.get("pos",    pos);
@@ -41,8 +44,8 @@
   heightfield1 = &heightfield_store1;
   heightfield2 = &heightfield_store2;
 
-  heightfield1->resize(width * 10, 0);
-  heightfield2->resize(width * 10, 0);
+  heightfield1->resize(width * SAMPLES, 0);
+  heightfield2->resize(width * SAMPLES, 0);
   
   for(std::vector<float>::size_type i = 2; i < heightfield1->size()-2; ++i)
     {
@@ -51,9 +54,11 @@
       (*heightfield2)[i] = (*heightfield1)[i];
     }
 
-  (*heightfield1)[49] += 0.0025f;
-  (*heightfield1)[50] += 0.005f;
-  (*heightfield1)[51] += 0.0025f;
+  for(int i = 50; i < 70 && i < int(heightfield1->size()); ++i)
+    (*heightfield1)[i] += 0.0025f;
+
+  texture = Texture("images/textures/water.png");
+  texture.set_wrap(GL_REPEAT);
 }
 
 Liquid::~Liquid()
@@ -63,9 +68,11 @@
 void
 Liquid::draw(SceneContext& sc)
 {
+  float texscale = 1.0f/128.0f;
   {
     VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector(pos.x, pos.y), 10000,
                                                                      sc.light().get_modelview());
+    array->set_texture(texture);
     array->set_mode(GL_QUAD_STRIP);
     array->set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
 
@@ -78,11 +85,15 @@
             c = std::min(1.0f, std::max(0.5f, 8.0f * (angle/float(M_PI)) + 0.5f));
           }
 
-        array->color(Color(0.5f, 0.5f, 1.0f, 0.5f));
-        array->vertex(i * 32.0f/10.0f, -32.0f * (*heightfield1)[i] + 8.0f);
+        array->color(Color(0.5f, 0.5f, 1.0f, 0.7f));
+        array->texcoord((i * 32.0f/SAMPLES) * texscale + sin(t + i/10.0f)*0.2f,
+                        (-32.0f * (*heightfield1)[i] + 8.0f) * texscale + sin(t+i/10.0f)*0.2f);
+        array->vertex(i * 32.0f/SAMPLES, -32.0f * (*heightfield1)[i] + 8.0f);
 
         array->color(Color(c, c, 1.0f, 1.0f));
-        array->vertex(i * 32.0f/10.0f, -32.0f * (*heightfield1)[i]);
+        array->texcoord((i * 32.0f/SAMPLES) * texscale + sin(t + i/10.0f)*0.2f,
+                        (-32.0f * (*heightfield1)[i]) * texscale + sin(t+i/10.0f)*0.2f);
+        array->vertex(i * 32.0f/SAMPLES, -32.0f * (*heightfield1)[i]);
       }
 
     sc.color().draw(array);
@@ -90,16 +101,21 @@
   {
     VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector(pos.x, pos.y), 10000,
                                                                      sc.light().get_modelview());
+    array->set_texture(texture);
     array->set_mode(GL_QUAD_STRIP);
     array->set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
 
     for(std::vector<float>::size_type i = 0; i < heightfield1->size(); ++i)
       {
-        array->color(Color(0.0f, 0.0f, 0.5f, 0.5f));
-        array->vertex(i * 32.0f/10.0f, 64.0f);
+        array->color(Color(0.0f, 0.0f, 0.5f, 0.7f));
+        array->texcoord((i * 32.0f/SAMPLES) * texscale + sin(t + i/10.0f)*0.2f,
+                        (64.0f) * texscale + sin(t+i/10.0f)*0.2f);
+        array->vertex(i * 32.0f/SAMPLES, 64.0f);
 
-        array->color(Color(0.5f, 0.5f, 1.0f, 0.5f));
-        array->vertex(i * 32.0f/10.0f, -32.0f * (*heightfield1)[i] + 8.0f);
+        array->color(Color(0.5f, 0.5f, 1.0f, 0.7f));
+        array->texcoord((i * 32.0f/SAMPLES) * texscale + sin(t + i/10.0f)*0.2f,
+                        (-32.0f * (*heightfield1)[i] + 8.0f) * texscale + sin(t+i/10.0f)*0.2f);
+        array->vertex(i * 32.0f/SAMPLES, -32.0f * (*heightfield1)[i] + 8.0f);
       }
 
     sc.color().draw(array);
@@ -109,20 +125,19 @@
 void
 Liquid::update(float delta)
 {
-  float factor = 0.01f * delta;
+  t += delta * 1.0f;
+  float factor = 0.1f * delta;
 
   for(int samples = 0; samples < 3; ++samples)
     {
       for(std::vector<float>::size_type i = 2; i < heightfield1->size()-2; ++i)
         {
           float value = 
-            factor * ((*heightfield1)[i-3] +
-                      (*heightfield1)[i-2] +
+            factor * ((*heightfield1)[i-2] +
                       (*heightfield1)[i-1] +
                       (*heightfield1)[i+1] +
-                      (*heightfield1)[i+2] +
-                      (*heightfield1)[i+3])
-            - (factor * 6 * (*heightfield1)[i])
+                      (*heightfield1)[i+2])                      
+            - (factor * 4 * (*heightfield1)[i])
             + (2*(*heightfield1)[i])
             - (*heightfield2)[i];
       

Modified: trunk/src/liquid.hpp
===================================================================
--- trunk/src/liquid.hpp	2005-09-28 21:38:21 UTC (rev 1098)
+++ trunk/src/liquid.hpp	2005-09-28 21:38:44 UTC (rev 1099)
@@ -34,6 +34,9 @@
 class Liquid : public Entity
 {
 private:
+  Texture texture;
+  float t;
+
   std::vector<float> heightfield_store1;
   std::vector<float> heightfield_store2;
 



From grumbel at berlios.de  Wed Sep 28 23:49:21 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Wed, 28 Sep 2005 23:49:21 +0200
Subject: [Windstille-commit] r1100 - trunk/data/models/characters/bob
Message-ID: <200509282149.j8SLnLBB010429@sheep.berlios.de>

Author: grumbel
Date: 2005-09-28 23:48:55 +0200 (Wed, 28 Sep 2005)
New Revision: 1100

Modified:
   trunk/data/models/characters/bob/bob.wsprite
Log:
- added aim animation

Modified: trunk/data/models/characters/bob/bob.wsprite
===================================================================
(Binary files differ)



From grumbel at berlios.de  Wed Sep 28 23:50:52 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Wed, 28 Sep 2005 23:50:52 +0200
Subject: [Windstille-commit] r1101 - trunk/data/blender/bob
Message-ID: <200509282150.j8SLoqeM010845@sheep.berlios.de>

Author: grumbel
Date: 2005-09-28 23:50:38 +0200 (Wed, 28 Sep 2005)
New Revision: 1101

Modified:
   trunk/data/blender/bob/bob.blend
Log:
- added aim test animation

Modified: trunk/data/blender/bob/bob.blend
===================================================================
(Binary files differ)



From grumbel at berlios.de  Thu Sep 29 00:01:50 2005
From: grumbel at berlios.de (Ingo Ruhnke at BerliOS)
Date: Thu, 29 Sep 2005 00:01:50 +0200
Subject: [Windstille-commit] r1102 - trunk/data/models/characters/jane
Message-ID: <200509282201.j8SM1oIu011818@sheep.berlios.de>

Author: grumbel
Date: 2005-09-29 00:01:03 +0200 (Thu, 29 Sep 2005)
New Revision: 1102

Added:
   trunk/data/models/characters/jane/jane.wsprite
Log:
- added aim animation to jane

Added: trunk/data/models/characters/jane/jane.wsprite
===================================================================
(Binary files differ)


Property changes on: trunk/data/models/characters/jane/jane.wsprite
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



