<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Windstille-commit] r2768 - in trunk/windstille: .	data/sectors/trainstation src/editor src/util
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/windstille-commit/2009-March/index.html" >
   <LINK REL="made" HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r2768%20-%20in%20trunk/windstille%3A%20.%0A%09data/sectors/trainstation%20src/editor%20src/util&In-Reply-To=%3C200903260146.n2Q1kjWl019139%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001764.html">
   <LINK REL="Next"  HREF="001766.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Windstille-commit] r2768 - in trunk/windstille: .	data/sectors/trainstation src/editor src/util</H1>
    <B>grumbel at BerliOS</B> 
    <A HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r2768%20-%20in%20trunk/windstille%3A%20.%0A%09data/sectors/trainstation%20src/editor%20src/util&In-Reply-To=%3C200903260146.n2Q1kjWl019139%40sheep.berlios.de%3E"
       TITLE="[Windstille-commit] r2768 - in trunk/windstille: .	data/sectors/trainstation src/editor src/util">grumbel at mail.berlios.de
       </A><BR>
    <I>Thu Mar 26 02:46:45 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001764.html">[Windstille-commit] r2767 - in trunk/windstille: . src src/editor
</A></li>
        <LI>Next message: <A HREF="001766.html">[Windstille-commit] r2769 - in trunk/windstille: .	data/sectors/trainstation src/editor src/util
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1765">[ date ]</a>
              <a href="thread.html#1765">[ thread ]</a>
              <a href="subject.html#1765">[ subject ]</a>
              <a href="author.html#1765">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: grumbel
Date: 2009-03-26 02:46:44 +0100 (Thu, 26 Mar 2009)
New Revision: 2768

Modified:
   trunk/windstille/TODO
   trunk/windstille/data/sectors/trainstation/trainstation.wst
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/editor_window.hpp
   trunk/windstille/src/editor/layer.hpp
   trunk/windstille/src/editor/layer_widget.cpp
   trunk/windstille/src/editor/layer_widget.hpp
   trunk/windstille/src/editor/object_model.cpp
   trunk/windstille/src/editor/object_model.hpp
   trunk/windstille/src/editor/sector_model.cpp
   trunk/windstille/src/editor/sector_model.hpp
   trunk/windstille/src/editor/select_tool.cpp
   trunk/windstille/src/editor/windstille_widget.cpp
   trunk/windstille/src/editor/windstille_widget.hpp
   trunk/windstille/src/util/file_reader.cpp
   trunk/windstille/src/util/file_reader.hpp
   trunk/windstille/src/util/file_reader_impl.hpp
   trunk/windstille/src/util/file_writer.cpp
   trunk/windstille/src/util/file_writer.hpp
   trunk/windstille/src/util/sexpr_file_reader.cpp
Log:
Implemented blender like layers

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/TODO	2009-03-26 01:46:44 UTC (rev 2768)
@@ -499,6 +499,16 @@
 Editor
 ======
 
+* lisp can't save uint32_t, maybe should save layer mask as string or so
+
+* add recent files
+
+* add difference between &quot;save&quot; and &quot;save as&quot;, along with overwrite warnings
+
+* add second toolbar, first one is getting a little crowded
+
+* disable light layer on default/startup
+
 * lightmap objects are hard to see
 
 * decal needs to be scalable and have vertices moveable
@@ -514,6 +524,8 @@
 
 * think about Undo/Redo
 
+* layer move tool
+
 * add a Blender like layer system:
  
   - layers are a 1 bit in a uint32_t (or uint64_t if needed)

Modified: trunk/windstille/data/sectors/trainstation/trainstation.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/trainstation.wst	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/data/sectors/trainstation/trainstation.wst	2009-03-26 01:46:44 UTC (rev 2768)
@@ -6,58 +6,70 @@
   (init-script &quot;init.nut&quot;)
   (objects
     (decal
-      (pos -1173.15 161.93)
+      (pos -1060.64 577.839)
       (parent &quot;&quot;)
-      (path &quot;images/decal/wallplate.png&quot;)
+      (path &quot;images/decal/light.png&quot;)
+      (type 1)
+      )
+    (decal
+      (pos -2115.12 1225.16)
+      (parent &quot;&quot;)
+      (path &quot;images/noise.png&quot;)
       (type 0)
       )
     (decal
-      (pos -1429.15 161.93)
+      (pos -2120.61 981.188)
       (parent &quot;&quot;)
-      (path &quot;images/decal/wallplate.png&quot;)
+      (path &quot;images/noise.png&quot;)
       (type 0)
       )
     (decal
-      (pos -1369.77 178.332)
+      (pos -1721.87 520.367)
       (parent &quot;&quot;)
-      (path &quot;images/decal/light.png&quot;)
-      (type 2)
+      (path &quot;images/objects/elevatordoor_left.png&quot;)
+      (type 0)
       )
     (decal
-      (pos -1241.39 128.266)
+      (pos -1721.87 392.367)
       (parent &quot;&quot;)
-      (path &quot;images/decal/roof.png&quot;)
+      (path &quot;images/objects/elevatordoor_left.png&quot;)
       (type 0)
       )
     (decal
-      (pos -1364.88 234.351)
+      (pos -602.767 343.23)
       (parent &quot;&quot;)
-      (path &quot;images/decal/light.png&quot;)
-      (type 1)
+      (path &quot;images/decal/dark.png&quot;)
+      (type 0)
       )
     (decal
-      (pos -1210.12 845.062)
+      (pos -1091.77 303.729)
       (parent &quot;&quot;)
+      (path &quot;images/decal/rooflamp_bloom.png&quot;)
+      (type 2)
+      )
+    (decal
+      (pos -1072.91 403.374)
+      (parent &quot;&quot;)
       (path &quot;images/decal/light.png&quot;)
-      (type 1)
+      (type 2)
       )
     (decal
-      (pos -475.483 759.19)
+      (pos -1553.29 729.292)
       (parent &quot;&quot;)
       (path &quot;images/decal/light.png&quot;)
       (type 1)
       )
     (decal
-      (pos -1683.2 421.836)
+      (pos -1210.12 845.062)
       (parent &quot;&quot;)
-      (path &quot;images/decal/wallplate.png&quot;)
-      (type 0)
+      (path &quot;images/decal/light.png&quot;)
+      (type 1)
       )
     (decal
-      (pos -1755.46 539.93)
+      (pos -475.483 759.19)
       (parent &quot;&quot;)
-      (path &quot;images/decal/wallplate.png&quot;)
-      (type 0)
+      (path &quot;images/decal/light.png&quot;)
+      (type 1)
       )
     (decal
       (pos 2219.07 674.539)
@@ -672,6 +684,18 @@
       (type 0)
       )
     (decal
+      (pos -1695.53 1074.91)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/dark.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -1863.92 1227.11)
+      (parent &quot;&quot;)
+      (path &quot;images/noise.png&quot;)
+      (type 0)
+      )
+    (decal
       (pos -661.151 929.93)
       (parent &quot;&quot;)
       (path &quot;images/decal/wallplate.png&quot;)
@@ -918,18 +942,12 @@
       (type 0)
       )
     (decal
-      (pos -1838.61 1103.44)
+      (pos -1549.55 1103.44)
       (parent &quot;&quot;)
       (path &quot;images/decal/ground.png&quot;)
       (type 0)
       )
     (decal
-      (pos -2146.61 1103.44)
-      (parent &quot;&quot;)
-      (path &quot;images/decal/ground.png&quot;)
-      (type 0)
-      )
-    (decal
       (pos -2365.62 1380.44)
       (parent &quot;&quot;)
       (path &quot;images/decal/stone2.png&quot;)
@@ -1020,12 +1038,18 @@
       (type 0)
       )
     (decal
-      (pos -1590.92 458.929)
+      (pos -1592.87 441.44)
       (parent &quot;&quot;)
       (path &quot;images/decal/stairs.png&quot;)
       (type 0)
       )
     (decal
+      (pos -1726.45 358.897)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/dark.png&quot;)
+      (type 0)
+      )
+    (decal
       (pos -751.996 886.773)
       (parent &quot;&quot;)
       (path &quot;images/decal/handrail.png&quot;)
@@ -1062,7 +1086,7 @@
       (type 0)
       )
     (decal
-      (pos -810.5 414.625)
+      (pos -810.5 422.438)
       (parent &quot;&quot;)
       (path &quot;images/decal/roof.png&quot;)
       (type 0)
@@ -1122,42 +1146,24 @@
       (type 2)
       )
     (decal
-      (pos -1449.56 -39.2807)
+      (pos -1433.95 273.652)
       (parent &quot;&quot;)
       (path &quot;images/decal/rooflamp_bloom.png&quot;)
       (type 2)
       )
     (decal
-      (pos -1638.23 50.563)
+      (pos -1348.02 358.027)
       (parent &quot;&quot;)
       (path &quot;images/decal/rooflamp_bloom.png&quot;)
       (type 2)
       )
     (decal
-      (pos -1644.88 132.985)
-      (parent &quot;&quot;)
-      (path &quot;images/decal/rooflamp_bloom.png&quot;)
-      (type 2)
-      )
-    (decal
-      (pos -1623.39 206.813)
-      (parent &quot;&quot;)
-      (path &quot;images/decal/rooflamp_bloom.png&quot;)
-      (type 2)
-      )
-    (decal
       (pos -1604.64 321.266)
       (parent &quot;&quot;)
       (path &quot;images/decal/rooflamp_bloom.png&quot;)
       (type 2)
       )
     (decal
-      (pos -1388.63 78.6875)
-      (parent &quot;&quot;)
-      (path &quot;images/decal/rooflamp_bloom.png&quot;)
-      (type 2)
-      )
-    (decal
       (pos 889.5 909.938)
       (parent &quot;&quot;)
       (path &quot;images/decal/rooflamp_bloom.png&quot;)
@@ -1200,113 +1206,353 @@
       (type 0)
       )
     (decal
-      (pos 159.502 622.202)
+      (pos 983.756 904.953)
       (parent &quot;&quot;)
       (path &quot;images/decal/light.png&quot;)
       (type 1)
       )
     (decal
-      (pos 972.752 671.292)
+      (pos 315.072 868.593)
       (parent &quot;&quot;)
       (path &quot;images/decal/light.png&quot;)
       (type 1)
       )
     (decal
-      (pos 968.131 705.734)
+      (pos 1562.96 829.374)
       (parent &quot;&quot;)
       (path &quot;images/decal/light.png&quot;)
       (type 1)
       )
     (decal
-      (pos 328.744 835.39)
+      (pos 1626.96 1067.2)
       (parent &quot;&quot;)
       (path &quot;images/decal/light.png&quot;)
       (type 1)
       )
     (decal
-      (pos -1060.64 577.839)
+      (pos 11.075 1013.44)
       (parent &quot;&quot;)
+      (path &quot;images/objects/plant.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos 424.131 1013.44)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/plant.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -1002.18 1013.44)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/plant.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -914.086 1013.44)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/plant.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -832.618 1013.44)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/plant.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos 1064.43 1014.67)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/plant.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -259.112 904.761)
+      (parent &quot;&quot;)
       (path &quot;images/decal/light.png&quot;)
       (type 1)
       )
     (decal
-      (pos 1562.96 829.374)
+      (pos -1181.83 303.2)
       (parent &quot;&quot;)
+      (path &quot;images/decal/roof2.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -1721.87 997.44)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/elevatordoor_left.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -1721.87 869.44)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/elevatordoor_left.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -1721.87 648.367)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/elevatordoor_left.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -1721.87 776.367)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/elevatordoor_left.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -2120.61 725.188)
+      (parent &quot;&quot;)
+      (path &quot;images/noise.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -2123.43 469.188)
+      (parent &quot;&quot;)
+      (path &quot;images/noise.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -1721.87 1081.44)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/elevatordoor_left.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -1652.53 302.712)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/roof2.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -1867.43 469.188)
+      (parent &quot;&quot;)
+      (path &quot;images/noise.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -1865.87 725.188)
+      (parent &quot;&quot;)
+      (path &quot;images/noise.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -1865.87 981.188)
+      (parent &quot;&quot;)
+      (path &quot;images/noise.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -2264.59 1063.59)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/dark.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -2259.22 975.602)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/dark.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -2166.67 1074.01)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/dark.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -2173.27 303.706)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/roof2.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -2658.88 301.753)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/roof2.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -2238.03 381.164)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/dark.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -2237.28 444.414)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/dark.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -2245.9 656.102)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/dark.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -2246.65 592.852)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/dark.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -2238.51 829.117)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/dark.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -2080.67 802.977)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/dark.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -2047.4 581.164)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/dark.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -2016.55 1049.91)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/dark.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos -810.844 849.183)
+      (parent &quot;&quot;)
       (path &quot;images/decal/light.png&quot;)
       (type 1)
       )
     (decal
-      (pos 1690.18 500.046)
+      (pos 676.954 1029.44)
       (parent &quot;&quot;)
-      (path &quot;images/decal/light.png&quot;)
+      (path &quot;images/objects/box.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos 612.954 1029.44)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/box.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos 648.954 965.44)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/box.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos 740.954 1029.44)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/box.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos 584.954 965.44)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/box.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos 548.954 1029.44)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/box.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos 706.554 965.44)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/box.png&quot;)
+      (type 0)
+      )
+    (decal
+      (pos 996.814 579.855)
+      (parent &quot;&quot;)
+      (path &quot;images/objects/apartmentlamp_light.png&quot;)
       (type 1)
       )
     (decal
-      (pos 1705.09 795.718)
+      (pos 264.392 554.465)
       (parent &quot;&quot;)
-      (path &quot;images/decal/light.png&quot;)
+      (path &quot;images/objects/apartmentlamp_light.png&quot;)
       (type 1)
       )
     (decal
-      (pos 926.541 883.87)
+      (pos 1649.16 577.902)
       (parent &quot;&quot;)
+      (path &quot;images/objects/apartmentlamp_light.png&quot;)
+      (type 1)
+      )
+    (decal
+      (pos -1636 909.933)
+      (parent &quot;&quot;)
       (path &quot;images/decal/light.png&quot;)
       (type 1)
       )
     (decal
-      (pos 11.075 1013.44)
+      (pos -3689.93 712.902)
       (parent &quot;&quot;)
-      (path &quot;images/objects/plant.png&quot;)
+      (path &quot;images/decal/steelplate.png&quot;)
       (type 0)
       )
     (decal
-      (pos 424.131 1013.44)
+      (pos -3886.44 968.902)
       (parent &quot;&quot;)
-      (path &quot;images/objects/plant.png&quot;)
+      (path &quot;images/decal/steelplate.png&quot;)
       (type 0)
       )
     (decal
-      (pos -1002.18 1013.44)
+      (pos -3516.44 968.902)
       (parent &quot;&quot;)
-      (path &quot;images/objects/plant.png&quot;)
+      (path &quot;images/decal/steelplate.png&quot;)
       (type 0)
       )
     (decal
-      (pos -914.086 1013.44)
+      (pos -4059.93 712.902)
       (parent &quot;&quot;)
-      (path &quot;images/objects/plant.png&quot;)
+      (path &quot;images/decal/steelplate.png&quot;)
       (type 0)
       )
     (decal
-      (pos -832.618 1013.44)
+      (pos -4256.44 968.902)
       (parent &quot;&quot;)
-      (path &quot;images/objects/plant.png&quot;)
+      (path &quot;images/decal/steelplate.png&quot;)
       (type 0)
       )
     (decal
-      (pos 1064.43 1014.67)
+      (pos -4253.74 456.902)
       (parent &quot;&quot;)
-      (path &quot;images/objects/plant.png&quot;)
+      (path &quot;images/decal/steelplate.png&quot;)
       (type 0)
       )
     (decal
-      (pos -354.815 727.027)
+      (pos -3513.74 456.902)
       (parent &quot;&quot;)
-      (path &quot;images/decal/light.png&quot;)
-      (type 1)
+      (path &quot;images/decal/steelplate.png&quot;)
+      (type 0)
       )
     (decal
-      (pos -893.773 129.906)
+      (pos -3883.74 456.902)
       (parent &quot;&quot;)
-      (path &quot;images/decal/dark.png&quot;)
+      (path &quot;images/decal/steelplate.png&quot;)
       (type 0)
       )
     (decal
-      (pos -899.632 118.188)
+      (pos -4429.93 712.902)
       (parent &quot;&quot;)
-      (path &quot;images/decal/dark.png&quot;)
+      (path &quot;images/decal/steelplate.png&quot;)
       (type 0)
       )
+    (decal
+      (pos -3319.93 712.902)
+      (parent &quot;&quot;)
+      (path &quot;images/decal/steelplate.png&quot;)
+      (type 0)
+      )
     )
   )
 

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -88,6 +88,7 @@
     &quot;      &lt;menuitem action='ToggleLightLayer'/&gt;&quot;
     &quot;      &lt;menuitem action='ToggleHighlightLayer'/&gt;&quot;
     &quot;      &lt;menuitem action='ToggleControlLayer'/&gt;&quot;
+    &quot;      &lt;menuitem action='ToggleBackgroundLayer'/&gt;&quot;
     &quot;    &lt;/menu&gt;&quot;
     &quot;    &lt;menu action='MenuTools'&gt;&quot;
     &quot;      &lt;menuitem action='SelectTool'/&gt;&quot;
@@ -140,6 +141,7 @@
     &quot;    &lt;toolitem action='ToggleLightLayer'/&gt;&quot;
     &quot;    &lt;toolitem action='ToggleHighlightLayer'/&gt;&quot;
     &quot;    &lt;toolitem action='ToggleControlLayer'/&gt;&quot;
+    &quot;    &lt;toolitem action='ToggleBackgroundLayer'/&gt;&quot;
     &quot;  &lt;/toolbar&gt;&quot;
     &quot;&lt;/ui&gt;&quot;;
 
@@ -202,15 +204,18 @@
   action_group-&gt;add(Gtk::Action::create(&quot;About&quot;,       Gtk::Stock::ABOUT),
                     sigc::mem_fun(*this, &amp;EditorWindow::on_about_clicked));
 
-  Glib::RefPtr&lt;Gtk::ToggleAction&gt; toggle_color_layer = Gtk::ToggleAction::create_with_icon_name(&quot;ToggleColorLayer&quot;, &quot;color&quot;, &quot;Toogle Color Layer&quot;, &quot;Toogle Color Layer&quot;);
-  Glib::RefPtr&lt;Gtk::ToggleAction&gt; toggle_light_layer = Gtk::ToggleAction::create_with_icon_name(&quot;ToggleLightLayer&quot;, &quot;light&quot;, &quot;Toogle Light Layer&quot;, &quot;Toogle Light Layer&quot;);
+  Glib::RefPtr&lt;Gtk::ToggleAction&gt; toggle_color_layer     = Gtk::ToggleAction::create_with_icon_name(&quot;ToggleColorLayer&quot;, &quot;color&quot;, &quot;Toogle Color Layer&quot;, &quot;Toogle Color Layer&quot;);
+  Glib::RefPtr&lt;Gtk::ToggleAction&gt; toggle_light_layer     = Gtk::ToggleAction::create_with_icon_name(&quot;ToggleLightLayer&quot;, &quot;light&quot;, &quot;Toogle Light Layer&quot;, &quot;Toogle Light Layer&quot;);
   Glib::RefPtr&lt;Gtk::ToggleAction&gt; toggle_highlight_layer = Gtk::ToggleAction::create_with_icon_name(&quot;ToggleHighlightLayer&quot;, &quot;highlight&quot;, &quot;Toogle Highlight Layer&quot;, &quot;Toogle Highlight Layer&quot;);
-  Glib::RefPtr&lt;Gtk::ToggleAction&gt; toggle_control_layer = Gtk::ToggleAction::create_with_icon_name(&quot;ToggleControlLayer&quot;, &quot;control&quot;, &quot;Toogle Control Layer&quot;, &quot;Toogle Control Layer&quot;);
+  Glib::RefPtr&lt;Gtk::ToggleAction&gt; toggle_control_layer   = Gtk::ToggleAction::create_with_icon_name(&quot;ToggleControlLayer&quot;, &quot;control&quot;, &quot;Toogle Control Layer&quot;, &quot;Toogle Control Layer&quot;);
+
+  Glib::RefPtr&lt;Gtk::ToggleAction&gt; background_layer = Gtk::ToggleAction::create_with_icon_name(&quot;ToggleBackgroundLayer&quot;, &quot;background_layer&quot;, &quot;Toggle Background Layer&quot;, &quot;Toggle Background Layer&quot;);
   
   toggle_color_layer-&gt;set_active(true);
   toggle_light_layer-&gt;set_active(true);
   toggle_highlight_layer-&gt;set_active(true);
   toggle_control_layer-&gt;set_active(true);
+  background_layer-&gt;set_active(true);
 
   action_group-&gt;add(toggle_color_layer,
                     sigc::bind(sigc::mem_fun(*this, &amp;EditorWindow::toggle_render_layer), toggle_color_layer, (uint32_t)SceneContext::COLORMAP));
@@ -220,6 +225,8 @@
                     sigc::bind(sigc::mem_fun(*this, &amp;EditorWindow::toggle_render_layer), toggle_highlight_layer, (uint32_t)SceneContext::HIGHLIGHTMAP));
   action_group-&gt;add(toggle_control_layer,
                     sigc::bind(sigc::mem_fun(*this, &amp;EditorWindow::toggle_render_layer), toggle_control_layer, (uint32_t)SceneContext::CONTROLMAP));
+  action_group-&gt;add(background_layer,
+                    sigc::bind(sigc::mem_fun(*this, &amp;EditorWindow::toggle_background_layer), background_layer));
 
   // Tools
   action_group-&gt;add(Gtk::Action::create(&quot;MenuTools&quot;,  &quot;_Tools&quot;));
@@ -253,7 +260,9 @@
 
   Gtk::Toolbar* toolbar = static_cast&lt;Gtk::Toolbar*&gt;(ui_manager-&gt;get_widget(&quot;/ToolBar&quot;));
   toolbar-&gt;append(*(Gtk::manage(new Gtk::SeparatorToolItem())));
-  toolbar-&gt;append(*(Gtk::manage(new LayerWidget())));
+  layer_widget = Gtk::manage(new LayerWidget());
+  toolbar-&gt;append(*layer_widget);
+  layer_widget-&gt;signal_layer_toggle.connect(sigc::mem_fun(*this, &amp;EditorWindow::on_layer_toggle));
 
   // Packing
 
@@ -281,7 +290,7 @@
   vpaned.pack1(object_selector, Gtk::EXPAND);
   vpaned.pack2(object_tree,     Gtk::SHRINK);
 
-  hpaned.set_position(730);
+  hpaned.set_position(1024);
   vpaned.set_position(420);
 
   // Window
@@ -318,14 +327,15 @@
   std::cout &lt;&lt; &quot;on_new&quot; &lt;&lt; std::endl;
 
   // FIXME: We abuse the minimap as our root GLContext
-  WindstilleWidget* windstille = Gtk::manage(new WindstilleWidget(glconfig, minimap_widget.get_gl_context()));
+  WindstilleWidget* wst = Gtk::manage(new WindstilleWidget(glconfig, minimap_widget.get_gl_context()));
 
   Glib::ustring title = Glib::ustring::compose(&quot;Sector %1&quot;, notebook.get_n_pages());
-  int new_page = notebook.append_page(*windstille, title);
-  windstille-&gt;show();
-  notebook.set_current_page(new_page); 
+  int new_page = notebook.append_page(*wst, title);
+  wst-&gt;show();
+  notebook.set_current_page(new_page);
 
-  object_tree.set_model(windstille-&gt;get_sector_model());
+  object_tree.set_model(wst-&gt;get_sector_model());
+  layer_widget-&gt;update(wst-&gt;get_layer_mask());
 }
 
 void
@@ -482,6 +492,16 @@
     }
 }
 
+void
+EditorWindow::toggle_background_layer(Glib::RefPtr&lt;Gtk::ToggleAction&gt; action)
+{
+  if (WindstilleWidget* wst = get_windstille_widget())
+    {
+      wst-&gt;set_draw_background_pattern(action-&gt;get_active());
+      wst-&gt;queue_draw();
+    }
+}
+
 Tool*
 EditorWindow::get_current_tool() const
 {
@@ -532,10 +552,15 @@
 EditorWindow::on_switch_page(GtkNotebookPage* page, guint page_num)
 {
   std::cout &lt;&lt; &quot;on_switch_page(&quot; &lt;&lt; page &lt;&lt; &quot;, &quot; &lt;&lt; page_num &lt;&lt; &quot;)&quot; &lt;&lt; std::endl;
-  if (get_windstille_widget())
-    object_tree.set_model(get_windstille_widget()-&gt;get_sector_model());
+  if (WindstilleWidget* wst = get_windstille_widget())
+    {
+      object_tree.set_model(wst-&gt;get_sector_model());
+      layer_widget-&gt;update(wst-&gt;get_layer_mask());
+    }
   else
-    object_tree.set_model(0);
+    {
+      object_tree.set_model(0);
+    }
 }
 
 void
@@ -559,6 +584,17 @@
 }
 
 void
+EditorWindow::on_layer_toggle(int layer, bool status)
+{
+  std::cout &lt;&lt; &quot;EditorWindow::on_layer_toggle(&quot; &lt;&lt; layer &lt;&lt; &quot;, &quot; &lt;&lt; status &lt;&lt; &quot;)&quot; &lt;&lt; std::endl;
+
+  if (WindstilleWidget* wst = get_windstille_widget())
+    {
+      wst-&gt;get_layer_mask().set(layer, status);
+    }
+}
+
+void
 EditorWindow::on_play()
 {
   if (play_action-&gt;get_active())

Modified: trunk/windstille/src/editor/editor_window.hpp
===================================================================
--- trunk/windstille/src/editor/editor_window.hpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/editor/editor_window.hpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -36,6 +36,7 @@
 class WindstilleWidget;
 class SelectTool;
 class ZoomTool;
+class LayerWidget;
 
 class EditorWindow : public Gtk::Window
 {
@@ -72,6 +73,7 @@
   std::auto_ptr&lt;SelectTool&gt; select_tool;
   std::auto_ptr&lt;ZoomTool&gt;   zoom_tool;
   Tool* current_tool;
+  LayerWidget* layer_widget;
 
   sigc::connection  timeout_connection;
   
@@ -98,11 +100,14 @@
   void on_zoom_in();
   void on_zoom_out();
   void on_zoom_100();
+  
+  void on_layer_toggle(int layer, bool status);
 
   void on_switch_page(GtkNotebookPage* page, guint page_num);
   void on_tool_select(Glib::RefPtr&lt;Gtk::RadioAction&gt; action, Tool*);
 
   void toggle_render_layer(Glib::RefPtr&lt;Gtk::ToggleAction&gt; action, uint32_t mask);
+  void toggle_background_layer(Glib::RefPtr&lt;Gtk::ToggleAction&gt; action);
 
   Tool* get_current_tool() const;
   WindstilleWidget* get_windstille_widget();

Modified: trunk/windstille/src/editor/layer.hpp
===================================================================
--- trunk/windstille/src/editor/layer.hpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/editor/layer.hpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -18,8 +18,7 @@
 
 #ifndef HEADER_WINDSTILLE_EDITOR_LAYER_HPP
 #define HEADER_WINDSTILLE_EDITOR_LAYER_HPP
-
-/** */
+
 class Layer
 {
 private:
@@ -29,14 +28,35 @@
   Layer() : mask(~0) {}
   Layer(uint32_t mask_) : mask(mask_) {}
 
-  uint32_t get_mask() const;
+  uint32_t get_mask() const { return mask; }
 
   bool match(const Layer&amp; rhs) const
   {
     return (mask &amp; rhs.mask);
   }
+
+  void set(unsigned int layer, bool enable)
+  {
+    if (enable)
+      {
+        mask = mask | (1&lt;&lt;layer);
+      }
+    else
+      {
+        mask = mask &amp; (~(1&lt;&lt;layer));
+      }
+  }
+
+  bool get(unsigned int layer) const 
+  {
+    return mask &amp; (1&lt;&lt;layer);
+  }
+
+  operator bool() {
+    return mask;
+  }
 };
-
+
 #endif
 
 /* EOF */

Modified: trunk/windstille/src/editor/layer_widget.cpp
===================================================================
--- trunk/windstille/src/editor/layer_widget.cpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/editor/layer_widget.cpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -19,6 +19,8 @@
 #include &lt;iostream&gt;
 #include &lt;gtkmm/togglebutton.h&gt;
 #include &lt;gtkmm/separator.h&gt;
+
+#include &quot;layer.hpp&quot;
 #include &quot;layer_widget.hpp&quot;
 
 LayerWidget::LayerWidget()
@@ -36,6 +38,7 @@
 
             button-&gt;signal_toggled().connect(sigc::bind(sigc::mem_fun(*this, &amp;LayerWidget::on_layer_toggle), 
                                                         button, layer_number));
+            buttons.push_back(button);
             layer_number += 1;
           }
         else
@@ -61,6 +64,16 @@
 LayerWidget::on_layer_toggle(Gtk::ToggleButton* button, int layer)
 {
   std::cout &lt;&lt; &quot;Layer: &quot; &lt;&lt; layer &lt;&lt; &quot; -&gt; &quot; &lt;&lt; button-&gt;get_active() &lt;&lt; std::endl;
+  signal_layer_toggle(layer, button-&gt;get_active());
 }
+
+void
+LayerWidget::update(const Layer&amp; layer)
+{
+  for(int i = 0; i &lt; 32; ++i)
+    {
+      buttons[i]-&gt;set_active(layer.get(i));
+    }
+}
 
 /* EOF */

Modified: trunk/windstille/src/editor/layer_widget.hpp
===================================================================
--- trunk/windstille/src/editor/layer_widget.hpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/editor/layer_widget.hpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -22,17 +22,23 @@
 #include &lt;gtkmm/toolitem.h&gt;
 #include &lt;gtkmm/table.h&gt;
 
+class Layer;
+
 class LayerWidget : public Gtk::ToolItem
 {
 private:
   Gtk::Table table;
+  std::vector&lt;Gtk::ToggleButton*&gt; buttons;
 
 public:
   LayerWidget();
   ~LayerWidget();
 
   void on_layer_toggle(Gtk::ToggleButton* button, int layer);
+  void update(const Layer&amp; layer);
 
+  sigc::signal&lt;void, int, bool&gt; signal_layer_toggle;
+
 private:
   LayerWidget(const LayerWidget&amp;);
   LayerWidget&amp; operator=(const LayerWidget&amp;);

Modified: trunk/windstille/src/editor/object_model.cpp
===================================================================
--- trunk/windstille/src/editor/object_model.cpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/editor/object_model.cpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -35,6 +35,11 @@
   reader.read(&quot;name&quot;, name);
   reader.get(&quot;pos&quot;,  rel_pos);
   reader.read(&quot;parent&quot;,  parent);
+  
+  // FIXME: Bad, will overflow
+  int layer_mask = 1;
+  reader.read(&quot;layer&quot;,  layer_mask);
+  layer = Layer(layer_mask);
 }
 
 ObjectModel::~ObjectModel()
@@ -48,7 +53,8 @@
 
   return writer
     .write(&quot;pos&quot;, rel_pos)
-    .write(&quot;parent&quot;, parent.get() ? parent-&gt;get_name() : &quot;&quot;);
+    .write(&quot;parent&quot;, parent.get() ? parent-&gt;get_name() : &quot;&quot;)
+    .write(&quot;layer&quot;, layer.get_mask());
 }
 
 void

Modified: trunk/windstille/src/editor/object_model.hpp
===================================================================
--- trunk/windstille/src/editor/object_model.hpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/editor/object_model.hpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -64,6 +64,7 @@
   void on_move_end(const Vector2f&amp; offset);
 
   Layer get_layer() const { return layer; }
+  void  set_layer(const Layer&amp; layer_) { layer = layer_; }
 
   SnapData snap_object(const Rectf&amp; rect) const;
 

Modified: trunk/windstille/src/editor/sector_model.cpp
===================================================================
--- trunk/windstille/src/editor/sector_model.cpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/editor/sector_model.cpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -82,11 +82,12 @@
 }
 
 ObjectModelHandle
-SectorModel::get_object_at(const Vector2f&amp; pos) const
+SectorModel::get_object_at(const Vector2f&amp; pos, const Layer&amp; layer) const
 {
   for(Objects::const_reverse_iterator i = objects.rbegin(); i != objects.rend(); ++i)
     {
-      if ((*i)-&gt;get_bounding_box().is_inside(pos))
+      if (layer.match((*i)-&gt;get_layer()) &amp;&amp;
+          (*i)-&gt;get_bounding_box().is_inside(pos))
         {
           return *i;
         }
@@ -95,13 +96,14 @@
 }
 
 SelectionHandle
-SectorModel::get_selection(const Rectf&amp; rect) const
+SectorModel::get_selection(const Rectf&amp; rect, const Layer&amp; layer) const
 {
   SelectionHandle selection = Selection::create();
 
   for(Objects::const_reverse_iterator i = objects.rbegin(); i != objects.rend(); ++i)
     {
-      if ((*i)-&gt;get_bounding_box().is_overlapped(rect))
+      if (layer.match((*i)-&gt;get_layer()) &amp;&amp;
+          (*i)-&gt;get_bounding_box().is_overlapped(rect))
         {
           selection-&gt;add(*i);
         }

Modified: trunk/windstille/src/editor/sector_model.hpp
===================================================================
--- trunk/windstille/src/editor/sector_model.hpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/editor/sector_model.hpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -83,8 +83,8 @@
   void on_row_inserted(const Gtk::TreeModel::Path&amp; path, const Gtk::TreeModel::iterator&amp; iter);
   void on_rows_reordered(const Gtk::TreeModel::Path&amp; path, const Gtk::TreeModel::iterator&amp; iter, int* new_order);
 
-  ObjectModelHandle get_object_at(const Vector2f&amp; pos) const;
-  SelectionHandle   get_selection(const Rectf&amp; rect) const;
+  ObjectModelHandle get_object_at(const Vector2f&amp; pos, const Layer&amp; layer) const;
+  SelectionHandle   get_selection(const Rectf&amp; rect, const Layer&amp; layer) const;
   
   void raise_to_top(ObjectModelHandle object);
   void lower_to_bottom(ObjectModelHandle object);

Modified: trunk/windstille/src/editor/select_tool.cpp
===================================================================
--- trunk/windstille/src/editor/select_tool.cpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/editor/select_tool.cpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -32,7 +32,7 @@
 {
   click_pos = wst.get_state().screen_to_world(Vector2f(event-&gt;x, event-&gt;y));
   
-  ObjectModelHandle object = wst.get_sector_model()-&gt;get_object_at(click_pos);
+  ObjectModelHandle object = wst.get_sector_model()-&gt;get_object_at(click_pos, wst.get_layer_mask());
   if (object.get())
     {
       if (wst.get_selection()-&gt;has_object(object))
@@ -141,7 +141,7 @@
     {
       mode = NO_MODE;
       rect.normalize();
-      wst.set_selection(wst.get_sector_model()-&gt;get_selection(rect));
+      wst.set_selection(wst.get_sector_model()-&gt;get_selection(rect, wst.get_layer_mask()));
     }
 
   mode = NO_MODE;

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -41,7 +41,9 @@
   : sector_model(new SectorModel()),
     active_tool(0),
     scroll_tool(new ScrollTool()),
-    map_type(DecalObjectModel::COLORMAP)
+    map_type(DecalObjectModel::COLORMAP),
+    draw_background_pattern(true),
+    layer_mask(1)
 {
   set_gl_capability(glconfig, share_list);
 
@@ -204,8 +206,10 @@
     {
       state.push(*sc);
       
-      //sc-&gt;color().fill_pattern(background_pattern);
-      sc-&gt;color().fill_screen(Color());
+      if (draw_background_pattern)
+        sc-&gt;color().fill_pattern(background_pattern);
+      else
+        sc-&gt;color().fill_screen(Color());
 
       sector_model-&gt;draw(*sc);
 
@@ -469,6 +473,14 @@
                                                       state.screen_to_world(Vector2f(x, y)),
                                                       data.get_data_as_string().substr(5), 
                                                       map_type);
+
+  // if layer mask is 0, set it to all layers instead, so that the
+  // object doesn't become unusable
+  if (!layer_mask)
+    object-&gt;set_layer(Layer());
+  else
+    object-&gt;set_layer(layer_mask);
+
   sector_model-&gt;add(object);
 }
 

Modified: trunk/windstille/src/editor/windstille_widget.hpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.hpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/editor/windstille_widget.hpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -36,6 +36,7 @@
 #include &quot;control_point.hpp&quot;
 #include &quot;decal_object_model.hpp&quot;
 #include &quot;selection.hpp&quot;
+#include &quot;layer.hpp&quot;
 
 class Tool;
 class ScrollTool;
@@ -58,7 +59,9 @@
   SelectionHandle selection;
   DecalObjectModel::MapType map_type;
   Texture background_pattern;
-
+  bool draw_background_pattern;
+  Layer layer_mask;
+  
 public:
   WindstilleWidget(const Glib::RefPtr&lt;const Gdk::GL::Config&gt;&amp; glconfig,
                    const Glib::RefPtr&lt;const Gdk::GL::Context&gt;&amp; share_list);
@@ -108,10 +111,14 @@
   void set_selection(const SelectionHandle&amp; selection);
   SelectionHandle get_selection() const;
 
+  Layer&amp; get_layer_mask() { return layer_mask; }
+
   SceneContext* get_sc() const { return sc.get(); }
 
   void load_file(const std::string&amp; filename);
 
+  void set_draw_background_pattern(bool v) { draw_background_pattern = v; }
+
 private:
   WindstilleWidget (const WindstilleWidget&amp;);
   WindstilleWidget&amp; operator= (const WindstilleWidget&amp;);

Modified: trunk/windstille/src/util/file_reader.cpp
===================================================================
--- trunk/windstille/src/util/file_reader.cpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/util/file_reader.cpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -84,6 +84,15 @@
 }
 
 bool
+FileReader::read(const char* name, uint32_t&amp; value)
+{
+  if (impl.get())
+    return impl-&gt;read_uint32(name, value);
+  else
+    return false;
+}
+
+bool
 FileReader::read(const char* name, int&amp; value)
 {
   if (impl.get())

Modified: trunk/windstille/src/util/file_reader.hpp
===================================================================
--- trunk/windstille/src/util/file_reader.hpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/util/file_reader.hpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -66,6 +66,7 @@
   // FIXME: Is there any nice way to not use two different names?
   bool read(const char* name, FileReader&amp; v);
 
+  bool read(const char* name, uint32_t&amp; v);
   bool read(const char* name, int&amp;   v);
   bool read(const char* name, float&amp; v);
   bool read(const char* name, bool&amp; v);

Modified: trunk/windstille/src/util/file_reader_impl.hpp
===================================================================
--- trunk/windstille/src/util/file_reader_impl.hpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/util/file_reader_impl.hpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -41,6 +41,7 @@
 
   virtual bool read_bool  (const char* name, bool&amp;)        const =0;
   virtual bool read_int   (const char* name, int&amp;)         const =0;
+  virtual bool read_uint32(const char* name, uint32_t&amp;)    const =0;
   virtual bool read_float (const char* name, float&amp;)       const =0;
   virtual bool read_string(const char* name, std::string&amp;) const =0;
 

Modified: trunk/windstille/src/util/file_writer.cpp
===================================================================
--- trunk/windstille/src/util/file_writer.cpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/util/file_writer.cpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -80,6 +80,14 @@
 }
 
 FileWriter&amp;
+FileWriter::write(const std::string&amp; name, uint32_t value)
+{
+  indent();
+  out &lt;&lt; &quot;(&quot; &lt;&lt; name &lt;&lt; &quot; &quot; &lt;&lt; value &lt;&lt; &quot;)\n&quot;;
+  return *this;
+}
+
+FileWriter&amp;
 FileWriter::write(const std::string&amp; name, float value)
 {
   indent();

Modified: trunk/windstille/src/util/file_writer.hpp
===================================================================
--- trunk/windstille/src/util/file_writer.hpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/util/file_writer.hpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -44,6 +44,7 @@
 
   FileWriter&amp; write(const std::string&amp; name, bool value);
   FileWriter&amp; write(const std::string&amp; name, int value);
+  FileWriter&amp; write(const std::string&amp; name, uint32_t value);
   FileWriter&amp; write(const std::string&amp; name, float value);
   FileWriter&amp; write(const std::string&amp; name, const std::string&amp; value);
   FileWriter&amp; write(const std::string&amp; name, const char* value);

Modified: trunk/windstille/src/util/sexpr_file_reader.cpp
===================================================================
--- trunk/windstille/src/util/sexpr_file_reader.cpp	2009-03-25 22:07:04 UTC (rev 2767)
+++ trunk/windstille/src/util/sexpr_file_reader.cpp	2009-03-26 01:46:44 UTC (rev 2768)
@@ -81,6 +81,18 @@
     return false;
   }
 
+  bool read_uint32(const char* name, uint32_t&amp; v) const 
+  {
+    lisp::Lisp* item = get_subsection_item(name);
+    if (item &amp;&amp; item-&gt;get_type() == lisp::Lisp::TYPE_INT)
+      {
+        // FIXME: Not good: overflow
+        v = item-&gt;get_int();
+        return true;
+      }
+    return false;
+  }
+
   bool read_float(const char* name, float&amp; v) const 
   {
     lisp::Lisp* item = get_subsection_item(name);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001764.html">[Windstille-commit] r2767 - in trunk/windstille: . src src/editor
</A></li>
	<LI>Next message: <A HREF="001766.html">[Windstille-commit] r2769 - in trunk/windstille: .	data/sectors/trainstation src/editor src/util
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1765">[ date ]</a>
              <a href="thread.html#1765">[ thread ]</a>
              <a href="subject.html#1765">[ subject ]</a>
              <a href="author.html#1765">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/windstille-commit">More information about the Windstille-commit
mailing list</a><br>
</body></html>
