From grumbel at mail.berlios.de  Wed Apr  1 04:10:40 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 1 Apr 2009 04:10:40 +0200
Subject: [Windstille-commit] r2840 - in trunk/windstille/src: display editor
	math
Message-ID: <200904010210.n312Aeos030815@sheep.berlios.de>

Author: grumbel
Date: 2009-04-01 04:10:38 +0200 (Wed, 01 Apr 2009)
New Revision: 2840

Modified:
   trunk/windstille/src/display/surface.cpp
   trunk/windstille/src/display/surface_drawing_parameters.hpp
   trunk/windstille/src/editor/control_point.hpp
   trunk/windstille/src/editor/decal_object_model.cpp
   trunk/windstille/src/editor/decal_object_model.hpp
   trunk/windstille/src/editor/select_tool.cpp
   trunk/windstille/src/editor/windstille_widget.cpp
   trunk/windstille/src/editor/windstille_widget.hpp
   trunk/windstille/src/math/rect.hpp
   trunk/windstille/src/math/vector2f.hpp
Log:
Switched back from Quad editing to plain Surface with a scale and angle

Modified: trunk/windstille/src/display/surface.cpp
===================================================================
--- trunk/windstille/src/display/surface.cpp	2009-03-31 16:03:01 UTC (rev 2839)
+++ trunk/windstille/src/display/surface.cpp	2009-04-01 02:10:38 UTC (rev 2840)
@@ -148,22 +148,29 @@
   state.activate();
 
   glBegin(GL_QUADS);
+  if (0) // params.rotation)
+    {
 
-  // FIXME: This is just a primitive prototype, should take things
-  // like hotspot and flip into account 
-  glTexCoord2f(impl->uv.left, impl->uv.top);
-  glVertex2f(params.pos.x, params.pos.y);
+    }
+  else
+    {
+      // FIXME: This is just a primitive prototype, should take things
+      // like hotspot and flip into account 
+      glTexCoord2f(impl->uv.left, impl->uv.top);
+      glVertex2f(params.pos.x, params.pos.y);
 
-  glTexCoord2f(impl->uv.right, impl->uv.top);
-  glVertex2f(params.pos.x + impl->size.width * params.scale, params.pos.y);
+      glTexCoord2f(impl->uv.right, impl->uv.top);
+      glVertex2f(params.pos.x + impl->size.width * params.scale.x, 
+                 params.pos.y);
 
-  glTexCoord2f(impl->uv.right, impl->uv.bottom);
-  glVertex2f(params.pos.x + impl->size.width * params.scale, 
-             params.pos.y + impl->size.height * params.scale);
+      glTexCoord2f(impl->uv.right, impl->uv.bottom);
+      glVertex2f(params.pos.x + impl->size.width  * params.scale.x, 
+                 params.pos.y + impl->size.height * params.scale.y);
 
-  glTexCoord2f(impl->uv.left, impl->uv.bottom);
-  glVertex2f(params.pos.x, params.pos.y + impl->size.height * params.scale);
-
+      glTexCoord2f(impl->uv.left, impl->uv.bottom);
+      glVertex2f(params.pos.x, 
+                 params.pos.y + impl->size.height * params.scale.y);
+    }
   glEnd(); 
 }
 

Modified: trunk/windstille/src/display/surface_drawing_parameters.hpp
===================================================================
--- trunk/windstille/src/display/surface_drawing_parameters.hpp	2009-03-31 16:03:01 UTC (rev 2839)
+++ trunk/windstille/src/display/surface_drawing_parameters.hpp	2009-04-01 02:10:38 UTC (rev 2840)
@@ -40,7 +40,7 @@
 
   float rotation;
 
-  float scale;
+  Vector2f scale;
 
   SurfaceDrawingParameters()
   {
@@ -52,12 +52,12 @@
     color = Color(1.0f, 1.0f, 1.0f, 1.0f);
   
     rotation = 0.0f;
-    scale    = 1.0f;
+    scale    = Vector2f(1.0f, 1.0f);
   }
 
   SurfaceDrawingParameters& set_scale(float s) 
   { 
-    scale    = s; 
+    scale    = Vector2f(s, s); 
     return *this; 
   }
 
@@ -69,10 +69,16 @@
 
   SurfaceDrawingParameters& set_rotation(float r) 
   { 
-    rotation = r; 
+    rotation = r;
     return *this; 
   }
 
+  SurfaceDrawingParameters& set_scale(const Vector2f& s) 
+  { 
+    scale = s;
+    return *this; 
+  }
+
   SurfaceDrawingParameters& set_pos(const Vector2f& p) 
   { 
     pos = p;

Modified: trunk/windstille/src/editor/control_point.hpp
===================================================================
--- trunk/windstille/src/editor/control_point.hpp	2009-03-31 16:03:01 UTC (rev 2839)
+++ trunk/windstille/src/editor/control_point.hpp	2009-04-01 02:10:38 UTC (rev 2840)
@@ -32,7 +32,7 @@
 public:
   static ControlPointHandle create(const Vector2f& pos);
 
-private:
+protected:
   Vector2f     pos;
   Vector2f  offset;
 

Modified: trunk/windstille/src/editor/decal_object_model.cpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.cpp	2009-03-31 16:03:01 UTC (rev 2839)
+++ trunk/windstille/src/editor/decal_object_model.cpp	2009-04-01 02:10:38 UTC (rev 2840)
@@ -16,9 +16,11 @@
 **  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
 
+#include <iostream>
 #include "util/file_reader.hpp"
 #include "display/surface.hpp"
 #include "display/drawing_parameters.hpp"
+#include "display/surface_drawing_parameters.hpp"
 #include "display/scene_context.hpp"
 #include "decal_object_model.hpp"
 
@@ -30,15 +32,17 @@
 }
 
 DecalObjectModel::DecalObjectModel(const FileReader& reader)
-  : ObjectModel(reader)
+  : ObjectModel(reader),
+    scale(1.0f, 1.0f),
+    angle(0.0f)
 {
   int map_type = 0;
   reader.get("path", path);
   reader.get("type", map_type);
+  reader.get("scale", scale);
+  reader.get("angle", angle);
   type = (MapType)map_type;
   surface = Surface(path);
-
-  quad = Quad(0, 0, surface.get_width(), surface.get_height());
 }
 
 DecalObjectModel::DecalObjectModel(const std::string& name, const Vector2f& rel_pos, 
@@ -46,9 +50,10 @@
   : ObjectModel("DecalObjectModel", rel_pos),
     path(path_),
     surface(path_),
-    type(type_)
+    type(type_),
+    scale(1.0f, 1.0f),
+    angle(0.0f)
 {
-  quad = Quad(0, 0, surface.get_width(), surface.get_height());
 }
 
 DecalObjectModel::~DecalObjectModel()
@@ -56,6 +61,12 @@
 }
 
 void
+DecalObjectModel::set_scale(const Vector2f& scale_)
+{
+  scale = scale_;
+}
+
+void
 DecalObjectModel::draw(SceneContext& sc)
 {
   ObjectModel::draw(sc);
@@ -64,32 +75,37 @@
   Vector2f center_offset(-surface.get_width()/2,
                          -surface.get_height()/2);
 
+  DrawingContext* dc = 0; 
+
   switch(type)
     {
-      case COLORMAP:
-        sc.color().draw(surface, wo_pos + center_offset, quad,
-                        DrawingParameters());
-        break;
+      case COLORMAP:     dc = &sc.color();
+      case LIGHTMAP:     dc = &sc.light();
+      case HIGHLIGHTMAP: dc = &sc.highlight();
+    }
 
-      case LIGHTMAP:
-        sc.light().draw(surface, wo_pos + center_offset, quad, 
-                        DrawingParameters().set_blend_func(GL_SRC_ALPHA, GL_ONE));
-        break;
+  center_offset.x *= scale.x;
+  center_offset.y *= scale.y;
 
-      case HIGHLIGHTMAP:
-        sc.highlight().draw(surface, wo_pos + center_offset, quad, 
-                            DrawingParameters().set_blend_func(GL_SRC_ALPHA, GL_ONE));
-        break;
-    }
+  dc->draw(surface, SurfaceDrawingParameters()
+                        .set_pos(wo_pos + center_offset)
+                        .set_rotation(angle)
+                        .set_scale(scale));
 }
 
 Rectf
 DecalObjectModel::get_bounding_box() const
 {
-  Vector2f center_offset(-surface.get_width()/2,
-                         -surface.get_height()/2);
+  Vector2f center_offset(surface.get_width()/2,
+                         surface.get_height()/2);
 
-  return quad.get_bounding_box() + get_world_pos() + center_offset;
+  center_offset.x *= scale.x;
+  center_offset.y *= scale.y;
+
+  Rectf r(get_world_pos() - center_offset,
+          get_world_pos() + center_offset);
+  r.normalize();
+  return r;
 }
 
 ObjectModelHandle
@@ -105,47 +121,58 @@
   ObjectModel::write_member(writer);
   writer.write("path",    path);
   writer.write("type",    type);
+  writer.write("scale",   scale);
+  writer.write("angle",   angle);
   writer.end_section();
 }
 
-class QuadControlPoint : public ControlPoint
+class DecalControlPoint : public ControlPoint
 {
 private:
-  Quad& quad;
-  int n;
+  DecalObjectModel* object;
+  Vector2f orig_scale;
 
 public:
-  QuadControlPoint(int n_, Quad& quad_, const Vector2f& pos_)
+  DecalControlPoint(DecalObjectModel* object_, const Vector2f& pos_)
     : ControlPoint(pos_),
-      quad(quad_),
-      n(n_)
+      object(object_),
+      orig_scale(object_->get_scale())
   {}
 
-  void on_move_start() {}
-  void on_move_update(const Vector2f& offset) {}
-  void on_move_end(const Vector2f& offset)
+  void on_move_start() 
   {
-    if (n == 0)
-      quad.p1 += offset;
-    else if (n == 1)
-      quad.p2 += offset;
-    else if (n == 2)
-      quad.p3 += offset;
-    else if (n == 3)
-      quad.p4 += offset;
-  }  
+  }
+
+  void on_move_update(const Vector2f& offset_) 
+  {
+    offset = offset_;
+
+    Vector2f start   = pos - object->get_world_pos();
+    Vector2f current = (pos + offset) - object->get_world_pos();
+
+    std::cout << "on_move_update: " << (current.x / start.x) << " " << (current.y / start.y) << std::endl;  
+    Vector2f new_scale = current / start;
+    new_scale.x *= orig_scale.x;
+    new_scale.y *= orig_scale.y;
+    object->set_scale(new_scale);
+  }
+  
+  void on_move_end(const Vector2f& offset_)
+  {
+    on_move_update(offset_);
+  }
 };
 
 void
 DecalObjectModel::add_control_points(std::vector<ControlPointHandle>& control_points)
 {
-  Vector2f center_offset(-surface.get_width()/2,
-                         -surface.get_height()/2);
+  float w = surface.get_width()/2  * scale.x;
+  float h = surface.get_height()/2 * scale.y;
 
-  control_points.push_back(ControlPointHandle(new QuadControlPoint(0, quad, quad.p1 + get_world_pos() + center_offset)));
-  control_points.push_back(ControlPointHandle(new QuadControlPoint(1, quad, quad.p2 + get_world_pos() + center_offset)));
-  control_points.push_back(ControlPointHandle(new QuadControlPoint(2, quad, quad.p3 + get_world_pos() + center_offset)));
-  control_points.push_back(ControlPointHandle(new QuadControlPoint(3, quad, quad.p4 + get_world_pos() + center_offset)));
+  control_points.push_back(ControlPointHandle(new DecalControlPoint(this, get_world_pos() - Vector2f(-w, -h))));
+  control_points.push_back(ControlPointHandle(new DecalControlPoint(this, get_world_pos() - Vector2f( w, -h))));
+  control_points.push_back(ControlPointHandle(new DecalControlPoint(this, get_world_pos() - Vector2f( w,  h))));
+  control_points.push_back(ControlPointHandle(new DecalControlPoint(this, get_world_pos() - Vector2f(-w,  h))));
 }
 
 /* EOF */

Modified: trunk/windstille/src/editor/decal_object_model.hpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.hpp	2009-03-31 16:03:01 UTC (rev 2839)
+++ trunk/windstille/src/editor/decal_object_model.hpp	2009-04-01 02:10:38 UTC (rev 2840)
@@ -34,15 +34,22 @@
 private:
   std::string path;
   Surface surface;
-  Quad quad;
   MapType type;
 
+  /** scale of the object, independed in x and y axis */
+  Vector2f scale;
+
+  float    angle;
+
 public:
   DecalObjectModel(const FileReader& reader);
   DecalObjectModel(const std::string& name, const Vector2f& rel_pos, 
                    const std::string& path_, MapType type_);
   ~DecalObjectModel();
 
+  void set_scale(const Vector2f& scale);
+  Vector2f get_scale() const { return scale; }
+
   bool is_snappable() const { return type == COLORMAP; }
   void draw(SceneContext& sc);
   Rectf get_bounding_box() const;

Modified: trunk/windstille/src/editor/select_tool.cpp
===================================================================
--- trunk/windstille/src/editor/select_tool.cpp	2009-03-31 16:03:01 UTC (rev 2839)
+++ trunk/windstille/src/editor/select_tool.cpp	2009-04-01 02:10:38 UTC (rev 2840)
@@ -36,6 +36,7 @@
   if (ctrl_point)
     {
       mode = CONTROL_DRAG_MODE;
+      wst.clear_control_points();
       ctrl_point->on_move_start();
     }
   else
@@ -152,6 +153,7 @@
   if (mode == CONTROL_DRAG_MODE)
     {
       ctrl_point->on_move_end(pos - click_pos);
+      wst.create_control_points();
     }
   else if (mode == OBJECT_DRAG_MODE)
     {

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-03-31 16:03:01 UTC (rev 2839)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-01 02:10:38 UTC (rev 2840)
@@ -650,6 +650,19 @@
     }
   return ControlPointHandle();
 }
+
+void
+WindstilleWidget::clear_control_points()
+{
+  control_points.clear();
+}
+
+void
+WindstilleWidget::create_control_points()
+{
+  control_points.clear();
+  selection->add_control_points(control_points);
+}
 
 SectorModel*
 WindstilleWidget::get_sector_model()

Modified: trunk/windstille/src/editor/windstille_widget.hpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.hpp	2009-03-31 16:03:01 UTC (rev 2839)
+++ trunk/windstille/src/editor/windstille_widget.hpp	2009-04-01 02:10:38 UTC (rev 2840)
@@ -138,6 +138,9 @@
 
   ControlPointHandle get_control_point(const Vector2f& pos) const;
 
+  void clear_control_points();
+  void create_control_points();
+
   void on_selection_change();
 
 private:

Modified: trunk/windstille/src/math/rect.hpp
===================================================================
--- trunk/windstille/src/math/rect.hpp	2009-03-31 16:03:01 UTC (rev 2839)
+++ trunk/windstille/src/math/rect.hpp	2009-04-01 02:10:38 UTC (rev 2840)
@@ -44,339 +44,346 @@
 //- !header=core.h!
 class Rect
 {
-//! Construction:
+  //! Construction:
 public:
-	//: Constructs an rectangle.
-	//param left: Initial left position of rectangle.
-	//param top: Initial top position of rectangle.
-	//param right: Initial right position of rectangle.
-	//param bottom: Initial bottom position of rectangle.
-	//param point: Initial top-left position of rectangle.
-	//param size: Initial size of rectangle.
-	//param rect: Initial rectangle position and size.
-	Rect() { left = right = top = bottom = 0; }
+  //: Constructs an rectangle.
+  //param left: Initial left position of rectangle.
+  //param top: Initial top position of rectangle.
+  //param right: Initial right position of rectangle.
+  //param bottom: Initial bottom position of rectangle.
+  //param point: Initial top-left position of rectangle.
+  //param size: Initial size of rectangle.
+  //param rect: Initial rectangle position and size.
+  Rect() { left = right = top = bottom = 0; }
 
-	explicit Rect(const Rectf& rect);
+  explicit Rect(const Rectf& rect);
 
-	Rect(int new_left, int new_top, int new_right, int new_bottom)
-	{ left = new_left; top = new_top; right = new_right; bottom = new_bottom; }
+  Rect(int new_left, int new_top, int new_right, int new_bottom)
+  { left = new_left; top = new_top; right = new_right; bottom = new_bottom; }
 
-	Rect(const Point &p, const Size &size)
-	{ left = p.x; top = p.y; right = left + size.width; bottom = top + size.height; }
+  Rect(const Point &p, const Size &size)
+  { left = p.x; top = p.y; right = left + size.width; bottom = top + size.height; }
 
-	Rect(const Rect &rect)
-	{ left = rect.left; top = rect.top; right = rect.right; bottom = rect.bottom; }
+  Rect(const Rect &rect)
+  { left = rect.left; top = rect.top; right = rect.right; bottom = rect.bottom; }
 
-	//: Rect += Rect operator.
-	Rect &operator+=(const Rect &r)
-	{ left += r.left; top += r.top; right += r.right; bottom += r.bottom; return *this; }
+  //: Rect += Rect operator.
+  Rect &operator+=(const Rect &r)
+  { left += r.left; top += r.top; right += r.right; bottom += r.bottom; return *this; }
 
-	//: Rect -= Rect operator.
-	Rect &operator-=(const Rect &r)
-	{ left -= r.left; top -= r.top; right -= r.right; bottom -= r.bottom; return *this; }
+  //: Rect -= Rect operator.
+  Rect &operator-=(const Rect &r)
+  { left -= r.left; top -= r.top; right -= r.right; bottom -= r.bottom; return *this; }
 	
-	//: Rect += Point operator.
-	Rect &operator+=(const Point &p)
-	{ left += p.x; top += p.y; right += p.x; bottom += p.y; return *this; }
+  //: Rect += Point operator.
+  Rect &operator+=(const Point &p)
+  { left += p.x; top += p.y; right += p.x; bottom += p.y; return *this; }
 
-	//: Rect -= Point operator.
-	Rect &operator-=(const Point &p)
-	{ left -= p.x; top -= p.y; right -= p.x; bottom -= p.y; return *this; }
+  //: Rect -= Point operator.
+  Rect &operator-=(const Point &p)
+  { left -= p.x; top -= p.y; right -= p.x; bottom -= p.y; return *this; }
 
-	//: Rect + Rect operator.
-	Rect operator+(const Rect &r) const
-	{ return Rect(left + r.left, top + r.top, right + r.right, bottom + r.bottom); }
+  //: Rect + Rect operator.
+  Rect operator+(const Rect &r) const
+  { return Rect(left + r.left, top + r.top, right + r.right, bottom + r.bottom); }
 
-	//: Rect - Rect operator.
-	Rect operator-(const Rect &r) const
-	{ return Rect(left - r.left, top - r.top, right - r.right, bottom - r.bottom); }
+  //: Rect - Rect operator.
+  Rect operator-(const Rect &r) const
+  { return Rect(left - r.left, top - r.top, right - r.right, bottom - r.bottom); }
 
-	//: Rect + Point operator.
-	Rect operator+(const Point &p) const
-	{ return Rect(left + p.x, top + p.y, right + p.x, bottom + p.y); }
+  //: Rect + Point operator.
+  Rect operator+(const Point &p) const
+  { return Rect(left + p.x, top + p.y, right + p.x, bottom + p.y); }
 
-	//: Rect - Point operator.
-	Rect operator-(const Point &p) const
-	{ return Rect(left - p.x, top - p.y, right - p.x, bottom - p.y); }
+  //: Rect - Point operator.
+  Rect operator-(const Point &p) const
+  { return Rect(left - p.x, top - p.y, right - p.x, bottom - p.y); }
 
-	//: Rect == Rect operator.
-	bool operator==(const Rect &r) const
-	{ return (left == r.left && top == r.top && right == r.right && bottom && r.bottom); }
+  //: Rect == Rect operator.
+  bool operator==(const Rect &r) const
+  { return (left == r.left && top == r.top && right == r.right && bottom && r.bottom); }
 
-	//: Rect != Rect operator.
-	bool operator!=(const Rect &r) const
-	{ return (left != r.left || top != r.top || right != r.right || bottom != r.bottom); }
+  //: Rect != Rect operator.
+  bool operator!=(const Rect &r) const
+  { return (left != r.left || top != r.top || right != r.right || bottom != r.bottom); }
 
-//! Attributes:
+  //! Attributes:
 public:
-	//: X1-coordinate.
-	int left;
+  //: X1-coordinate.
+  int left;
 	
-	//: Y1-coordinate.
-	int top;
+  //: Y1-coordinate.
+  int top;
 	
-	//: X2-coordinate.
-	int right;
+  //: X2-coordinate.
+  int right;
 	
-	//: Y2-coordinate.
-	int bottom;
+  //: Y2-coordinate.
+  int bottom;
 	
-	//: Returns the width of the rectangle.
-	int get_width() const { return right - left; }
+  //: Returns the width of the rectangle.
+  int get_width() const { return right - left; }
 	
-	//: Returns the height of the rectangle.
-	int get_height() const { return bottom - top; }
+  //: Returns the height of the rectangle.
+  int get_height() const { return bottom - top; }
 
-	//: Returns the size of the rectangle.
-	Size get_size() const { return Size(right - left, bottom - top); }
+  //: Returns the size of the rectangle.
+  Size get_size() const { return Size(right - left, bottom - top); }
 	
-	//: Returns true if point is inside the rectangle.
-	bool is_inside(const Point &p) const { return (p.x >= left && p.y >= top && p.x <= right && p.y <= bottom); }
+  //: Returns true if point is inside the rectangle.
+  bool is_inside(const Point &p) const { return (p.x >= left && p.y >= top && p.x <= right && p.y <= bottom); }
 
-	//: Returns true if rectangle passed is overlapping or inside this rectangle.
-	bool is_overlapped(const Rect &r) const 
-	{
-		return (r.left < right && r.right > left && r.top < bottom && r.bottom > top);
-	}
+  //: Returns true if rectangle passed is overlapping or inside this rectangle.
+  bool is_overlapped(const Rect &r) const 
+  {
+    return (r.left < right && r.right > left && r.top < bottom && r.bottom > top);
+  }
 	
-	//: Returns another Rect containing a rotated version of this one.
-	//param hotspot: Point to rotate around.
-	//param origin: Determines the hotspot point within the rectangle
-	//param x, y: Offsets applied negatively to the hotspot point
-	//param angle: Angle to rotate in degrees.
-	Rect get_rot_bounds(const Point &hotspot, float angle) const;
-	Rect get_rot_bounds(Origin origin, int x, int y, float angle) const;
+  //: Returns another Rect containing a rotated version of this one.
+  //param hotspot: Point to rotate around.
+  //param origin: Determines the hotspot point within the rectangle
+  //param x, y: Offsets applied negatively to the hotspot point
+  //param angle: Angle to rotate in degrees.
+  Rect get_rot_bounds(const Point &hotspot, float angle) const;
+  Rect get_rot_bounds(Origin origin, int x, int y, float angle) const;
 	
-//! Operations:
+  //! Operations:
 public:
-	//: Sets the size of the rectangle, maintaining top/left position.
-	void set_size(const Size &size)
-	{
-		right = left + size.width;
-		bottom = top + size.height;
-	}
+  //: Sets the size of the rectangle, maintaining top/left position.
+  void set_size(const Size &size)
+  {
+    right = left + size.width;
+    bottom = top + size.height;
+  }
 
-	//: Calculates and returns the union of two rectangles.
-	Rect calc_union(const Rect &rect)
-	{
-		Rect result;
-		if (left   > rect.left)   result.left   = left;   else result.left   = rect.left;
-		if (right  < rect.right)  result.right  = right;  else result.right  = rect.right;
-		if (top    > rect.top)    result.top    = top;    else result.top    = rect.top;
-		if (bottom < rect.bottom) result.bottom = bottom; else result.bottom = rect.bottom;
-		return result;
-	}
+  //: Calculates and returns the union of two rectangles.
+  Rect calc_union(const Rect &rect)
+  {
+    Rect result;
+    if (left   > rect.left)   result.left   = left;   else result.left   = rect.left;
+    if (right  < rect.right)  result.right  = right;  else result.right  = rect.right;
+    if (top    > rect.top)    result.top    = top;    else result.top    = rect.top;
+    if (bottom < rect.bottom) result.bottom = bottom; else result.bottom = rect.bottom;
+    return result;
+  }
 
-	//: Normalize rectangle. Ensures that left is less than right and top is less than bottom.
-	void normalize()
-	{
-		if (left > right)
-		{
-			int temp = right;
-			right = left;
-			left = temp;
-		}
+  //: Normalize rectangle. Ensures that left is less than right and top is less than bottom.
+  void normalize()
+  {
+    if (left > right)
+      {
+        int temp = right;
+        right = left;
+        left = temp;
+      }
 
-		if (top > bottom)
-		{
-			int temp = bottom;
-			bottom = top;
-			top = temp;
-		}
-	}
+    if (top > bottom)
+      {
+        int temp = bottom;
+        bottom = top;
+        top = temp;
+      }
+  }
 	
-	//: Applies an origin and offset pair to this rectangle
-	//param origin: The new origin to adjust to from default upper-left position
-	//param x, y: Offsets applied negatively to each corner of the rectangle
-	void apply_alignment(Origin origin, int x, int y)
-	{
-		Point offset = calc_origin(origin, get_size());
-		offset.x -= x;
-		offset.y -= y;
+  //: Applies an origin and offset pair to this rectangle
+  //param origin: The new origin to adjust to from default upper-left position
+  //param x, y: Offsets applied negatively to each corner of the rectangle
+  void apply_alignment(Origin origin, int x, int y)
+  {
+    Point offset = calc_origin(origin, get_size());
+    offset.x -= x;
+    offset.y -= y;
 		
-		left += offset.x;
-		top += offset.y;
-		right += offset.x;
-		bottom += offset.y;
-	}
+    left += offset.x;
+    top += offset.y;
+    right += offset.x;
+    bottom += offset.y;
+  }
 };
 
 //: 2D (left,top,right,bottom) floating point rectangle structure.
 class Rectf
 {
-//! Construction:
+  //! Construction:
 public:
-	//: Constructs an rectangle.
-	//param left: Initial left position of rectangle.
-	//param top: Initial top position of rectangle.
-	//param right: Initial right position of rectangle.
-	//param bottom: Initial bottom position of rectangle.
-	//param point: Initial top-left position of rectangle.
-	//param size: Initial size of rectangle.
-	//param rect: Initial rectangle position and size.
-	Rectf() { left = right = top = bottom = 0.0f; }
+  //: Constructs an rectangle.
+  //param left: Initial left position of rectangle.
+  //param top: Initial top position of rectangle.
+  //param right: Initial right position of rectangle.
+  //param bottom: Initial bottom position of rectangle.
+  //param point: Initial top-left position of rectangle.
+  //param size: Initial size of rectangle.
+  //param rect: Initial rectangle position and size.
+  Rectf() { left = right = top = bottom = 0.0f; }
 
-	Rectf(const Rect& rect)
-		: left((float)rect.left), 
-		  top((float)rect.top), 
-		  right((float)rect.right), 
-		  bottom((float)rect.bottom)
-	{}
+  Rectf(const Rect& rect)
+    : left((float)rect.left), 
+      top((float)rect.top), 
+      right((float)rect.right), 
+      bottom((float)rect.bottom)
+  {}
 
-	Rectf(float new_left, float new_top, float new_right, float new_bottom)
-	{ left = new_left; top = new_top; right = new_right; bottom = new_bottom; }
+  Rectf(float new_left, float new_top, float new_right, float new_bottom)
+  { left = new_left; top = new_top; right = new_right; bottom = new_bottom; }
 
-	Rectf(const Vector2f &p, const Sizef &size)
-	{ left = p.x; top = p.y; right = left + size.width; bottom = top + size.height; }
+  Rectf(const Vector2f &p, const Sizef &size)
+  { left = p.x; top = p.y; right = left + size.width; bottom = top + size.height; }
 
-	Rectf(const Rectf &rect)
-	{ left = rect.left; top = rect.top; right = rect.right; bottom = rect.bottom; }
+  Rectf(const Vector2f& p1, const Vector2f& p2)
+    :  left(p1.x),
+       top(p1.y),
+       right(p2.x),
+       bottom(p2.y)
+  {}
 
-   //: Rect += Rect operator.
-	Rectf &operator+=(const Rectf &r)
-	{ left += r.left; top += r.top; right += r.right; bottom += r.bottom; return *this; }
+  Rectf(const Rectf &rect)
+  { left = rect.left; top = rect.top; right = rect.right; bottom = rect.bottom; }
 
-	//: Rect -= Rect operator.
-	Rectf &operator-=(const Rectf &r)
-	{ left -= r.left; top -= r.top; right -= r.right; bottom -= r.bottom; return *this; }
+  //: Rect += Rect operator.
+  Rectf &operator+=(const Rectf &r)
+  { left += r.left; top += r.top; right += r.right; bottom += r.bottom; return *this; }
+
+  //: Rect -= Rect operator.
+  Rectf &operator-=(const Rectf &r)
+  { left -= r.left; top -= r.top; right -= r.right; bottom -= r.bottom; return *this; }
 	
-	//: Rect += Point operator.
-	Rectf &operator+=(const Vector2f &p)
-	{ left += p.x; top += p.y; right += p.x; bottom += p.y; return *this; }
+  //: Rect += Point operator.
+  Rectf &operator+=(const Vector2f &p)
+  { left += p.x; top += p.y; right += p.x; bottom += p.y; return *this; }
 
-	//: Rect -= Point operator.
-	Rectf &operator-=(const Vector2f &p)
-	{ left -= p.x; top -= p.y; right -= p.x; bottom -= p.y; return *this; }
+  //: Rect -= Point operator.
+  Rectf &operator-=(const Vector2f &p)
+  { left -= p.x; top -= p.y; right -= p.x; bottom -= p.y; return *this; }
 
-	//: Rect + Rect operator.
-	Rectf operator+(const Rectf &r) const
-	{ return Rectf(left + r.left, top + r.top, right + r.right, bottom + r.bottom); }
+  //: Rect + Rect operator.
+  Rectf operator+(const Rectf &r) const
+  { return Rectf(left + r.left, top + r.top, right + r.right, bottom + r.bottom); }
 
-	//: Rect - Rect operator.
-	Rectf operator-(const Rectf &r) const
-	{ return Rectf(left - r.left, top - r.top, right - r.right, bottom - r.bottom); }
+  //: Rect - Rect operator.
+  Rectf operator-(const Rectf &r) const
+  { return Rectf(left - r.left, top - r.top, right - r.right, bottom - r.bottom); }
 
-	//: Rect + Point operator.
-	Rectf operator+(const Vector2f &p) const
-	{ return Rectf(left + p.x, top + p.y, right + p.x, bottom + p.y); }
+  //: Rect + Point operator.
+  Rectf operator+(const Vector2f &p) const
+  { return Rectf(left + p.x, top + p.y, right + p.x, bottom + p.y); }
 
-	//: Rect - Point operator.
-	Rectf operator-(const Vector2f &p) const
-	{ return Rectf(left - p.x, top - p.y, right - p.x, bottom - p.y); }
+  //: Rect - Point operator.
+  Rectf operator-(const Vector2f &p) const
+  { return Rectf(left - p.x, top - p.y, right - p.x, bottom - p.y); }
 
-	//: Rect == Rect operator.
-	bool operator==(const Rectf &r) const
-	{ return (left == r.left && top == r.top && right == r.right && bottom && r.bottom); }
+  //: Rect == Rect operator.
+  bool operator==(const Rectf &r) const
+  { return (left == r.left && top == r.top && right == r.right && bottom && r.bottom); }
 
-	//: Rect != Rect operator.
-	bool operator!=(const Rect &r) const
-	{ return (left != r.left || top != r.top || right != r.right || bottom != r.bottom); }
+  //: Rect != Rect operator.
+  bool operator!=(const Rect &r) const
+  { return (left != r.left || top != r.top || right != r.right || bottom != r.bottom); }
 
-//! Attributes:
+  //! Attributes:
 public:
-	//: X1-coordinate.
-	float left;
+  //: X1-coordinate.
+  float left;
 	
-	//: Y1-coordinate.
-	float top;
+  //: Y1-coordinate.
+  float top;
 	
-	//: X2-coordinate.
-	float right;
+  //: X2-coordinate.
+  float right;
 	
-	//: Y2-coordinate.
-	float bottom;
+  //: Y2-coordinate.
+  float bottom;
 	
-	//: Returns the width of the rectangle.
-	float get_width() const { return right - left; }
+  //: Returns the width of the rectangle.
+  float get_width() const { return right - left; }
 	
-	//: Returns the height of the rectangle.
-	float get_height() const { return bottom - top; }
+  //: Returns the height of the rectangle.
+  float get_height() const { return bottom - top; }
 
-	//: Returns the size of the rectangle.
-	Sizef get_size() const { return Sizef(right - left, bottom - top); }
+  //: Returns the size of the rectangle.
+  Sizef get_size() const { return Sizef(right - left, bottom - top); }
 	
-	//: Returns true if point is inside the rectangle.
-	bool is_inside(const Vector2f &p) const { return (p.x >= left && p.y >= top && p.x <= right && p.y <= bottom); }
+  //: Returns true if point is inside the rectangle.
+  bool is_inside(const Vector2f &p) const { return (p.x >= left && p.y >= top && p.x <= right && p.y <= bottom); }
 	
-	//: Returns true if rectangle passed is overlapping or inside this rectangle.
-	bool is_overlapped(const Rectf &r) const 
-	{
-		return (r.left < right && r.right > left && r.top < bottom && r.bottom > top);
-	}
+  //: Returns true if rectangle passed is overlapping or inside this rectangle.
+  bool is_overlapped(const Rectf &r) const 
+  {
+    return (r.left < right && r.right > left && r.top < bottom && r.bottom > top);
+  }
 
-	bool contains(const Rectf& rect) const
-	{
-          return rect.left >= left && rect.right <= right &&
-            rect.top >= top && rect.bottom <= bottom;
-	}
+  bool contains(const Rectf& rect) const
+  {
+    return rect.left >= left && rect.right <= right &&
+      rect.top >= top && rect.bottom <= bottom;
+  }
 	
-//! Operations:
+  //! Operations:
 public:
-	//: Sets the size of the rectangle, maintaining top/left position.
-	void set_size(const Size &size)
-	{
-		right = left + size.width;
-		bottom = top + size.height;
-	}
+  //: Sets the size of the rectangle, maintaining top/left position.
+  void set_size(const Size &size)
+  {
+    right = left + size.width;
+    bottom = top + size.height;
+  }
 
-	//: Calculates and returns the union of two rectangles.
-	Rectf calc_union(const Rectf &rect)
-	{
-		Rectf result;
-		if (left   > rect.left)   result.left   = left;   else result.left   = rect.left;
-		if (right  < rect.right)  result.right  = right;  else result.right  = rect.right;
-		if (top    > rect.top)    result.top    = top;    else result.top    = rect.top;
-		if (bottom < rect.bottom) result.bottom = bottom; else result.bottom = rect.bottom;
-		return result;
-	}
+  //: Calculates and returns the union of two rectangles.
+  Rectf calc_union(const Rectf &rect)
+  {
+    Rectf result;
+    if (left   > rect.left)   result.left   = left;   else result.left   = rect.left;
+    if (right  < rect.right)  result.right  = right;  else result.right  = rect.right;
+    if (top    > rect.top)    result.top    = top;    else result.top    = rect.top;
+    if (bottom < rect.bottom) result.bottom = bottom; else result.bottom = rect.bottom;
+    return result;
+  }
 
-	//: Normalize rectangle. Ensures that left<right and top<bottom.
-	void normalize()
-	{
-		if (left > right)
-		{
-			float temp = right;
-			right = left;
-			left = temp;
-		}
+  //: Normalize rectangle. Ensures that left<right and top<bottom.
+  void normalize()
+  {
+    if (left > right)
+      {
+        float temp = right;
+        right = left;
+        left = temp;
+      }
 
-		if (top > bottom)
-		{
-			float temp = bottom;
-			bottom = top;
-			top = temp;
-		}
-	}
+    if (top > bottom)
+      {
+        float temp = bottom;
+        bottom = top;
+        top = temp;
+      }
+  }
 	
-	//: Applies an origin and offset pair to this rectangle
-	//param origin: The new origin to adjust to from default upper-left position
-	//param x, y: Offsets applied negatively to each corner of the rectangle
-	void apply_alignment(Origin origin, float x, float y)
-	{
-		Vector2f offset = calc_origin(origin, get_size());
-		offset.x -= x;
-		offset.y -= y;
+  //: Applies an origin and offset pair to this rectangle
+  //param origin: The new origin to adjust to from default upper-left position
+  //param x, y: Offsets applied negatively to each corner of the rectangle
+  void apply_alignment(Origin origin, float x, float y)
+  {
+    Vector2f offset = calc_origin(origin, get_size());
+    offset.x -= x;
+    offset.y -= y;
 		
-		left += offset.x;
-		top += offset.y;
-		right += offset.x;
-		bottom += offset.y;
-	}
+    left += offset.x;
+    top += offset.y;
+    right += offset.x;
+    bottom += offset.y;
+  }
 
-	// Moves each edge f away from the center, thus width = old_width + 2*f
-	Rectf grow(float f) const {
-		return Rectf(left   - f, 
-                             top    - f,
-                             right  + f,
-                             bottom + f);
-	}
+  // Moves each edge f away from the center, thus width = old_width + 2*f
+  Rectf grow(float f) const {
+    return Rectf(left   - f, 
+                 top    - f,
+                 right  + f,
+                 bottom + f);
+  }
 
-        Rectf grow(float x, float y) const {
-		return Rectf(left   - x, 
-                             top    - y,
-                             right  + x,
-                             bottom + y);
-	}
+  Rectf grow(float x, float y) const {
+    return Rectf(left   - x, 
+                 top    - y,
+                 right  + x,
+                 bottom + y);
+  }
   
   // Construct a rectangle large enough
   Rectf grow(const Rectf& rect) const {
@@ -388,10 +395,10 @@
 };
 
 inline Rect::Rect(const Rectf& rect)
-	: left(static_cast<int>(rect.left)), 
-	  top(static_cast<int>(rect.top)), 
-	  right(static_cast<int>(rect.right)), 
-	  bottom(static_cast<int>(rect.bottom))
+  : left(static_cast<int>(rect.left)), 
+    top(static_cast<int>(rect.top)), 
+    right(static_cast<int>(rect.right)), 
+    bottom(static_cast<int>(rect.bottom))
 {}
 
 std::ostream& operator<<(std::ostream& s, const Rect& rect);

Modified: trunk/windstille/src/math/vector2f.hpp
===================================================================
--- trunk/windstille/src/math/vector2f.hpp	2009-03-31 16:03:01 UTC (rev 2839)
+++ trunk/windstille/src/math/vector2f.hpp	2009-04-01 02:10:38 UTC (rev 2840)
@@ -71,6 +71,11 @@
       return Vector2f(x / s, y / s);
     }
 
+  Vector2f operator/(const Vector2f& s) const
+    {
+      return Vector2f(x / s.x, y / s.y);
+    }
+
   Vector2f operator-() const
     {
       return Vector2f(-x, -y);



From grumbel at mail.berlios.de  Wed Apr  1 05:02:47 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 1 Apr 2009 05:02:47 +0200
Subject: [Windstille-commit] r2841 - in trunk/windstille/src: display editor
	math
Message-ID: <200904010302.n3132lOu006689@sheep.berlios.de>

Author: grumbel
Date: 2009-04-01 05:02:45 +0200 (Wed, 01 Apr 2009)
New Revision: 2841

Modified:
   trunk/windstille/src/display/surface.cpp
   trunk/windstille/src/display/surface_drawing_parameters.hpp
   trunk/windstille/src/editor/decal_object_model.cpp
   trunk/windstille/src/editor/decal_object_model.hpp
   trunk/windstille/src/math/quad.hpp
   trunk/windstille/src/math/vector2f.cpp
   trunk/windstille/src/math/vector2f.hpp
Log:
Some half broken object rotation code

Modified: trunk/windstille/src/display/surface.cpp
===================================================================
--- trunk/windstille/src/display/surface.cpp	2009-04-01 02:10:38 UTC (rev 2840)
+++ trunk/windstille/src/display/surface.cpp	2009-04-01 03:02:45 UTC (rev 2841)
@@ -16,8 +16,11 @@
 **  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
 
+#include <iostream>
+
 #include "surface.hpp"
 #include "math/vector2f.hpp"
+#include "math/quad.hpp"
 #include "display/opengl_state.hpp"
 #include "surface_drawing_parameters.hpp"
 #include "surface_manager.hpp"
@@ -148,29 +151,26 @@
   state.activate();
 
   glBegin(GL_QUADS);
-  if (0) // params.rotation)
-    {
 
-    }
-  else
-    {
-      // FIXME: This is just a primitive prototype, should take things
-      // like hotspot and flip into account 
-      glTexCoord2f(impl->uv.left, impl->uv.top);
-      glVertex2f(params.pos.x, params.pos.y);
+  Quad quad(params.pos.x, 
+            params.pos.y,
+            params.pos.x + impl->size.width * params.scale.x, 
+            params.pos.y + impl->size.height * params.scale.y);
 
-      glTexCoord2f(impl->uv.right, impl->uv.top);
-      glVertex2f(params.pos.x + impl->size.width * params.scale.x, 
-                 params.pos.y);
+  quad.rotate(params.angle);
+  
+  glTexCoord2f(impl->uv.left, impl->uv.top);
+  glVertex2f(quad.p1.x, quad.p1.y);
 
-      glTexCoord2f(impl->uv.right, impl->uv.bottom);
-      glVertex2f(params.pos.x + impl->size.width  * params.scale.x, 
-                 params.pos.y + impl->size.height * params.scale.y);
+  glTexCoord2f(impl->uv.right, impl->uv.top);
+  glVertex2f(quad.p2.x, quad.p2.y);
 
-      glTexCoord2f(impl->uv.left, impl->uv.bottom);
-      glVertex2f(params.pos.x, 
-                 params.pos.y + impl->size.height * params.scale.y);
-    }
+  glTexCoord2f(impl->uv.right, impl->uv.bottom);
+  glVertex2f(quad.p3.x, quad.p3.y);
+
+  glTexCoord2f(impl->uv.left, impl->uv.bottom);
+  glVertex2f(quad.p4.x, quad.p4.y);
+
   glEnd(); 
 }
 

Modified: trunk/windstille/src/display/surface_drawing_parameters.hpp
===================================================================
--- trunk/windstille/src/display/surface_drawing_parameters.hpp	2009-04-01 02:10:38 UTC (rev 2840)
+++ trunk/windstille/src/display/surface_drawing_parameters.hpp	2009-04-01 03:02:45 UTC (rev 2841)
@@ -38,7 +38,7 @@
   /** Includes color and alpha settings */
   Color   color;
 
-  float rotation;
+  float angle;
 
   Vector2f scale;
 
@@ -51,7 +51,7 @@
     
     color = Color(1.0f, 1.0f, 1.0f, 1.0f);
   
-    rotation = 0.0f;
+    angle = 0.0f;
     scale    = Vector2f(1.0f, 1.0f);
   }
 
@@ -67,9 +67,9 @@
     return *this; 
   }
 
-  SurfaceDrawingParameters& set_rotation(float r) 
+  SurfaceDrawingParameters& set_angle(float r) 
   { 
-    rotation = r;
+    angle = r;
     return *this; 
   }
 

Modified: trunk/windstille/src/editor/decal_object_model.cpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.cpp	2009-04-01 02:10:38 UTC (rev 2840)
+++ trunk/windstille/src/editor/decal_object_model.cpp	2009-04-01 03:02:45 UTC (rev 2841)
@@ -61,11 +61,19 @@
 }
 
 void
+DecalObjectModel::set_angle(float angle_)
+{
+  angle = angle_;
+}
+
+void
 DecalObjectModel::set_scale(const Vector2f& scale_)
 {
   scale = scale_;
 }
 
+
+
 void
 DecalObjectModel::draw(SceneContext& sc)
 {
@@ -89,7 +97,7 @@
 
   dc->draw(surface, SurfaceDrawingParameters()
                         .set_pos(wo_pos + center_offset)
-                        .set_rotation(angle)
+                        .set_angle(angle)
                         .set_scale(scale));
 }
 
@@ -125,15 +133,57 @@
   writer.write("angle",   angle);
   writer.end_section();
 }
+
+class DecalRotateControlPoint : public ControlPoint
+{
+private:
+  DecalObjectModel* object;
+  float orig_angle;
+  Vector2f center;
 
-class DecalControlPoint : public ControlPoint
+public:
+  DecalRotateControlPoint(DecalObjectModel* object_, const Vector2f& pos_)
+    : ControlPoint(pos_),
+      object(object_),
+      orig_angle(object->get_angle()),
+      center(object->get_world_pos())
+    {
+  }
+
+  void on_move_start() 
+  {
+  }
+
+  void on_move_update(const Vector2f& offset_) 
+  {
+    offset = offset_;
+
+    Vector2f base = pos - center;
+    float base_angle = atan2(base.y, base.x);
+
+    Vector2f current = (pos+offset) - center;
+    float current_angle = atan2(current.y, current.x);
+
+    float new_angle = orig_angle + current_angle - base_angle;
+    object->set_angle(new_angle);
+
+    std::cout << new_angle << std::endl;
+  }
+  
+  void on_move_end(const Vector2f& offset_)
+  {
+    on_move_update(offset_);
+  }
+};
+
+class DecalScaleControlPoint : public ControlPoint
 {
 private:
   DecalObjectModel* object;
   Vector2f orig_scale;
 
 public:
-  DecalControlPoint(DecalObjectModel* object_, const Vector2f& pos_)
+  DecalScaleControlPoint(DecalObjectModel* object_, const Vector2f& pos_)
     : ControlPoint(pos_),
       object(object_),
       orig_scale(object_->get_scale())
@@ -162,17 +212,23 @@
     on_move_update(offset_);
   }
 };
-
+
 void
 DecalObjectModel::add_control_points(std::vector<ControlPointHandle>& control_points)
 {
   float w = surface.get_width()/2  * scale.x;
   float h = surface.get_height()/2 * scale.y;
 
-  control_points.push_back(ControlPointHandle(new DecalControlPoint(this, get_world_pos() - Vector2f(-w, -h))));
-  control_points.push_back(ControlPointHandle(new DecalControlPoint(this, get_world_pos() - Vector2f( w, -h))));
-  control_points.push_back(ControlPointHandle(new DecalControlPoint(this, get_world_pos() - Vector2f( w,  h))));
-  control_points.push_back(ControlPointHandle(new DecalControlPoint(this, get_world_pos() - Vector2f(-w,  h))));
+  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, get_world_pos() - Vector2f(-w, -h))));
+  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, get_world_pos() - Vector2f( w, -h))));
+  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, get_world_pos() - Vector2f( w,  h))));
+  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, get_world_pos() - Vector2f(-w,  h))));
+
+
+  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, get_world_pos() - Vector2f( w,  0))));
+  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, get_world_pos() - Vector2f(-w,  0))));
+  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, get_world_pos() - Vector2f( 0,  h))));
+  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, get_world_pos() - Vector2f( 0, -h))));
 }
 
 /* EOF */

Modified: trunk/windstille/src/editor/decal_object_model.hpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.hpp	2009-04-01 02:10:38 UTC (rev 2840)
+++ trunk/windstille/src/editor/decal_object_model.hpp	2009-04-01 03:02:45 UTC (rev 2841)
@@ -50,6 +50,9 @@
   void set_scale(const Vector2f& scale);
   Vector2f get_scale() const { return scale; }
 
+  void set_angle(float angle);
+  float get_angle() const { return angle; }
+
   bool is_snappable() const { return type == COLORMAP; }
   void draw(SceneContext& sc);
   Rectf get_bounding_box() const;

Modified: trunk/windstille/src/math/quad.hpp
===================================================================
--- trunk/windstille/src/math/quad.hpp	2009-04-01 02:10:38 UTC (rev 2840)
+++ trunk/windstille/src/math/quad.hpp	2009-04-01 03:02:45 UTC (rev 2841)
@@ -19,6 +19,8 @@
 #ifndef HEADER_WINDSTILLE_MATH_QUAD_HPP
 #define HEADER_WINDSTILLE_MATH_QUAD_HPP
 
+#include <math.h>
+
 #include "math.hpp"
 #include "vector2f.hpp"
 #include "rect.hpp"
@@ -60,6 +62,17 @@
                  math::max(math::max(math::max(p1.x, p2.x), p3.x), p4.x),
                  math::max(math::max(math::max(p1.y, p2.y), p3.y), p4.y));
   }
+
+  void rotate(float angle)
+  {
+    Vector2f center((p1.x + p2.x + p3.x + p4.x) / 4.0f,
+                    (p1.y + p2.y + p3.y + p4.y) / 4.0f);
+
+    p1 = center + (p1 - center).rotate(angle);
+    p2 = center + (p2 - center).rotate(angle);
+    p3 = center + (p3 - center).rotate(angle);
+    p4 = center + (p4 - center).rotate(angle);
+  }
 };
 
 #endif

Modified: trunk/windstille/src/math/vector2f.cpp
===================================================================
--- trunk/windstille/src/math/vector2f.cpp	2009-04-01 02:10:38 UTC (rev 2840)
+++ trunk/windstille/src/math/vector2f.cpp	2009-04-01 03:02:45 UTC (rev 2841)
@@ -41,8 +41,8 @@
 Vector2f
 Vector2f::rotate(float angle) const
 {
-  float len = magnitude();
-  return Vector2f(len * cos(angle), len * sin(angle));
+  return Vector2f(x * cos(angle) - y * sin(angle),
+                  x * sin(angle) + y * cos(angle));
 }
 
 Vector2f

Modified: trunk/windstille/src/math/vector2f.hpp
===================================================================
--- trunk/windstille/src/math/vector2f.hpp	2009-04-01 02:10:38 UTC (rev 2840)
+++ trunk/windstille/src/math/vector2f.hpp	2009-04-01 03:02:45 UTC (rev 2841)
@@ -25,24 +25,24 @@
 {
 public:
   Vector2f(float nx, float ny)
-      : x(nx), y(ny)
+    : x(nx), y(ny)
   { }
   Vector2f(const Vector2f& other)
-      : x(other.x), y(other.y)
+    : x(other.x), y(other.y)
   { }
   Vector2f()
-      : x(0), y(0)
+    : x(0), y(0)
   { }
 
   bool operator ==(const Vector2f& other) const
-    {
-      return x == other.x && y == other.y;
-    }
+  {
+    return x == other.x && y == other.y;
+  }
 
   bool operator !=(const Vector2f& other) const
-    {
-      return !(x == other.x && y == other.y);
-    }
+  {
+    return !(x == other.x && y == other.y);
+  }
 
   const Vector2f& operator=(const Vector2f& other)
   {
@@ -52,34 +52,34 @@
   }
 
   Vector2f operator+(const Vector2f& other) const
-    {
-      return Vector2f(x + other.x, y + other.y);
-    }
+  {
+    return Vector2f(x + other.x, y + other.y);
+  }
 
   Vector2f operator-(const Vector2f& other) const
-    {
-      return Vector2f(x - other.x, y - other.y);
-    }
+  {
+    return Vector2f(x - other.x, y - other.y);
+  }
 
   Vector2f operator*(float s) const
-    {
-      return Vector2f(x * s, y * s);
-    }
+  {
+    return Vector2f(x * s, y * s);
+  }
 
   Vector2f operator/(float s) const
-    {
-      return Vector2f(x / s, y / s);
-    }
+  {
+    return Vector2f(x / s, y / s);
+  }
 
   Vector2f operator/(const Vector2f& s) const
-    {
-      return Vector2f(x / s.x, y / s.y);
-    }
+  {
+    return Vector2f(x / s.x, y / s.y);
+  }
 
   Vector2f operator-() const
-    {
-      return Vector2f(-x, -y);
-    }
+  {
+    return Vector2f(-x, -y);
+  }
 
   const Vector2f& operator +=(const Vector2f& other)
   {
@@ -115,9 +115,9 @@
 
   /// Scalar product of 2 vectors
   float operator*(const Vector2f& other) const
-    {
-      return x*other.x + y*other.y;
-    }
+  {
+    return x*other.x + y*other.y;
+  }
 
   /** Project vecter a onto vector b and return the resulting vector */
   Vector2f project(const Vector2f& b);



From grumbel at mail.berlios.de  Wed Apr  1 05:17:05 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 1 Apr 2009 05:17:05 +0200
Subject: [Windstille-commit] r2842 - trunk/windstille/src/editor
Message-ID: <200904010317.n313H5Qf008274@sheep.berlios.de>

Author: grumbel
Date: 2009-04-01 05:17:05 +0200 (Wed, 01 Apr 2009)
New Revision: 2842

Modified:
   trunk/windstille/src/editor/decal_object_model.cpp
Log:
Fixed a few newly introduced bugs in the drawing

Modified: trunk/windstille/src/editor/decal_object_model.cpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.cpp	2009-04-01 03:02:45 UTC (rev 2841)
+++ trunk/windstille/src/editor/decal_object_model.cpp	2009-04-01 03:17:05 UTC (rev 2842)
@@ -39,9 +39,10 @@
   int map_type = 0;
   reader.get("path", path);
   reader.get("type", map_type);
+  type = (MapType)map_type;
+
   reader.get("scale", scale);
   reader.get("angle", angle);
-  type = (MapType)map_type;
   surface = Surface(path);
 }
 
@@ -84,21 +85,21 @@
                          -surface.get_height()/2);
 
   DrawingContext* dc = 0; 
-
+  SurfaceDrawingParameters params;
   switch(type)
     {
-      case COLORMAP:     dc = &sc.color();
-      case LIGHTMAP:     dc = &sc.light();
-      case HIGHLIGHTMAP: dc = &sc.highlight();
+      case COLORMAP:     dc = &sc.color(); break;
+      case LIGHTMAP:     dc = &sc.light();     params.set_blend_func(GL_SRC_ALPHA, GL_ONE); break;
+      case HIGHLIGHTMAP: dc = &sc.highlight(); params.set_blend_func(GL_SRC_ALPHA, GL_ONE); break;
     }
 
   center_offset.x *= scale.x;
   center_offset.y *= scale.y;
 
-  dc->draw(surface, SurfaceDrawingParameters()
-                        .set_pos(wo_pos + center_offset)
-                        .set_angle(angle)
-                        .set_scale(scale));
+  dc->draw(surface, params
+           .set_pos(wo_pos + center_offset)
+           .set_angle(angle)
+           .set_scale(scale));
 }
 
 Rectf
@@ -166,8 +167,6 @@
 
     float new_angle = orig_angle + current_angle - base_angle;
     object->set_angle(new_angle);
-
-    std::cout << new_angle << std::endl;
   }
   
   void on_move_end(const Vector2f& offset_)
@@ -200,7 +199,8 @@
     Vector2f start   = pos - object->get_world_pos();
     Vector2f current = (pos + offset) - object->get_world_pos();
 
-    std::cout << "on_move_update: " << (current.x / start.x) << " " << (current.y / start.y) << std::endl;  
+    //std::cout << "on_move_update: " << (current.x / start.x) << " " << (current.y / start.y) << std::endl;  
+
     Vector2f new_scale = current / start;
     new_scale.x *= orig_scale.x;
     new_scale.y *= orig_scale.y;



From grumbel at mail.berlios.de  Wed Apr  1 05:25:32 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 1 Apr 2009 05:25:32 +0200
Subject: [Windstille-commit] r2843 -
	trunk/windstille/data/sectors/trainstation
Message-ID: <200904010325.n313PWiE008709@sheep.berlios.de>

Author: grumbel
Date: 2009-04-01 05:25:28 +0200 (Wed, 01 Apr 2009)
New Revision: 2843

Modified:
   trunk/windstille/data/sectors/trainstation/mine.wst
   trunk/windstille/data/sectors/trainstation/office.wst
   trunk/windstille/data/sectors/trainstation/stairtest.wst
   trunk/windstille/data/sectors/trainstation/train.wst
   trunk/windstille/data/sectors/trainstation/trainstation.wst
   trunk/windstille/data/sectors/trainstation/worker.wst
Log:
Resaved all levels to add scale/angle tags

Modified: trunk/windstille/data/sectors/trainstation/mine.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/mine.wst	2009-04-01 03:17:05 UTC (rev 2842)
+++ trunk/windstille/data/sectors/trainstation/mine.wst	2009-04-01 03:25:28 UTC (rev 2843)
@@ -1,7 +1,7 @@
 ;; -*- scheme -*-
 
 (windstille-sector
-  (version 1)
+  (version 2)
   (name "")
   (ambient-color 0 0 0 1)
   (init-script "init.nut")
@@ -17,47 +17,59 @@
         (locked 0)
         (objects
           (decal
-            (id "0x9c78fd8")
+            (id "0x9b77ca8")
             (pos 549 593)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c7a1d8")
+            (id "0x9b70ce8")
             (pos 1347 593)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c797c0")
+            (id "0x9b70d90")
             (pos -249 593)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c79858")
+            (id "0x9b70e38")
             (pos -2297 593)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c798f0")
+            (id "0x9b70f20")
             (pos -700.997 593)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c79988")
+            (id "0x9b71008")
             (pos -1499 593)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_ground.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Light")
@@ -65,61 +77,77 @@
         (locked 0)
         (objects
           (decal
-            (id "0x9c79a30")
+            (id "0x9b71200")
             (pos 72.8123 428.586)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c79a98")
+            (id "0x9b712b8")
             (pos 957.187 478)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c79b00")
+            (id "0x9b71398")
             (pos -2024.01 398.313)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c79b90")
+            (id "0x9b71478")
             (pos -1088.37 457.98)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c79c20")
+            (id "0x9b71558")
             (pos -1595.5 531.125)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c79cb0")
+            (id "0x9b71638")
             (pos -626.089 548.147)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c79d40")
+            (id "0x9b71718")
             (pos 452.5 531.125)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c79dd0")
+            (id "0x9b717f8")
             (pos -1090.81 479.953)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1)))
+            (type 1)
+            (scale 1 1)
+            (angle 0)))
         (child-layers
           (layer
             (name "Lamps")
@@ -127,47 +155,59 @@
             (locked 0)
             (objects
               (decal
-                (id "0x9c86aa8")
+                (id "0x9b71f40")
                 (pos 523 227.062)
                 (parent "")
                 (select-mask 1)
                 (path "images/objects/apartmentlamp_light.png")
-                (type 1))
+                (type 1)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x9c86b48")
+                (id "0x9b72030")
                 (pos -1525 227.062)
                 (parent "")
                 (select-mask 1)
                 (path "images/objects/apartmentlamp_light.png")
-                (type 1))
+                (type 1)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x9c86be8")
+                (id "0x9b72120")
                 (pos -1490.94 161.75)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp_bloom.png")
-                (type 2))
+                (type 2)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x9c86c80")
+                (id "0x9b72208")
                 (pos 552.57 42.1211)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x9c86d18")
+                (id "0x9b722f0")
                 (pos 561.945 159.309)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp_bloom.png")
-                (type 2))
+                (type 2)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x9c86db0")
+                (id "0x9b723d8")
                 (pos -1495.43 42.1211)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp.png")
-                (type 0)))
+                (type 0)
+                (scale 1 1)
+                (angle 0)))
             (child-layers))))
       (layer
         (name "Wood")
@@ -175,61 +215,77 @@
         (locked 0)
         (objects
           (decal
-            (id "0x9c86eb0")
+            (id "0x9b71eb0")
             (pos -2170.5 332.688)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c86a08")
+            (id "0x9b6e4a8")
             (pos -954.877 340.5)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c873e0")
+            (id "0x9b700b0")
             (pos -122.5 332.688)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c862f0")
+            (id "0x9b63f08")
             (pos 1093.12 340.5)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c86388")
+            (id "0x9b6f920")
             (pos -122.5 -180.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c86420")
+            (id "0x9b6f9e8")
             (pos 1093.12 -171.5)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c864b8")
+            (id "0x9c6c900")
             (pos -954.877 -171.5)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c85a60")
+            (id "0x9c6c9e8")
             (pos -2170.5 -180.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree1.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Items")
@@ -237,33 +293,41 @@
         (locked 0)
         (objects
           (decal
-            (id "0x9c761c8")
+            (id "0x9b77c18")
             (pos 750.812 468)
             (parent "")
             (select-mask 1)
             (path "images/decal/trashcan.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c76230")
+            (id "0x9c6cba0")
             (pos 425.812 460.188)
             (parent "")
             (select-mask 1)
             (path "images/decal/trashcan.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c76298")
+            (id "0x9c6cc58")
             (pos -445.623 466.047)
             (parent "")
             (select-mask 1)
             (path "images/decal/trashcan.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c76300")
+            (id "0x9c6cd10")
             (pos -1903.44 466.047)
             (parent "")
             (select-mask 1)
             (path "images/decal/trashcan.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Player")
@@ -271,12 +335,14 @@
         (locked 0)
         (objects
           (decal
-            (id "0x9c85d70")
+            (id "0x9c6ce78")
             (pos 638.516 439.91)
             (parent "")
             (select-mask 1)
             (path "images/decal/humanreference.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Shadows")
@@ -284,89 +350,113 @@
         (locked 0)
         (objects
           (decal
-            (id "0x9c85ce8")
+            (id "0x9cd50c8")
             (pos -103.75 531.125)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c768b8")
+            (id "0x9c6d6a8")
             (pos 1075.94 526.438)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c76920")
+            (id "0x9c6e038")
             (pos 613.437 582.688)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c769b0")
+            (id "0x9c6e118")
             (pos 211.875 567.062)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c76a40")
+            (id "0x9c6e1f8")
             (pos -450.186 557.297)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c76ad0")
+            (id "0x9c6e2d8")
             (pos -1840.03 590.5)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c76b60")
+            (id "0x9cd2da8")
             (pos -2149.79 531.125)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c77000")
+            (id "0x9cd2e88")
             (pos -2179.87 298.703)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c77090")
+            (id "0x9cd2f68")
             (pos 1073.56 306.875)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c77120")
+            (id "0x9cd3048")
             (pos -131.875 296.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c771b0")
+            (id "0x9cd3128")
             (pos -974.437 306.875)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c77240")
+            (id "0x9cd3208")
             (pos -972.057 526.438)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Wall")
@@ -374,173 +464,221 @@
         (locked 0)
         (objects
           (decal
-            (id "0x9c77ff0")
+            (id "0x9c6e8c0")
             (pos 803.06 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c780f0")
+            (id "0x9e2bdf8")
             (pos 803.063 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c776a0")
+            (id "0x9cd4290")
             (pos 1315.06 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c77740")
+            (id "0x9cd4340")
             (pos 1315.06 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c777e0")
+            (id "0x9cd4410")
             (pos 803.06 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9c77880")
+            (id "0x9cd4500")
             (pos 1315.06 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9ceb4f0")
+            (id "0x9cd45f0")
             (pos -732.937 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9ceb590")
+            (id "0x9cd46e0")
             (pos -732.937 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9ceb630")
+            (id "0x9cd47d0")
             (pos -732.937 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9ceb6d0")
+            (id "0x9cd48c0")
             (pos -1244.94 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9ceb770")
+            (id "0x9cd49b0")
             (pos -1244.93 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9ceb810")
+            (id "0x9cd4aa0")
             (pos -1244.94 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9ceb8b0")
+            (id "0x9cd4b90")
             (pos -220.937 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9ceb950")
+            (id "0x9cd4c80")
             (pos -220.937 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9ceb9f0")
+            (id "0x9cd4d70")
             (pos 291.063 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9ceba90")
+            (id "0x9e29b10")
             (pos 291.063 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9cebb30")
+            (id "0x9e29c00")
             (pos 291.063 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9cebbd0")
+            (id "0x9e29cf0")
             (pos -220.937 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9cebc70")
+            (id "0x9e29de0")
             (pos -1756.93 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9cebd10")
+            (id "0x9e29ed0")
             (pos -1756.93 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9cebdb0")
+            (id "0x9e29fc0")
             (pos -1756.93 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9cebe50")
+            (id "0x9e2a0b0")
             (pos -2268.93 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9cebef0")
+            (id "0x9e2a1a0")
             (pos -2268.93 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9cebf90")
+            (id "0x9e2a290")
             (pos -2268.93 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers)))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/office.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/office.wst	2009-04-01 03:17:05 UTC (rev 2842)
+++ trunk/windstille/data/sectors/trainstation/office.wst	2009-04-01 03:25:28 UTC (rev 2843)
@@ -1,7 +1,7 @@
 ;; -*- scheme -*-
 
 (windstille-sector
-  (version 1)
+  (version 2)
   (name "")
   (ambient-color 0 0 0 1)
   (init-script "init.nut")
@@ -17,12 +17,14 @@
         (locked 0)
         (objects
           (decal
-            (id "0x982ca58")
+            (id "0xa2ab680")
             (pos 24 457)
             (parent "")
             (select-mask 1)
             (path "images/decal/humanreference.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Light")
@@ -30,47 +32,59 @@
         (locked 0)
         (objects
           (decal
-            (id "0x982ccf0")
+            (id "0xa2aae28")
             (pos -176.66 473.947)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982cd78")
+            (id "0xa2aad68")
             (pos 359.466 456.262)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982ce48")
+            (id "0xa2aae90")
             (pos -739.878 477.707)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982cf18")
+            (id "0xa2aaf70")
             (pos -1203.21 476.314)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982d028")
+            (id "0xa2ab780")
             (pos 838.744 503.93)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982d0f8")
+            (id "0xa2ab860")
             (pos 241.479 454.773)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1)))
+            (type 1)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Ground")
@@ -78,187 +92,239 @@
         (locked 0)
         (objects
           (decal
-            (id "0x982db88")
+            (id "0xa2aac58")
             (pos 130 636)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982dc60")
+            (id "0xa2a6750")
             (pos 386 636)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982dd38")
+            (id "0xa2a90b0")
             (pos 642 636)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982de10")
+            (id "0xa2a9128")
             (pos 130 124)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9829c90")
+            (id "0xa2b8ae8")
             (pos 386 124)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9829d68")
+            (id "0xa2a9250")
             (pos 642 124)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9829e40")
+            (id "0xa2a92f8")
             (pos -638 636)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9829f18")
+            (id "0xa2a93a0")
             (pos -382 636)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9829ff0")
+            (id "0xa2a9488")
             (pos -126 636)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982a0c8")
+            (id "0xa2a9570")
             (pos -638 124)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982a1a0")
+            (id "0xa2a9658")
             (pos -382 124)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982a278")
+            (id "0xa2a9740")
             (pos -126 124)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982a350")
+            (id "0xa2a9828")
             (pos -1406 636)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982a428")
+            (id "0xa2a9910")
             (pos -1150 636)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982a500")
+            (id "0xa2a99f8")
             (pos -894 636)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982a5d8")
+            (id "0xa2a9ae0")
             (pos -1406 124)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982a6b0")
+            (id "0xa2a9bc8")
             (pos -1150 124)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982a788")
+            (id "0xa2a9cb0")
             (pos -894 124)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982a860")
+            (id "0xa2a9d98")
             (pos 898 636)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982a938")
+            (id "0xa2a9e80")
             (pos 898 124)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982aa10")
+            (id "0xa2a9f68")
             (pos 1410 636)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982aae8")
+            (id "0xa2aa050")
             (pos 1154 636)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982abc0")
+            (id "0xa2aa138")
             (pos 1154 124)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982ac98")
+            (id "0xa2aa220")
             (pos 1410 124)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982ad70")
+            (id "0xa2aa308")
             (pos 1666 124)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982ae48")
+            (id "0xa2aa3f0")
             (pos 1666 636)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Lights")
@@ -266,89 +332,113 @@
         (locked 0)
         (objects
           (decal
-            (id "0x982d5d8")
+            (id "0xa2ac9d0")
             (pos -185.687 478)
             (parent "")
             (select-mask 1)
             (path "images/decal/lamp1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982b5d8")
+            (id "0xa2ac348")
             (pos -186.087 454.328)
             (parent "")
             (select-mask 1)
             (path "images/decal/lamp1_highlight.png")
-            (type 2))
+            (type 2)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x982afb0")
+            (id "0xa2aa8e0")
             (pos -697.391 478)
             (parent "")
             (select-mask 1)
             (path "images/decal/lamp1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9827950")
+            (id "0xa2b74c0")
             (pos -697.791 454.328)
             (parent "")
             (select-mask 1)
             (path "images/decal/lamp1_highlight.png")
-            (type 2))
+            (type 2)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986b160")
+            (id "0xa2b7570")
             (pos -1218 458.328)
             (parent "")
             (select-mask 1)
             (path "images/decal/lamp1_highlight.png")
-            (type 2))
+            (type 2)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986b220")
+            (id "0xa2b7640")
             (pos -1218.6 478)
             (parent "")
             (select-mask 1)
             (path "images/decal/lamp1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986b2f0")
+            (id "0xa2b7720")
             (pos 143.113 478)
             (parent "")
             (select-mask 1)
             (path "images/decal/lamp1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986b3c0")
+            (id "0xa2b7800")
             (pos 142.713 454.328)
             (parent "")
             (select-mask 1)
             (path "images/decal/lamp1_highlight.png")
-            (type 2))
+            (type 2)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986b4a0")
+            (id "0xa2b78f0")
             (pos 370.625 454.328)
             (parent "")
             (select-mask 1)
             (path "images/decal/lamp1_highlight.png")
-            (type 2))
+            (type 2)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986b580")
+            (id "0xa2b79e0")
             (pos 371.025 478)
             (parent "")
             (select-mask 1)
             (path "images/decal/lamp1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986b650")
+            (id "0xa2b7ac0")
             (pos 721.247 478)
             (parent "")
             (select-mask 1)
             (path "images/decal/lamp1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986b720")
+            (id "0xa2b7ba0")
             (pos 720.847 454.328)
             (parent "")
             (select-mask 1)
             (path "images/decal/lamp1_highlight.png")
-            (type 2)))
+            (type 2)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Character")
@@ -362,40 +452,50 @@
         (locked 0)
         (objects
           (decal
-            (id "0x982dae0")
+            (id "0xa2ac890")
             (pos 546.349 496)
             (parent "")
             (select-mask 1)
             (path "images/decal/bench.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986c7e8")
+            (id "0xa2b7cf0")
             (pos -21.9375 496)
             (parent "")
             (select-mask 1)
             (path "images/decal/bench.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986c8b8")
+            (id "0xa2b7dd0")
             (pos -435.526 496)
             (parent "")
             (select-mask 1)
             (path "images/decal/bench.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986c988")
+            (id "0xa2b7eb0")
             (pos -965.526 496)
             (parent "")
             (select-mask 1)
             (path "images/decal/bench.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986ca58")
+            (id "0xa2b7f90")
             (pos 956.427 496)
             (parent "")
             (select-mask 1)
             (path "images/decal/bench.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Shadow")
@@ -403,54 +503,68 @@
         (locked 0)
         (objects
           (decal
-            (id "0x986cbe8")
+            (id "0xa450648")
             (pos 253.75 47.375)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986cc90")
+            (id "0xa450700")
             (pos 238.125 713)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986cd60")
+            (id "0xa4507e0")
             (pos 563.125 702.062)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986b8c8")
+            (id "0xa2b8570")
             (pos 255.313 430)
             (parent "")
             (select-mask 1)
             (path "images/decal/train_door.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986b9a0")
+            (id "0xa2b8658")
             (pos -175 635)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986ba70")
+            (id "0xa2b8738")
             (pos -702.376 610.672)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x986bb40")
+            (id "0xa2b8818")
             (pos -1181.38 644.672)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "BackgroundWall")
@@ -458,187 +572,239 @@
         (locked 0)
         (objects
           (decal
-            (id "0x983e558")
+            (id "0xa2ac830")
             (pos 578 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983ef78")
+            (id "0xa2aa830")
             (pos 962 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall3.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983f0f8")
+            (id "0xa39ffc0")
             (pos 450 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9a7f118")
+            (id "0xa39fa48")
             (pos 66 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983fd28")
+            (id "0xa39fae8")
             (pos 322 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall3.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983fdb8")
+            (id "0xa312758")
             (pos 194 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983fe88")
+            (id "0xa312838")
             (pos -190 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983bf38")
+            (id "0xa312918")
             (pos -62 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall3.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983c008")
+            (id "0xa3129f8")
             (pos -318 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983c0d8")
+            (id "0xa312ad8")
             (pos -702 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983c1a8")
+            (id "0xa312bb8")
             (pos -446 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall3.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983c278")
+            (id "0xa312c98")
             (pos -574 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983c348")
+            (id "0xa312d78")
             (pos -958 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983c418")
+            (id "0xa312e58")
             (pos -830 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall3.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983c4e8")
+            (id "0xa312f38")
             (pos -1086 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983c5b8")
+            (id "0xa313018")
             (pos -1470 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983c688")
+            (id "0xa3130f8")
             (pos -1214 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall3.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983c758")
+            (id "0xa3131d8")
             (pos -1342 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983c828")
+            (id "0xa3132b8")
             (pos 834 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983c8f8")
+            (id "0xa313398")
             (pos 1090 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall3.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983c9c8")
+            (id "0xa313478")
             (pos 706 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983ca98")
+            (id "0xa313558")
             (pos 1474 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall3.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983cb68")
+            (id "0xa313638")
             (pos 1346 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983cc38")
+            (id "0xa313718")
             (pos 1602 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall3.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983cd08")
+            (id "0xa3137f8")
             (pos 1218 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x983cdd8")
+            (id "0xa5b3248")
             (pos 1730 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/wall3.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers)))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/stairtest.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/stairtest.wst	2009-04-01 03:17:05 UTC (rev 2842)
+++ trunk/windstille/data/sectors/trainstation/stairtest.wst	2009-04-01 03:25:28 UTC (rev 2843)
@@ -1,7 +1,7 @@
 ;; -*- scheme -*-
 
 (windstille-sector
-  (version 1)
+  (version 2)
   (name "")
   (ambient-color 0 0 0 1)
   (init-script "init.nut")
@@ -11,908 +11,1166 @@
     (locked 0)
     (objects
       (decal
-        (id "0x9e9f018")
+        (id "0x9f4d0b8")
         (pos -784.328 285.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9e9f330")
+        (id "0x9f4d1a0")
         (pos -1154.33 285.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9e9f3b0")
+        (id "0x9f4d288")
         (pos -1239.52 541.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea0e80")
+        (id "0x9f4d370")
         (pos -869.515 541.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea0f18")
+        (id "0x9f4d458")
         (pos -868.033 29.2408)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea0fb0")
+        (id "0x9f4e758")
         (pos -1238.03 29.2408)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1048")
+        (id "0x9f4e840")
         (pos -1152.85 -226.759)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea10e0")
+        (id "0x9f4e928")
         (pos -782.845 -226.759)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1178")
+        (id "0x9f4ea10")
         (pos -42.8453 -226.759)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1210")
+        (id "0x9f4eaf8")
         (pos -412.845 -226.759)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea12a8")
+        (id "0x9f4ebe0")
         (pos -498.033 29.2408)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1340")
+        (id "0x9f4ecc8")
         (pos -128.033 29.2408)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea13d8")
+        (id "0x9f4edb0")
         (pos -129.515 541.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1470")
+        (id "0x9f4ee98")
         (pos -499.515 541.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1508")
+        (id "0x9f4ef80")
         (pos -414.328 285.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea15a0")
+        (id "0x9f4f068")
         (pos -44.3278 285.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1638")
+        (id "0x9f4f150")
         (pos -50.4747 1309.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea16d0")
+        (id "0x9f4f238")
         (pos -420.475 1309.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1768")
+        (id "0x9f4f320")
         (pos -505.662 1565.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1800")
+        (id "0x9f4f408")
         (pos -135.662 1565.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1898")
+        (id "0x9f4f4f0")
         (pos -134.18 1053.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1930")
+        (id "0x9f4f5d8")
         (pos -504.18 1053.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea19c8")
+        (id "0x9f4f6c0")
         (pos -418.992 797.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1a60")
+        (id "0x9f4f7a8")
         (pos -48.9923 797.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1af8")
+        (id "0x9f4f890")
         (pos -788.992 797.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1b90")
+        (id "0x9f4f978")
         (pos -1158.99 797.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1c28")
+        (id "0x9f4fa60")
         (pos -1244.18 1053.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1cc0")
+        (id "0x9f4fb48")
         (pos -874.18 1053.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1d58")
+        (id "0x9f4fc30")
         (pos -875.662 1565.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1df0")
+        (id "0x9f4fd18")
         (pos -1245.66 1565.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1e88")
+        (id "0x9f4fe00")
         (pos -1160.47 1309.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1f20")
+        (id "0x9f4fee8")
         (pos -790.475 1309.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea1fb8")
+        (id "0x9f4ffd0")
         (pos 689.526 1309.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea2050")
+        (id "0x9f500b8")
         (pos 319.525 1309.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea20e8")
+        (id "0x9f501a0")
         (pos 234.338 1566.8)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea2180")
+        (id "0x9f50288")
         (pos 604.338 1565.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea2218")
+        (id "0x9f50370")
         (pos 605.821 1053.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea22b0")
+        (id "0x9f50458")
         (pos 235.82 1053.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea2348")
+        (id "0x9f50540")
         (pos 321.008 797.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea23e0")
+        (id "0x9f50628")
         (pos 691.008 797.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea2478")
+        (id "0x9f50710")
         (pos 1431.01 797.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea2510")
+        (id "0x9f5e6f0")
         (pos 1061.01 797.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea25a8")
+        (id "0x9f5e7a8")
         (pos 975.82 1053.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea2640")
+        (id "0x9f5e890")
         (pos 1345.82 1053.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea26d8")
+        (id "0x9f5e978")
         (pos 1344.34 1565.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9ea2770")
+        (id "0x9f5ea60")
         (pos 974.338 1565.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb36b8")
+        (id "0x9f5eb48")
         (pos 1059.53 1309.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb3720")
+        (id "0x9f5ec30")
         (pos 1429.53 1309.24)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb37b8")
+        (id "0x9f5ed18")
         (pos 1065.67 285.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb3850")
+        (id "0x9f5ee00")
         (pos 980.485 541.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb38e8")
+        (id "0x9f5eee8")
         (pos 1350.49 541.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb3980")
+        (id "0x9f5efd0")
         (pos 1351.97 29.2407)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb3a18")
+        (id "0x9f5f0b8")
         (pos 367.905 -108.259)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb3ab0")
+        (id "0x9f5f1a0")
         (pos 1067.15 -226.759)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb3b48")
+        (id "0x9f5f288")
         (pos 1437.15 -226.759)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb3be0")
+        (id "0x9f5f370")
         (pos 697.155 -226.759)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb3c78")
+        (id "0x9f5f458")
         (pos 327.155 -226.759)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb3d10")
+        (id "0x9f5f540")
         (pos 241.967 29.2407)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb3da8")
+        (id "0x9f5f628")
         (pos 611.968 29.2407)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb3e40")
+        (id "0x9f5f710")
         (pos 610.485 541.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb3ed8")
+        (id "0x9f5f7f8")
         (pos -188.118 395.202)
         (parent "")
         (select-mask 1)
         (path "images/decal/dark.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb4028")
+        (id "0x9f5f8d8")
         (pos 240.485 541.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb4968")
+        (id "0x9f5f9c0")
         (pos 325.672 285.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb4a00")
+        (id "0x9f5faa8")
         (pos 6.44479 160.077)
         (parent "")
         (select-mask 1)
         (path "images/decal/dark.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb4a90")
+        (id "0x9f5fb88")
         (pos 13.4448 209.264)
         (parent "")
         (select-mask 1)
         (path "images/decal/dark.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb4b20")
+        (id "0x9f5fc68")
         (pos 695.673 285.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb4bb8")
+        (id "0x9f5fd50")
         (pos 588 224)
         (parent "")
         (select-mask 1)
         (path "images/decal/stair2.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb5710")
+        (id "0x9f48f60")
         (pos 588 384)
         (parent "")
         (select-mask 1)
         (path "images/decal/stair1.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb5858")
+        (id "0x9f63c28")
         (pos 716 512)
         (parent "")
         (select-mask 1)
         (path "images/decal/stair1.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb6188")
+        (id "0x9f63cc8")
         (pos 336.132 378.827)
         (parent "")
         (select-mask 1)
         (path "images/decal/dark.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb6218")
+        (id "0x9f63d68")
         (pos 716 352)
         (parent "")
         (select-mask 1)
         (path "images/decal/stair2.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb62a8")
+        (id "0x9f63e48")
         (pos 972 608)
         (parent "")
         (select-mask 1)
         (path "images/decal/stair2.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb6338")
+        (id "0x9f63f28")
         (pos 972 766.438)
         (parent "")
         (select-mask 1)
         (path "images/decal/stair1.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb63c8")
+        (id "0x9f64008")
         (pos 844 640)
         (parent "")
         (select-mask 1)
         (path "images/decal/stair1.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb6458")
+        (id "0x9f640e8")
         (pos 844 480)
         (parent "")
         (select-mask 1)
         (path "images/decal/stair2.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb64e8")
+        (id "0x9f641c8")
         (pos -295.118 263.202)
         (parent "")
         (select-mask 1)
         (path "images/decal/dark.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9eb6578")
+        (id "0x9f642a8")
         (pos 396 320.563)
         (parent "")
         (select-mask 1)
         (path "images/decal/wallplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9f9fd78")
+        (id "0x9f64360")
         (pos 98.6324 375.702)
         (parent "")
         (select-mask 1)
         (path "images/decal/dark.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9f9fe08")
+        (id "0x9f64440")
         (pos -377.93 358.514)
         (parent "")
         (select-mask 1)
         (path "images/decal/dark.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9f9fe98")
+        (id "0x9f64520")
         (pos 140 320.563)
         (parent "")
         (select-mask 1)
         (path "images/decal/wallplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9f9ff00")
+        (id "0x9f64608")
         (pos -372 320.563)
         (parent "")
         (select-mask 1)
         (path "images/decal/wallplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9f9ff98")
+        (id "0x9f646f0")
         (pos -116 320.563)
         (parent "")
         (select-mask 1)
         (path "images/decal/wallplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9fa0030")
+        (id "0x9f647d8")
         (pos 379 487.563)
         (parent "")
         (select-mask 1)
         (path "images/decal/rooflamp.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9fa01a8")
+        (id "0x9f648c0")
         (pos -99 487.563)
         (parent "")
         (select-mask 1)
         (path "images/decal/rooflamp.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9fa0af8")
+        (id "0x9f649a8")
         (pos 376.312 684.625)
         (parent "")
         (select-mask 1)
         (path "images/objects/apartmentlamp_light.png")
-        (type 1))
+        (type 1)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9fa0c38")
+        (id "0x9f64a98")
         (pos -66.6875 696.312)
         (parent "")
         (select-mask 1)
         (path "images/objects/apartmentlamp_light.png")
-        (type 1))
+        (type 1)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9fa15d0")
+        (id "0x9f64b88")
         (pos 385.688 606.5)
         (parent "")
         (select-mask 1)
         (path "images/decal/rooflamp_bloom.png")
-        (type 2))
+        (type 2)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9fa16c8")
+        (id "0x9fbcd28")
         (pos -79.9375 597.125)
         (parent "")
         (select-mask 1)
         (path "images/decal/rooflamp_bloom.png")
-        (type 2))
+        (type 2)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9f13700")
+        (id "0x9fbce10")
         (pos -150.336 803.741)
         (parent "")
         (select-mask 1)
         (path "images/decal/light.png")
-        (type 1))
+        (type 1)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9f14478")
+        (id "0x9fbcef0")
         (pos 368.377 942.761)
         (parent "")
         (select-mask 1)
         (path "images/decal/light.png")
-        (type 1))
+        (type 1)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9f14508")
+        (id "0x9fbcfd0")
         (pos 274.615 124.982)
         (parent "")
         (select-mask 1)
         (path "images/decal/light.png")
-        (type 1))
+        (type 1)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9f14598")
+        (id "0x9fbd0b0")
         (pos 323.559 150.22)
         (parent "")
         (select-mask 1)
         (path "images/streetlamp.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9f145f8")
+        (id "0x9f60778")
         (pos 322.07 217.889)
         (parent "")
         (select-mask 1)
         (path "images/streetlamp-light.png")
-        (type 1))
+        (type 1)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9f14fa0")
+        (id "0x9fbde78")
         (pos 323.632 105.389)
         (parent "")
         (select-mask 1)
         (path "images/streetlamp-highlight.png")
-        (type 2))
+        (type 2)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a8ae8")
+        (id "0x9fbe9f8")
         (pos 9.67236 108.563)
         (parent "")
         (select-mask 1)
         (path "images/decal/terminal.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x9f16118")
+        (id "0x9fbd648")
         (pos -296.68 180.563)
         (parent "")
         (select-mask 1)
         (path "images/decal/bench.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa177f38")
+        (id "0x9fbe320")
         (pos 981.968 29.2407)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa178150")
+        (id "0x9fbe3e8")
         (pos 1435.67 285.241)
         (parent "")
         (select-mask 1)
         (path "images/decal/steelplate.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a6940")
+        (id "0x9fbe4d0")
         (pos -238.868 211.639)
         (parent "")
         (select-mask 1)
         (path "images/decal/light.png")
-        (type 1))
+        (type 1)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a69d0")
+        (id "0x9fbe5b0")
         (pos 0.194588 208.514)
         (parent "")
         (select-mask 1)
         (path "images/decal/light.png")
-        (type 1))
+        (type 1)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a6a60")
+        (id "0x9fbe690")
         (pos -475.787 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0d2ea8")
+        (id "0x9fbe778")
         (pos -440.787 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a72e8")
+        (id "0x9fbe860")
         (pos -370.787 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7380")
+        (id "0x9fbe948")
         (pos -405.787 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7418")
+        (id "0x9f609b8")
         (pos -300.816 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a74b0")
+        (id "0x9f60aa0")
         (pos -335.816 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7548")
+        (id "0x9f60b88")
         (pos -125.845 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a75e0")
+        (id "0x9f60c70")
         (pos -90.8452 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7678")
+        (id "0x9f60d58")
         (pos -195.816 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7710")
+        (id "0x9f60e40")
         (pos -160.816 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a77a8")
+        (id "0x9f60f28")
         (pos -230.816 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7840")
+        (id "0x9f61010")
         (pos -265.816 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a78d8")
+        (id "0x9f610f8")
         (pos 154.126 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7970")
+        (id "0x9f611e0")
         (pos 189.126 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7a08")
+        (id "0x9f612c8")
         (pos 259.126 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7aa0")
+        (id "0x9f613b0")
         (pos 224.126 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7b38")
+        (id "0x9f61498")
         (pos 329.097 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7bd0")
+        (id "0x9f61580")
         (pos 294.097 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7c68")
+        (id "0x9f61668")
         (pos 84.1258 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7d00")
+        (id "0x9f61750")
         (pos 119.126 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7d98")
+        (id "0x9f61838")
         (pos 14.1548 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7e30")
+        (id "0x9f61920")
         (pos 49.1548 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7ec8")
+        (id "0x9f61a08")
         (pos -20.8452 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7f60")
+        (id "0x9f61af0")
         (pos -55.8452 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a7ff8")
+        (id "0x9f61bd8")
         (pos 498.53 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a8090")
+        (id "0x9f61cc0")
         (pos 428.559 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a8128")
+        (id "0x9f61da8")
         (pos 463.559 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a81c0")
+        (id "0x9f61e90")
         (pos 393.559 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0xa0a8258")
+        (id "0x9f61f78")
         (pos 358.559 265.367)
         (parent "")
         (select-mask 1)
         (path "images/decal/handrail.png")
-        (type 0)))
+        (type 0)
+        (scale 1 1)
+        (angle 0)))
     (child-layers)))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/train.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/train.wst	2009-04-01 03:17:05 UTC (rev 2842)
+++ trunk/windstille/data/sectors/trainstation/train.wst	2009-04-01 03:25:28 UTC (rev 2843)
@@ -1,7 +1,7 @@
 ;; -*- scheme -*-
 
 (windstille-sector
-  (version 1)
+  (version 2)
   (name "")
   (ambient-color 0 0 0 1)
   (init-script "init.nut")
@@ -11,68 +11,86 @@
     (locked 0)
     (objects
       (decal
-        (id "0x9049d48")
+        (id "0x9143ee8")
         (pos -752 0)
-        (parent "0x8d4ab20")
+        (parent "0x9f4d030")
         (select-mask 1)
         (path "images/decal/train_front.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x87e4060")
+        (id "0x9128f30")
         (pos 696 0)
-        (parent "0x8d4ab20")
+        (parent "0x9f4d030")
         (select-mask 1)
         (path "images/decal/train_back.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x8d4ab20")
+        (id "0x9f4d030")
         (pos 974.233 -296.814)
         (parent "")
         (select-mask 1)
         (path "images/decal/train_middle.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x8d4ad90")
+        (id "0x90627b0")
         (pos -153.68 -216)
-        (parent "0x8d4ab20")
+        (parent "0x9f4d030")
         (select-mask 1)
         (path "images/decal/train_generator.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x904a968")
+        (id "0x91299b8")
         (pos -593.074 240.832)
-        (parent "0x8d4ab20")
+        (parent "0x9f4d030")
         (select-mask 1)
         (path "images/decal/train_engine_front.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x8ea4710")
+        (id "0x97e9ea0")
         (pos 586.93 241.832)
-        (parent "0x8d4ab20")
+        (parent "0x9f4d030")
         (select-mask 1)
         (path "images/decal/train_engine_back.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x87e6040")
+        (id "0x96e3850")
         (pos -213.07 240.832)
-        (parent "0x8d4ab20")
+        (parent "0x9f4d030")
         (select-mask 1)
         (path "images/decal/train_engine_middle.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x881a578")
+        (id "0x9158d78")
         (pos 242.93 240.832)
-        (parent "0x8d4ab20")
+        (parent "0x9f4d030")
         (select-mask 1)
         (path "images/decal/train_engine_middle.png")
-        (type 0))
+        (type 0)
+        (scale 1 1)
+        (angle 0))
       (decal
-        (id "0x8bbb7f0")
+        (id "0x9b9dfe0")
         (pos 1.44153 -15.168)
-        (parent "0x8d4ab20")
+        (parent "0x9f4d030")
         (select-mask 1)
         (path "images/decal/train_door.png")
-        (type 0)))
+        (type 0)
+        (scale 1 1)
+        (angle 0)))
     (child-layers)))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/trainstation.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/trainstation.wst	2009-04-01 03:17:05 UTC (rev 2842)
+++ trunk/windstille/data/sectors/trainstation/trainstation.wst	2009-04-01 03:25:28 UTC (rev 2843)
@@ -1,7 +1,7 @@
 ;; -*- scheme -*-
 
 (windstille-sector
-  (version 1)
+  (version 2)
   (name "")
   (ambient-color 0 0 0 1)
   (init-script "init.nut")
@@ -17,40 +17,50 @@
         (locked 0)
         (objects
           (decal
-            (id "0x87e61d8")
+            (id "0x91291d8")
             (pos -855.442 319.354)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")
-            (type 2))
+            (type 2)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x87e5438")
+            (id "0x9128438")
             (pos -1297.52 365.776)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 2))
+            (type 2)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x87e72f8")
+            (id "0x912a340")
             (pos -1402.7 340.058)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")
-            (type 2))
+            (type 2)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x87e7360")
+            (id "0x912a3b8")
             (pos -1099.97 336.543)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")
-            (type 2))
+            (type 2)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x87e73f8")
+            (id "0x9126380")
             (pos -1569.48 329.078)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")
-            (type 2)))
+            (type 2)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Lights")
@@ -58,75 +68,95 @@
         (locked 0)
         (objects
           (decal
-            (id "0x87e34a0")
+            (id "0x9128da0")
             (pos 1630.08 1070.32)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x87e3528")
+            (id "0x9126728")
             (pos 983.756 904.953)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x87e35f8")
+            (id "0x9126808")
             (pos 315.072 868.593)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x87e36c8")
+            (id "0x91268e8")
             (pos -1636 909.933)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x87e3798")
+            (id "0x91269c8")
             (pos -810.844 849.183)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x87e3868")
+            (id "0x9126aa8")
             (pos 1559.83 804.374)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x87e3938")
+            (id "0x9126b88")
             (pos -259.112 903.761)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x87e3e48")
+            (id "0x91270a8")
             (pos -477.046 760.753)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x87e3f18")
+            (id "0x9127188")
             (pos -1553.29 729.292)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x87e3fe8")
+            (id "0x9127268")
             (pos -1169.49 799.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1)))
+            (type 1)
+            (scale 1 1)
+            (angle 0)))
         (child-layers
           (layer
             (name "ExtraLight")
@@ -134,68 +164,86 @@
             (locked 0)
             (objects
               (decal
-                (id "0x87e4348")
+                (id "0x9127f78")
                 (pos -402.054 1017.24)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
-                (type 1))
+                (type 1)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x87e43d0")
+                (id "0x9128170")
                 (pos 161.91 1097.81)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
-                (type 1))
+                (type 1)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x87e44a0")
+                (id "0x9128250")
                 (pos 860.719 704.086)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
-                (type 1))
+                (type 1)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x87e4570")
+                (id "0x91273e8")
                 (pos 208.559 708.054)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
-                (type 1))
+                (type 1)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x87e4be8")
+                (id "0x91274c8")
                 (pos -845.605 1035.11)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
-                (type 1))
+                (type 1)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x87e4c98")
+                (id "0x91275a8")
                 (pos -332.91 1098.59)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
-                (type 1))
+                (type 1)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x87e4d68")
+                (id "0x9127688")
                 (pos -1151.04 1059.27)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
-                (type 1))
+                (type 1)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x87e4e38")
+                (id "0x9127768")
                 (pos -1663.74 995.791)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
-                (type 1))
+                (type 1)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x87e4f08")
+                (id "0x9127848")
                 (pos 943.16 1149.08)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
-                (type 1)))
+                (type 1)
+                (scale 1 1)
+                (angle 0)))
             (child-layers))))
       (layer
         (name "Shadow")
@@ -203,82 +251,104 @@
         (locked 0)
         (objects
           (decal
-            (id "0x87e42f0")
+            (id "0x9128080")
             (pos -2249.87 1060.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x87e4230")
+            (id "0x9127ff0")
             (pos -2244.5 972.452)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8816b18")
+            (id "0x9159730")
             (pos -2151.95 1070.86)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8816ba8")
+            (id "0x91597f0")
             (pos -2223.31 378.014)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8816c78")
+            (id "0x91598d0")
             (pos -2222.56 441.264)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8816d48")
+            (id "0x91599b0")
             (pos -2231.18 652.952)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8816e18")
+            (id "0x9159a90")
             (pos -2231.93 589.702)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8816ee8")
+            (id "0x9159b70")
             (pos -2223.79 825.967)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8816fb8")
+            (id "0x9159c50")
             (pos -2016.48 1029.67)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8817088")
+            (id "0x9159d30")
             (pos -2047.33 560.924)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8817158")
+            (id "0x9159e10")
             (pos -2080.6 782.737)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Roof")
@@ -286,82 +356,104 @@
         (locked 0)
         (objects
           (decal
-            (id "0x8819ee0")
+            (id "0x9126608")
             (pos -132.297 329.766)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881a4a8")
+            (id "0x915c5a0")
             (pos 378.703 329.766)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881a670")
+            (id "0x915d210")
             (pos 1400.7 331.719)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881a700")
+            (id "0x915d2b0")
             (pos 889.703 331.719)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8817778")
+            (id "0x915d370")
             (pos 2422.7 331.719)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8817848")
+            (id "0x915d450")
             (pos 1911.7 331.719)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8817918")
+            (id "0x915d530")
             (pos -1652.53 298.683)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x88179e8")
+            (id "0x915d610")
             (pos -771.438 410.719)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8817b18")
+            (id "0x915a700")
             (pos -1141.53 298.683)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8818478")
+            (id "0x915a7a0")
             (pos -2163.53 298.683)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8818508")
+            (id "0x915a840")
             (pos -2674.53 298.683)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Train2")
@@ -369,61 +461,77 @@
         (locked 0)
         (objects
           (decal
-            (id "0x8819e70")
+            (id "0x915af20")
             (pos -752 0)
-            (parent "0x8819768")
+            (parent "0x915bb30")
             (select-mask 1)
             (path "images/decal/train_front.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8818ca8")
+            (id "0x915a948")
             (pos 696 0)
-            (parent "0x8819768")
+            (parent "0x915bb30")
             (select-mask 1)
             (path "images/decal/train_back.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8819768")
+            (id "0x915bb30")
             (pos -2098.65 942.97)
             (parent "")
             (select-mask 1)
             (path "images/decal/train_middle.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8820a90")
+            (id "0x915edf8")
             (pos -586.991 241.125)
-            (parent "0x8819768")
+            (parent "0x915bb30")
             (select-mask 1)
             (path "images/decal/train_engine_front.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8820c40")
+            (id "0x915efa0")
             (pos 593.009 242.125)
-            (parent "0x8819768")
+            (parent "0x915bb30")
             (select-mask 1)
             (path "images/decal/train_engine_back.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8821f20")
+            (id "0x915faf8")
             (pos -206.991 241.125)
-            (parent "0x8819768")
+            (parent "0x915bb30")
             (select-mask 1)
             (path "images/decal/train_engine_middle.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8821d10")
+            (id "0x925d700")
             (pos 249.009 241.125)
-            (parent "0x8819768")
+            (parent "0x915bb30")
             (select-mask 1)
             (path "images/decal/train_engine_middle.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x891abb8")
+            (id "0x925d7d0")
             (pos 0.719482 -14.875)
-            (parent "0x8819768")
+            (parent "0x915bb30")
             (select-mask 1)
             (path "images/decal/train_door.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Lamps")
@@ -431,68 +539,86 @@
         (locked 0)
         (objects
           (decal
-            (id "0x881e4e8")
+            (id "0x915cb00")
             (pos 266.7 554.465)
             (parent "")
             (select-mask 1)
             (path "images/objects/apartmentlamp_light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881db38")
+            (id "0x925e4f8")
             (pos 999.122 579.855)
             (parent "")
             (select-mask 1)
             (path "images/objects/apartmentlamp_light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881dff0")
+            (id "0x925e768")
             (pos 1651.47 577.902)
             (parent "")
             (select-mask 1)
             (path "images/objects/apartmentlamp_light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881ea98")
+            (id "0x925ef18")
             (pos 1660.56 541.188)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")
-            (type 2))
+            (type 2)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881eb70")
+            (id "0x925efd0")
             (pos 998.057 533.375)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")
-            (type 2))
+            (type 2)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881ec48")
+            (id "0x925f0b8")
             (pos 237.12 549)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")
-            (type 2))
+            (type 2)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881ed20")
+            (id "0x925f1a0")
             (pos 1642.66 434.301)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881faa0")
+            (id "0x9163878")
             (pos 982.958 428.895)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881f438")
+            (id "0x9163908")
             (pos 231.267 426.715)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Decor Items")
@@ -500,152 +626,194 @@
         (locked 0)
         (objects
           (decal
-            (id "0x881f820")
+            (id "0x92f3cb8")
             (pos 240.218 886.438)
             (parent "")
             (select-mask 1)
             (path "images/decal/board.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x89ad9b8")
+            (id "0x9162c60")
             (pos 934.407 913.438)
             (parent "")
             (select-mask 1)
             (path "images/decal/terminal.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x89ae320")
+            (id "0x93a0fc8")
             (pos -163.625 985.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/bench.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x89af828")
+            (id "0x92f21c8")
             (pos 578.562 985.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/bench.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8b18d80")
+            (id "0x92f2c20")
             (pos 1244.19 985.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/bench.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8b18e10")
+            (id "0x92f2cc0")
             (pos 1689.49 985.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/bench.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x89af5c8")
+            (id "0x92f2da0")
             (pos 2006.69 985.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/bench.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x89af698")
+            (id "0x92f2e80")
             (pos 424.131 1013.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/plant.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8a5f0a0")
+            (id "0x92f36f8")
             (pos -1002.18 1013.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/plant.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8a5f108")
+            (id "0x92f3770")
             (pos -914.086 1013.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/plant.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881c080")
+            (id "0x9162968")
             (pos -832.618 1013.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/plant.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881c158")
+            (id "0x9162a50")
             (pos 1064.43 1014.67)
             (parent "")
             (select-mask 1)
             (path "images/objects/plant.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881c230")
+            (id "0x940f230")
             (pos 676.954 1029.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/box.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x89af978")
+            (id "0x9162590")
             (pos 612.954 1029.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/box.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881cda8")
+            (id "0x91622f8")
             (pos 648.954 965.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/box.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881ce20")
+            (id "0x9162398")
             (pos 740.954 1029.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/box.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881ced0")
+            (id "0x9160780")
             (pos 584.954 965.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/box.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881cfa0")
+            (id "0x9160860")
             (pos 548.954 1029.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/box.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881d070")
+            (id "0x9160940")
             (pos 706.554 965.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/box.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881d140")
+            (id "0x9160a20")
             (pos 28.218 973.438)
             (parent "")
             (select-mask 1)
             (path "images/decal/trashcan.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881d4d0")
+            (id "0x9160fa8")
             (pos 1448.12 973.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/trashcan.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Railground")
@@ -653,376 +821,482 @@
         (locked 0)
         (objects
           (decal
-            (id "0x8a5dad8")
+            (id "0x9161940")
             (pos -249.032 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbd6c0")
+            (id "0x940fa00")
             (pos -761.032 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8a5e330")
+            (id "0x940faa0")
             (pos -2297.03 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8a5e3c0")
+            (id "0x940fb40")
             (pos -1785.03 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8a5e490")
+            (id "0x940fc00")
             (pos -1273.03 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8a5e560")
+            (id "0x940fce0")
             (pos 262.968 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8a5e630")
+            (id "0x940fdc0")
             (pos 774.968 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8a5e700")
+            (id "0x940fea0")
             (pos 1798.97 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8a5e7d0")
+            (id "0x940ff80")
             (pos 1286.97 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8a5e8a0")
+            (id "0x9410060")
             (pos 1670.97 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbd4c0")
+            (id "0x9410a40")
             (pos 1926.97 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8a5e970")
+            (id "0x9410ae0")
             (pos 1414.97 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8a5ea00")
+            (id "0x9410b80")
             (pos 1158.97 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8a5ead0")
+            (id "0x9410c60")
             (pos 2214.14 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbbfd0")
+            (id "0x9411440")
             (pos 1702.14 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbc060")
+            (id "0x9410f88")
             (pos 1958.14 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbc0f0")
+            (id "0x9411010")
             (pos 1446.14 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbc1c0")
+            (id "0x968c2d8")
             (pos -121.032 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbc290")
+            (id "0x968c390")
             (pos -377.032 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbc360")
+            (id "0x968c470")
             (pos 646.968 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbc430")
+            (id "0x968c550")
             (pos 902.968 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbc500")
+            (id "0x968c630")
             (pos 390.968 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbc5d0")
+            (id "0x9515330")
             (pos 134.968 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbc6a0")
+            (id "0x9515410")
             (pos 1190.13 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbc770")
+            (id "0x95154f0")
             (pos 934.13 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbc840")
+            (id "0x95155d0")
             (pos 422.13 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbc910")
+            (id "0x95156b0")
             (pos 166.13 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbc9e0")
+            (id "0x9515790")
             (pos 678.13 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbcab0")
+            (id "0x9515870")
             (pos -89.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbcb80")
+            (id "0x9515950")
             (pos -889.032 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbcc50")
+            (id "0x9515a30")
             (pos -633.032 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbcd20")
+            (id "0x9515b10")
             (pos -345.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbcdf0")
+            (id "0x9515bf0")
             (pos -601.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbcec0")
+            (id "0x9515cd0")
             (pos -1369.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbcf90")
+            (id "0x9515db0")
             (pos -1881.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbd060")
+            (id "0x9515e90")
             (pos -1625.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbd130")
+            (id "0x9515f70")
             (pos -1113.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbd200")
+            (id "0x9516050")
             (pos -857.872 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbd2d0")
+            (id "0x9516130")
             (pos -1145.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8bbd3a0")
+            (id "0x9516210")
             (pos -1657.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d48b20")
+            (id "0x95162f0")
             (pos -1401.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d48bf0")
+            (id "0x95163d0")
             (pos -1913.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d48cc0")
+            (id "0x95164b0")
             (pos -2169.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d48d90")
+            (id "0x9516590")
             (pos -3193.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d48e60")
+            (id "0x9516670")
             (pos -2937.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d48f30")
+            (id "0x9516750")
             (pos -2681.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d49000")
+            (id "0x9516830")
             (pos -2649.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d490d0")
+            (id "0x9516910")
             (pos -2905.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d491a0")
+            (id "0x95169f0")
             (pos -2809.03 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d49270")
+            (id "0x9516ad0")
             (pos -3321.03 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d49340")
+            (id "0x9516bb0")
             (pos -2393.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d49410")
+            (id "0x9516c90")
             (pos -2137.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d494e0")
+            (id "0x9516d70")
             (pos -2425.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Endwall")
@@ -1030,152 +1304,194 @@
         (locked 0)
         (objects
           (decal
-            (id "0x8a5d8d0")
+            (id "0x9161690")
             (pos -1681.93 441.438)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor_left.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x87e3380")
+            (id "0x95765c8")
             (pos -1681.93 313.438)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor_left.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881f4f0")
+            (id "0x9161e58")
             (pos -1681.93 953.438)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor_left.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881f5c0")
+            (id "0x9161ed8")
             (pos -1681.93 825.438)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor_left.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881f6d0")
+            (id "0x9517378")
             (pos -1681.93 569.438)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor_left.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x881f7b0")
+            (id "0x91639f0")
             (pos -1681.93 697.438)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor_left.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8c32c18")
+            (id "0x9163ae0")
             (pos -1681.93 1081.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor_left.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8c32cf8")
+            (id "0x9574178")
             (pos -1883.06 1017.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d4a3d0")
+            (id "0x96e3e68")
             (pos -2253.06 1017.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d4a438")
+            (id "0x95749f8")
             (pos -2253.06 757.687)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d4a4d0")
+            (id "0x9574aa0")
             (pos -1883.06 757.687)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d4a5a8")
+            (id "0x9574b88")
             (pos -2253.06 501.687)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d4a680")
+            (id "0x9574c70")
             (pos -1883.06 501.687)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d4a758")
+            (id "0x9574d58")
             (pos -2251.49 245.687)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d4a830")
+            (id "0x9574e40")
             (pos -1881.49 245.687)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d4a908")
+            (id "0x9574f28")
             (pos -1763.88 1198.81)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d4a9d8")
+            (id "0x9574fe0")
             (pos -2080.29 1241.78)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d4aaa8")
+            (id "0x95750c0")
             (pos -2400.6 1212.48)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d4ab78")
+            (id "0x95751a0")
             (pos -2376.41 267.922)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d4ac48")
+            (id "0x9575280")
             (pos -2118.6 301.125)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8d4ad18")
+            (id "0x9575360")
             (pos -1854.93 254.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Ground")
@@ -1183,96 +1499,122 @@
         (locked 0)
         (objects
           (decal
-            (id "0x8a5da28")
+            (id "0x9161760")
             (pos 1836.13 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8e0a368")
+            (id "0x9576208")
             (pos 2144.13 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8e0af40")
+            (id "0x974e358")
             (pos -1551.87 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8e0afd0")
+            (id "0x974e3e0")
             (pos -1243.87 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8e0b060")
+            (id "0x974e4a0")
             (pos -935.87 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8e0b130")
+            (id "0x974e580")
             (pos -627.87 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8e0b200")
+            (id "0x96e1ac0")
             (pos -319.87 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8c301c0")
+            (id "0x96e1ba0")
             (pos -11.87 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8c30290")
+            (id "0x96e1c80")
             (pos 296.13 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8c30360")
+            (id "0x96e1d60")
             (pos 604.13 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8c30430")
+            (id "0x96e1e40")
             (pos 912.13 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8c30500")
+            (id "0x96e1f20")
             (pos 1220.13 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8c305d0")
+            (id "0x96e2000")
             (pos 1528.13 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Stairs")
@@ -1286,47 +1628,59 @@
             (locked 0)
             (objects
               (decal
-                (id "0x8c30718")
+                (id "0x96f1838")
                 (pos -1672.24 1055.45)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/dark.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8c307c0")
+                (id "0x96f1918")
                 (pos -1743.76 802.297)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/dark.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8c30890")
+                (id "0x96e21d8")
                 (pos -1723.47 1039.37)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/dark.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8c30960")
+                (id "0x96e22b8")
                 (pos -1744.37 547.859)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/dark.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8c30a30")
+                (id "0x96e2398")
                 (pos -1484.44 1141.69)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/dark.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8c30f40")
+                (id "0x96e29c0")
                 (pos -937.569 1133.87)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/dark.png")
-                (type 0)))
+                (type 0)
+                (scale 1 1)
+                (angle 0)))
             (child-layers))
           (layer
             (name "StairHandle")
@@ -1334,138 +1688,176 @@
             (locked 0)
             (objects
               (decal
-                (id "0x8c31488")
+                (id "0x96e2490")
                 (pos -616.808 986.023)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8d4a358")
+                (id "0x96e3b40")
                 (pos -747.308 903.961)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8c32378")
+                (id "0x96e2e30")
                 (pos -866.058 819.586)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8c32410")
+                (id "0x96e2ef8")
                 (pos -994.995 739.086)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8c31c38")
+                (id "0x96e3050")
                 (pos -1121.56 643.773)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8c31d10")
+                (id "0x96e3138")
                 (pos -1266.12 541.398)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8c31de8")
+                (id "0x96ef8b0")
                 (pos -1417.24 435.273)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8c31ec0")
+                (id "0x96ef998")
                 (pos -616.808 986.023)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8c31f98")
+                (id "0x96efa80")
                 (pos -1548.99 346.023)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8da0910")
+                (id "0x96efb68")
                 (pos -1513.04 261.304)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail2.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ea6978")
+                (id "0x97e9dd0")
                 (pos -1401.54 337.804)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail2.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8da1150")
+                (id "0x96f03e8")
                 (pos -1284.79 418.304)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail2.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8da11e8")
+                (id "0x96f0490")
                 (pos -1168.6 497.851)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail2.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8da12a0")
+                (id "0x96f0558")
                 (pos -1055.1 576.164)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail2.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8da1378")
+                (id "0x96f0640")
                 (pos -951.354 648.164)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail2.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8da1450")
+                (id "0x96f0728")
                 (pos -951.354 648.164)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail2.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8da1528")
+                (id "0x96f0810")
                 (pos -840.354 724.914)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail2.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8da1600")
+                (id "0x96f08f8")
                 (pos -727.167 804.352)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail2.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8da16d8")
+                (id "0x96f09e0")
                 (pos -618.354 880.164)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail2.png")
-                (type 0)))
+                (type 0)
+                (scale 1 1)
+                (angle 0)))
             (child-layers))
           (layer
             (name "Stairs")
@@ -1473,75 +1865,95 @@
             (locked 0)
             (objects
               (decal
-                (id "0x8c31408")
+                (id "0x97e9ca8")
                 (pos -1136.93 991.617)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/stairs.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8da2258")
+                (id "0x96e2d50")
                 (pos -908.368 955.628)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/stairs.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8da1a60")
+                (id "0x96f0f28")
                 (pos -1135.37 789.851)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/stairs.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8da1af0")
+                (id "0x9843800")
                 (pos -1585.06 933.992)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/stairs.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8da1bc0")
+                (id "0x98438a8")
                 (pos -1360.81 868.503)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/stairs.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8da1c90")
+                (id "0x9843988")
                 (pos -1356.49 631.226)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/stairs.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8f003e0")
+                (id "0x9843a68")
                 (pos -1583.49 700.43)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/stairs.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8f004b0")
+                (id "0x97e7b48")
                 (pos -1583.49 453.94)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/stairs.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8f00580")
+                (id "0x97e7c28")
                 (pos -1196.46 916.438)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/door.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ea4ae8")
+                (id "0x9813280")
                 (pos -681.368 1109.43)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/stairs.png")
-                (type 0)))
+                (type 0)
+                (scale 1 1)
+                (angle 0)))
             (child-layers))
           (layer
             (name "StairWall")
@@ -1549,166 +1961,212 @@
             (locked 0)
             (objects
               (decal
-                (id "0x8ea54a0")
+                (id "0x96e3940")
                 (pos -658.251 306.508)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ecfc40")
+                (id "0x97e8858")
                 (pos -658.251 434.508)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ecfe50")
+                (id "0x97e96a0")
                 (pos -656.688 690.508)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ea6058")
+                (id "0x97e9748")
                 (pos -656.688 562.508)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ea60f0")
+                (id "0x97e9830")
                 (pos -1424.46 307.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ea61c8")
+                (id "0x97e9918")
                 (pos -656.462 935.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/tunnelplate_bottom.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ea65e8")
+                (id "0x97e9a98")
                 (pos -656.688 818.508)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8fef830")
+                (id "0x9811670")
                 (pos -656.688 946.508)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8fef8c8")
+                (id "0x9811718")
                 (pos -656.688 1074.51)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8fef980")
+                (id "0x9811800")
                 (pos -1424.46 563.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8fefa58")
+                (id "0x98118e8")
                 (pos -1424.46 691.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8fefb30")
+                (id "0x98119d0")
                 (pos -1424.46 435.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ecd9e8")
+                (id "0x9811ab8")
                 (pos -1424.46 819.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ecdac0")
+                (id "0x9811ba0")
                 (pos -1168.46 819.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ecdb98")
+                (id "0x9811c88")
                 (pos -1168.46 435.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ecdc70")
+                (id "0x9811d70")
                 (pos -1168.46 691.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ecdd48")
+                (id "0x9811e58")
                 (pos -1168.46 563.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ecde20")
+                (id "0x9811f40")
                 (pos -1168.46 307.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ecdef8")
+                (id "0x9812028")
                 (pos -912.462 307.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ecdfd0")
+                (id "0x9812110")
                 (pos -912.462 563.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ece0a8")
+                (id "0x98121f8")
                 (pos -912.462 691.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ece180")
+                (id "0x98122e0")
                 (pos -912.462 435.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x8ece258")
+                (id "0x98123c8")
                 (pos -912.462 819.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
-                (type 0)))
+                (type 0)
+                (scale 1 1)
+                (angle 0)))
             (child-layers))))
       (layer
         (name "WallShadow")
@@ -1716,19 +2174,23 @@
         (locked 0)
         (objects
           (decal
-            (id "0x8ea52d8")
+            (id "0x97e85d0")
             (pos -498.687 804.29)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8ea5310")
+            (id "0x97e8618")
             (pos -418.187 492.016)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Train")
@@ -1736,61 +2198,77 @@
         (locked 0)
         (objects
           (decal
-            (id "0x8f5e3b0")
+            (id "0x97e8498")
             (pos -752 0)
-            (parent "0x8c312e0")
+            (parent "0x96e38e8")
             (select-mask 1)
             (path "images/decal/train_front.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8ea5410")
+            (id "0x96e37c0")
             (pos 696 0)
-            (parent "0x8c312e0")
+            (parent "0x96e38e8")
             (select-mask 1)
             (path "images/decal/train_back.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8c312e0")
+            (id "0x96e38e8")
             (pos 1705.54 939.785)
             (parent "")
             (select-mask 1)
             (path "images/decal/train_middle.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8ece3b8")
+            (id "0x9812e48")
             (pos -586.991 241.125)
-            (parent "0x8c312e0")
+            (parent "0x96e38e8")
             (select-mask 1)
             (path "images/decal/train_engine_front.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8ece4d8")
+            (id "0x9812500")
             (pos 593.009 242.125)
-            (parent "0x8c312e0")
+            (parent "0x96e38e8")
             (select-mask 1)
             (path "images/decal/train_engine_back.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8ece5f8")
+            (id "0x9812630")
             (pos -206.991 241.125)
-            (parent "0x8c312e0")
+            (parent "0x96e38e8")
             (select-mask 1)
             (path "images/decal/train_engine_middle.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8ece718")
+            (id "0x9812760")
             (pos 249.009 241.125)
-            (parent "0x8c312e0")
+            (parent "0x96e38e8")
             (select-mask 1)
             (path "images/decal/train_engine_middle.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8ecec50")
+            (id "0x9812890")
             (pos 0.719482 -14.875)
-            (parent "0x8c312e0")
+            (parent "0x96e38e8")
             (select-mask 1)
             (path "images/decal/train_door.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Tunnel Wall")
@@ -1798,313 +2276,401 @@
         (locked 0)
         (objects
           (decal
-            (id "0x8ecf3f8")
+            (id "0x989fd50")
             (pos 1790.43 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8f5bfe0")
+            (id "0x989fe40")
             (pos 2046.43 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8f5c0c0")
+            (id "0x989ff30")
             (pos 1278.43 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8f5c1a0")
+            (id "0x98a0020")
             (pos 1534.43 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8f5c280")
+            (id "0x98a0110")
             (pos 1022.43 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8f5c360")
+            (id "0x98a0200")
             (pos 2165.35 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8f5c4a8")
+            (id "0x98a0c58")
             (pos 2101.35 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8f5da10")
+            (id "0x99c1778")
             (pos 2037.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8f5dab0")
+            (id "0x99c1828")
             (pos 1781.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8f5db50")
+            (id "0x99c18d8")
             (pos 1845.35 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8f5dbf8")
+            (id "0x99c1990")
             (pos 1909.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8f5dcd8")
+            (id "0x99c1a80")
             (pos 1397.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8f5ddb8")
+            (id "0x9932888")
             (pos 1333.35 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x8f5de90")
+            (id "0x9932970")
             (pos 1269.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9049c08")
+            (id "0x9932a60")
             (pos 1525.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9049cc8")
+            (id "0x9932b50")
             (pos 1589.35 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9049da0")
+            (id "0x9932c38")
             (pos 1653.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9049e80")
+            (id "0x9932d28")
             (pos 629.352 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9049f60")
+            (id "0x9932e18")
             (pos 565.354 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904a038")
+            (id "0x9932f00")
             (pos 501.352 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904a118")
+            (id "0x9932ff0")
             (pos 245.352 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904a1f8")
+            (id "0x99330e0")
             (pos 309.354 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904a2d0")
+            (id "0x99331c8")
             (pos 373.352 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904a3b0")
+            (id "0x99332b8")
             (pos 885.352 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904a490")
+            (id "0x99333a8")
             (pos 821.354 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904a568")
+            (id "0x9933490")
             (pos 757.352 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904a648")
+            (id "0x9933580")
             (pos 1013.35 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904a728")
+            (id "0x9933670")
             (pos 1077.35 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904a800")
+            (id "0x9933758")
             (pos 1141.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904a8e0")
+            (id "0x9933848")
             (pos -394.638 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904a9c0")
+            (id "0x9933938")
             (pos -138.648 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904aaa0")
+            (id "0x9933a28")
             (pos -202.646 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904ab78")
+            (id "0x9933b10")
             (pos -266.648 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904ac58")
+            (id "0x9933c00")
             (pos -10.6475 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904ad38")
+            (id "0x9933cf0")
             (pos 53.3544 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904ae10")
+            (id "0x9933dd8")
             (pos 117.352 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904aef0")
+            (id "0x9933ec8")
             (pos 766.427 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904afd0")
+            (id "0x9933fb8")
             (pos 510.427 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904b0b0")
+            (id "0x99340a8")
             (pos 254.427 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904b190")
+            (id "0x9934198")
             (pos -458.636 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904b268")
+            (id "0x9934280")
             (pos -522.638 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904b348")
+            (id "0x9934370")
             (pos -1.57263 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904b428")
+            (id "0x9934460")
             (pos -257.573 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x904b508")
+            (id "0x9934550")
             (pos -513.573 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers)))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/worker.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/worker.wst	2009-04-01 03:17:05 UTC (rev 2842)
+++ trunk/windstille/data/sectors/trainstation/worker.wst	2009-04-01 03:25:28 UTC (rev 2843)
@@ -1,7 +1,7 @@
 ;; -*- scheme -*-
 
 (windstille-sector
-  (version 1)
+  (version 2)
   (name "")
   (ambient-color 0 0 0 1)
   (init-script "init.nut")
@@ -11,12 +11,14 @@
     (locked 0)
     (objects
       (decal
-        (id "0x93586f8")
+        (id "0xa752988")
         (pos 1204.55 268.312)
         (parent "")
         (select-mask 1)
         (path "images/decal/humanreference.png")
-        (type 0)))
+        (type 0)
+        (scale 1 1)
+        (angle 0)))
     (child-layers
       (layer
         (name "Light")
@@ -24,61 +26,77 @@
         (locked 0)
         (objects
           (decal
-            (id "0x935bb60")
+            (id "0xa755958")
             (pos 58.9653 321.293)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935bff0")
+            (id "0xa755a10")
             (pos 1347.85 311.818)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935c080")
+            (id "0xa755af0")
             (pos -518.274 304.576)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935c110")
+            (id "0xa755bd0")
             (pos 667.297 305.114)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935c1a0")
+            (id "0xa755cb0")
             (pos 45.189 -395.95)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935c230")
+            (id "0xa755d90")
             (pos 653.521 -410.567)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935c2c0")
+            (id "0xa755e70")
             (pos -535.175 -411.104)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1))
+            (type 1)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935c350")
+            (id "0xa755f50")
             (pos 1334.07 -403.863)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
-            (type 1)))
+            (type 1)
+            (scale 1 1)
+            (angle 0)))
         (child-layers
           (layer
             (name "Highlight")
@@ -86,117 +104,149 @@
             (locked 0)
             (objects
               (decal
-                (id "0x935c8a0")
+                (id "0xa756230")
                 (pos -520.276 3.38026)
                 (parent "")
                 (select-mask 1)
                 (path "images/objects/apartmentlamp_highlight.png")
-                (type 2))
+                (type 2)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x939bac8")
+                (id "0xa756a98")
                 (pos 657.849 1.81776)
                 (parent "")
                 (select-mask 1)
                 (path "images/objects/apartmentlamp_highlight.png")
-                (type 2))
+                (type 2)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x939bb00")
+                (id "0xa750700")
                 (pos 1321.1 -0.557228)
                 (parent "")
                 (select-mask 1)
                 (path "images/objects/apartmentlamp_highlight.png")
-                (type 2))
+                (type 2)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x939c050")
+                (id "0xa752ef8")
                 (pos 36.7242 -0.55722)
                 (parent "")
                 (select-mask 1)
                 (path "images/objects/apartmentlamp_highlight.png")
-                (type 2))
+                (type 2)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x939c0f8")
+                (id "0xa752f90")
                 (pos -499.515 23.7381)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp_bloom.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x939c190")
+                (id "0xa753048")
                 (pos 46.7499 29.8416)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp_bloom.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x939c228")
+                (id "0xa753130")
                 (pos 656.491 10.0661)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp_bloom.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x936f418")
+                (id "0xa753218")
                 (pos 1331.54 20.6863)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp_bloom.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x936f4b0")
+                (id "0xa753300")
                 (pos 1394.11 -619.545)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp_bloom.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x936f548")
+                (id "0xa7533e8")
                 (pos 728.826 -616.493)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp_bloom.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x936f5e0")
+                (id "0xa7534d0")
                 (pos 109.319 -610.39)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp_bloom.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x936f678")
+                (id "0xa7535b8")
                 (pos -436.945 -616.493)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp_bloom.png")
-                (type 0))
+                (type 0)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x936f710")
+                (id "0xa7536a0")
                 (pos 99.2935 -640.789)
                 (parent "")
                 (select-mask 1)
                 (path "images/objects/apartmentlamp_highlight.png")
-                (type 2))
+                (type 2)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x936f7b8")
+                (id "0xa753798")
                 (pos 1383.67 -640.789)
                 (parent "")
                 (select-mask 1)
                 (path "images/objects/apartmentlamp_highlight.png")
-                (type 2))
+                (type 2)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x936f860")
+                (id "0xa753890")
                 (pos 720.418 -638.414)
                 (parent "")
                 (select-mask 1)
                 (path "images/objects/apartmentlamp_highlight.png")
-                (type 2))
+                (type 2)
+                (scale 1 1)
+                (angle 0))
               (decal
-                (id "0x936f908")
+                (id "0xa753988")
                 (pos -457.706 -636.851)
                 (parent "")
                 (select-mask 1)
                 (path "images/objects/apartmentlamp_highlight.png")
-                (type 2)))
+                (type 2)
+                (scale 1 1)
+                (angle 0)))
             (child-layers))))
       (layer
         (name "Ground")
@@ -204,425 +254,545 @@
         (locked 0)
         (objects
           (decal
-            (id "0x9370518")
+            (id "0xa753dc8")
             (pos 1641.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935ab50")
+            (id "0xa753eb0")
             (pos 873.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935abb8")
+            (id "0xa753f98")
             (pos 1130.5 448.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935ac50")
+            (id "0xa754080")
             (pos 361.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9370cc8")
+            (id "0xa754168")
             (pos 105.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9370d60")
+            (id "0xa754250")
             (pos -150.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9370df8")
+            (id "0xa754338")
             (pos 617.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9370e90")
+            (id "0xa754420")
             (pos 1385.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9370f28")
+            (id "0xa754508")
             (pos -101.75 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9371098")
+            (id "0xa7545f0")
             (pos 154.25 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x939bf08")
+            (id "0xa7546d8")
             (pos 410.25 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9371218")
+            (id "0xa7547c0")
             (pos 1178.25 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x93712b0")
+            (id "0xa7548a8")
             (pos 922.25 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9371348")
+            (id "0xa754990")
             (pos 666.25 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x93587e8")
+            (id "0xa754a78")
             (pos 1690.25 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9358880")
+            (id "0xa768da8")
             (pos 1434.25 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9358918")
+            (id "0xa768e90")
             (pos -918.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x93589b0")
+            (id "0xa768f78")
             (pos -662.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9358a48")
+            (id "0xa769060")
             (pos -1430.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9358ae0")
+            (id "0xa769148")
             (pos -1686.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9358b78")
+            (id "0xa769230")
             (pos -1942.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9358c10")
+            (id "0xa769318")
             (pos -1174.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9358ca8")
+            (id "0xa769400")
             (pos -406.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9358d40")
+            (id "0xa7694e8")
             (pos -1893.75 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9358dd8")
+            (id "0xa7695d0")
             (pos -1637.75 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9358e70")
+            (id "0xa7696b8")
             (pos -1381.75 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9358f08")
+            (id "0xa7697a0")
             (pos -613.75 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9358fa0")
+            (id "0xa769888")
             (pos -869.75 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359038")
+            (id "0xa769970")
             (pos -1125.75 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x93590d0")
+            (id "0xa769a58")
             (pos -357.75 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359168")
+            (id "0xa769b40")
             (pos 1897.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359200")
+            (id "0xa769c28")
             (pos 2153.5 447.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359298")
+            (id "0xa769d10")
             (pos 1946.25 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359330")
+            (id "0xa769df8")
             (pos 2202.25 -64.6875)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x93593c8")
+            (id "0xa769ee0")
             (pos 1915.34 -192.687)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359460")
+            (id "0xa769fc8")
             (pos -388.656 -192.687)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x93594f8")
+            (id "0xa76a0b0")
             (pos -644.656 -192.687)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359590")
+            (id "0xa76a198")
             (pos -900.656 -192.687)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359628")
+            (id "0xa76a280")
             (pos 1403.34 -192.687)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x93596c0")
+            (id "0xa76a368")
             (pos 635.344 -192.687)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359758")
+            (id "0xa76a450")
             (pos -132.656 -192.687)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x93597f0")
+            (id "0xa76a538")
             (pos 123.344 -192.687)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359888")
+            (id "0xa76a620")
             (pos 379.344 -192.687)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359920")
+            (id "0xa76a708")
             (pos 1147.34 -192.687)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x93599b8")
+            (id "0xa76a7f0")
             (pos 891.344 -192.687)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359a50")
+            (id "0xa76a8d8")
             (pos 1659.34 -192.687)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueground.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359ae8")
+            (id "0xa76a9c0")
             (pos 2225.09 -704.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359b80")
+            (id "0xa76aaa8")
             (pos 1969.09 -704.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359c18")
+            (id "0xa76ab90")
             (pos -334.905 -704.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359cb0")
+            (id "0xa76ac78")
             (pos -1102.91 -704.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359d48")
+            (id "0xa76ad60")
             (pos -846.905 -704.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359de0")
+            (id "0xa76ae48")
             (pos -590.905 -704.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359e78")
+            (id "0xa76af30")
             (pos 1457.09 -704.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359f10")
+            (id "0xa76b018")
             (pos 1713.09 -704.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9359fa8")
+            (id "0xa7bd760")
             (pos 689.095 -704.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935a040")
+            (id "0xa7bd848")
             (pos 945.095 -704.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935a0d8")
+            (id "0xa7bd930")
             (pos 1201.09 -704.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935a170")
+            (id "0xa7bda18")
             (pos 433.095 -704.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935a208")
+            (id "0xa7bdb00")
             (pos 177.095 -704.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935a2a0")
+            (id "0xa7bdbe8")
             (pos -78.9053 -704.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/blueroof.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Stairs")
@@ -630,75 +800,95 @@
         (locked 0)
         (objects
           (decal
-            (id "0x936fc70")
+            (id "0xa76b718")
             (pos 1346.67 98.8136)
             (parent "")
             (select-mask 1)
             (path "images/decal/stair2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x936f9f8")
+            (id "0xa76b7e8")
             (pos 1346.67 258.814)
             (parent "")
             (select-mask 1)
             (path "images/decal/stair1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x936fae0")
+            (id "0xa76b898")
             (pos 1474.67 386.814)
             (parent "")
             (select-mask 1)
             (path "images/decal/stair1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935c738")
+            (id "0xa7bdd80")
             (pos 1474.67 226.814)
             (parent "")
             (select-mask 1)
             (path "images/decal/stair2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935c7c8")
+            (id "0xa7bde30")
             (pos 1218.67 -29.1864)
             (parent "")
             (select-mask 1)
             (path "images/decal/stair2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x936fca8")
+            (id "0xa7bdee0")
             (pos 1090.67 2.81363)
             (parent "")
             (select-mask 1)
             (path "images/decal/stair1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x936fd38")
+            (id "0xa7bdf90")
             (pos 1090.67 -157.186)
             (parent "")
             (select-mask 1)
             (path "images/decal/stair2.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x936fdc8")
+            (id "0xa7be040")
             (pos 1218.67 130.814)
             (parent "")
             (select-mask 1)
             (path "images/decal/stair1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935b998")
+            (id "0xa7be0f0")
             (pos 958.609 -125.186)
             (parent "")
             (select-mask 1)
             (path "images/decal/stair1.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935ba28")
+            (id "0xa7be1a0")
             (pos 958.609 -285.186)
             (parent "")
             (select-mask 1)
             (path "images/decal/stair2.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Locker")
@@ -706,110 +896,140 @@
         (locked 0)
         (objects
           (decal
-            (id "0x935a700")
+            (id "0xa76b908")
             (pos 337.491 253.75)
             (parent "")
             (select-mask 1)
             (path "images/objects/locker.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x93eed98")
+            (id "0xa7557a0")
             (pos 465.491 253.75)
             (parent "")
             (select-mask 1)
             (path "images/objects/locker.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x93eee30")
+            (id "0xa756338")
             (pos 593.491 253.75)
             (parent "")
             (select-mask 1)
             (path "images/objects/locker.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94ab1e8")
+            (id "0xa7563e0")
             (pos 721.491 253.75)
             (parent "")
             (select-mask 1)
             (path "images/objects/locker.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94ab280")
+            (id "0xa7c1258")
             (pos 849.491 253.75)
             (parent "")
             (select-mask 1)
             (path "images/objects/locker.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x93ef710")
+            (id "0xa7c1340")
             (pos -707.071 240.313)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x935c6d0")
+            (id "0xa7c0520")
             (pos -708.083 255.313)
             (parent "")
             (select-mask 1)
             (path "images/objects/door.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x95dd888")
+            (id "0xa7c26c0")
             (pos -326.468 339.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/bed.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x93f0240")
+            (id "0xa7c1b90")
             (pos 72.6572 339.312)
             (parent "")
             (select-mask 1)
             (path "images/objects/bed.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x93eff18")
+            (id "0xa7bead0")
             (pos -177.277 -384.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/door.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94a9790")
+            (id "0xa7beb88")
             (pos -175.578 -399.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94a9828")
+            (id "0xa7bec20")
             (pos 411.525 -399.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94a98c0")
+            (id "0xa7bed08")
             (pos 409.826 -384.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/door.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94a9950")
+            (id "0xa7bede8")
             (pos -726.788 -399.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94a99e8")
+            (id "0xa7beed0")
             (pos -728.486 -384.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/door.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Shadow")
@@ -817,68 +1037,86 @@
         (locked 0)
         (objects
           (decal
-            (id "0x95058b0")
+            (id "0xa76b760")
             (pos 1432.09 426.524)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94a9a88")
+            (id "0xa7bf0d8")
             (pos 325.796 355.072)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94a9ae8")
+            (id "0xa7bf188")
             (pos 870.812 337.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94a9b48")
+            (id "0xa7bf238")
             (pos 586.047 254.156)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94a9ba8")
+            (id "0xa7bf2e8")
             (pos -224.968 432.364)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94a9c08")
+            (id "0xa7bf398")
             (pos 67.5322 426.114)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94a9c80")
+            (id "0xa7bf850")
             (pos 1152.54 -13.9169)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94a9d10")
+            (id "0xa7bf930")
             (pos 929.427 -188.448)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94a9da0")
+            (id "0xa7bfa10")
             (pos 1198.26 393.161)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers))
       (layer
         (name "Background")
@@ -886,138 +1124,176 @@
         (locked 0)
         (objects
           (decal
-            (id "0x94a9e90")
+            (id "0xa7bf010")
             (pos 346.25 191.313)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94aa580")
+            (id "0xa7bfe70")
             (pos 730.25 191.313)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94aa798")
+            (id "0xa966b30")
             (pos 1498.25 191.313)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x94aa830")
+            (id "0xa966bd8")
             (pos 1114.25 191.313)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x96d7c08")
+            (id "0xa966cc0")
             (pos -37.75 191.313)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x96d7ca0")
+            (id "0xa966da8")
             (pos -1573.75 191.313)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x96d7d38")
+            (id "0xa966e90")
             (pos -421.75 191.313)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9503708")
+            (id "0xa8ccb28")
             (pos -805.75 191.313)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x95037a0")
+            (id "0xa8ccbf0")
             (pos -1189.75 191.313)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9503838")
+            (id "0xa8cccd8")
             (pos 1882.25 191.313)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x95038d0")
+            (id "0xa8ccdc0")
             (pos 1975.29 -448.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9503968")
+            (id "0xa8ccea8")
             (pos -1096.71 -448.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9503a00")
+            (id "0xa8ccf90")
             (pos -712.715 -448.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9503a98")
+            (id "0xa8cd078")
             (pos -328.715 -448.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9503b30")
+            (id "0xa8cd160")
             (pos 55.2852 -448.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9503bc8")
+            (id "0xa8cd248")
             (pos 1207.29 -448.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9503c60")
+            (id "0xa8cd330")
             (pos 1591.29 -448.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9503cf8")
+            (id "0xa8cd418")
             (pos 823.285 -448.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0))
+            (type 0)
+            (scale 1 1)
+            (angle 0))
           (decal
-            (id "0x9503d90")
+            (id "0xa8cd500")
             (pos 439.285 -448.688)
             (parent "")
             (select-mask 1)
             (path "images/objects/bluewall.png")
-            (type 0)))
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
         (child-layers)))))
 
 ;; EOF ;;



From grumbel at mail.berlios.de  Wed Apr  1 17:44:54 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 1 Apr 2009 17:44:54 +0200
Subject: [Windstille-commit] r2844 - trunk/windstille/src/display
Message-ID: <200904011544.n31Fisr5029458@sheep.berlios.de>

Author: grumbel
Date: 2009-04-01 17:44:54 +0200 (Wed, 01 Apr 2009)
New Revision: 2844

Modified:
   trunk/windstille/src/display/drawing_context.cpp
   trunk/windstille/src/display/drawing_context.hpp
   trunk/windstille/src/display/surface.cpp
Log:
draw_control() no longer scales the surfaces

Modified: trunk/windstille/src/display/drawing_context.cpp
===================================================================
--- trunk/windstille/src/display/drawing_context.cpp	2009-04-01 03:25:28 UTC (rev 2843)
+++ trunk/windstille/src/display/drawing_context.cpp	2009-04-01 15:44:54 UTC (rev 2844)
@@ -22,6 +22,7 @@
 #include <GL/glew.h>
 #include <GL/gl.h>
 
+#include "math/vector3.hpp"
 #include "display/display.hpp"
 #include "display/opengl_state.hpp"
 #include "display/scene_context.hpp"
@@ -140,7 +141,7 @@
 public:
   SurfaceQuadDrawingRequest(Surface surface_, const Vector2f& pos_, const Quad& quad_, 
                             const DrawingParameters& params_, float z_pos_,
-                            const Matrix modelview_)
+                            const Matrix& modelview_)
     : DrawingRequest(pos_, z_pos_, modelview_),
       surface(surface_),
       quad(quad_),
@@ -187,9 +188,10 @@
 
 public:
   SurfaceDrawingRequest(Surface surface, const SurfaceDrawingParameters& params, float z_pos_,
-                        const Matrix modelview)
+                        const Matrix& modelview)
     : DrawingRequest(pos, z_pos_, modelview), surface(surface), params(params)
   {}
+
   virtual ~SurfaceDrawingRequest()
   {}
 
@@ -204,6 +206,42 @@
   }
 };
 
+class ControlDrawingRequest : public DrawingRequest
+{
+private:
+  Surface surface;
+  float angle;
+
+public:
+  ControlDrawingRequest(Surface surface_, const Vector2f& pos_, float angle_, float z_pos_,
+                        const Matrix& modelview_)
+    : DrawingRequest(pos_, z_pos_, modelview_), 
+      surface(surface_), 
+      angle(angle_)
+  {}
+
+  virtual ~ControlDrawingRequest() {}
+
+  void draw(const Texture& /*tmp_texture*/)
+  {
+    glPushMatrix();
+
+    // FIXME: This looks badly broken, should modelview.multiply() be enough?
+    glTranslatef(modelview.matrix[12],
+                 modelview.matrix[13],
+                 modelview.matrix[14]);
+
+    Vector3 p = modelview.multiply(Vector3(pos.x, pos.y, 0.0f));
+
+    surface.draw(SurfaceDrawingParameters()
+                 .set_angle(angle)
+                 .set_pos(Vector2f(p.x - surface.get_width()/2,
+                                   p.y - surface.get_height()/2)));
+
+    glPopMatrix();
+  }
+};
+
 DrawingContext::DrawingContext()
 {
   modelview_stack.push_back(Matrix::identity());
@@ -289,6 +327,12 @@
 }
 
 void
+DrawingContext::draw_control(const Surface surface, const Vector2f& pos, float angle, float z_pos)
+{
+  draw(new ControlDrawingRequest(surface, pos, angle, z_pos, modelview_stack.back()));
+}
+
+void
 DrawingContext::fill_screen(const Color& color)
 {
   draw(new FillScreenDrawingRequest(color));

Modified: trunk/windstille/src/display/drawing_context.hpp
===================================================================
--- trunk/windstille/src/display/drawing_context.hpp	2009-04-01 03:25:28 UTC (rev 2843)
+++ trunk/windstille/src/display/drawing_context.hpp	2009-04-01 15:44:54 UTC (rev 2844)
@@ -79,6 +79,7 @@
   void draw(const Surface surface, const SurfaceDrawingParameters& params, float z_pos = 0);
   void draw(const Surface surface, const Vector2f& pos, const Quad& quad,
             const DrawingParameters& params, float z_pos = 0);
+  void draw_control(const Surface surface, const Vector2f& pos, float angle, float z_pos = 0);
   /*} */
   
   /** Translate the drawing context */

Modified: trunk/windstille/src/display/surface.cpp
===================================================================
--- trunk/windstille/src/display/surface.cpp	2009-04-01 03:25:28 UTC (rev 2843)
+++ trunk/windstille/src/display/surface.cpp	2009-04-01 15:44:54 UTC (rev 2844)
@@ -154,7 +154,7 @@
 
   Quad quad(params.pos.x, 
             params.pos.y,
-            params.pos.x + impl->size.width * params.scale.x, 
+            params.pos.x + impl->size.width  * params.scale.x, 
             params.pos.y + impl->size.height * params.scale.y);
 
   quad.rotate(params.angle);



From grumbel at mail.berlios.de  Wed Apr  1 17:56:27 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 1 Apr 2009 17:56:27 +0200
Subject: [Windstille-commit] r2845 - in trunk/windstille: data/editor
	src/editor
Message-ID: <200904011556.n31FuRpA030193@sheep.berlios.de>

Author: grumbel
Date: 2009-04-01 17:56:26 +0200 (Wed, 01 Apr 2009)
New Revision: 2845

Added:
   trunk/windstille/data/editor/handle.png
   trunk/windstille/data/editor/rotate_handle.png
   trunk/windstille/data/editor/scale_handle.png
Modified:
   trunk/windstille/src/editor/control_point.cpp
   trunk/windstille/src/editor/control_point.hpp
   trunk/windstille/src/editor/decal_object_model.cpp
   trunk/windstille/src/editor/decal_object_model.hpp
   trunk/windstille/src/editor/object_model.cpp
   trunk/windstille/src/editor/object_model.hpp
   trunk/windstille/src/editor/selection.cpp
   trunk/windstille/src/editor/selection.hpp
Log:
added graphical ControlPoint handles

Added: trunk/windstille/data/editor/handle.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/editor/handle.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/editor/rotate_handle.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/editor/rotate_handle.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/editor/scale_handle.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/editor/scale_handle.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/windstille/src/editor/control_point.cpp
===================================================================
--- trunk/windstille/src/editor/control_point.cpp	2009-04-01 15:44:54 UTC (rev 2844)
+++ trunk/windstille/src/editor/control_point.cpp	2009-04-01 15:56:26 UTC (rev 2845)
@@ -23,11 +23,12 @@
 ControlPointHandle
 ControlPoint::create(const Vector2f& pos)
 {
-  return ControlPointHandle(new ControlPoint(pos));
+  return ControlPointHandle(new ControlPoint(Surface("editor/handle.png"), pos));
 }
 
-ControlPoint::ControlPoint(const Vector2f& pos_)
-  : pos(pos_)
+ControlPoint::ControlPoint(const Surface& surface_, const Vector2f& pos_)
+  : surface(surface_),
+    pos(pos_)
 {
 }
 
@@ -60,7 +61,7 @@
 Rectf
 ControlPoint::get_bounding_box() const
 {
-  return Rectf(pos - Vector2f(8.0f, 8.0f), Sizef(16.0f ,16.0f));
+  return Rectf(pos - Vector2f(11.0f, 11.0f), Sizef(22.0f, 22.0f));
 }
 
 void
@@ -70,8 +71,9 @@
 
   rect += offset;
 
-  sc.control().fill_rect(rect.grow(4.0f), Color(0.0f, 0.0f, 0.0f));
-  sc.control().fill_rect(rect, Color(1.0f, 0.0f, 0.0f));
+  //sc.control().fill_rect(rect.grow(4.0f), Color(0.0f, 0.0f, 0.0f));
+  //sc.control().fill_rect(rect, Color(1.0f, 0.0f, 0.0f));
+  sc.control().draw_control(surface, pos, 0.0f);
 }
 
 /* EOF */

Modified: trunk/windstille/src/editor/control_point.hpp
===================================================================
--- trunk/windstille/src/editor/control_point.hpp	2009-04-01 15:44:54 UTC (rev 2844)
+++ trunk/windstille/src/editor/control_point.hpp	2009-04-01 15:56:26 UTC (rev 2845)
@@ -20,6 +20,8 @@
 #define HEADER_WINDSTILLE_EDITOR_CONTROL_POINT_HPP
 
 #include <boost/shared_ptr.hpp>
+
+#include "display/surface.hpp"
 #include "math/rect.hpp"
 #include "math/vector2f.hpp"
 
@@ -33,16 +35,17 @@
   static ControlPointHandle create(const Vector2f& pos);
 
 protected:
-  Vector2f     pos;
+  Surface   surface;
+  Vector2f  pos;
   Vector2f  offset;
 
 public:
-  ControlPoint(const Vector2f& pos);
-  ~ControlPoint();
+  ControlPoint(const Surface& surface, const Vector2f& pos);
+  virtual ~ControlPoint();
   
-  void draw(SceneContext& sc);
+  virtual void draw(SceneContext& sc);
 
-  Rectf get_bounding_box() const;
+  virtual Rectf get_bounding_box() const;
 
   virtual void on_move_start();
   virtual void on_move_update(const Vector2f& offset);

Modified: trunk/windstille/src/editor/decal_object_model.cpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.cpp	2009-04-01 15:44:54 UTC (rev 2844)
+++ trunk/windstille/src/editor/decal_object_model.cpp	2009-04-01 15:56:26 UTC (rev 2845)
@@ -117,6 +117,13 @@
   return r;
 }
 
+void
+DecalObjectModel::reset()
+{
+  scale = Vector2f(1.0f, 1.0f);
+  angle = 0.0f;
+}
+
 ObjectModelHandle
 DecalObjectModel::clone() const
 {
@@ -139,16 +146,18 @@
 {
 private:
   DecalObjectModel* object;
+  float ctrl_angle;
   float orig_angle;
   Vector2f center;
 
 public:
-  DecalRotateControlPoint(DecalObjectModel* object_, const Vector2f& pos_)
-    : ControlPoint(pos_),
+  DecalRotateControlPoint(DecalObjectModel* object_, float ctrl_angle_, const Vector2f& pos_)
+    : ControlPoint(Surface("editor/rotate_handle.png"), pos_),
       object(object_),
+      ctrl_angle(ctrl_angle_),
       orig_angle(object->get_angle()),
       center(object->get_world_pos())
-    {
+  {
   }
 
   void on_move_start() 
@@ -173,6 +182,15 @@
   {
     on_move_update(offset_);
   }
+
+  void draw(SceneContext& sc)
+  {
+    Rectf rect = get_bounding_box();
+
+    rect += offset;
+
+    sc.control().draw_control(surface, pos, ctrl_angle);
+  }
 };
 
 class DecalScaleControlPoint : public ControlPoint
@@ -183,7 +201,7 @@
 
 public:
   DecalScaleControlPoint(DecalObjectModel* object_, const Vector2f& pos_)
-    : ControlPoint(pos_),
+    : ControlPoint(Surface("editor/scale_handle.png"), pos_),
       object(object_),
       orig_scale(object_->get_scale())
   {}
@@ -224,11 +242,10 @@
   control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, get_world_pos() - Vector2f( w,  h))));
   control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, get_world_pos() - Vector2f(-w,  h))));
 
-
-  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, get_world_pos() - Vector2f( w,  0))));
-  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, get_world_pos() - Vector2f(-w,  0))));
-  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, get_world_pos() - Vector2f( 0,  h))));
-  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, get_world_pos() - Vector2f( 0, -h))));
+  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, M_PI, get_world_pos() - Vector2f(-32-w, -32-h))));
+  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, M_PI+M_PI/2, get_world_pos() - Vector2f(32+w, -32-h))));
+  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, M_PI+2*M_PI/2, get_world_pos() - Vector2f(32+w,  32+h))));
+  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, M_PI+3*M_PI/2, get_world_pos() - Vector2f(-32-w, 32+h))));
 }
 
 /* EOF */

Modified: trunk/windstille/src/editor/decal_object_model.hpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.hpp	2009-04-01 15:44:54 UTC (rev 2844)
+++ trunk/windstille/src/editor/decal_object_model.hpp	2009-04-01 15:56:26 UTC (rev 2845)
@@ -59,6 +59,8 @@
   ObjectModelHandle clone() const;
   void write(FileWriter& writer) const;
 
+  void reset();
+
   void add_control_points(std::vector<ControlPointHandle>& control_points);
 };
 

Modified: trunk/windstille/src/editor/object_model.cpp
===================================================================
--- trunk/windstille/src/editor/object_model.cpp	2009-04-01 15:44:54 UTC (rev 2844)
+++ trunk/windstille/src/editor/object_model.cpp	2009-04-01 15:56:26 UTC (rev 2845)
@@ -152,6 +152,11 @@
   move_offset = Vector2f(0,0);
 }
 
+void
+ObjectModel::reset()
+{
+}
+
 static bool overlap(float l1, float r1,
                     float l2, float r2)
 {

Modified: trunk/windstille/src/editor/object_model.hpp
===================================================================
--- trunk/windstille/src/editor/object_model.hpp	2009-04-01 15:44:54 UTC (rev 2844)
+++ trunk/windstille/src/editor/object_model.hpp	2009-04-01 15:56:26 UTC (rev 2845)
@@ -72,6 +72,9 @@
 
   SnapData snap_object(const Rectf& rect) const;
 
+  /** Reset scale and rotation to default values */
+  virtual void reset();
+
   virtual bool is_snappable() const { return true; }
 
   virtual void draw(SceneContext& sc);

Modified: trunk/windstille/src/editor/selection.cpp
===================================================================
--- trunk/windstille/src/editor/selection.cpp	2009-04-01 15:44:54 UTC (rev 2844)
+++ trunk/windstille/src/editor/selection.cpp	2009-04-01 15:56:26 UTC (rev 2845)
@@ -187,9 +187,17 @@
 }
 
 void
+Selection::reset()
+{
+  for(Objects::const_iterator i = objects.begin(); i != objects.end(); ++i)
+    {
+      (*i)->reset();
+    }
+}
+
+void
 Selection::add_control_points(std::vector<ControlPointHandle>& control_points)
 {
-  std::cout << "Adding ControlPoints" << std::endl;
   if (!empty())
     {
       if (size() == 1)

Modified: trunk/windstille/src/editor/selection.hpp
===================================================================
--- trunk/windstille/src/editor/selection.hpp	2009-04-01 15:44:54 UTC (rev 2844)
+++ trunk/windstille/src/editor/selection.hpp	2009-04-01 15:56:26 UTC (rev 2845)
@@ -88,6 +88,8 @@
 
   Rectf get_bounding_box() const;
 
+  void reset();
+
   sigc::signal<void> signal_changed;
 
 private:



From grumbel at mail.berlios.de  Wed Apr  1 18:06:03 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 1 Apr 2009 18:06:03 +0200
Subject: [Windstille-commit] r2846 - trunk/windstille/src/editor
Message-ID: <200904011606.n31G63M3031319@sheep.berlios.de>

Author: grumbel
Date: 2009-04-01 18:06:03 +0200 (Wed, 01 Apr 2009)
New Revision: 2846

Modified:
   trunk/windstille/src/editor/decal_object_model.cpp
   trunk/windstille/src/editor/object_model.cpp
Log:
Force things to full integer positions

Modified: trunk/windstille/src/editor/decal_object_model.cpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.cpp	2009-04-01 15:56:26 UTC (rev 2845)
+++ trunk/windstille/src/editor/decal_object_model.cpp	2009-04-01 16:06:03 UTC (rev 2846)
@@ -73,8 +73,6 @@
   scale = scale_;
 }
 
-
-
 void
 DecalObjectModel::draw(SceneContext& sc)
 {

Modified: trunk/windstille/src/editor/object_model.cpp
===================================================================
--- trunk/windstille/src/editor/object_model.cpp	2009-04-01 15:56:26 UTC (rev 2845)
+++ trunk/windstille/src/editor/object_model.cpp	2009-04-01 16:06:03 UTC (rev 2846)
@@ -136,20 +136,34 @@
 
 void
 ObjectModel::on_move_start()
-{  
+{
 }
 
 void
 ObjectModel::on_move_update(const Vector2f& offset)
 {
-  move_offset = offset;
+  // Cut to integer positions
+  move_offset.x = floorf(offset.x);
+  move_offset.y = floorf(offset.y);
+
+  // Cut to integer positions
+  rel_pos.x = floorf(rel_pos.x);
+  rel_pos.y = floorf(rel_pos.y);
 }
 
 void
 ObjectModel::on_move_end(const Vector2f& offset)
 {
-  rel_pos += offset;
+  // Cut to integer positions
+  move_offset.x = floorf(offset.x);
+  move_offset.y = floorf(offset.y);
+
+  rel_pos += move_offset;
   move_offset = Vector2f(0,0);
+
+  // Cut to integer positions
+  rel_pos.x = floorf(rel_pos.x);
+  rel_pos.y = floorf(rel_pos.y);
 }
 
 void



From grumbel at mail.berlios.de  Thu Apr  2 05:01:06 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 2 Apr 2009 05:01:06 +0200
Subject: [Windstille-commit] r2847 - trunk/windstille/src/editor
Message-ID: <200904020301.n323162L025509@sheep.berlios.de>

Author: grumbel
Date: 2009-04-02 05:01:05 +0200 (Thu, 02 Apr 2009)
New Revision: 2847

Modified:
   trunk/windstille/src/editor/editor_window.cpp
Log:
Little adjustment to allow 3 icons side by side on default

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-01 16:06:03 UTC (rev 2846)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-02 03:01:05 UTC (rev 2847)
@@ -342,7 +342,7 @@
   vpaned.pack1(object_selector, Gtk::EXPAND);
   vpaned.pack2(layer_manager,     Gtk::SHRINK);
 
-  hpaned.set_position(1000);
+  hpaned.set_position(970);
   vpaned.set_position(420);
 
   // Window



From grumbel at mail.berlios.de  Thu Apr  2 17:55:38 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 2 Apr 2009 17:55:38 +0200
Subject: [Windstille-commit] r2848 - in trunk/windstille/data: editor
	images/decal sectors/trainstation
Message-ID: <200904021555.n32FtceR031681@sheep.berlios.de>

Author: grumbel
Date: 2009-04-02 17:54:25 +0200 (Thu, 02 Apr 2009)
New Revision: 2848

Added:
   trunk/windstille/data/editor/object_hflip.png
   trunk/windstille/data/editor/object_vflip.png
   trunk/windstille/data/images/decal/city_houseairvent.png
   trunk/windstille/data/images/decal/city_housewall.png
   trunk/windstille/data/images/decal/city_subway.png
   trunk/windstille/data/images/decal/city_window.png
   trunk/windstille/data/images/decal/cityground.png
   trunk/windstille/data/images/decal/citywall.png
   trunk/windstille/data/images/decal/container_background.png
   trunk/windstille/data/images/decal/container_corner.png
   trunk/windstille/data/images/decal/container_crack.png
   trunk/windstille/data/images/decal/container_gate.png
   trunk/windstille/data/images/decal/container_roof.png
   trunk/windstille/data/images/decal/container_roof2.png
   trunk/windstille/data/images/decal/container_side.png
   trunk/windstille/data/images/decal/explosion_decal.png
   trunk/windstille/data/images/decal/steelbox.png
   trunk/windstille/data/images/decal/steelbox_small.png
   trunk/windstille/data/sectors/trainstation/city.wst
   trunk/windstille/data/sectors/trainstation/container.wst
Modified:
   trunk/windstille/data/images/decal/mine_tree1.png
   trunk/windstille/data/images/decal/mine_tree2.png
   trunk/windstille/data/images/decal/stair2.png
Log:
Some new graphics and sectors

Added: trunk/windstille/data/editor/object_hflip.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/editor/object_hflip.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/editor/object_vflip.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/editor/object_vflip.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/city_houseairvent.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/city_houseairvent.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/city_housewall.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/city_housewall.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/city_subway.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/city_subway.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/city_window.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/city_window.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/cityground.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/cityground.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/citywall.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/citywall.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/container_background.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/container_background.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/container_corner.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/container_corner.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/container_crack.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/container_crack.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/container_gate.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/container_gate.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/container_roof.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/container_roof.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/container_roof2.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/container_roof2.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/container_side.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/container_side.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/explosion_decal.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/explosion_decal.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/windstille/data/images/decal/mine_tree1.png
===================================================================
(Binary files differ)

Modified: trunk/windstille/data/images/decal/mine_tree2.png
===================================================================
(Binary files differ)

Modified: trunk/windstille/data/images/decal/stair2.png
===================================================================
(Binary files differ)

Added: trunk/windstille/data/images/decal/steelbox.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/steelbox.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/steelbox_small.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/steelbox_small.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/sectors/trainstation/city.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/city.wst	2009-04-02 03:01:05 UTC (rev 2847)
+++ trunk/windstille/data/sectors/trainstation/city.wst	2009-04-02 15:54:25 UTC (rev 2848)
@@ -0,0 +1,783 @@
+;; -*- scheme -*-
+
+(windstille-sector
+  (version 2)
+  (name "")
+  (ambient-color 0 0 0 1)
+  (init-script "init.nut")
+  (layer
+    (name "Scene")
+    (visible 1)
+    (locked 0)
+    (objects)
+    (child-layers
+      (layer
+        (name "Light")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (id "0xa269120")
+            (pos 689 326)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light.png")
+            (type 1)
+            (scale 3.63751 2.04308)
+            (angle 0))
+          (decal
+            (id "0x9f1b858")
+            (pos -2229 315)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light.png")
+            (type 1)
+            (scale 3.7027 1.9346)
+            (angle 0))
+          (decal
+            (id "0xa283598")
+            (pos 2213 674)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light.png")
+            (type 1)
+            (scale 1.76741 2.13994)
+            (angle 0))
+          (decal
+            (id "0xa3659e8")
+            (pos 909 162)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light.png")
+            (type 1)
+            (scale 1.90027 1.81253)
+            (angle 0))
+          (decal
+            (id "0xa281620")
+            (pos -1070 626)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light.png")
+            (type 1)
+            (scale 1.5143 1.10403)
+            (angle 0))
+          (decal
+            (id "0xa365b78")
+            (pos -1064 624)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp_bloom.png")
+            (type 2)
+            (scale 1.34704 1.09163)
+            (angle 0)))
+        (child-layers
+          (layer
+            (name "Highlight")
+            (visible 1)
+            (locked 1)
+            (objects
+              (decal
+                (id "0xa3429b0")
+                (pos 836 212)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/rooflamp.png")
+                (type 0)
+                (scale 1.05279 1.05689)
+                (angle -1.56597))
+              (decal
+                (id "0xa361238")
+                (pos 985 221)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/rooflamp_bloom.png")
+                (type 2)
+                (scale 3.65012 5.58788)
+                (angle 1.47871))
+              (decal
+                (id "0xa276c88")
+                (pos 949 214)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/rooflamp_bloom.png")
+                (type 2)
+                (scale 0.961703 0.344589)
+                (angle 1.58209))
+              (decal
+                (id "0x9b682f0")
+                (pos -1207 634)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/lamp1.png")
+                (type 0)
+                (scale 1 1)
+                (angle 0))
+              (decal
+                (id "0xa211ae0")
+                (pos -910 639)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/lamp1.png")
+                (type 0)
+                (scale 1 1)
+                (angle 0))
+              (decal
+                (id "0xa2834c0")
+                (pos -912 619)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/lamp1_highlight.png")
+                (type 2)
+                (scale 1 1)
+                (angle 0))
+              (decal
+                (id "0xa280e08")
+                (pos -1208 615)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/lamp1_highlight.png")
+                (type 2)
+                (scale 1 1)
+                (angle 0)))
+            (child-layers))))
+      (layer
+        (name "Character")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (id "0xa26a168")
+            (pos 525 612)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/humanreference.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
+        (child-layers))
+      (layer
+        (name "Ground")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (id "0xa266918")
+            (pos 1271 855)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa275730")
+            (pos 759 855)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa257150")
+            (pos 247 855)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0x9f16d40")
+            (pos 2807 855)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa295d88")
+            (pos 2295 855)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa299e20")
+            (pos 1783 855)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa20d8e0")
+            (pos -777 855)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa272c00")
+            (pos -1289 855)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa261d90")
+            (pos -1801 855)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa261b00")
+            (pos -265 855)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa2988f0")
+            (pos -2313 855)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa299dd8")
+            (pos -2825 855)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa271d20")
+            (pos -3337 855)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
+        (child-layers))
+      (layer
+        (name "House2")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (id "0xa20cda8")
+            (pos 1470 471)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_subway.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
+        (child-layers))
+      (layer
+        (name "House")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (id "0xa2791b8")
+            (pos 217 471)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_housewall.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa2742b0")
+            (pos 217 -41)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_housewall.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa257198")
+            (pos 217 -553)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_housewall.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa276d90")
+            (pos 643 -38)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_houseairvent.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa20de18")
+            (pos 645 -550)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_houseairvent.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa279248")
+            (pos -131 -559)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa2785b0")
+            (pos 48 -558)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa272e30")
+            (pos 236 -556)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa20d990")
+            (pos -126 -45)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa293100")
+            (pos 53 -44)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa276358")
+            (pos 241 -42)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa26b150")
+            (pos 438 817)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 2.96695 1.58413)
+            (angle 0))
+          (decal
+            (id "0xa1428b0")
+            (pos -807 471)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_housewall.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa20da90")
+            (pos -807 -41)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_housewall.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa274200")
+            (pos -807 -553)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_housewall.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa257430")
+            (pos -1831 471)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_housewall.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa20df18")
+            (pos -1831 -41)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_housewall.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa274c78")
+            (pos -1831 -553)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_housewall.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa271bb0")
+            (pos 49 457)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/explosion_decal.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa342f28")
+            (pos -1495 498)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_crack.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa274580")
+            (pos -1003 -564)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0x9e88618")
+            (pos -824 -563)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa277e88")
+            (pos -636 -561)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0x9e89598")
+            (pos -998 -50)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa263590")
+            (pos -819 -49)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa274470")
+            (pos -631 -47)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa13f768")
+            (pos -1527 -34)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa294848")
+            (pos -1715 -39)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa279e40")
+            (pos -1894 -40)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa20d7f8")
+            (pos -1532 -563)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0x9ef9528")
+            (pos -1720 -565)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa272a48")
+            (pos -1899 -566)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0x9e0b6b0")
+            (pos -2237 -561)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_houseairvent.png")
+            (type 0)
+            (scale -1.23139 1.08248)
+            (angle 0))
+          (decal
+            (id "0xa279148")
+            (pos -2239 -41)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_houseairvent.png")
+            (type 0)
+            (scale -1.23139 1.08248)
+            (angle 0))
+          (decal
+            (id "0xa27ab90")
+            (pos -1061 582)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/door.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa13fb48")
+            (pos -810 477)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa275628")
+            (pos -628 478)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_window.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa277b40")
+            (pos -437 671)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/steelplate_crack.png")
+            (type 0)
+            (scale 1.09301 1.15319)
+            (angle 0)))
+        (child-layers))
+      (layer
+        (name "Shadow")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (id "0xa141470")
+            (pos 858 689)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1.55695 0.984741)
+            (angle 0))
+          (decal
+            (id "0xa276930")
+            (pos 704 418)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.786377 2.50299)
+            (angle 0))
+          (decal
+            (id "0xa2988a8")
+            (pos 1974 744)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1.22888 0.977112)
+            (angle 0))
+          (decal
+            (id "0xa284180")
+            (pos 1397 489)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 3.22015 1.55695)
+            (angle 0))
+          (decal
+            (id "0x9f16cd8")
+            (pos -2291 573)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1.49889 2.34289)
+            (angle 0))
+          (decal
+            (id "0xa27d5a8")
+            (pos -2855 737)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 2.52588 1.11444)
+            (angle 0)))
+        (child-layers))
+      (layer
+        (name "Wall")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (id "0xa274088")
+            (pos 613 398)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0))
+          (decal
+            (id "0xa295cf8")
+            (pos 1145 398)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0))
+          (decal
+            (id "0xa261960")
+            (pos 1677 397)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0))
+          (decal
+            (id "0xa273018")
+            (pos 2209 397)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0))
+          (decal
+            (id "0xa295e08")
+            (pos 2741 397)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0))
+          (decal
+            (id "0x9f16b08")
+            (pos -2731 398)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0))
+          (decal
+            (id "0xa141380")
+            (pos -2199 398)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0))
+          (decal
+            (id "0xa274d08")
+            (pos -3263 398)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0)))
+        (child-layers)))))
+
+;; EOF ;;

Added: trunk/windstille/data/sectors/trainstation/container.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/container.wst	2009-04-02 03:01:05 UTC (rev 2847)
+++ trunk/windstille/data/sectors/trainstation/container.wst	2009-04-02 15:54:25 UTC (rev 2848)
@@ -0,0 +1,678 @@
+;; -*- scheme -*-
+
+(windstille-sector
+  (version 2)
+  (name "")
+  (ambient-color 0 0 0 1)
+  (init-script "init.nut")
+  (layer
+    (name "Scene")
+    (visible 1)
+    (locked 0)
+    (objects)
+    (child-layers
+      (layer
+        (name "Character")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (id "0xa437ba0")
+            (pos 521 777)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/humanreference.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa437de8")
+            (pos 539 200)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1.49438 1.43945)
+            (angle 0))
+          (decal
+            (id "0xa437ea0")
+            (pos 451 331)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/explosion_decal.png")
+            (type 0)
+            (scale 1.40212 1.74096)
+            (angle 0))
+          (decal
+            (id "0xa437f90")
+            (pos 789 826)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/steelbox.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa436fd8")
+            (pos 917 826)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/steelbox.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa438610")
+            (pos 789 698)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/steelbox.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa4386b8")
+            (pos 917 698)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/steelbox.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa4387a0")
+            (pos 805 601)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/steelbox_small.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa438c90")
+            (pos 693 858)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/steelbox_small.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
+        (child-layers))
+      (layer
+        (name "Lights")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (id "0xa437ca8")
+            (pos 1087 797)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/lamp1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa438e08")
+            (pos -147 797)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/lamp1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa59ccb0")
+            (pos 1082 782)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/lamp1_highlight.png")
+            (type 2)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa59cda0")
+            (pos -148 782)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/lamp1_highlight.png")
+            (type 2)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa59ce90")
+            (pos -109 755)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light.png")
+            (type 1)
+            (scale 2.23024 0.952316)
+            (angle 0))
+          (decal
+            (id "0xa59cf70")
+            (pos 1091 786)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light.png")
+            (type 1)
+            (scale 2.23024 0.952316)
+            (angle 0))
+          (decal
+            (id "0xa435270")
+            (pos 981 182)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light.png")
+            (type 1)
+            (scale 2.35601 1.92387)
+            (angle 0))
+          (decal
+            (id "0xa435350")
+            (pos 1101 779)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light.png")
+            (type 2)
+            (scale 0.950408 0.128342)
+            (angle 0))
+          (decal
+            (id "0xa435430")
+            (pos -128 779)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light.png")
+            (type 2)
+            (scale 0.959945 0.142647)
+            (angle 0)))
+        (child-layers))
+      (layer
+        (name "Ground")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (id "0xa438d18")
+            (pos 663 -121)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_roof.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa435d98")
+            (pos 1047 -121)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_roof.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa4366b0")
+            (pos -105 -121)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_roof.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa436758")
+            (pos 1484 135)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa436818")
+            (pos 1484 263)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa436cc0")
+            (pos 1484 391)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa436d68")
+            (pos 1480 519)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa436e50")
+            (pos 1480 647)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa5942e8")
+            (pos 1367 -57)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_corner.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa59c5c0")
+            (pos -540 127)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale -1.02656 0.904633)
+            (angle 0))
+          (decal
+            (id "0xa59c7d8")
+            (pos 1373 903)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_corner.png")
+            (type 0)
+            (scale 1.49591 1.01907)
+            (angle 1.54812))
+          (decal
+            (id "0xa594ac0")
+            (pos -540 475)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale -1.02656 0.904633)
+            (angle 0))
+          (decal
+            (id "0xa594ba8")
+            (pos -540 591)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale -1.02656 0.904633)
+            (angle 0))
+          (decal
+            (id "0xa594c90")
+            (pos -540 707)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale -1.02656 0.904633)
+            (angle 0))
+          (decal
+            (id "0xa594d78")
+            (pos -425 -57)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_corner.png")
+            (type 0)
+            (scale 1 1)
+            (angle -1.60494))
+          (decal
+            (id "0xa594e68")
+            (pos -419 905)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_corner.png")
+            (type 0)
+            (scale 0.984741 1.09155)
+            (angle 3.11112))
+          (decal
+            (id "0xa594f58")
+            (pos -104 954)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_roof.png")
+            (type 0)
+            (scale 1 1)
+            (angle 3.14387))
+          (decal
+            (id "0xa595040")
+            (pos 280 954)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_roof.png")
+            (type 0)
+            (scale 1 1)
+            (angle 3.14387))
+          (decal
+            (id "0xa595128")
+            (pos 661 954)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_roof.png")
+            (type 0)
+            (scale 1 1)
+            (angle 3.14387))
+          (decal
+            (id "0xa595210")
+            (pos 1045 954)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_roof.png")
+            (type 0)
+            (scale 1 1)
+            (angle 3.14387))
+          (decal
+            (id "0xa5952f8")
+            (pos -544 401)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale -1.04999 0.326508)
+            (angle 0))
+          (decal
+            (id "0xa5953e0")
+            (pos 279 -97)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_roof2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
+        (child-layers))
+      (layer
+        (name "Stairs")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (id "0xa436be8")
+            (pos -389 447)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/stair1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa437ac8")
+            (pos -261 409)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/stair2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa59a9e0")
+            (pos -261 575)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/stair1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa59aa80")
+            (pos -133 537)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/stair2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa59bba0")
+            (pos -133 703)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/stair1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa59bc78")
+            (pos -5 665)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/stair2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa59bd58")
+            (pos -5 831)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/stair1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa59be38")
+            (pos 123 793)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/stair2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
+        (child-layers))
+      (layer
+        (name "Shadow")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (id "0xa5955a0")
+            (pos 429 -18)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 4.3617 0.916553)
+            (angle 0))
+          (decal
+            (id "0xa59c088")
+            (pos -264 91)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1.60797 1.59605)
+            (angle 0))
+          (decal
+            (id "0xa59c168")
+            (pos 1200 36)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1.60797 1.59605)
+            (angle 0))
+          (decal
+            (id "0xa59c248")
+            (pos 481 562)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.517823 1.49438)
+            (angle 0))
+          (decal
+            (id "0xa59c328")
+            (pos 804 479)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.121094 0.865723)
+            (angle 0))
+          (decal
+            (id "0xa676570")
+            (pos 821 347)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.456787 0.414063)
+            (angle 0))
+          (decal
+            (id "0xa676a30")
+            (pos 854 439)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.125254 0.663415)
+            (angle 0))
+          (decal
+            (id "0xa676b10")
+            (pos 713 859)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.560547 0.511719)
+            (angle 0))
+          (decal
+            (id "0xa676bf0")
+            (pos 976 842)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.54834 0.737549)
+            (angle 0))
+          (decal
+            (id "0xa676cd0")
+            (pos 818 723)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
+        (child-layers))
+      (layer
+        (name "Door")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (id "0xa59bf48")
+            (pos 338 745)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/door.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
+        (child-layers))
+      (layer
+        (name "Background")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (id "0xa679440")
+            (pos -15 424)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa6750e0")
+            (pos 973 427)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa675190")
+            (pos 549 839)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/steelplate_crack.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa675240")
+            (pos -181 185)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_crack.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa6752f0")
+            (pos 1267 845)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_crack.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0))
+          (decal
+            (id "0xa6753e0")
+            (pos 1209 472)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.640625 0.746094)
+            (angle 0))
+          (decal
+            (id "0xa6754c0")
+            (pos 1192 578)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.142578 0.601562)
+            (angle 0))
+          (decal
+            (id "0xa6755a0")
+            (pos 1206 450)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.535156 0.523438)
+            (angle 0))
+          (decal
+            (id "0xa675680")
+            (pos 1241 553)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.078125 0.478516)
+            (angle 0))
+          (decal
+            (id "0xa675760")
+            (pos 1206 435)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_gate.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)))
+        (child-layers)))))
+
+;; EOF ;;



From grumbel at mail.berlios.de  Thu Apr  2 17:55:50 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 2 Apr 2009 17:55:50 +0200
Subject: [Windstille-commit] r2849 - trunk/windstille/src/util
Message-ID: <200904021555.n32FtotQ031729@sheep.berlios.de>

Author: grumbel
Date: 2009-04-02 17:55:49 +0200 (Thu, 02 Apr 2009)
New Revision: 2849

Modified:
   trunk/windstille/src/util/file_writer.cpp
Log:
Fixed bug in bool writing

Modified: trunk/windstille/src/util/file_writer.cpp
===================================================================
--- trunk/windstille/src/util/file_writer.cpp	2009-04-02 15:54:25 UTC (rev 2848)
+++ trunk/windstille/src/util/file_writer.cpp	2009-04-02 15:55:49 UTC (rev 2849)
@@ -67,7 +67,7 @@
 FileWriter::write(const std::string& name, bool value)
 {
   indent();
-  out << "(" << name << " " << value << ")";
+  out << "(" << name << " " << (value?"#t":"#f") << ")";
   return *this;
 }
 



From grumbel at mail.berlios.de  Thu Apr  2 17:58:54 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 2 Apr 2009 17:58:54 +0200
Subject: [Windstille-commit] r2850 - trunk/windstille/src/editor
Message-ID: <200904021558.n32FwsVg032029@sheep.berlios.de>

Author: grumbel
Date: 2009-04-02 17:58:54 +0200 (Thu, 02 Apr 2009)
New Revision: 2850

Modified:
   trunk/windstille/src/editor/object_selector.cpp
   trunk/windstille/src/editor/object_selector.hpp
Log:
Added ObjectSelector Toolbar

Modified: trunk/windstille/src/editor/object_selector.cpp
===================================================================
--- trunk/windstille/src/editor/object_selector.cpp	2009-04-02 15:55:49 UTC (rev 2849)
+++ trunk/windstille/src/editor/object_selector.cpp	2009-04-02 15:58:54 UTC (rev 2850)
@@ -19,8 +19,11 @@
 #include <iostream>
 #include <boost/function.hpp>
 #include <gtkmm/treeselection.h>
+#include <gtkmm/stock.h>
+#include <gtkmm/toolbar.h>
 #include <gtkmm/treemodelcolumn.h>
 
+#include "editor_window.hpp"
 #include "object_selector.hpp"
 
 class ObjectIconColumns : public Gtk::TreeModel::ColumnRecord
@@ -47,9 +50,26 @@
 
 ObjectIconColumns* ObjectIconColumns::instance_ = 0;
 
-ObjectSelector::ObjectSelector()
-  : label("Object Selector", Gtk::ALIGN_LEFT)
+ObjectSelector::ObjectSelector(EditorWindow& editor_)
+  : editor(editor_),
+    label("Object Selector", Gtk::ALIGN_LEFT)
 {
+  Glib::RefPtr<Gtk::UIManager>   ui_manager   = editor.get_ui_manager();
+  Glib::RefPtr<Gtk::ActionGroup> action_group = Gtk::ActionGroup::create();
+
+  action_group->add(Gtk::Action::create("ObjectSelectorRefresh", Gtk::Stock::REFRESH),
+                    sigc::mem_fun(*this, &ObjectSelector::refresh));
+
+  ui_manager->insert_action_group(action_group);
+
+  ui_manager->add_ui_from_string("<ui>"
+                                 "  <toolbar name='ObjectSelectorToolBar'>"
+                                 "    <toolitem action='ObjectSelectorRefresh'/>"
+                                 "  </toolbar>"
+                                 "</ui>");
+
+  Gtk::Toolbar& toolbar = dynamic_cast<Gtk::Toolbar&>(*ui_manager->get_widget("/ObjectSelectorToolBar"));
+  
   list_store = Gtk::ListStore::create(ObjectIconColumns::instance());
 
   // Change background color
@@ -78,8 +98,9 @@
 
   scrolled.add(iconview);
   pack_start(label, Gtk::PACK_SHRINK);
+
+  pack_start(toolbar, Gtk::PACK_SHRINK);
   add(scrolled);
-  
   //show_all();
 }
 
@@ -96,6 +117,12 @@
   (*it)[ObjectIconColumns::instance().pathname] = pathname;
   (*it)[ObjectIconColumns::instance().icon]     = icon;
 }
+
+void
+ObjectSelector::refresh()
+{
+  std::cout << "Refresh" << std::endl;
+}
                     
 void
 ObjectSelector::on_drag_begin(const Glib::RefPtr<Gdk::DragContext>& context)

Modified: trunk/windstille/src/editor/object_selector.hpp
===================================================================
--- trunk/windstille/src/editor/object_selector.hpp	2009-04-02 15:55:49 UTC (rev 2849)
+++ trunk/windstille/src/editor/object_selector.hpp	2009-04-02 15:58:54 UTC (rev 2850)
@@ -26,21 +26,27 @@
 #include <gdkmm/dragcontext.h>
 #include <gtkmm/iconview.h>
 
+class EditorWindow;
+
 class ObjectSelector : public Gtk::VBox
 {
 private:
+  EditorWindow& editor;
+
   Gtk::Label label;
   Gtk::ScrolledWindow scrolled;
   Gtk::IconView iconview;
   Glib::RefPtr<Gtk::ListStore> list_store;
   
 public:
-  ObjectSelector();
+  ObjectSelector(EditorWindow& editor);
   virtual ~ObjectSelector();
 
   void add_object(const std::string& pathname,
                   const Glib::RefPtr<Gdk::Pixbuf>& icon);
 
+  void refresh();
+
 protected:
   void on_drag_begin(const Glib::RefPtr<Gdk::DragContext>& context);
   void on_drag_data_get(const Glib::RefPtr<Gdk::DragContext>& context,



From grumbel at mail.berlios.de  Thu Apr  2 17:59:55 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 2 Apr 2009 17:59:55 +0200
Subject: [Windstille-commit] r2851 - in trunk/windstille/src: display editor
Message-ID: <200904021559.n32Fxtxh032190@sheep.berlios.de>

Author: grumbel
Date: 2009-04-02 17:59:55 +0200 (Thu, 02 Apr 2009)
New Revision: 2851

Modified:
   trunk/windstille/src/display/surface.cpp
   trunk/windstille/src/display/surface_drawing_parameters.hpp
   trunk/windstille/src/editor/decal_object_model.cpp
   trunk/windstille/src/editor/decal_object_model.hpp
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/object_model.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
   trunk/windstille/src/editor/windstille_widget.hpp
Log:
Added vertical/horizontal object flipping

Modified: trunk/windstille/src/display/surface.cpp
===================================================================
--- trunk/windstille/src/display/surface.cpp	2009-04-02 15:58:54 UTC (rev 2850)
+++ trunk/windstille/src/display/surface.cpp	2009-04-02 15:59:55 UTC (rev 2851)
@@ -152,6 +152,14 @@
 
   glBegin(GL_QUADS);
 
+  Rectf uv = impl->uv;
+
+  if (params.hflip)
+    std::swap(uv.left, uv.right);
+
+  if (params.vflip)
+    std::swap(uv.top, uv.bottom);
+
   Quad quad(params.pos.x, 
             params.pos.y,
             params.pos.x + impl->size.width  * params.scale.x, 
@@ -159,16 +167,16 @@
 
   quad.rotate(params.angle);
   
-  glTexCoord2f(impl->uv.left, impl->uv.top);
+  glTexCoord2f(uv.left, uv.top);
   glVertex2f(quad.p1.x, quad.p1.y);
 
-  glTexCoord2f(impl->uv.right, impl->uv.top);
+  glTexCoord2f(uv.right, uv.top);
   glVertex2f(quad.p2.x, quad.p2.y);
 
-  glTexCoord2f(impl->uv.right, impl->uv.bottom);
+  glTexCoord2f(uv.right, uv.bottom);
   glVertex2f(quad.p3.x, quad.p3.y);
 
-  glTexCoord2f(impl->uv.left, impl->uv.bottom);
+  glTexCoord2f(uv.left, uv.bottom);
   glVertex2f(quad.p4.x, quad.p4.y);
 
   glEnd(); 

Modified: trunk/windstille/src/display/surface_drawing_parameters.hpp
===================================================================
--- trunk/windstille/src/display/surface_drawing_parameters.hpp	2009-04-02 15:58:54 UTC (rev 2850)
+++ trunk/windstille/src/display/surface_drawing_parameters.hpp	2009-04-02 15:59:55 UTC (rev 2851)
@@ -42,6 +42,9 @@
 
   Vector2f scale;
 
+  bool hflip;
+  bool vflip;
+
   SurfaceDrawingParameters()
   {
     blendfunc_src = GL_SRC_ALPHA;
@@ -53,6 +56,9 @@
   
     angle = 0.0f;
     scale    = Vector2f(1.0f, 1.0f);
+
+    hflip = false;
+    vflip = false;
   }
 
   SurfaceDrawingParameters& set_scale(float s) 
@@ -84,6 +90,18 @@
     pos = p;
     return *this;
   }
+
+  SurfaceDrawingParameters& set_hflip(bool v)
+  {
+    hflip = v;
+    return *this;
+  }
+
+  SurfaceDrawingParameters& set_vflip(bool v)
+  {
+    vflip = v;
+    return *this;
+  }
   
   SurfaceDrawingParameters& set_blend_func(GLenum src, GLenum dst) 
   { 

Modified: trunk/windstille/src/editor/decal_object_model.cpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.cpp	2009-04-02 15:58:54 UTC (rev 2850)
+++ trunk/windstille/src/editor/decal_object_model.cpp	2009-04-02 15:59:55 UTC (rev 2851)
@@ -34,7 +34,9 @@
 DecalObjectModel::DecalObjectModel(const FileReader& reader)
   : ObjectModel(reader),
     scale(1.0f, 1.0f),
-    angle(0.0f)
+    angle(0.0f),
+    hflip(false),
+    vflip(false)
 {
   int map_type = 0;
   reader.get("path", path);
@@ -43,6 +45,8 @@
 
   reader.get("scale", scale);
   reader.get("angle", angle);
+  reader.get("hflip", hflip);
+  reader.get("vflip", vflip);
   surface = Surface(path);
 }
 
@@ -53,7 +57,9 @@
     surface(path_),
     type(type_),
     scale(1.0f, 1.0f),
-    angle(0.0f)
+    angle(0.0f),
+    hflip(false),
+    vflip(false)
 {
 }
 
@@ -97,6 +103,8 @@
   dc->draw(surface, params
            .set_pos(wo_pos + center_offset)
            .set_angle(angle)
+           .set_hflip(hflip)
+           .set_vflip(vflip)
            .set_scale(scale));
 }
 
@@ -137,6 +145,8 @@
   writer.write("type",    type);
   writer.write("scale",   scale);
   writer.write("angle",   angle);
+  writer.write("hflip",   hflip);
+  writer.write("vflip",   vflip);
   writer.end_section();
 }
 

Modified: trunk/windstille/src/editor/decal_object_model.hpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.hpp	2009-04-02 15:58:54 UTC (rev 2850)
+++ trunk/windstille/src/editor/decal_object_model.hpp	2009-04-02 15:59:55 UTC (rev 2851)
@@ -41,6 +41,9 @@
 
   float    angle;
 
+  bool hflip;
+  bool vflip;
+
 public:
   DecalObjectModel(const FileReader& reader);
   DecalObjectModel(const std::string& name, const Vector2f& rel_pos, 
@@ -59,6 +62,12 @@
   ObjectModelHandle clone() const;
   void write(FileWriter& writer) const;
 
+  bool get_hflip() const { return hflip; }
+  bool get_vflip() const { return vflip; }
+
+  void set_hflip(bool t) { hflip = t; }
+  void set_vflip(bool t) { vflip = t; }
+
   void reset();
 
   void add_control_points(std::vector<ControlPointHandle>& control_points);

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-02 15:58:54 UTC (rev 2850)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-02 15:59:55 UTC (rev 2851)
@@ -46,6 +46,7 @@
   : ui_manager(Gtk::UIManager::create()),
     action_group(Gtk::ActionGroup::create()),
     glconfig(glconfig_),
+    object_selector(*this),
     layer_manager(*this),
     minimap_widget(glconfig_),
     select_tool(new SelectTool()),
@@ -87,6 +88,9 @@
     "      <menuitem action='LowerObject'/>"
     "      <menuitem action='LowerObjectToBottom'/>"
     "      <separator/>"
+    "      <menuitem action='HFlipObject'/>"
+    "      <menuitem action='VFlipObject'/>"
+    "      <separator/>"
     "      <menuitem action='ConnectParent'/>"
     "      <menuitem action='ClearParent'/>"
     "      <separator/>"
@@ -153,6 +157,9 @@
     "    <toolitem action='RaiseObject'/>"
     "    <toolitem action='RaiseObjectToTop'/>"
     "    <separator/>"
+    "    <toolitem action='HFlipObject'/>"
+    "    <toolitem action='VFlipObject'/>"
+    "    <separator/>"
     "    <toolitem action='ConnectParent'/>"
     "    <toolitem action='ClearParent'/>"
     "    <separator/>"
@@ -236,6 +243,10 @@
   action_group->add(Gtk::Action::create_with_icon_name("ClearParent", "clear_parent", "Clear Parent", "Clear Parent"),
                     sigc::bind(sigc::mem_fun(*this, &EditorWindow::call_with_windstille_widget), &WindstilleWidget::selection_clear_parent));
 
+  action_group->add(Gtk::Action::create_with_icon_name("HFlipObject", "object_hflip", "Horizontal Flip", "Horizontal Flip"),
+                    sigc::bind(sigc::mem_fun(*this, &EditorWindow::call_with_windstille_widget), &WindstilleWidget::selection_hflip));
+  action_group->add(Gtk::Action::create_with_icon_name("VFlipObject", "object_vflip", "Vertical Flip", "Vertical Flip"),
+                    sigc::bind(sigc::mem_fun(*this, &EditorWindow::call_with_windstille_widget), &WindstilleWidget::selection_vflip));
 
   action_group->add(Gtk::Action::create("MenuView",    "_View"));
   action_group->add(Gtk::Action::create("Zoom100",     Gtk::Stock::ZOOM_100),

Modified: trunk/windstille/src/editor/object_model.hpp
===================================================================
--- trunk/windstille/src/editor/object_model.hpp	2009-04-02 15:58:54 UTC (rev 2850)
+++ trunk/windstille/src/editor/object_model.hpp	2009-04-02 15:59:55 UTC (rev 2851)
@@ -72,6 +72,12 @@
 
   SnapData snap_object(const Rectf& rect) const;
 
+  virtual bool get_hflip() const { return false; }
+  virtual bool get_vflip() const { return false; }
+
+  virtual void set_hflip(bool) { }
+  virtual void set_vflip(bool) { }
+
   /** Reset scale and rotation to default values */
   virtual void reset();
 

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-02 15:58:54 UTC (rev 2850)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-02 15:59:55 UTC (rev 2851)
@@ -300,6 +300,26 @@
 }
 
 void
+WindstilleWidget::selection_vflip()
+{
+ for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
+    {
+      (*i)->set_vflip(!(*i)->get_vflip());
+    }
+  queue_draw();
+}
+
+void
+WindstilleWidget::selection_hflip()
+{
+ for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
+    {
+      (*i)->set_hflip(!(*i)->get_hflip());
+    }
+  queue_draw();
+}
+
+void
 WindstilleWidget::selection_connect_parent()
 {
   if (selection->size() >= 2)

Modified: trunk/windstille/src/editor/windstille_widget.hpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.hpp	2009-04-02 15:58:54 UTC (rev 2850)
+++ trunk/windstille/src/editor/windstille_widget.hpp	2009-04-02 15:59:55 UTC (rev 2851)
@@ -106,6 +106,9 @@
   void selection_raise_to_top();
   void selection_lower_to_bottom();
 
+  void selection_vflip();
+  void selection_hflip();
+
   void selection_connect_parent();
   void selection_clear_parent();
   



From grumbel at mail.berlios.de  Thu Apr  2 18:00:13 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 2 Apr 2009 18:00:13 +0200
Subject: [Windstille-commit] r2852 - trunk/windstille
Message-ID: <200904021600.n32G0CmE032321@sheep.berlios.de>

Author: grumbel
Date: 2009-04-02 18:00:12 +0200 (Thu, 02 Apr 2009)
New Revision: 2852

Modified:
   trunk/windstille/TODO
Log:
TODO updates

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-04-02 15:59:55 UTC (rev 2851)
+++ trunk/windstille/TODO	2009-04-02 16:00:12 UTC (rev 2852)
@@ -488,6 +488,10 @@
 Graphics
 ========
 
+* generate .png's directly from .xcf's
+
+* figure out a way how to properly organize graphics/decal
+
 * Model lower-poly version of Jane and stuff
 
 * aspect-ratio/resolution options:
@@ -503,6 +507,24 @@
 Editor
 ======
 
+* (id ...) is a string'ified pointer, while this work, this causes the
+  levels to be different after each and every load/save cycle, should
+  be something more constant
+
+* scale drag&drop sprite to current zoom level
+
+* add rectangle overlay that indicates the visible area of the game (i.e. one screen in current zoom size
+
+* add flip for decal
+
+* bounding rect doesn't rotate, controls don't rotate
+
+* ControlPoint bounding rect scales, which it shouldn't, ControlPoint
+  offset does to (scale and rotate handles get close together when
+  zooming out)
+
+* reduce icon padding in the ObjectSelector
+
 * implement Blender-like grab-handles, that toggle between
   scale/rotation/etc., but also allow limit of move along the x- or
   y-axis
@@ -517,7 +539,7 @@
 * add more ways to snapping objects:
 
   - snap to snap-points
-  - snap to integer positions (IMPORTANT)
+  - snap to integer positions (done, but should be optional, won't work with scale/rotate)
   - snap to grid (IMPORTANT)
 
 * reevaluate the current parent/child implementation, since its very
@@ -614,6 +636,7 @@
   - mark all objects
   - delete object
   - duplicate object
+  - next/previous layer: Ctrl-PageUp/Down
 
 * add second toolbar, first one is getting a little crowded
 



From grumbel at mail.berlios.de  Thu Apr  2 18:19:06 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 2 Apr 2009 18:19:06 +0200
Subject: [Windstille-commit] r2853 - trunk/windstille/src/math
Message-ID: <200904021619.n32GJ6cS001725@sheep.berlios.de>

Author: grumbel
Date: 2009-04-02 18:19:06 +0200 (Thu, 02 Apr 2009)
New Revision: 2853

Modified:
   trunk/windstille/src/math/rect.hpp
Log:
Added get_center()

Modified: trunk/windstille/src/math/rect.hpp
===================================================================
--- trunk/windstille/src/math/rect.hpp	2009-04-02 16:00:12 UTC (rev 2852)
+++ trunk/windstille/src/math/rect.hpp	2009-04-02 16:19:06 UTC (rev 2853)
@@ -370,6 +370,11 @@
     bottom += offset.y;
   }
 
+  Vector2f get_center() const {
+    return Vector2f((left + right) / 2.0f,
+                    (top + bottom) / 2.0f);
+  }
+
   // Moves each edge f away from the center, thus width = old_width + 2*f
   Rectf grow(float f) const {
     return Rectf(left   - f, 



From grumbel at mail.berlios.de  Thu Apr  2 18:19:38 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 2 Apr 2009 18:19:38 +0200
Subject: [Windstille-commit] r2854 - trunk/windstille/src/editor
Message-ID: <200904021619.n32GJcTD001800@sheep.berlios.de>

Author: grumbel
Date: 2009-04-02 18:19:38 +0200 (Thu, 02 Apr 2009)
New Revision: 2854

Modified:
   trunk/windstille/src/editor/windstille_widget.cpp
Log:
Properly handle position in flipping selections greater then 1

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-02 16:19:06 UTC (rev 2853)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-02 16:19:38 UTC (rev 2854)
@@ -302,21 +302,53 @@
 void
 WindstilleWidget::selection_vflip()
 {
- for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
+  if (!selection->empty())
     {
-      (*i)->set_vflip(!(*i)->get_vflip());
+      if (selection->size() > 1)
+        {
+          const Vector2f& center = selection->get_bounding_box().get_center();
+          for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
+            {
+              Vector2f pos = (*i)->get_rel_pos();
+          
+              pos.y = center.y + (center.y - pos.y);
+          
+              (*i)->set_rel_pos(pos);
+            }
+        }
+
+      for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
+        {
+          (*i)->set_vflip(!(*i)->get_vflip());
+        }
+      queue_draw();
     }
-  queue_draw();
 }
 
 void
 WindstilleWidget::selection_hflip()
 {
- for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
+  if (!selection->empty())
     {
-      (*i)->set_hflip(!(*i)->get_hflip());
+      if (selection->size() > 1)
+        {
+          const Vector2f& center = selection->get_bounding_box().get_center();
+          for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
+            {
+              Vector2f pos = (*i)->get_rel_pos();
+          
+              pos.x = center.x + (center.x - pos.x);
+          
+              (*i)->set_rel_pos(pos);
+            }
+        }
+
+      for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
+        {
+          (*i)->set_hflip(!(*i)->get_hflip());
+        }
+      queue_draw();
     }
-  queue_draw();
 }
 
 void



From grumbel at mail.berlios.de  Thu Apr  2 18:33:29 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 2 Apr 2009 18:33:29 +0200
Subject: [Windstille-commit] r2855 - trunk/windstille/src/editor
Message-ID: <200904021633.n32GXTpx005206@sheep.berlios.de>

Author: grumbel
Date: 2009-04-02 18:33:27 +0200 (Thu, 02 Apr 2009)
New Revision: 2855

Modified:
   trunk/windstille/src/editor/object_model.cpp
   trunk/windstille/src/editor/object_model.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
Log:
Fixed parent flipping a bit, still broken, but somewhat less broken then before

Modified: trunk/windstille/src/editor/object_model.cpp
===================================================================
--- trunk/windstille/src/editor/object_model.cpp	2009-04-02 16:19:38 UTC (rev 2854)
+++ trunk/windstille/src/editor/object_model.cpp	2009-04-02 16:33:27 UTC (rev 2855)
@@ -122,6 +122,15 @@
 }
 
 void
+ObjectModel::set_world_pos(const Vector2f& p)
+{
+  if (parent_ptr.lock())
+    rel_pos += p - get_world_pos();
+  else
+    rel_pos = p;
+}
+
+void
 ObjectModel::draw(SceneContext& sc)
 {
   Vector2f wo_pos = get_world_pos();

Modified: trunk/windstille/src/editor/object_model.hpp
===================================================================
--- trunk/windstille/src/editor/object_model.hpp	2009-04-02 16:19:38 UTC (rev 2854)
+++ trunk/windstille/src/editor/object_model.hpp	2009-04-02 16:33:27 UTC (rev 2855)
@@ -59,6 +59,7 @@
   std::string get_id() const;
 
   Vector2f get_world_pos() const;
+  void set_world_pos(const Vector2f& p);
 
   Vector2f get_rel_pos() const { return rel_pos; }
   void     set_rel_pos(const Vector2f& rel_pos_)  {  rel_pos = rel_pos_; }

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-02 16:19:38 UTC (rev 2854)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-02 16:33:27 UTC (rev 2855)
@@ -309,11 +309,11 @@
           const Vector2f& center = selection->get_bounding_box().get_center();
           for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
             {
-              Vector2f pos = (*i)->get_rel_pos();
+              Vector2f pos = (*i)->get_world_pos();
           
               pos.y = center.y + (center.y - pos.y);
           
-              (*i)->set_rel_pos(pos);
+              (*i)->set_world_pos(pos);
             }
         }
 
@@ -335,11 +335,11 @@
           const Vector2f& center = selection->get_bounding_box().get_center();
           for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
             {
-              Vector2f pos = (*i)->get_rel_pos();
+              Vector2f pos = (*i)->get_world_pos();
           
               pos.x = center.x + (center.x - pos.x);
           
-              (*i)->set_rel_pos(pos);
+              (*i)->set_world_pos(pos);
             }
         }
 



From grumbel at mail.berlios.de  Thu Apr  2 22:00:25 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 2 Apr 2009 22:00:25 +0200
Subject: [Windstille-commit] r2856 - trunk/windstille/src/editor
Message-ID: <200904022000.n32K0PaD003566@sheep.berlios.de>

Author: grumbel
Date: 2009-04-02 22:00:25 +0200 (Thu, 02 Apr 2009)
New Revision: 2856

Modified:
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/windstille_widget.cpp
   trunk/windstille/src/editor/windstille_widget.hpp
Log:
Added ContextMenu to WindstilleWidget

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-02 16:33:27 UTC (rev 2855)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-02 20:00:25 UTC (rev 2856)
@@ -391,7 +391,7 @@
   //std::cout << "on_new" << std::endl;
 
   // FIXME: We abuse the minimap as our root GLContext
-  WindstilleWidget* wst = Gtk::manage(new WindstilleWidget(glconfig, minimap_widget.get_gl_context()));
+  WindstilleWidget* wst = Gtk::manage(new WindstilleWidget(*this, glconfig, minimap_widget.get_gl_context()));
 
   Glib::ustring title = Glib::ustring::compose("Unsaved Sector %1", notebook.get_n_pages()+1);
   int new_page = notebook.append_page(*wst, title);

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-02 16:33:27 UTC (rev 2855)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-02 20:00:25 UTC (rev 2856)
@@ -36,9 +36,11 @@
 
 bool lib_init = false;
 
-WindstilleWidget::WindstilleWidget(const Glib::RefPtr<const Gdk::GL::Config>&  glconfig,
+WindstilleWidget::WindstilleWidget(EditorWindow& editor_,
+                                   const Glib::RefPtr<const Gdk::GL::Config>&  glconfig,
                                    const Glib::RefPtr<const Gdk::GL::Context>& share_list)
-  : sector_model(new SectorModel()),
+  : editor(editor_),
+    sector_model(new SectorModel()),
     active_tool(0),
     scroll_tool(new ScrollTool()),
     map_type(DecalObjectModel::COLORMAP),
@@ -49,6 +51,31 @@
 {
   set_gl_capability(glconfig, share_list);
 
+  {
+    Glib::RefPtr<Gtk::UIManager>   ui_manager   = editor.get_ui_manager();
+    Glib::RefPtr<Gtk::ActionGroup> action_group = Gtk::ActionGroup::create();
+   
+    action_group->add(Gtk::Action::create("PopupMenu",   "_PopupMenu")); 
+    //action_group->add(Gtk::Action::create("ObjectReset", Gtk::Stock::REFRESH));
+
+    ui_manager->insert_action_group(action_group);
+
+    ui_manager->add_ui_from_string("<ui>"
+                                   "  <popup name='PopupMenu'>"
+                                   "    <menuitem action='Delete'/>"
+                                   "    <menuitem action='Duplicate'/>"
+                                   "    <separator/>"
+                                   "    <menuitem action='ConnectParent'/>"
+                                   "    <menuitem action='ClearParent'/>"
+                                   "    <separator/>"
+                                   "    <menuitem action='HFlipObject'/>"
+                                   "    <menuitem action='VFlipObject'/>"
+                                   "    <separator/>"
+                                   //"    <menuitem action='ObjectReset'/>"
+                                   "  </popup>"
+                                   "</ui>");
+  }
+
   add_events(Gdk::POINTER_MOTION_MASK | Gdk::BUTTON_PRESS_MASK | Gdk::BUTTON_RELEASE_MASK |
              Gdk::KEY_PRESS_MASK      | Gdk::KEY_RELEASE_MASK | 
              Gdk::ENTER_NOTIFY_MASK   | Gdk::LEAVE_NOTIFY_MASK);
@@ -458,20 +485,30 @@
 WindstilleWidget::mouse_down(GdkEventButton* event)
 {
   grab_focus();
-  //std::cout << "Button Press: " << event->x << ", " << event->y << " - " << event->button << std::endl;
+  std::cout << "Button Press: " << event->x << ", " << event->y << " - " << event->button << std::endl;
   //ewer->on_mouse_button_down(Vector2i(event->x, event->y), event->button);
   if (event->button == 1)
-    {
+    { // Tool
       active_tool = EditorWindow::current()->get_current_tool();
       active_tool->mouse_down(event, *this);
+      return true;
     }
   else if (event->button == 2)
-    {
+    { // Scroll
       active_tool = scroll_tool.get();
       active_tool->mouse_down(event, *this);
+      return true;
     }
-
-  return false;
+  else if (event->button == 3)
+    { // Context Menu
+      Gtk::Menu* menu = static_cast<Gtk::Menu*>(editor.get_ui_manager()->get_widget("/PopupMenu"));
+      menu->popup(event->button, event->time);
+      return true;
+    }
+  else
+    {
+      return false;
+    }
 }
 
 bool

Modified: trunk/windstille/src/editor/windstille_widget.hpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.hpp	2009-04-02 16:33:27 UTC (rev 2855)
+++ trunk/windstille/src/editor/windstille_widget.hpp	2009-04-02 20:00:25 UTC (rev 2856)
@@ -43,6 +43,7 @@
 class Tool;
 class ScrollTool;
 class SectorModel;
+class EditorWindow;
 
 /** OpenGL drawing area into which the Windstille game will be
     embedded */
@@ -51,6 +52,8 @@
     public Gtk::GL::Widget<WindstilleWidget>
 {
 private:
+  EditorWindow& editor;
+
   std::string filename;
   std::auto_ptr<SectorModel> sector_model;
   std::vector<ControlPointHandle> control_points;
@@ -68,7 +71,8 @@
   bool grid_enabled;
   
 public:
-  WindstilleWidget(const Glib::RefPtr<const Gdk::GL::Config>& glconfig,
+  WindstilleWidget(EditorWindow& editor,
+                   const Glib::RefPtr<const Gdk::GL::Config>& glconfig,
                    const Glib::RefPtr<const Gdk::GL::Context>& share_list);
   virtual ~WindstilleWidget();
 



From grumbel at mail.berlios.de  Thu Apr  2 23:24:17 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 2 Apr 2009 23:24:17 +0200
Subject: [Windstille-commit] r2857 - in trunk/windstille: . src/editor
Message-ID: <200904022124.n32LOHXS014161@sheep.berlios.de>

Author: grumbel
Date: 2009-04-02 23:24:17 +0200 (Thu, 02 Apr 2009)
New Revision: 2857

Modified:
   trunk/windstille/TODO
   trunk/windstille/src/editor/object_selector.cpp
Log:
Scale image on drag&drop to current zoom level

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-04-02 20:00:25 UTC (rev 2856)
+++ trunk/windstille/TODO	2009-04-02 21:24:17 UTC (rev 2857)
@@ -507,16 +507,32 @@
 Editor
 ======
 
+* add shift-toggle to rotation to 90/180/270 degree, etc., pass
+  GdkEvent modifier mask to control point
+
+* things are getting messy, we have: 
+
+   - hflip, vflip (works on UV)
+   - scale
+   - angle
+  
+  This all could be replaced with a translation matrix:
+
+   + would make things more general
+
+   - flipping via uv is trivial and doesn't lead to any trouble with
+     float instability/snapping
+
+   - rotation and scale can't easily be reset or edited separately
+
+   - float instability might lead to gaps between objects
+
 * (id ...) is a string'ified pointer, while this work, this causes the
   levels to be different after each and every load/save cycle, should
   be something more constant
 
-* scale drag&drop sprite to current zoom level
-
 * add rectangle overlay that indicates the visible area of the game (i.e. one screen in current zoom size
 
-* add flip for decal
-
 * bounding rect doesn't rotate, controls don't rotate
 
 * ControlPoint bounding rect scales, which it shouldn't, ControlPoint
@@ -527,7 +543,7 @@
 
 * implement Blender-like grab-handles, that toggle between
   scale/rotation/etc., but also allow limit of move along the x- or
-  y-axis
+  y-axis only
 
 * figure out how to properly draw controls in the Workspace (resize,
   rotation, vertices of a quad),
@@ -547,6 +563,9 @@
   might be useful in some situation (i.e. hold Ctrl pressed to move
   only the parent, not the children). Other issues:
 
+  - flipping doesn't work for parented objects when parent is in the
+    selection
+
   - parents could be handled like normal objects, but with the
     SelectTool traversing all children and marking them before the
     move begings, Ctrl could be used to toggle this behaviour (sounds
@@ -558,6 +577,8 @@
     to each other object in the group), wouldn't allow an easy way to
     edit objects in the Group, which however might be a good thing
 
+  - current parenthandling makes things like flipping much more complicated
+
 * raise/lower of multiple objects at once is a bit wonky, when objects
   reach the bottom/top they will change their relative order in the
   selection (not a big deal with layers)

Modified: trunk/windstille/src/editor/object_selector.cpp
===================================================================
--- trunk/windstille/src/editor/object_selector.cpp	2009-04-02 20:00:25 UTC (rev 2856)
+++ trunk/windstille/src/editor/object_selector.cpp	2009-04-02 21:24:17 UTC (rev 2857)
@@ -23,6 +23,7 @@
 #include <gtkmm/toolbar.h>
 #include <gtkmm/treemodelcolumn.h>
 
+#include "windstille_widget.hpp"
 #include "editor_window.hpp"
 #include "object_selector.hpp"
 
@@ -129,7 +130,7 @@
 {
   std::string iconpath = "data/editor/icon.png";
 
-Gtk::IconView::ArrayHandle_TreePaths selection = iconview.get_selected_items();
+  Gtk::IconView::ArrayHandle_TreePaths selection = iconview.get_selected_items();
   for(Gtk::IconView::ArrayHandle_TreePaths::iterator i = selection.begin();
       i != selection.end();
       ++i)
@@ -139,6 +140,12 @@
     }
 
   Glib::RefPtr<Gdk::Pixbuf> pixbuf = Gdk::Pixbuf::create_from_file(iconpath);
+  if (WindstilleWidget* wst = EditorWindow::current()->get_windstille_widget())
+    {
+      pixbuf = pixbuf->scale_simple(std::max(4, int(pixbuf->get_width()  * wst->get_state().get_zoom())),
+                                    std::max(4, int(pixbuf->get_height() * wst->get_state().get_zoom())),
+                                    Gdk::INTERP_TILES);
+    }
   context->set_icon(pixbuf, pixbuf->get_width()/2, pixbuf->get_height()/2);
 }     
 



From grumbel at mail.berlios.de  Fri Apr  3 03:04:13 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Fri, 3 Apr 2009 03:04:13 +0200
Subject: [Windstille-commit] r2858 - in trunk/windstille: . src/editor
Message-ID: <200904030104.n3314DAY010211@sheep.berlios.de>

Author: grumbel
Date: 2009-04-03 03:04:11 +0200 (Fri, 03 Apr 2009)
New Revision: 2858

Modified:
   trunk/windstille/TODO
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/windstille_widget.cpp
Log:
Added a few keyboard shortcuts

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-04-02 21:24:17 UTC (rev 2857)
+++ trunk/windstille/TODO	2009-04-03 01:04:11 UTC (rev 2858)
@@ -507,6 +507,21 @@
 Editor
 ======
 
+* maybe make Layers not be hardwired into the level struture, but add
+  them as independed meta-data:
+ 
+  (layers
+    (layer (objects 1)
+           (child-layers
+             (layers
+               (layer (objects 2 3))))))
+
+  (objects
+    (decal (id 1) ...)
+    (decal (id 2) ...)
+    (decal (id 3) ...)
+    ...)
+
 * add shift-toggle to rotation to 90/180/270 degree, etc., pass
   GdkEvent modifier mask to control point
 
@@ -521,7 +536,8 @@
    + would make things more general
 
    - flipping via uv is trivial and doesn't lead to any trouble with
-     float instability/snapping
+     float instability/snapping, could be easily extended to
+     90/180/270 rotations
 
    - rotation and scale can't easily be reset or edited separately
 
@@ -652,11 +668,8 @@
 
 * add keyboard shortcut important stuff:
 
-  - layer toggle 1,2,3,4,5,...
+  - layer toggle 1,2,3,4,5,... (obsoleted by new layer system)
   - color, light, highlight toggle
-  - mark all objects
-  - delete object
-  - duplicate object
   - next/previous layer: Ctrl-PageUp/Down
 
 * add second toolbar, first one is getting a little crowded

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-02 21:24:17 UTC (rev 2857)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-03 01:04:11 UTC (rev 2858)
@@ -221,11 +221,13 @@
   action_group->add(Gtk::Action::create("Paste",       Gtk::Stock::PASTE),
                     sigc::mem_fun(*this, &EditorWindow::on_paste));
   action_group->add(Gtk::Action::create("SelectAll",       Gtk::Stock::SELECT_ALL),
+                    Gtk::AccelKey("<control>a"),
                     sigc::mem_fun(*this, &EditorWindow::on_select_all));
 
   action_group->add(Gtk::Action::create("Delete",      Gtk::Stock::DELETE),
                     sigc::bind(sigc::mem_fun(*this, &EditorWindow::call_with_windstille_widget), &WindstilleWidget::selection_delete));
   action_group->add(Gtk::Action::create_with_icon_name("Duplicate", "duplicate", "Duplicate Object", "Duplicate Object"),
+                    Gtk::AccelKey(GDK_d, Gdk::CONTROL_MASK),
                     sigc::bind(sigc::mem_fun(*this, &EditorWindow::call_with_windstille_widget), &WindstilleWidget::selection_duplicate));
 
   action_group->add(Gtk::Action::create("MenuObject",    "_Object"));
@@ -252,8 +254,10 @@
   action_group->add(Gtk::Action::create("Zoom100",     Gtk::Stock::ZOOM_100),
                     sigc::mem_fun(*this, &EditorWindow::on_zoom_100));
   action_group->add(Gtk::Action::create("ZoomIn",      Gtk::Stock::ZOOM_IN),
+                    Gtk::AccelKey(GDK_plus, Gdk::CONTROL_MASK),
                     sigc::mem_fun(*this, &EditorWindow::on_zoom_in));
   action_group->add(Gtk::Action::create("ZoomOut",     Gtk::Stock::ZOOM_OUT),
+                    Gtk::AccelKey(GDK_minus, Gdk::CONTROL_MASK),
                     sigc::mem_fun(*this, &EditorWindow::on_zoom_out));
   action_group->add(play_action = Gtk::ToggleAction::create("Play", Gtk::Stock::MEDIA_PLAY), 
                     sigc::mem_fun(*this, &EditorWindow::on_play));

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-02 21:24:17 UTC (rev 2857)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-03 01:04:11 UTC (rev 2858)
@@ -62,7 +62,6 @@
 
     ui_manager->add_ui_from_string("<ui>"
                                    "  <popup name='PopupMenu'>"
-                                   "    <menuitem action='Delete'/>"
                                    "    <menuitem action='Duplicate'/>"
                                    "    <separator/>"
                                    "    <menuitem action='ConnectParent'/>"
@@ -71,6 +70,7 @@
                                    "    <menuitem action='HFlipObject'/>"
                                    "    <menuitem action='VFlipObject'/>"
                                    "    <separator/>"
+                                   "    <menuitem action='Delete'/>"
                                    //"    <menuitem action='ObjectReset'/>"
                                    "  </popup>"
                                    "</ui>");
@@ -548,6 +548,8 @@
 bool
 WindstilleWidget::key_press(GdkEventKey* event)
 {
+  std::cout << event->keyval << " keypress " << state.get_pos() << std::endl;
+
   switch(event->keyval)
     {
       case GDK_1:
@@ -565,9 +567,20 @@
         EditorWindow::current()->print("HIGHLIGHT");
         break;
 
+      case GDK_a:
+        EditorWindow::current()->on_select_all();
+        break;
+
+      case GDK_d:
+        selection_duplicate();
+        break;
+
+      case GDK_Delete:
+        selection_delete();
+        break;
+
       case GDK_Left:
         state.set_pos(state.get_pos() + Vector2f(-100.0f, 0.0f));
-        queue_draw();
         break;
 
       case GDK_Right:
@@ -586,8 +599,6 @@
         break;
     }
 
-  //std::cout << state.get_pos() << std::endl;
-
   return true;
 }
 



From grumbel at mail.berlios.de  Fri Apr  3 06:19:10 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Fri, 3 Apr 2009 06:19:10 +0200
Subject: [Windstille-commit] r2859 - in trunk/windstille: .
	data/images/decal data/sectors/trainstation
Message-ID: <200904030419.n334JAfP000354@sheep.berlios.de>

Author: grumbel
Date: 2009-04-03 06:19:02 +0200 (Fri, 03 Apr 2009)
New Revision: 2859

Added:
   trunk/windstille/data/images/decal/fuel_container.png
   trunk/windstille/data/images/decal/streetlamp.png
Modified:
   trunk/windstille/TODO
   trunk/windstille/data/sectors/trainstation/city.wst
Log:
Some work on the City sector

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-04-03 01:04:11 UTC (rev 2858)
+++ trunk/windstille/TODO	2009-04-03 04:19:02 UTC (rev 2859)
@@ -668,8 +668,7 @@
 
 * add keyboard shortcut important stuff:
 
-  - layer toggle 1,2,3,4,5,... (obsoleted by new layer system)
-  - color, light, highlight toggle
+  - color, light, highlight toggle (1,2,3 are currently used up for the object selector)
   - next/previous layer: Ctrl-PageUp/Down
 
 * add second toolbar, first one is getting a little crowded

Added: trunk/windstille/data/images/decal/fuel_container.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/fuel_container.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/streetlamp.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/streetlamp.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/windstille/data/sectors/trainstation/city.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/city.wst	2009-04-03 01:04:11 UTC (rev 2858)
+++ trunk/windstille/data/sectors/trainstation/city.wst	2009-04-03 04:19:02 UTC (rev 2859)
@@ -7,777 +7,1653 @@
   (init-script "init.nut")
   (layer
     (name "Scene")
-    (visible 1)
-    (locked 0)
+    (visible #t)
+    (locked #t)
     (objects)
     (child-layers
       (layer
         (name "Light")
-        (visible 1)
-        (locked 1)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0xa269120")
+            (id "0x92ae190")
             (pos 689 326)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 3.63751 2.04308)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9f1b858")
+            (id "0x92ad630")
             (pos -2229 315)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 3.7027 1.9346)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa283598")
+            (id "0x92ad6d0")
             (pos 2213 674)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1.76741 2.13994)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa3659e8")
+            (id "0x92ad790")
             (pos 909 162)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1.90027 1.81253)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa281620")
+            (id "0x92ae6b8")
             (pos -1070 626)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1.5143 1.10403)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa365b78")
+            (id "0x92ae770")
             (pos -1064 624)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")
             (type 2)
             (scale 1.34704 1.09163)
-            (angle 0)))
-        (child-layers
-          (layer
-            (name "Highlight")
-            (visible 1)
-            (locked 1)
-            (objects
-              (decal
-                (id "0xa3429b0")
-                (pos 836 212)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/rooflamp.png")
-                (type 0)
-                (scale 1.05279 1.05689)
-                (angle -1.56597))
-              (decal
-                (id "0xa361238")
-                (pos 985 221)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/rooflamp_bloom.png")
-                (type 2)
-                (scale 3.65012 5.58788)
-                (angle 1.47871))
-              (decal
-                (id "0xa276c88")
-                (pos 949 214)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/rooflamp_bloom.png")
-                (type 2)
-                (scale 0.961703 0.344589)
-                (angle 1.58209))
-              (decal
-                (id "0x9b682f0")
-                (pos -1207 634)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/lamp1.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa211ae0")
-                (pos -910 639)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/lamp1.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa2834c0")
-                (pos -912 619)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/lamp1_highlight.png")
-                (type 2)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa280e08")
-                (pos -1208 615)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/lamp1_highlight.png")
-                (type 2)
-                (scale 1 1)
-                (angle 0)))
-            (child-layers))))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
       (layer
+        (name "Highlight")
+        (visible #t)
+        (locked #f)
+        (objects
+          (decal
+            (id "0x92c4b40")
+            (pos 2998 558)
+            (parent "")
+            (select-mask 1)
+            (path "images/streetlamp-light.png")
+            (type 1)
+            (scale 2.4498 1.68449)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92ab5d8")
+            (pos 836 212)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp.png")
+            (type 0)
+            (scale 1.05279 1.05689)
+            (angle -1.56597)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92ab690")
+            (pos 985 221)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp_bloom.png")
+            (type 2)
+            (scale 3.65012 5.58788)
+            (angle 1.47871)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92abad0")
+            (pos 949 214)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp_bloom.png")
+            (type 2)
+            (scale 0.961703 0.344589)
+            (angle 1.58209)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92ac708")
+            (pos -1207 634)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/lamp1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92acee8")
+            (pos -910 639)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/lamp1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92ac7d0")
+            (pos -912 619)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/lamp1_highlight.png")
+            (type 2)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92acb90")
+            (pos -1208 615)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/lamp1_highlight.png")
+            (type 2)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8c36558")
+            (pos 2992 368)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/streetlamp.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92c6718")
+            (pos 2999 380)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp_bloom.png")
+            (type 2)
+            (scale 0.698039 0.489933)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8c365a0")
+            (pos 3542 559)
+            (parent "")
+            (select-mask 1)
+            (path "images/streetlamp-light.png")
+            (type 1)
+            (scale 2.4498 1.68449)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8c37530")
+            (pos 3536 369)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/streetlamp.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x982ff68")
+            (pos 3543 381)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp_bloom.png")
+            (type 2)
+            (scale 0.698039 0.489933)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92c3970")
+            (pos 4050 558)
+            (parent "")
+            (select-mask 1)
+            (path "images/streetlamp-light.png")
+            (type 1)
+            (scale 2.4498 1.68449)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x921a780")
+            (pos 4044 368)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/streetlamp.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92c2b60")
+            (pos 4051 380)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp_bloom.png")
+            (type 2)
+            (scale 0.698039 0.489933)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92c4a50")
+            (pos 3549 485)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp_bloom.png")
+            (type 1)
+            (scale 4.8895 5.48547)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92bdd20")
+            (pos -3945 517)
+            (parent "")
+            (select-mask 1)
+            (path "images/streetlamp-light.png")
+            (type 1)
+            (scale 2.4498 1.68449)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92c4fb0")
+            (pos -3951 327)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/streetlamp.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8f5b508")
+            (pos -3944 339)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp_bloom.png")
+            (type 2)
+            (scale 0.698039 0.489933)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
         (name "Character")
-        (visible 1)
-        (locked 1)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0xa26a168")
+            (id "0x92adde8")
             (pos 525 612)
             (parent "")
             (select-mask 1)
             (path "images/decal/humanreference.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Ground")
-        (visible 1)
-        (locked 1)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0xa266918")
+            (id "0x92d0880")
             (pos 1271 855)
             (parent "")
             (select-mask 1)
             (path "images/decal/cityground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa275730")
+            (id "0x93ae0f0")
             (pos 759 855)
             (parent "")
             (select-mask 1)
             (path "images/decal/cityground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa257150")
+            (id "0x92d10e8")
             (pos 247 855)
             (parent "")
             (select-mask 1)
             (path "images/decal/cityground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9f16d40")
+            (id "0x92d1190")
             (pos 2807 855)
             (parent "")
             (select-mask 1)
             (path "images/decal/cityground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa295d88")
+            (id "0x92d1278")
             (pos 2295 855)
             (parent "")
             (select-mask 1)
             (path "images/decal/cityground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa299e20")
+            (id "0x92d1360")
             (pos 1783 855)
             (parent "")
             (select-mask 1)
             (path "images/decal/cityground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa20d8e0")
+            (id "0x92d1448")
             (pos -777 855)
             (parent "")
             (select-mask 1)
             (path "images/decal/cityground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa272c00")
+            (id "0x92d1530")
             (pos -1289 855)
             (parent "")
             (select-mask 1)
             (path "images/decal/cityground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa261d90")
+            (id "0x92d1618")
             (pos -1801 855)
             (parent "")
             (select-mask 1)
             (path "images/decal/cityground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa261b00")
+            (id "0x92d1700")
             (pos -265 855)
             (parent "")
             (select-mask 1)
             (path "images/decal/cityground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa2988f0")
+            (id "0x92d17e8")
             (pos -2313 855)
             (parent "")
             (select-mask 1)
             (path "images/decal/cityground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa299dd8")
+            (id "0x92d18d0")
             (pos -2825 855)
             (parent "")
             (select-mask 1)
             (path "images/decal/cityground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa271d20")
+            (id "0x92d19b8")
             (pos -3337 855)
             (parent "")
             (select-mask 1)
             (path "images/decal/cityground.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92d1aa0")
+            (pos -3849 854)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92d1b88")
+            (pos -4361 854)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92d1c70")
+            (pos -4873 854)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92d1d58")
+            (pos -5385 854)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92d1e40")
+            (pos -5897 854)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92d1f28")
+            (pos -6409 854)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92d2010")
+            (pos -6921 854)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92d20f8")
+            (pos -7433 854)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92d21e0")
+            (pos -7945 854)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92d22c8")
+            (pos -2215 -873)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92d23b0")
+            (pos -1959 -873)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x93ac4e0")
+            (pos -1703 -873)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x93ac588")
+            (pos -1447 -873)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x93ac670")
+            (pos 601 -873)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0x93ac758")
+            (pos 345 -873)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0x93ac920")
+            (pos 89 -873)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0x93ac9d8")
+            (pos -167 -873)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0x93acac0")
+            (pos -679 -873)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0x93acba8")
+            (pos -423 -873)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0x93acc90")
+            (pos -935 -873)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x93acd78")
+            (pos -1191 -873)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_side.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x93ace60")
+            (pos 3831 853)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x93acf48")
+            (pos 3319 853)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x93ad030")
+            (pos 5367 853)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x93ad118")
+            (pos 4855 853)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x93ad200")
+            (pos 4343 853)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x93ad2e8")
+            (pos 6903 852)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x93ad3d0")
+            (pos 6391 852)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x93ad4b8")
+            (pos 5879 852)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/cityground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "House2")
-        (visible 1)
-        (locked 1)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0xa20cda8")
+            (id "0x92d0678")
             (pos 1470 471)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_subway.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
+        (name "Fuel")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x92d3c08")
+            (pos -2749 423)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/fuel_container.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92d04f8")
+            (pos -3388 422)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/fuel_container.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
         (name "House")
-        (visible 1)
-        (locked 1)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0xa2791b8")
+            (id "0x948ad78")
             (pos 217 471)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_housewall.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa2742b0")
+            (id "0x948b770")
             (pos 217 -41)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_housewall.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa257198")
+            (id "0x9488298")
             (pos 217 -553)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_housewall.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa276d90")
+            (id "0x9488340")
             (pos 643 -38)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_houseairvent.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa20de18")
+            (id "0x9488ed8")
             (pos 645 -550)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_houseairvent.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa279248")
+            (id "0x9489028")
             (pos -131 -559)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa2785b0")
+            (id "0x9489b18")
             (pos 48 -558)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa272e30")
+            (id "0x9489868")
             (pos 236 -556)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa20d990")
+            (id "0x9489910")
             (pos -126 -45)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa293100")
+            (id "0x94ec690")
             (pos 53 -44)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa276358")
+            (id "0x94ec778")
             (pos 241 -42)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa26b150")
+            (id "0x94ec860")
             (pos 438 817)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 2.96695 1.58413)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa1428b0")
+            (id "0x94f08c8")
             (pos -807 471)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_housewall.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa20da90")
+            (id "0x94f0940")
             (pos -807 -41)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_housewall.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa274200")
+            (id "0x94f09e8")
             (pos -807 -553)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_housewall.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa257430")
+            (id "0x94f0ad0")
             (pos -1831 471)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_housewall.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa20df18")
+            (id "0x94eede8")
             (pos -1831 -41)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_housewall.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa274c78")
+            (id "0x94eeed0")
             (pos -1831 -553)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_housewall.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa271bb0")
+            (id "0x94eefb8")
             (pos 49 457)
             (parent "")
             (select-mask 1)
             (path "images/decal/explosion_decal.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa342f28")
+            (id "0x94eebb8")
             (pos -1495 498)
             (parent "")
             (select-mask 1)
             (path "images/decal/container_crack.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa274580")
+            (id "0x94ecf40")
             (pos -1003 -564)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9e88618")
+            (id "0x94ecfb8")
             (pos -824 -563)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa277e88")
+            (id "0x94ed060")
             (pos -636 -561)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9e89598")
+            (id "0x94ed128")
             (pos -998 -50)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa263590")
+            (id "0x94ed210")
             (pos -819 -49)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa274470")
+            (id "0x94ed2f8")
             (pos -631 -47)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa13f768")
+            (id "0x94ed3e0")
             (pos -1527 -34)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa294848")
+            (id "0x94ed4c8")
             (pos -1715 -39)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa279e40")
+            (id "0x94ed5b0")
             (pos -1894 -40)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa20d7f8")
+            (id "0x94ed698")
             (pos -1532 -563)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9ef9528")
+            (id "0x94ed780")
             (pos -1720 -565)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa272a48")
+            (id "0x94ed868")
             (pos -1899 -566)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9e0b6b0")
+            (id "0x94ed950")
             (pos -2237 -561)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_houseairvent.png")
             (type 0)
             (scale -1.23139 1.08248)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa279148")
+            (id "0x94eda40")
             (pos -2239 -41)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_houseairvent.png")
             (type 0)
             (scale -1.23139 1.08248)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa27ab90")
+            (id "0x94edb30")
             (pos -1061 582)
             (parent "")
             (select-mask 1)
             (path "images/decal/door.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa13fb48")
+            (id "0x963f3f0")
             (pos -810 477)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa275628")
+            (id "0x94edcc8")
             (pos -628 478)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_window.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa277b40")
+            (id "0x94edd70")
             (pos -437 671)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate_crack.png")
             (type 0)
             (scale 1.09301 1.15319)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Shadow")
-        (visible 1)
-        (locked 1)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0xa141470")
+            (id "0x94ee660")
             (pos 858 689)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1.55695 0.984741)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa276930")
+            (id "0x94ee6a8")
             (pos 704 418)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 0.786377 2.50299)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa2988a8")
+            (id "0x94ee738")
             (pos 1974 744)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1.22888 0.977112)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa284180")
+            (id "0x948b468")
             (pos 1397 489)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 3.22015 1.55695)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9f16cd8")
+            (id "0x948b518")
             (pos -2291 573)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1.49889 2.34289)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa27d5a8")
+            (id "0x948b5c8")
             (pos -2855 737)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 2.52588 1.11444)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x963ca20")
+            (pos 2870 735)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 6.60283 0.940395)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x963cad0")
+            (pos 4870 739)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 6.60283 0.940395)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Wall")
-        (visible 1)
-        (locked 1)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0xa274088")
+            (id "0x94ee618")
             (pos 613 398)
             (parent "")
             (select-mask 1)
             (path "images/decal/citywall.png")
             (type 0)
             (scale 1.03906 1.2832)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa295cf8")
+            (id "0x963d188")
             (pos 1145 398)
             (parent "")
             (select-mask 1)
             (path "images/decal/citywall.png")
             (type 0)
             (scale 1.03906 1.2832)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa261960")
+            (id "0x963db00")
             (pos 1677 397)
             (parent "")
             (select-mask 1)
             (path "images/decal/citywall.png")
             (type 0)
             (scale 1.03906 1.2832)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa273018")
+            (id "0x963dba8")
             (pos 2209 397)
             (parent "")
             (select-mask 1)
             (path "images/decal/citywall.png")
             (type 0)
             (scale 1.03906 1.2832)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa295e08")
+            (id "0x963dc70")
             (pos 2741 397)
             (parent "")
             (select-mask 1)
             (path "images/decal/citywall.png")
             (type 0)
             (scale 1.03906 1.2832)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9f16b08")
-            (pos -2731 398)
+            (id "0x963dd58")
+            (pos -2609 407)
             (parent "")
             (select-mask 1)
             (path "images/decal/citywall.png")
             (type 0)
             (scale 1.03906 1.2832)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa141380")
-            (pos -2199 398)
+            (id "0x963de40")
+            (pos -2077 407)
             (parent "")
             (select-mask 1)
             (path "images/decal/citywall.png")
             (type 0)
             (scale 1.03906 1.2832)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0xa274d08")
-            (pos -3263 398)
+            (id "0x963df28")
+            (pos -3141 407)
             (parent "")
             (select-mask 1)
             (path "images/decal/citywall.png")
             (type 0)
             (scale 1.03906 1.2832)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x963e010")
+            (pos -4205 407)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x963e0f8")
+            (pos -3673 407)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x963e1e0")
+            (pos -4737 407)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x963e2c8")
+            (pos -5801 407)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x963e3b0")
+            (pos -5269 407)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x963e498")
+            (pos -6333 407)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x963e580")
+            (pos 3273 396)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x963e668")
+            (pos 3805 397)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x963e750")
+            (pos 4337 396)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x963e838")
+            (pos 4869 396)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x963e920")
+            (pos 5401 396)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x963ea08")
+            (pos 5933 396)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x96ed618")
+            (pos 6465 396)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/citywall.png")
+            (type 0)
+            (scale 1.03906 1.2832)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x96ed6e8")
+            (pos 4631 455)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.284744 0.58992)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x96ed7a0")
+            (pos 4558 464)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.322891 0.914169)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x96ed880")
+            (pos 4599 378)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/container_gate.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "Background")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x96efa28")
+            (pos 1328 80)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/fuel_container.png")
+            (type 0)
+            (scale 1.93044 2.12433)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x96efaa0")
+            (pos 2513 80)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/fuel_container.png")
+            (type 0)
+            (scale 1.93044 2.12433)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers)))))
 
 ;; EOF ;;



From grumbel at mail.berlios.de  Sat Apr  4 01:26:54 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sat, 4 Apr 2009 01:26:54 +0200
Subject: [Windstille-commit] r2860 -
	trunk/windstille/data/sectors/trainstation
Message-ID: <200904032326.n33NQsXH007881@sheep.berlios.de>

Author: grumbel
Date: 2009-04-04 01:26:52 +0200 (Sat, 04 Apr 2009)
New Revision: 2860

Added:
   trunk/windstille/data/sectors/trainstation/bar.wst
   trunk/windstille/data/sectors/trainstation/toilet.wst
Log:
Some more experimental sectors

Added: trunk/windstille/data/sectors/trainstation/bar.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/bar.wst	2009-04-03 04:19:02 UTC (rev 2859)
+++ trunk/windstille/data/sectors/trainstation/bar.wst	2009-04-03 23:26:52 UTC (rev 2860)
@@ -0,0 +1,634 @@
+;; -*- scheme -*-
+
+(windstille-sector
+  (version 2)
+  (name "")
+  (ambient-color 0 0 0 1)
+  (init-script "init.nut")
+  (layer
+    (name "Scene")
+    (visible #t)
+    (locked #t)
+    (objects
+      (decal
+        (id "0x94db3a0")
+        (pos -94 321)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 1.30518 2.44005)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x94d6db8")
+        (pos -62 353)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 1.30518 2.44005)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x94d9528")
+        (pos -30 385)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 1.30518 2.44005)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x94d9720")
+        (pos 2212 342)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 1.30518 2.44005)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x94dc620")
+        (pos 2244 374)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 1.30518 2.44005)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x94d76b0")
+        (pos 2276 406)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 1.30518 2.44005)
+        (angle 0)
+        (hflip #f)
+        (vflip #f)))
+    (child-layers
+      (layer
+        (name "Light")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x94d7fe8")
+            (pos 1429 299)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp_bloom.png")
+            (type 2)
+            (scale 0.417892 0.444211)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x94d6410")
+            (pos 1039 286)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp_bloom.png")
+            (type 2)
+            (scale 0.417892 0.444211)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9134e20")
+            (pos 648 283)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp_bloom.png")
+            (type 2)
+            (scale 0.417892 0.444211)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x94d96d8")
+            (pos 1037 390)
+            (parent "")
+            (select-mask 1)
+            (path "images/streetlamp-light.png")
+            (type 1)
+            (scale 1.57731 1.2139)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x94d7110")
+            (pos 1421 397)
+            (parent "")
+            (select-mask 1)
+            (path "images/streetlamp-light.png")
+            (type 1)
+            (scale 1.57731 1.2139)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x94d7f78")
+            (pos 647 375)
+            (parent "")
+            (select-mask 1)
+            (path "images/streetlamp-light.png")
+            (type 1)
+            (scale 1.57731 1.2139)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "Ground")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x91ff300")
+            (pos 431 629)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x91fed48")
+            (pos 815 629)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x91fedf0")
+            (pos 1199 629)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9234120")
+            (pos 1583 629)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92341e8")
+            (pos 431 117)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x92342d0")
+            (pos 815 117)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x92343b8")
+            (pos 1199 117)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x92344a0")
+            (pos 1583 117)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x94d2dc8")
+            (pos 47 629)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x94d62c8")
+            (pos 47 117)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x94d71d0")
+            (pos 1967 629)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x94d7218")
+            (pos 1967 117)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t)))
+        (child-layers))
+      (layer
+        (name "Character")
+        (visible #t)
+        (locked #f)
+        (objects
+          (decal
+            (id "0x94d0368")
+            (pos 1224 586)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.346924 0.591065)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x91fd478")
+            (pos 1233 450)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/humanreference.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "Objects")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x91fd418")
+            (pos 1160 462)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/bar/seat.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9209758")
+            (pos 902 462)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/bar/seat.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0x91fc128")
+            (pos 1229 437)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/bar/seat_separator.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x91fcbc0")
+            (pos 833 437)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/bar/seat_separator.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x91fcc58")
+            (pos 1031 502)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/bar/table.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x93849a8")
+            (pos 1556 462)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/bar/seat.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9384a20")
+            (pos 1298 462)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/bar/seat.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0x91fcf90")
+            (pos 1625 437)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/bar/seat_separator.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x91fd078")
+            (pos 1427 502)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/bar/table.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x91fd160")
+            (pos 764 462)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/bar/seat.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92077d0")
+            (pos 506 462)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/bar/seat.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0x92078b8")
+            (pos 437 437)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/bar/seat_separator.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92079a8")
+            (pos 635 502)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/bar/table.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9207a90")
+            (pos 1038 208)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_lamp.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x913b700")
+            (pos 643 205)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_lamp.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8b82e28")
+            (pos 1423 226)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_lamp.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "Shadow")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x91fb1f0")
+            (pos 1460 564)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1.42725 0.499512)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x91ff378")
+            (pos 1056 562)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1.42725 0.499512)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92092f0")
+            (pos 582 572)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1.42725 0.499512)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "Background")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x92094b8")
+            (pos 383 374)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92e4bc8")
+            (pos 671 374)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92e4c58")
+            (pos 959 374)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92e4d00")
+            (pos 1247 374)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x92e4dc8")
+            (pos 1535 373)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x94d94e0")
+            (pos 1823 373)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90ee588")
+            (pos 95 374)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x94dc2b8")
+            (pos 2111 373)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bar_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers)))))
+
+;; EOF ;;

Added: trunk/windstille/data/sectors/trainstation/toilet.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/toilet.wst	2009-04-03 04:19:02 UTC (rev 2859)
+++ trunk/windstille/data/sectors/trainstation/toilet.wst	2009-04-03 23:26:52 UTC (rev 2860)
@@ -0,0 +1,1113 @@
+;; -*- scheme -*-
+
+(windstille-sector
+  (version 2)
+  (name "")
+  (ambient-color 0 0 0 1)
+  (init-script "init.nut")
+  (layer
+    (name "Scene")
+    (visible #t)
+    (locked #t)
+    (objects)
+    (child-layers
+      (layer
+        (name "Light")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x8fa9330")
+            (pos 1283 392)
+            (parent "")
+            (select-mask 1)
+            (path "images/streetlamp-light.png")
+            (type 1)
+            (scale 0.843122 2.78601)
+            (angle 4.53577)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fa9950")
+            (pos 940 336)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/apartmentlamp_light.png")
+            (type 1)
+            (scale 1.36387 1.52344)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8faa688")
+            (pos 949 103)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/apartmentlamp_highlight.png")
+            (type 2)
+            (scale 1.74257 1.58333)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "Character")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x8fa7068")
+            (pos 1572 367)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/humanreference.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "Ground")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x88704b8")
+            (pos 1674 45)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 0.792 0.76)
+            (angle -2.32532)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8edc3c0")
+            (pos 1707 498)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 0.792 0.76)
+            (angle -0.809692)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8e9fe90")
+            (pos 326 503)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 0.792 0.76)
+            (angle -2.32532)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x922b8a0")
+            (pos 357 49)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 0.792 0.76)
+            (angle -0.809692)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x8fa7fe8")
+            (pos 1463 546)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbf538")
+            (pos 1335 546)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbf5b0")
+            (pos 1207 546)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbf658")
+            (pos 1079 546)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbf720")
+            (pos 951 546)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbf808")
+            (pos 823 546)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbf8f0")
+            (pos 695 546)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbf9d8")
+            (pos 567 546)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbfac0")
+            (pos 439 546)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbfba8")
+            (pos 1463 34)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x8fbfc90")
+            (pos 1335 34)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x8fbfd78")
+            (pos 1207 34)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x8fbfe60")
+            (pos 1079 34)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x8fbff48")
+            (pos 951 34)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x8fc0030")
+            (pos 823 34)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x8fc0118")
+            (pos 695 34)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x8fc0200")
+            (pos 567 34)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x8fc02e8")
+            (pos 439 34)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x8fc03d0")
+            (pos 1591 34)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x8fc04b8")
+            (pos 1591 546)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbc110")
+            (pos 1719 418)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle -1.57174)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9140120")
+            (pos 1719 290)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle -1.57174)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8870400")
+            (pos 1719 162)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle -1.57174)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8eed6e8")
+            (pos 311 162)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle -1.57174)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x922b180")
+            (pos 311 290)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle -1.57174)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x8faf6b0")
+            (pos 311 418)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_ground.png")
+            (type 0)
+            (scale 1 1)
+            (angle -1.57174)
+            (hflip #f)
+            (vflip #t)))
+        (child-layers))
+      (layer
+        (name "Objects")
+        (visible #t)
+        (locked #f)
+        (objects
+          (decal
+            (id "0x8fc0bf0")
+            (pos 775 391)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fa7610")
+            (pos 983 356)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x903d8f0")
+            (pos 1100 356)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x903d998")
+            (pos 781 355)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_door.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x903e398")
+            (pos 630 395)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x903e410")
+            (pos 637 355)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_door.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x903e4b8")
+            (pos 485 395)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x903e5a0")
+            (pos 493 355)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_door.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbb920")
+            (pos 853 354)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_door2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8ed7fe0")
+            (pos 709 354)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_door2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8e99f40")
+            (pos 565 354)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_door2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8eaac58")
+            (pos 421 354)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_door2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9244780")
+            (pos 1288 272)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_housewall.png")
+            (type 0)
+            (scale 0.157431 0.18585)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9245f30")
+            (pos 1284 349)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/sink.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "Shadow")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x903ec80")
+            (pos 986 391)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.340821 0.423828)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x903edc0")
+            (pos 1103 396)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.340821 0.423828)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x903e950")
+            (pos 1293 378)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.35547 0.301758)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x903e9f0")
+            (pos 797 478)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.824219 0.682617)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x903ead0")
+            (pos 579 483)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.824219 0.682617)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8e86530")
+            (pos 378 446)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.570312 1.12109)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8870448")
+            (pos 352 60)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1.09277 0.549805)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x891b880")
+            (pos 1670 53)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1.09277 0.549805)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9244730")
+            (pos 1761 518)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1.09277 0.549805)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x922ba00")
+            (pos 1658 260)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.25293 0.97461)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fb99a8")
+            (pos 1141 494)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 2.00098 0.256836)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbb968")
+            (pos 1320 423)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.296876 0.604492)
+            (angle -0.443416)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9245fd0")
+            (pos 1125 511)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.423829 0.848633)
+            (angle -0.184662)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fc0af0")
+            (pos 992 512)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.340821 0.863281)
+            (angle 0.0135104)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8faa8d0")
+            (pos 827 333)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.501953 0.609375)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "Background")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x8fa82e0")
+            (pos 439 418)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbda20")
+            (pos 439 162)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbda98")
+            (pos 439 290)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbe1f0")
+            (pos 567 418)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbe2d8")
+            (pos 567 162)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbe3c0")
+            (pos 567 290)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbe4a8")
+            (pos 695 290)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbe590")
+            (pos 695 162)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbe678")
+            (pos 695 418)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbe760")
+            (pos 823 418)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbe848")
+            (pos 823 162)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b74b0")
+            (pos 823 290)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b7598")
+            (pos 951 418)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b7680")
+            (pos 951 162)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b7768")
+            (pos 951 290)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b7850")
+            (pos 1079 290)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b7938")
+            (pos 1079 162)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b7a20")
+            (pos 1079 418)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b7b08")
+            (pos 1463 162)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b7bf0")
+            (pos 1336 290)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b7cd8")
+            (pos 1335 162)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b7dc0")
+            (pos 1335 418)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b7ea8")
+            (pos 1207 290)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b7f90")
+            (pos 1207 162)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b8078")
+            (pos 1207 418)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b8160")
+            (pos 1591 290)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b8248")
+            (pos 1591 162)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b8330")
+            (pos 1591 418)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/walltiles.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "New Layer")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x8fbcf10")
+            (pos 1463 354)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/door.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fa8228")
+            (pos 1389 365)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.243164 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x8fbce00")
+            (pos 1580 364)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.370117 1.00977)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b86c8")
+            (pos 1439 222)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.213867 0.560547)
+            (angle 1.45326)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x90b8780")
+            (pos 953 104)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp_bloom.png")
+            (type 2)
+            (scale 0.862746 0.219799)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers)))))
+
+;; EOF ;;



From grumbel at mail.berlios.de  Sat Apr  4 01:27:47 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sat, 4 Apr 2009 01:27:47 +0200
Subject: [Windstille-commit] r2861 - trunk/windstille/data/images/decal
Message-ID: <200904032327.n33NRlQn008649@sheep.berlios.de>

Author: grumbel
Date: 2009-04-04 01:27:42 +0200 (Sat, 04 Apr 2009)
New Revision: 2861

Added:
   trunk/windstille/data/images/decal/bar_background.png
   trunk/windstille/data/images/decal/bar_ground.png
   trunk/windstille/data/images/decal/bar_lamp.png
   trunk/windstille/data/images/decal/sink.png
   trunk/windstille/data/images/decal/toilet1.png
   trunk/windstille/data/images/decal/toilet2.png
   trunk/windstille/data/images/decal/toilet_door.png
   trunk/windstille/data/images/decal/toilet_door2.png
   trunk/windstille/data/images/decal/toilet_ground.png
Log:
More experimental sectors

Added: trunk/windstille/data/images/decal/bar_background.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/bar_background.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/bar_ground.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/bar_ground.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/bar_lamp.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/bar_lamp.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/sink.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/sink.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/toilet1.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/toilet1.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/toilet2.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/toilet2.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/toilet_door.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/toilet_door.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/toilet_door2.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/toilet_door2.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/toilet_ground.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/toilet_ground.png
___________________________________________________________________
Name: svn:mime-type
   + image/png



From grumbel at mail.berlios.de  Sat Apr  4 06:31:49 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sat, 4 Apr 2009 06:31:49 +0200
Subject: [Windstille-commit] r2862 - trunk/windstille/src/editor
Message-ID: <200904040431.n344VnhJ015949@sheep.berlios.de>

Author: grumbel
Date: 2009-04-04 06:31:44 +0200 (Sat, 04 Apr 2009)
New Revision: 2862

Modified:
   trunk/windstille/src/editor/main.cpp
Log:
Added support for loading sectors from command line

Modified: trunk/windstille/src/editor/main.cpp
===================================================================
--- trunk/windstille/src/editor/main.cpp	2009-04-03 23:27:42 UTC (rev 2861)
+++ trunk/windstille/src/editor/main.cpp	2009-04-04 04:31:44 UTC (rev 2862)
@@ -64,11 +64,20 @@
       icon_theme->append_search_path("data/editor/");
       
       EditorWindow window(glconfig);
-      
       window.show_all();
       window.show_minimap(false);
 
-      window.on_new();
+      if (argc == 1)
+        {
+          window.on_new();
+        }
+      else
+        {
+          for(int i = 1; i < argc; ++i)
+            {
+              window.load_file(argv[i]);
+            }
+        }
       
       Gtk::Main::run(window);
     }



From grumbel at mail.berlios.de  Sat Apr  4 06:33:10 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sat, 4 Apr 2009 06:33:10 +0200
Subject: [Windstille-commit] r2863 - trunk/windstille/src/editor
Message-ID: <200904040433.n344XACa016562@sheep.berlios.de>

Author: grumbel
Date: 2009-04-04 06:33:05 +0200 (Sat, 04 Apr 2009)
New Revision: 2863

Modified:
   trunk/windstille/src/editor/editor_window.cpp
Log:
Fixed(?) issue with recent menu not showing recently created files

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-04 04:31:44 UTC (rev 2862)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-04 04:33:05 UTC (rev 2863)
@@ -64,6 +64,10 @@
     "    <menu action='MenuFile'>"
     "      <menuitem action='New'/>"
     "      <menuitem action='FileOpen'/>"
+    // FIXME: This doesn't work, RecentActon seems to create both an
+    // Open entry, as well as a menu-button, with the toolbar this
+    // works fine, with the menu it doesn't as both entries are merged
+    // into one, activating the callback on hover
     //"      <menuitem action='FileRecentFiles'/>"
     "      <separator/>"
     "      <menuitem action='Save'/>"
@@ -200,6 +204,14 @@
   {
     Glib::RefPtr<Gtk::RecentAction> recent_action = Gtk::RecentAction::create("FileRecentFiles", Gtk::Stock::OPEN);
 
+    // Not sure what this does, but it seems to help bring recent items up to the top
+    recent_action->set_sort_type(Gtk::RECENT_SORT_MRU);
+
+    // Show only file:// resources
+    recent_action->set_local_only();
+
+    recent_action->set_limit(25);
+
     Gtk::RecentFilter* filter= Gtk::manage(new Gtk::RecentFilter);
     filter->add_mime_type("application/windstille");
     //filter->add_application("Windstille Editor");



From grumbel at mail.berlios.de  Sat Apr  4 06:35:30 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sat, 4 Apr 2009 06:35:30 +0200
Subject: [Windstille-commit] r2864 - in trunk/windstille:
	data/sectors/trainstation src/editor
Message-ID: <200904040435.n344ZUbl019625@sheep.berlios.de>

Author: grumbel
Date: 2009-04-04 06:35:24 +0200 (Sat, 04 Apr 2009)
New Revision: 2864

Modified:
   trunk/windstille/data/sectors/trainstation/toilet.wst
   trunk/windstille/src/editor/editor_window.hpp
   trunk/windstille/src/editor/sector_model.cpp
   trunk/windstille/src/editor/sector_model.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
Log:
Added support for loading/saving ambient-color

Modified: trunk/windstille/data/sectors/trainstation/toilet.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/toilet.wst	2009-04-04 04:33:05 UTC (rev 2863)
+++ trunk/windstille/data/sectors/trainstation/toilet.wst	2009-04-04 04:35:24 UTC (rev 2864)
@@ -3,7 +3,7 @@
 (windstille-sector
   (version 2)
   (name "")
-  (ambient-color 0 0 0 1)
+  (ambient-color 0.5 0.5 0.5 1)
   (init-script "init.nut")
   (layer
     (name "Scene")

Modified: trunk/windstille/src/editor/editor_window.hpp
===================================================================
--- trunk/windstille/src/editor/editor_window.hpp	2009-04-04 04:33:05 UTC (rev 2863)
+++ trunk/windstille/src/editor/editor_window.hpp	2009-04-04 04:35:24 UTC (rev 2864)
@@ -139,6 +139,9 @@
   
   void load_file(const std::string& filename);
 
+  /** Queue a file to be loaded once the editor is full realized */
+  void queue_for_load(const std::string& filename);
+
   void call_with_windstille_widget(void (WindstilleWidget::*func)());
 
   void on_recent_file(const Glib::RefPtr<Gtk::RecentAction>& recent_action);

Modified: trunk/windstille/src/editor/sector_model.cpp
===================================================================
--- trunk/windstille/src/editor/sector_model.cpp	2009-04-04 04:33:05 UTC (rev 2863)
+++ trunk/windstille/src/editor/sector_model.cpp	2009-04-04 04:35:24 UTC (rev 2864)
@@ -346,6 +346,9 @@
       FileReader reader = FileReader::parse(stream, filename);
       if (reader.get_name() == "windstille-sector")
         {
+          ambient_color = Color(0,0,0,1);
+          reader.get("ambient-color", ambient_color);
+
           const std::vector<FileReader>& sections = reader.get_sections();
           for(std::vector<FileReader>::const_iterator i = sections.begin(); i != sections.end(); ++i)
             {
@@ -380,7 +383,7 @@
 
   writer.write("version", 2);
   writer.write("name", "");
-  writer.write("ambient-color", Color());
+  writer.write("ambient-color", ambient_color);
   writer.write("init-script", "init.nut");
 
   write(writer, *(layer_tree->children().begin()));

Modified: trunk/windstille/src/editor/sector_model.hpp
===================================================================
--- trunk/windstille/src/editor/sector_model.hpp	2009-04-04 04:33:05 UTC (rev 2863)
+++ trunk/windstille/src/editor/sector_model.hpp	2009-04-04 04:35:24 UTC (rev 2864)
@@ -25,6 +25,7 @@
 #include <gdkmm/pixbuf.h>
 #include <vector>
 
+#include "display/color.hpp"
 #include "layer.hpp"
 #include "selection.hpp"
 #include "object_model.hpp"
@@ -66,7 +67,8 @@
 {
 private:
   Glib::RefPtr<Gtk::TreeStore> layer_tree;
-
+  Color ambient_color;
+  
 public:
   //typedef Objects::iterator iterator;
   typedef std::vector<LayerHandle> Layers;
@@ -87,6 +89,9 @@
   void add(const ObjectModelHandle& object, const Gtk::TreeModel::Path& path);
   void remove(const ObjectModelHandle& object);
 
+  void  set_ambient_color(const Color& color) { ambient_color = color; }
+  Color get_ambient_color() const { return ambient_color; }
+
   LayerHandle get_layer(const Gtk::TreeModel::Path& path) const;
   Layers get_layers() const;
   LayerHandle get_layer(ObjectModelHandle object);

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-04 04:33:05 UTC (rev 2863)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-04 04:35:24 UTC (rev 2864)
@@ -238,6 +238,8 @@
     {
       state.push(*sc);
       
+      sc->light().fill_screen(sector_model->get_ambient_color());
+
       if (draw_background_pattern)
         {
           sc->color().fill_pattern(background_pattern, 



From grumbel at mail.berlios.de  Sat Apr  4 06:36:27 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sat, 4 Apr 2009 06:36:27 +0200
Subject: [Windstille-commit] r2865 - trunk/windstille/data/sectors
Message-ID: <200904040436.n344aR17020208@sheep.berlios.de>

Author: grumbel
Date: 2009-04-04 06:36:24 +0200 (Sat, 04 Apr 2009)
New Revision: 2865

Added:
   trunk/windstille/data/sectors/bar.wst
Log:
Added another sector

Added: trunk/windstille/data/sectors/bar.wst
===================================================================
--- trunk/windstille/data/sectors/bar.wst	2009-04-04 04:35:24 UTC (rev 2864)
+++ trunk/windstille/data/sectors/bar.wst	2009-04-04 04:36:24 UTC (rev 2865)
@@ -0,0 +1,189 @@
+;; -*- scheme -*-
+
+(windstille-sector
+  (version 1)
+  (name "")
+  (ambient-color 0 0 0 1)
+  (init-script "init.nut")
+  (layer
+    (name "Scene")
+    (visible 1)
+    (locked 1)
+    (objects
+      (decal
+        (pos 540.188 405.812)
+        (parent "")
+        (layer 1)
+        (path "images/objects/bar/seat.png")
+        (type 0))
+      (decal
+        (pos 805.375 380.812)
+        (parent "")
+        (layer 1)
+        (path "images/objects/bar/door.png")
+        (type 0))
+      (decal
+        (pos 329.25 444.812)
+        (parent "")
+        (layer 1)
+        (path "images/objects/bar/table.png")
+        (type 0))
+      (decal
+        (pos 1059 323)
+        (parent "")
+        (layer 1)
+        (path "images/objects/bar/doubledoor.png")
+        (type 0))
+      (decal
+        (pos -123.812 465.812)
+        (parent "")
+        (layer 1)
+        (path "images/objects/bar.png")
+        (type 0))
+      (decal
+        (pos 997.375 572.812)
+        (parent "")
+        (layer 1)
+        (path "images/objects/blueground.png")
+        (type 0))
+      (decal
+        (pos 741.375 572.812)
+        (parent "")
+        (layer 1)
+        (path "images/objects/blueground.png")
+        (type 0))
+      (decal
+        (pos 229.375 572.812)
+        (parent "")
+        (layer 1)
+        (path "images/objects/blueground.png")
+        (type 0))
+      (decal
+        (pos 485.375 572.812)
+        (parent "")
+        (layer 1)
+        (path "images/objects/blueground.png")
+        (type 0))
+      (decal
+        (pos -282.625 572.812)
+        (parent "")
+        (layer 1)
+        (path "images/objects/blueground.png")
+        (type 0))
+      (decal
+        (pos -26.6251 572.812)
+        (parent "")
+        (layer 1)
+        (path "images/objects/blueground.png")
+        (type 0)))
+    (child-layers
+      (layer
+        (name "Stuff")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (pos -10.8125 433.812)
+            (parent "")
+            (layer 1)
+            (path "images/objects/bar/stool.png")
+            (type 0))
+          (decal
+            (pos 610.188 379.812)
+            (parent "")
+            (layer 1)
+            (path "images/objects/bar/seat_separator.png")
+            (type 0)))
+        (child-layers))
+      (layer
+        (name "Shadow")
+        (visible 1)
+        (locked 1)
+        (objects
+          (decal
+            (pos 414.367 555.053)
+            (parent "")
+            (layer 1)
+            (path "images/decal/dark.png")
+            (type 0)))
+        (child-layers))
+      (layer
+        (name "Wall")
+        (visible 1)
+        (locked 0)
+        (objects
+          (decal
+            (pos 933.375 316.812)
+            (parent "")
+            (layer 1)
+            (path "images/decal/wall3.png")
+            (type 0))
+          (decal
+            (pos 1061.37 316.812)
+            (parent "")
+            (layer 1)
+            (path "images/decal/wall2.png")
+            (type 0))
+          (decal
+            (pos 805.375 316.812)
+            (parent "")
+            (layer 1)
+            (path "images/decal/wall1.png")
+            (type 0))
+          (decal
+            (pos 421.375 316.812)
+            (parent "")
+            (layer 1)
+            (path "images/decal/wall1.png")
+            (type 0))
+          (decal
+            (pos 677.375 316.812)
+            (parent "")
+            (layer 1)
+            (path "images/decal/wall2.png")
+            (type 0))
+          (decal
+            (pos 549.375 316.812)
+            (parent "")
+            (layer 1)
+            (path "images/decal/wall3.png")
+            (type 0))
+          (decal
+            (pos 37.3748 316.812)
+            (parent "")
+            (layer 1)
+            (path "images/decal/wall1.png")
+            (type 0))
+          (decal
+            (pos 293.375 316.812)
+            (parent "")
+            (layer 1)
+            (path "images/decal/wall2.png")
+            (type 0))
+          (decal
+            (pos 165.375 316.812)
+            (parent "")
+            (layer 1)
+            (path "images/decal/wall3.png")
+            (type 0))
+          (decal
+            (pos -346.625 316.812)
+            (parent "")
+            (layer 1)
+            (path "images/decal/wall1.png")
+            (type 0))
+          (decal
+            (pos -90.6252 316.812)
+            (parent "")
+            (layer 1)
+            (path "images/decal/wall2.png")
+            (type 0))
+          (decal
+            (pos -218.625 316.812)
+            (parent "")
+            (layer 1)
+            (path "images/decal/wall3.png")
+            (type 0)))
+        (child-layers)))))
+
+;; EOF ;;



From grumbel at mail.berlios.de  Sun Apr  5 00:37:39 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sun, 5 Apr 2009 00:37:39 +0200
Subject: [Windstille-commit] r2866 - in trunk/windstille/src: display editor
	math
Message-ID: <200904042237.n34MbdFU032161@sheep.berlios.de>

Author: grumbel
Date: 2009-04-05 00:37:36 +0200 (Sun, 05 Apr 2009)
New Revision: 2866

Modified:
   trunk/windstille/src/display/display.cpp
   trunk/windstille/src/display/display.hpp
   trunk/windstille/src/display/drawing_context.cpp
   trunk/windstille/src/display/drawing_context.hpp
   trunk/windstille/src/editor/decal_object_model.cpp
   trunk/windstille/src/editor/decal_object_model.hpp
   trunk/windstille/src/editor/object_model.cpp
   trunk/windstille/src/editor/object_model.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
   trunk/windstille/src/math/quad.hpp
Log:
Added some more Quad drawing

Modified: trunk/windstille/src/display/display.cpp
===================================================================
--- trunk/windstille/src/display/display.cpp	2009-04-04 04:36:24 UTC (rev 2865)
+++ trunk/windstille/src/display/display.cpp	2009-04-04 22:37:36 UTC (rev 2866)
@@ -73,6 +73,40 @@
 }
 
 void
+Display::fill_quad(const Quad& quad, const Color& color)
+{
+  OpenGLState state;
+  state.enable(GL_BLEND);
+  state.set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
+  state.color(color);
+  state.activate();
+
+  glBegin(GL_QUADS);
+  glVertex2f(quad.p1.x, quad.p1.y);
+  glVertex2f(quad.p2.x, quad.p2.y);
+  glVertex2f(quad.p3.x, quad.p3.y);
+  glVertex2f(quad.p4.x, quad.p4.y);
+  glEnd();  
+}
+
+void
+Display::draw_quad(const Quad& quad, const Color& color)
+{
+  OpenGLState state;
+  state.enable(GL_BLEND);
+  state.set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
+  state.color(color);
+  state.activate();
+
+  glBegin(GL_LINE_LOOP);
+  glVertex2f(quad.p1.x, quad.p1.y);
+  glVertex2f(quad.p2.x, quad.p2.y);
+  glVertex2f(quad.p3.x, quad.p3.y);
+  glVertex2f(quad.p4.x, quad.p4.y);
+  glEnd();
+}
+
+void
 Display::fill_rect(const Rectf& rect, const Color& color)
 {
   OpenGLState state;

Modified: trunk/windstille/src/display/display.hpp
===================================================================
--- trunk/windstille/src/display/display.hpp	2009-04-04 04:36:24 UTC (rev 2865)
+++ trunk/windstille/src/display/display.hpp	2009-04-04 22:37:36 UTC (rev 2866)
@@ -23,6 +23,7 @@
 #include <SDL.h>
 #include "math/size.hpp"
 #include "math/rect.hpp"
+#include "math/quad.hpp"
 #include "math/line.hpp"
 #include "color.hpp"
 #include "display/framebuffer.hpp"
@@ -36,6 +37,9 @@
   static Size aspect_size;
   
 public:
+  static void fill_quad(const Quad& quad, const Color& color);
+  static void draw_quad(const Quad& quad, const Color& color);
+
   static void fill_rect(const Rectf& rect, const Color& color);
   static void draw_rect(const Rectf& rect, const Color& color);
 

Modified: trunk/windstille/src/display/drawing_context.cpp
===================================================================
--- trunk/windstille/src/display/drawing_context.cpp	2009-04-04 04:36:24 UTC (rev 2865)
+++ trunk/windstille/src/display/drawing_context.cpp	2009-04-04 22:37:36 UTC (rev 2866)
@@ -456,11 +456,57 @@
 }
 
 void
+DrawingContext::draw_quad(const Quad& quad, const Color& color, float z_pos)
+{
+  VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector2f(0, 0), z_pos, modelview_stack.back());
+
+  array->set_mode(GL_LINE_LOOP);
+  array->set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
+
+  array->color(color);
+  array->vertex(quad.p1.x, quad.p1.y);
+
+  array->color(color);
+  array->vertex(quad.p2.x, quad.p2.y);
+
+  array->color(color);
+  array->vertex(quad.p3.x, quad.p3.y);
+
+  array->color(color);
+  array->vertex(quad.p4.x, quad.p4.y);
+  
+  draw(array);
+}
+
+void
+DrawingContext::fill_quad(const Quad& quad, const Color& color, float z_pos)
+{
+  VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector2f(0, 0), z_pos, modelview_stack.back());
+
+  array->set_mode(GL_QUADS);
+  array->set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
+
+  array->color(color);
+  array->vertex(quad.p1.x, quad.p1.y);
+
+  array->color(color);
+  array->vertex(quad.p2.x, quad.p2.y);
+
+  array->color(color);
+  array->vertex(quad.p3.x, quad.p3.y);
+
+  array->color(color);
+  array->vertex(quad.p4.x, quad.p4.y);
+
+  draw(array); 
+}
+
+void
 DrawingContext::draw_rect(const Rectf& rect, const Color& color, float z_pos)
 {
   VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector2f(0, 0), z_pos, modelview_stack.back());
 
-  array->set_mode(GL_LINE_STRIP);
+  array->set_mode(GL_LINE_LOOP);
   array->set_blend_func(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
 
   array->color(color);
@@ -475,9 +521,6 @@
   array->color(color);
   array->vertex(rect.left, rect.bottom);  
   
-  array->color(color);
-  array->vertex(rect.left, rect.top);
-  
   draw(array);
 }
 

Modified: trunk/windstille/src/display/drawing_context.hpp
===================================================================
--- trunk/windstille/src/display/drawing_context.hpp	2009-04-04 04:36:24 UTC (rev 2865)
+++ trunk/windstille/src/display/drawing_context.hpp	2009-04-04 22:37:36 UTC (rev 2866)
@@ -70,6 +70,9 @@
   void draw_rect(const Rectf& rect, const Color& color, float z_pos = 0);
   void fill_rect(const Rectf& rect, const Color& color, float z_pos = 0);
 
+  void draw_quad(const Quad& quad, const Color& color, float z_pos = 0);
+  void fill_quad(const Quad& quad, const Color& color, float z_pos = 0);
+
   /*{ */
   void draw(DrawingRequest* request);
   void draw(const Sprite&   sprite,  const Vector2f& pos, float z = 0);

Modified: trunk/windstille/src/editor/decal_object_model.cpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.cpp	2009-04-04 04:36:24 UTC (rev 2865)
+++ trunk/windstille/src/editor/decal_object_model.cpp	2009-04-04 22:37:36 UTC (rev 2866)
@@ -80,6 +80,19 @@
 }
 
 void
+DecalObjectModel::draw_select(SceneContext& sc, bool highlight)
+{
+  Quad quad(get_bounding_box());
+  
+  quad.rotate(angle);
+
+  if (highlight)
+    sc.control().draw_quad(quad, Color(0.5f, 1.0f, 1.0f, 1.0f));
+  else
+    sc.control().draw_quad(quad, Color(0.5f, 0.5f, 1.0f, 1.0f));
+}
+
+void
 DecalObjectModel::draw(SceneContext& sc)
 {
   ObjectModel::draw(sc);

Modified: trunk/windstille/src/editor/decal_object_model.hpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.hpp	2009-04-04 04:36:24 UTC (rev 2865)
+++ trunk/windstille/src/editor/decal_object_model.hpp	2009-04-04 22:37:36 UTC (rev 2866)
@@ -57,7 +57,10 @@
   float get_angle() const { return angle; }
 
   bool is_snappable() const { return type == COLORMAP; }
+
+  void draw_select(SceneContext& sc, bool highlight);
   void draw(SceneContext& sc);
+
   Rectf get_bounding_box() const;
   ObjectModelHandle clone() const;
   void write(FileWriter& writer) const;

Modified: trunk/windstille/src/editor/object_model.cpp
===================================================================
--- trunk/windstille/src/editor/object_model.cpp	2009-04-04 04:36:24 UTC (rev 2865)
+++ trunk/windstille/src/editor/object_model.cpp	2009-04-04 22:37:36 UTC (rev 2866)
@@ -131,6 +131,15 @@
 }
 
 void
+ObjectModel::draw_select(SceneContext& sc, bool highlight)
+{
+  if (highlight)
+    sc.control().draw_rect(get_bounding_box(), Color(1.0f, 1.0f, 1.0f, 1.0f));
+  else
+    sc.control().draw_rect(get_bounding_box(), Color(0.5f, 0.5f, 1.0f, 1.0f));
+}
+
+void
 ObjectModel::draw(SceneContext& sc)
 {
   Vector2f wo_pos = get_world_pos();

Modified: trunk/windstille/src/editor/object_model.hpp
===================================================================
--- trunk/windstille/src/editor/object_model.hpp	2009-04-04 04:36:24 UTC (rev 2865)
+++ trunk/windstille/src/editor/object_model.hpp	2009-04-04 22:37:36 UTC (rev 2866)
@@ -84,6 +84,8 @@
 
   virtual bool is_snappable() const { return true; }
 
+  virtual void draw_select(SceneContext& sc, bool highlight);
+
   virtual void draw(SceneContext& sc);
   virtual void update(float delta) {}
   virtual Rectf get_bounding_box() const = 0;

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-04 04:36:24 UTC (rev 2865)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-04 22:37:36 UTC (rev 2866)
@@ -259,10 +259,7 @@
         {
           for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
             {
-              if (i == selection->begin())
-                sc->control().draw_rect((*i)->get_bounding_box(), Color(1.0f, 1.0f, 1.0f, 1.0f));
-              else
-                sc->control().draw_rect((*i)->get_bounding_box(), Color(0.5f, 0.5f, 1.0f, 1.0f));
+              (*i)->draw_select(*sc, i == selection->begin());
             }
 
           //sc->control().draw_rect(selection->get_bounding_box(), Color(1.0f, 1.0f, 1.0f, 1.0f));

Modified: trunk/windstille/src/math/quad.hpp
===================================================================
--- trunk/windstille/src/math/quad.hpp	2009-04-04 04:36:24 UTC (rev 2865)
+++ trunk/windstille/src/math/quad.hpp	2009-04-04 22:37:36 UTC (rev 2866)
@@ -37,6 +37,13 @@
   Quad()
   {}
 
+  Quad(const Rectf& rect) 
+    : p1(rect.left, rect.top),
+      p2(rect.right, rect.top),
+      p3(rect.right, rect.bottom),
+      p4(rect.left, rect.bottom)
+  {}
+
   Quad(float x1, float y1,
        float x2, float y2)
     : p1(x1, y1),



From grumbel at mail.berlios.de  Sun Apr  5 01:28:19 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sun, 5 Apr 2009 01:28:19 +0200
Subject: [Windstille-commit] r2867 - in trunk/windstille: data/editor
	src/editor
Message-ID: <200904042328.n34NSJeX017246@sheep.berlios.de>

Author: grumbel
Date: 2009-04-05 01:28:18 +0200 (Sun, 05 Apr 2009)
New Revision: 2867

Modified:
   trunk/windstille/data/editor/scale_handle.png
   trunk/windstille/src/editor/decal_object_model.cpp
   trunk/windstille/src/editor/decal_object_model.hpp
   trunk/windstille/src/editor/layer.cpp
   trunk/windstille/src/editor/object_model.cpp
   trunk/windstille/src/editor/object_model.hpp
Log:
Fixed handling of ControlPoints of rotated DecalObjects

Modified: trunk/windstille/data/editor/scale_handle.png
===================================================================
(Binary files differ)

Modified: trunk/windstille/src/editor/decal_object_model.cpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.cpp	2009-04-04 22:37:36 UTC (rev 2866)
+++ trunk/windstille/src/editor/decal_object_model.cpp	2009-04-04 23:28:18 UTC (rev 2867)
@@ -77,6 +77,10 @@
 DecalObjectModel::set_scale(const Vector2f& scale_)
 {
   scale = scale_;
+
+  // Disallow negative scale
+  scale.x = fabsf(scale.x);
+  scale.y = fabsf(scale.y);
 }
 
 void
@@ -207,9 +211,7 @@
   void draw(SceneContext& sc)
   {
     Rectf rect = get_bounding_box();
-
     rect += offset;
-
     sc.control().draw_control(surface, pos, ctrl_angle);
   }
 };
@@ -218,12 +220,14 @@
 {
 private:
   DecalObjectModel* object;
+  float ctrl_angle;
   Vector2f orig_scale;
 
 public:
-  DecalScaleControlPoint(DecalObjectModel* object_, const Vector2f& pos_)
+  DecalScaleControlPoint(DecalObjectModel* object_, float ctrl_angle_, const Vector2f& pos_)
     : ControlPoint(Surface("editor/scale_handle.png"), pos_),
       object(object_),
+      ctrl_angle(ctrl_angle_),
       orig_scale(object_->get_scale())
   {}
 
@@ -233,16 +237,21 @@
 
   void on_move_update(const Vector2f& offset_) 
   {
-    offset = offset_;
+    offset = offset_; 
 
     Vector2f start   = pos - object->get_world_pos();
     Vector2f current = (pos + offset) - object->get_world_pos();
 
-    //std::cout << "on_move_update: " << (current.x / start.x) << " " << (current.y / start.y) << std::endl;  
+    start    = start.rotate(-object->get_angle());
+    current = current.rotate(-object->get_angle());
+    
+    //std::cout << "on_move_update: " << current.x << " " << current.y << std::endl;  
 
     Vector2f new_scale = current / start;
+
     new_scale.x *= orig_scale.x;
     new_scale.y *= orig_scale.y;
+
     object->set_scale(new_scale);
   }
   
@@ -250,7 +259,33 @@
   {
     on_move_update(offset_);
   }
+
+  void draw(SceneContext& sc)
+  {
+    Rectf rect = get_bounding_box();
+    rect += offset;
+    sc.control().draw_control(surface, pos, ctrl_angle);
+  }
 };
+
+bool
+DecalObjectModel::is_at(const Vector2f& pos) const
+{
+  Vector2f p = pos - get_world_pos();
+  p = p.rotate(-angle);
+  p.x /= scale.x;
+  p.y /= scale.y;
+
+  if (fabsf(p.x) < surface.get_width()/2 &&
+      fabsf(p.y) < surface.get_height()/2)
+    {
+      return true;
+    }
+  else
+    {
+      return false;
+    }
+}
 
 void
 DecalObjectModel::add_control_points(std::vector<ControlPointHandle>& control_points)
@@ -258,15 +293,22 @@
   float w = surface.get_width()/2  * scale.x;
   float h = surface.get_height()/2 * scale.y;
 
-  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, get_world_pos() - Vector2f(-w, -h))));
-  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, get_world_pos() - Vector2f( w, -h))));
-  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, get_world_pos() - Vector2f( w,  h))));
-  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, get_world_pos() - Vector2f(-w,  h))));
+  Rectf rect(-w, -h, w, h);
+  Quad quad1(rect);
+  quad1.rotate(angle);
 
-  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, M_PI, get_world_pos() - Vector2f(-32-w, -32-h))));
-  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, M_PI+M_PI/2, get_world_pos() - Vector2f(32+w, -32-h))));
-  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, M_PI+2*M_PI/2, get_world_pos() - Vector2f(32+w,  32+h))));
-  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, M_PI+3*M_PI/2, get_world_pos() - Vector2f(-32-w, 32+h))));
+  Quad quad2(rect.grow(32));
+  quad2.rotate(angle);
+
+  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, angle + 0*M_PI/2, get_world_pos() + quad1.p1)));
+  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, angle + 1*M_PI/2, get_world_pos() + quad1.p2)));
+  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, angle + 2*M_PI/2, get_world_pos() + quad1.p3)));
+  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, angle + 3*M_PI/2, get_world_pos() + quad1.p4)));
+
+  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, angle + 0*M_PI/2, get_world_pos() + quad2.p1)));
+  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, angle + 1*M_PI/2, get_world_pos() + quad2.p2)));
+  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, angle + 2*M_PI/2, get_world_pos() + quad2.p3)));
+  control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, angle + 3*M_PI/2, get_world_pos() + quad2.p4)));
 }
 
 /* EOF */

Modified: trunk/windstille/src/editor/decal_object_model.hpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.hpp	2009-04-04 22:37:36 UTC (rev 2866)
+++ trunk/windstille/src/editor/decal_object_model.hpp	2009-04-04 23:28:18 UTC (rev 2867)
@@ -71,6 +71,8 @@
   void set_hflip(bool t) { hflip = t; }
   void set_vflip(bool t) { vflip = t; }
 
+  bool is_at(const Vector2f& pos) const;
+
   void reset();
 
   void add_control_points(std::vector<ControlPointHandle>& control_points);

Modified: trunk/windstille/src/editor/layer.cpp
===================================================================
--- trunk/windstille/src/editor/layer.cpp	2009-04-04 22:37:36 UTC (rev 2866)
+++ trunk/windstille/src/editor/layer.cpp	2009-04-04 23:28:18 UTC (rev 2867)
@@ -80,7 +80,7 @@
   for(Objects::const_reverse_iterator i = objects.rbegin(); i != objects.rend(); ++i)
     {
       if (select_mask.match((*i)->get_select_mask()) &&
-          (*i)->get_bounding_box().is_inside(pos))
+          (*i)->is_at(pos))
         {
           return *i;
         }

Modified: trunk/windstille/src/editor/object_model.cpp
===================================================================
--- trunk/windstille/src/editor/object_model.cpp	2009-04-04 22:37:36 UTC (rev 2866)
+++ trunk/windstille/src/editor/object_model.cpp	2009-04-04 23:28:18 UTC (rev 2867)
@@ -189,6 +189,12 @@
 {
 }
 
+bool
+ObjectModel::is_at(const Vector2f& pos) const
+{
+  return get_bounding_box().is_inside(pos);
+}
+
 static bool overlap(float l1, float r1,
                     float l2, float r2)
 {

Modified: trunk/windstille/src/editor/object_model.hpp
===================================================================
--- trunk/windstille/src/editor/object_model.hpp	2009-04-04 22:37:36 UTC (rev 2866)
+++ trunk/windstille/src/editor/object_model.hpp	2009-04-04 23:28:18 UTC (rev 2867)
@@ -82,6 +82,8 @@
   /** Reset scale and rotation to default values */
   virtual void reset();
 
+  virtual bool is_at(const Vector2f& pos) const;
+
   virtual bool is_snappable() const { return true; }
 
   virtual void draw_select(SceneContext& sc, bool highlight);



From grumbel at mail.berlios.de  Sun Apr  5 01:53:14 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sun, 5 Apr 2009 01:53:14 +0200
Subject: [Windstille-commit] r2868 - in trunk/windstille: . src/display
	src/editor
Message-ID: <200904042353.n34NrEe9008895@sheep.berlios.de>

Author: grumbel
Date: 2009-04-05 01:53:12 +0200 (Sun, 05 Apr 2009)
New Revision: 2868

Modified:
   trunk/windstille/TODO
   trunk/windstille/src/display/software_surface.cpp
   trunk/windstille/src/display/software_surface.hpp
   trunk/windstille/src/editor/decal_object_model.cpp
   trunk/windstille/src/editor/decal_object_model.hpp
Log:
Added pixel perfect click detection

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-04-04 23:28:18 UTC (rev 2867)
+++ trunk/windstille/TODO	2009-04-04 23:53:12 UTC (rev 2868)
@@ -186,10 +186,14 @@
 Miscellaneous
 =============
 
+* maybe add special support for opaque textures, i.e. Textures with
+  1-bit alpha, which could be used to bucket sort drawing requests and
+  reduce texture switches (in case those ever start posing a problem)
+
+* http://www.blackpawn.com/texts/lightmaps/default.html
+
 * Display::aspect_size is ugly, turn that into a Display::set_size();
 
-* make FileReader const
-
 * move particle system into library
 
 * replace lisp::Writer with custom FileWriter (used in config)
@@ -488,8 +492,11 @@
 Graphics
 ========
 
-* generate .png's directly from .xcf's
+* do *NOT* use power of two textures, use multiple of 64/128 instead
+  (128 is easy to snap, power of two doesn't help, since textures are packed)
 
+* generate .png's automatically from .xcf's via scons
+
 * figure out a way how to properly organize graphics/decal
 
 * Model lower-poly version of Jane and stuff
@@ -507,6 +514,17 @@
 Editor
 ======
 
+* share SoftwareSurface via Manager class
+
+* add binlocate support
+
+* add an icon to the editor
+
+* remove the empty default sector when loading another level and the
+  default sector hasn't been modified
+
+* add a way to adjust the ambient lighting (button to change color) 
+
 * maybe make Layers not be hardwired into the level struture, but add
   them as independed meta-data:
  
@@ -537,15 +555,16 @@
 
    - flipping via uv is trivial and doesn't lead to any trouble with
      float instability/snapping, could be easily extended to
-     90/180/270 rotations
+     90/180/270 rotations (see Pingus source)
 
    - rotation and scale can't easily be reset or edited separately
+     with matrix
 
    - float instability might lead to gaps between objects
 
 * (id ...) is a string'ified pointer, while this work, this causes the
-  levels to be different after each and every load/save cycle, should
-  be something more constant
+  levels to be different after each and every load/save cycle, which
+  leads to ugly huge diff in SVN, should be something more constant
 
 * add rectangle overlay that indicates the visible area of the game (i.e. one screen in current zoom size
 
@@ -695,10 +714,6 @@
 * ObjectSelector/IconView allows drag&drop even when nothing is
   selected, leading to a Grumbel dummy image drag&drop without effect
 
-* save a bitmask along with an object to allow pixel perfect click
-  selection, for scaled, rotated or otherwise deformed objects the
-  mouse coordinates need to be transformed into texture space
-
 * add a way to draw objects to DrawingContext that only does
   translation, but not rotation and scaling, for use in UIElements,
   overlay text, etc.

Modified: trunk/windstille/src/display/software_surface.cpp
===================================================================
--- trunk/windstille/src/display/software_surface.cpp	2009-04-04 23:28:18 UTC (rev 2867)
+++ trunk/windstille/src/display/software_surface.cpp	2009-04-04 23:53:12 UTC (rev 2868)
@@ -16,6 +16,7 @@
 **  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
 
+#include <iostream>
 #include <sstream>
 #include <stdexcept>
 #include <SDL_image.h>
@@ -140,5 +141,21 @@
   
   SDL_BlitSurface(impl->surface, &src_rect, dst.impl->surface, &dst_rect);
 }
+
+bool
+SoftwareSurface::is_at(int x, int y) const
+{
+  if (x >= 0 && x < impl->surface->w &&
+      y >= 0 && y < impl->surface->h)
+    {
+      uint8_t* pixels = (uint8_t*)impl->surface->pixels;
+      
+      return pixels[y * impl->surface->pitch + x*4 + 3] > 128;
+    }
+  else
+    {
+      return false;
+    }
+}
 
 /* EOF */

Modified: trunk/windstille/src/display/software_surface.hpp
===================================================================
--- trunk/windstille/src/display/software_surface.hpp	2009-04-04 23:28:18 UTC (rev 2867)
+++ trunk/windstille/src/display/software_surface.hpp	2009-04-04 23:53:12 UTC (rev 2868)
@@ -16,8 +16,8 @@
 **  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
 
-#ifndef HEADER_SOFTWARE_SURFACE_HPP
-#define HEADER_SOFTWARE_SURFACE_HPP
+#ifndef HEADER_WINDSTILLE_DISPLAY_SOFTWARE_SURFACE_HPP
+#define HEADER_WINDSTILLE_DISPLAY_SOFTWARE_SURFACE_HPP
 
 #include "SDL.h"
 #include <boost/shared_ptr.hpp>
@@ -34,6 +34,7 @@
     RGBA
   };
 
+  SoftwareSurface() {}
   SoftwareSurface(const std::string& filename);
   SoftwareSurface(int width, int height, Format format = RGBA);
   ~SoftwareSurface();
@@ -50,6 +51,10 @@
 
   SDL_Surface* get_surface() const;
 
+  bool is_at(int x, int y) const;
+
+  operator bool() { return impl; }
+
 private:
   boost::shared_ptr<SoftwareSurfaceImpl> impl;
 };

Modified: trunk/windstille/src/editor/decal_object_model.cpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.cpp	2009-04-04 23:28:18 UTC (rev 2867)
+++ trunk/windstille/src/editor/decal_object_model.cpp	2009-04-04 23:53:12 UTC (rev 2868)
@@ -48,6 +48,7 @@
   reader.get("hflip", hflip);
   reader.get("vflip", vflip);
   surface = Surface(path);
+  software_surface = SoftwareSurface(path);
 }
 
 DecalObjectModel::DecalObjectModel(const std::string& name, const Vector2f& rel_pos, 
@@ -55,6 +56,7 @@
   : ObjectModel("DecalObjectModel", rel_pos),
     path(path_),
     surface(path_),
+    software_surface(path_),
     type(type_),
     scale(1.0f, 1.0f),
     angle(0.0f),
@@ -272,6 +274,9 @@
 DecalObjectModel::is_at(const Vector2f& pos) const
 {
   Vector2f p = pos - get_world_pos();
+
+  // Transform mouse coordinates into coordinates relative to the
+  // center of the unscaled and unrotated image
   p = p.rotate(-angle);
   p.x /= scale.x;
   p.y /= scale.y;
@@ -279,7 +284,8 @@
   if (fabsf(p.x) < surface.get_width()/2 &&
       fabsf(p.y) < surface.get_height()/2)
     {
-      return true;
+      return software_surface.is_at(static_cast<int>(p.x + surface.get_width()/2),
+                                    static_cast<int>(p.y + surface.get_height()/2));
     }
   else
     {

Modified: trunk/windstille/src/editor/decal_object_model.hpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.hpp	2009-04-04 23:28:18 UTC (rev 2867)
+++ trunk/windstille/src/editor/decal_object_model.hpp	2009-04-04 23:53:12 UTC (rev 2868)
@@ -22,6 +22,7 @@
 #include "math/quad.hpp"
 #include "control_point.hpp"
 #include "display/surface.hpp"
+#include "display/software_surface.hpp"
 #include "object_model.hpp"
 
 class DecalObjectModel : public ObjectModel
@@ -34,6 +35,7 @@
 private:
   std::string path;
   Surface surface;
+  SoftwareSurface software_surface;
   MapType type;
 
   /** scale of the object, independed in x and y axis */



From grumbel at mail.berlios.de  Sun Apr  5 02:44:04 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sun, 5 Apr 2009 02:44:04 +0200
Subject: [Windstille-commit] r2869 - trunk/windstille/src/editor
Message-ID: <200904050044.n350i4EZ014622@sheep.berlios.de>

Author: grumbel
Date: 2009-04-05 02:44:03 +0200 (Sun, 05 Apr 2009)
New Revision: 2869

Modified:
   trunk/windstille/src/editor/decal_object_model.cpp
Log:
Added is_at() handling for flipped decal

Modified: trunk/windstille/src/editor/decal_object_model.cpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.cpp	2009-04-04 23:53:12 UTC (rev 2868)
+++ trunk/windstille/src/editor/decal_object_model.cpp	2009-04-05 00:44:03 UTC (rev 2869)
@@ -284,6 +284,12 @@
   if (fabsf(p.x) < surface.get_width()/2 &&
       fabsf(p.y) < surface.get_height()/2)
     {
+      if (hflip)
+        p.x = -p.x;
+
+      if (vflip)
+        p.y = -p.y;
+
       return software_surface.is_at(static_cast<int>(p.x + surface.get_width()/2),
                                     static_cast<int>(p.y + surface.get_height()/2));
     }



From grumbel at mail.berlios.de  Sun Apr  5 07:17:36 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sun, 5 Apr 2009 07:17:36 +0200
Subject: [Windstille-commit] r2870 - trunk/windstille/data/images/decal
Message-ID: <200904050517.n355Hank016403@sheep.berlios.de>

Author: grumbel
Date: 2009-04-05 07:17:13 +0200 (Sun, 05 Apr 2009)
New Revision: 2870

Added:
   trunk/windstille/data/images/decal/cabinet2.png
   trunk/windstille/data/images/decal/dirty1.png
   trunk/windstille/data/images/decal/dirty2.png
   trunk/windstille/data/images/decal/dirty3.png
   trunk/windstille/data/images/decal/dirty4.png
   trunk/windstille/data/images/decal/dirty5.png
   trunk/windstille/data/images/decal/dirty6.png
   trunk/windstille/data/images/decal/dirty7.png
   trunk/windstille/data/images/decal/dirty8.png
   trunk/windstille/data/images/decal/plant1.png
   trunk/windstille/data/images/decal/plant2.png
   trunk/windstille/data/images/decal/plant3.png
   trunk/windstille/data/images/decal/plant4.png
   trunk/windstille/data/images/decal/plant5.png
   trunk/windstille/data/images/decal/shelf.png
   trunk/windstille/data/images/decal/shelf2.png
   trunk/windstille/data/images/decal/steeltile1.png
   trunk/windstille/data/images/decal/steeltile2.png
   trunk/windstille/data/images/decal/steeltile3.png
   trunk/windstille/data/images/decal/steeltile4.png
   trunk/windstille/data/images/decal/steeltile5.png
   trunk/windstille/data/images/decal/steeltile6.png
   trunk/windstille/data/images/decal/toilet_door_open.png
   trunk/windstille/data/images/decal/toilet_door_open2.png
Modified:
   trunk/windstille/data/images/decal/dark.png
   trunk/windstille/data/images/decal/lamp1_highlight.png
Log:
More images

Added: trunk/windstille/data/images/decal/cabinet2.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/cabinet2.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/windstille/data/images/decal/dark.png
===================================================================
(Binary files differ)

Added: trunk/windstille/data/images/decal/dirty1.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/dirty1.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/dirty2.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/dirty2.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/dirty3.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/dirty3.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/dirty4.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/dirty4.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/dirty5.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/dirty5.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/dirty6.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/dirty6.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/dirty7.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/dirty7.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/dirty8.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/dirty8.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/windstille/data/images/decal/lamp1_highlight.png
===================================================================
(Binary files differ)

Added: trunk/windstille/data/images/decal/plant1.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/plant1.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/plant2.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/plant2.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/plant3.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/plant3.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/plant4.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/plant4.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/plant5.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/plant5.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/shelf.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/shelf.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/shelf2.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/shelf2.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/steeltile1.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/steeltile1.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/steeltile2.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/steeltile2.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/steeltile3.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/steeltile3.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/steeltile4.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/steeltile4.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/steeltile5.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/steeltile5.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/steeltile6.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/steeltile6.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/toilet_door_open.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/toilet_door_open.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/toilet_door_open2.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/toilet_door_open2.png
___________________________________________________________________
Name: svn:mime-type
   + image/png



From grumbel at mail.berlios.de  Sun Apr  5 07:20:11 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sun, 5 Apr 2009 07:20:11 +0200
Subject: [Windstille-commit] r2871 - trunk/windstille/src/editor
Message-ID: <200904050520.n355KBUV018618@sheep.berlios.de>

Author: grumbel
Date: 2009-04-05 07:20:10 +0200 (Sun, 05 Apr 2009)
New Revision: 2871

Modified:
   trunk/windstille/src/editor/windstille_widget.cpp
Log:
Fixed issue with ControlPoints not getting updated

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-05 05:17:13 UTC (rev 2870)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-05 05:20:10 UTC (rev 2871)
@@ -451,6 +451,8 @@
         }
     }
 
+  on_selection_change();
+
   queue_draw();
 }
 



From grumbel at mail.berlios.de  Sun Apr  5 19:53:55 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sun, 5 Apr 2009 19:53:55 +0200
Subject: [Windstille-commit] r2872 - in trunk/windstille/src: display tile
Message-ID: <200904051753.n35HrtaW014424@sheep.berlios.de>

Author: grumbel
Date: 2009-04-05 19:53:54 +0200 (Sun, 05 Apr 2009)
New Revision: 2872

Modified:
   trunk/windstille/src/display/shader_object.cpp
   trunk/windstille/src/display/shader_object.hpp
   trunk/windstille/src/display/surface.cpp
   trunk/windstille/src/display/texture.cpp
   trunk/windstille/src/tile/tile_packer.cpp
   trunk/windstille/src/tile/tile_packer.hpp
Log:
Micro cleanup

Modified: trunk/windstille/src/display/shader_object.cpp
===================================================================
--- trunk/windstille/src/display/shader_object.cpp	2009-04-05 05:20:10 UTC (rev 2871)
+++ trunk/windstille/src/display/shader_object.cpp	2009-04-05 17:53:54 UTC (rev 2872)
@@ -20,7 +20,7 @@
 #include <iostream>
 #include <stdio.h>
 #include "util/util.hpp"
-
+
 /** Read a file, user must free() the returned pointer */
 static GLchar* load_file(const char* filename)
 {
@@ -48,7 +48,7 @@
   fclose(f);
   return str;
 }
-
+
 class ShaderObjectImpl
 {
 public:
@@ -64,7 +64,7 @@
     glDeleteObjectARB(handle);
   }
 };
-
+
 ShaderObject::ShaderObject(GLenum type, const std::string& filename)
   : impl(new ShaderObjectImpl(type))
 {
@@ -127,5 +127,5 @@
     }
   assert_gl("print_log3");
 }
-
+
 /* EOF */

Modified: trunk/windstille/src/display/shader_object.hpp
===================================================================
--- trunk/windstille/src/display/shader_object.hpp	2009-04-05 05:20:10 UTC (rev 2871)
+++ trunk/windstille/src/display/shader_object.hpp	2009-04-05 17:53:54 UTC (rev 2872)
@@ -23,10 +23,9 @@
 #include <GL/gl.h>
 #include <string>
 #include <boost/shared_ptr.hpp>
-
+
 class ShaderObjectImpl;
-
-/** */
+
 class ShaderObject
 {
 public:
@@ -41,7 +40,7 @@
 private:
   boost::shared_ptr<ShaderObjectImpl> impl;
 };
-
+
 #endif
 
 /* EOF */

Modified: trunk/windstille/src/display/surface.cpp
===================================================================
--- trunk/windstille/src/display/surface.cpp	2009-04-05 05:20:10 UTC (rev 2871)
+++ trunk/windstille/src/display/surface.cpp	2009-04-05 17:53:54 UTC (rev 2872)
@@ -24,7 +24,7 @@
 #include "display/opengl_state.hpp"
 #include "surface_drawing_parameters.hpp"
 #include "surface_manager.hpp"
-
+
 class SurfaceImpl
 {
 public:
@@ -43,7 +43,7 @@
    */
   Size size;
 };
-
+
 Surface::Surface()
 {
 }
@@ -55,6 +55,7 @@
 }
 
 static int power_of_two(int val) {
+  // FIXME: Replace this with a non-while loop based one
   int result = 1;
   while(result < val)
     result *= 2;
@@ -181,5 +182,5 @@
 
   glEnd(); 
 }
-
+
 /* EOF */

Modified: trunk/windstille/src/display/texture.cpp
===================================================================
--- trunk/windstille/src/display/texture.cpp	2009-04-05 05:20:10 UTC (rev 2871)
+++ trunk/windstille/src/display/texture.cpp	2009-04-05 17:53:54 UTC (rev 2872)
@@ -26,7 +26,7 @@
 #include "display/opengl_state.hpp"
 #include "texture_manager.hpp"
 #include "util/util.hpp"
-
+
 class TextureImpl
 {
 public:
@@ -46,7 +46,7 @@
     glDeleteTextures(1, &handle);
   }
 };
-
+
 Texture::Texture()
 {
 }
@@ -248,5 +248,5 @@
 {
   return impl->target;
 }
-
+
 /* EOF */

Modified: trunk/windstille/src/tile/tile_packer.cpp
===================================================================
--- trunk/windstille/src/tile/tile_packer.cpp	2009-04-05 05:20:10 UTC (rev 2871)
+++ trunk/windstille/src/tile/tile_packer.cpp	2009-04-05 17:53:54 UTC (rev 2872)
@@ -25,7 +25,7 @@
 #include "util/util.hpp"
 #include "display/blitter.hpp"
 #include "display/software_surface.hpp"
-
+
 class TilePackerImpl
 {
 public:
@@ -38,7 +38,7 @@
   int width;
   int height;
 };
-
+
 TilePacker::TilePacker(int width, int height)
   : impl(new TilePackerImpl())
 {
@@ -117,5 +117,5 @@
 {
   return impl->texture;
 }
-
+
 /* EOF */

Modified: trunk/windstille/src/tile/tile_packer.hpp
===================================================================
--- trunk/windstille/src/tile/tile_packer.hpp	2009-04-05 05:20:10 UTC (rev 2871)
+++ trunk/windstille/src/tile/tile_packer.hpp	2009-04-05 17:53:54 UTC (rev 2872)
@@ -23,10 +23,10 @@
 #include <GL/gl.h>
 #include "display/texture.hpp"
 #include "math/rect.hpp"
-
+
 class SoftwareSurface;
 class TilePackerImpl;
-
+
 /** Creates a pixelbuffer of the given size and packs 32x32 large
     tiles into it for later conversion to a texture */
 class TilePacker
@@ -50,7 +50,7 @@
 private:
   TilePackerImpl* impl;
 };
-
+
 #endif
 
 /* EOF */



From grumbel at mail.berlios.de  Sun Apr  5 20:13:30 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sun, 5 Apr 2009 20:13:30 +0200
Subject: [Windstille-commit] r2873 - in trunk/windstille/src: . display
Message-ID: <200904051813.n35IDU2J016406@sheep.berlios.de>

Author: grumbel
Date: 2009-04-05 20:13:29 +0200 (Sun, 05 Apr 2009)
New Revision: 2873

Added:
   trunk/windstille/src/display/texture_packer.cpp
   trunk/windstille/src/display/texture_packer.hpp
Modified:
   trunk/windstille/src/SConscript
   trunk/windstille/src/display/software_surface.cpp
   trunk/windstille/src/display/software_surface.hpp
   trunk/windstille/src/display/surface_manager.cpp
   trunk/windstille/src/display/surface_manager.hpp
Log:
Added TexturePacker

Modified: trunk/windstille/src/SConscript
===================================================================
--- trunk/windstille/src/SConscript	2009-04-05 17:53:54 UTC (rev 2872)
+++ trunk/windstille/src/SConscript	2009-04-05 18:13:29 UTC (rev 2873)
@@ -85,6 +85,7 @@
         'display/text_area.cpp',
         'display/texture.cpp',
         'display/texture_manager.cpp',
+        'display/texture_packer.cpp',
         'display/vertex_array_drawing_request.cpp',
         
         'sprite2d/data.cpp',

Modified: trunk/windstille/src/display/software_surface.cpp
===================================================================
--- trunk/windstille/src/display/software_surface.cpp	2009-04-05 17:53:54 UTC (rev 2872)
+++ trunk/windstille/src/display/software_surface.cpp	2009-04-05 18:13:29 UTC (rev 2873)
@@ -98,6 +98,13 @@
   return impl->surface->h;
 }
 
+Size
+SoftwareSurface::get_size() const
+{
+  return Size(impl->surface->w, 
+              impl->surface->h);
+}
+
 int
 SoftwareSurface::get_pitch() const
 {

Modified: trunk/windstille/src/display/software_surface.hpp
===================================================================
--- trunk/windstille/src/display/software_surface.hpp	2009-04-05 17:53:54 UTC (rev 2872)
+++ trunk/windstille/src/display/software_surface.hpp	2009-04-05 18:13:29 UTC (rev 2873)
@@ -22,6 +22,8 @@
 #include "SDL.h"
 #include <boost/shared_ptr.hpp>
 #include <string>
+
+#include "math/size.hpp"
 
 class Rect;
 class SoftwareSurfaceImpl;
@@ -44,6 +46,7 @@
   int   get_width() const;
   int   get_pitch() const;
   int   get_height() const;
+  Size  get_size() const;
   void* get_pixels() const;
 
   void blit(SoftwareSurface& dst, int x, int y) const;

Modified: trunk/windstille/src/display/surface_manager.cpp
===================================================================
--- trunk/windstille/src/display/surface_manager.cpp	2009-04-05 17:53:54 UTC (rev 2872)
+++ trunk/windstille/src/display/surface_manager.cpp	2009-04-05 18:13:29 UTC (rev 2873)
@@ -30,11 +30,13 @@
 #include "surface.hpp"
 #include "software_surface.hpp"
 #include "texture_manager.hpp"
+#include "texture_packer.hpp"
 #include "physfs/physfs_sdl.hpp"
 
 SurfaceManager* SurfaceManager::current_ = 0;
-
+
 SurfaceManager::SurfaceManager()
+  : texture_packer(new TexturePacker(Size(2048, 2048)))
 {
   assert(current_ == 0);
   current_ = this;
@@ -69,24 +71,33 @@
     {
       SoftwareSurface image(filename);
 
-      float maxu, maxv;
-      Texture texture;
-
-      try
+      if (1)
         {
-          texture = create_texture(image, maxu, maxv);
+          // FIXME: Need to 'grow' the image by 1 pixel, so we don't get blending artifacts
+          Surface result = texture_packer->upload(image);
+          surfaces.insert(std::make_pair(filename, result));
+          return result;              
         }
-      catch(std::exception& e)
+      else
         {
-          std::ostringstream msg;
-          msg << "Couldn't create texture for '" << filename << "': " << e.what();
-          throw std::runtime_error(msg.str());
-        }
+          float maxu, maxv;
+          Texture texture;
 
-      Surface result(texture, Rectf(0, 0, maxu, maxv), image.get_width(), image.get_height());
-      surfaces.insert(std::make_pair(filename, result));
-  
-      return result;
+          try
+            {
+              texture = create_texture(image, maxu, maxv);
+            }
+          catch(std::exception& e)
+            {
+              std::ostringstream msg;
+              msg << "Couldn't create texture for '" << filename << "': " << e.what();
+              throw std::runtime_error(msg.str());
+            }
+        
+          Surface result(texture, Rectf(0, 0, maxu, maxv), image.get_width(), image.get_height());
+          surfaces.insert(std::make_pair(filename, result));
+          return result;
+        }      
     }
 }
 
@@ -162,6 +173,5 @@
         }
     }
 }
-
-
+
 /* EOF */

Modified: trunk/windstille/src/display/surface_manager.hpp
===================================================================
--- trunk/windstille/src/display/surface_manager.hpp	2009-04-05 17:53:54 UTC (rev 2872)
+++ trunk/windstille/src/display/surface_manager.hpp	2009-04-05 18:13:29 UTC (rev 2873)
@@ -19,15 +19,17 @@
 #ifndef HEADER_WINDSTILLE_DISPLAY_SURFACE_MANAGER_HPP
 #define HEADER_WINDSTILLE_DISPLAY_SURFACE_MANAGER_HPP
 
+#include <memory>
 #include <string>
 #include <vector>
 #include <map>
 #include <GL/glew.h>
 #include <GL/gl.h>
 #include "texture.hpp"
-
+
 class Surface;
-
+class TexturePacker;
+
 /**
  * This class keeps a list of loaded surfaces and manages loading new ones
  */
@@ -38,6 +40,8 @@
 public:
   static SurfaceManager* current() { return current_; } 
 
+  std::auto_ptr<TexturePacker> texture_packer;
+
 public:
   SurfaceManager();
   ~SurfaceManager();
@@ -61,7 +65,7 @@
   typedef std::map<std::string, Surface> Surfaces;
   Surfaces surfaces;
 };
-
+
 #endif
 
 /* EOF */

Added: trunk/windstille/src/display/texture_packer.cpp
===================================================================
--- trunk/windstille/src/display/texture_packer.cpp	2009-04-05 17:53:54 UTC (rev 2872)
+++ trunk/windstille/src/display/texture_packer.cpp	2009-04-05 18:13:29 UTC (rev 2873)
@@ -0,0 +1,165 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#include <stdexcept>
+#include <memory>
+
+#include "math/point.hpp"
+#include "display/software_surface.hpp"
+
+#include "texture_packer.hpp"
+
+class TextureSpace
+{
+private:
+  Rect          rect;
+  bool          used;
+  std::auto_ptr<TextureSpace> left;
+  std::auto_ptr<TextureSpace> right;
+
+public:
+  TextureSpace(const Rect& rect_)
+    : rect(rect_),
+      used(false)
+  {}
+
+  ~TextureSpace()
+  {}
+
+  bool allocate(const Size& size, Rect& out_rect)
+  {
+    if (size.width  <= rect.get_width() &&
+        size.height <= rect.get_height())
+      {
+        if (!used)
+          {
+            used = true;
+            out_rect = Rect(Point(rect.left, rect.top), size);
+
+            // FIXME: Make this alterate between horizontal and vertical splitting
+            left.reset(new TextureSpace(Rect(out_rect.left,  out_rect.bottom,
+                                             out_rect.right, rect.bottom)));
+
+            right.reset(new TextureSpace(Rect(out_rect.right, out_rect.top, 
+                                              rect.right, rect.bottom)));
+
+            return true;
+          }
+        else
+          {
+            return
+              left->allocate(size, out_rect) ||
+              right->allocate(size, out_rect);
+          }
+      }
+    else
+      {
+        // Size doesn't fit here
+        return false;
+      }
+  }
+
+private:
+  TextureSpace(const TextureSpace&);
+  TextureSpace& operator=(const TextureSpace&);
+};
+
+class TexturePackerTexture
+{
+private:
+  Texture        texture;
+  TextureSpace   space;
+
+public:
+  TexturePackerTexture(const Size& size)
+    : texture(GL_TEXTURE_2D, size.width, size.height),
+      space(Rect(Point(0, 0), size))
+  {
+  }
+
+  ~TexturePackerTexture()
+  {}
+
+  bool allocate(const Size& size, Rect& out_rect, Texture& out_texture)
+  {
+    if (space.allocate(size, out_rect))
+      {
+        out_texture = texture;
+        return true;
+      }
+    else
+      {
+        return false;
+      }
+  }
+
+private:
+  TexturePackerTexture(const TexturePackerTexture&);
+  TexturePackerTexture& operator=(const TexturePackerTexture&);
+};
+
+TexturePacker::TexturePacker(const Size& texture_size_)
+  : texture_size(texture_size_)
+{
+}
+
+TexturePacker::~TexturePacker()
+{
+  for(Textures::iterator i = textures.begin(); i != textures.end(); ++i)
+    delete *i;
+  textures.clear();
+}
+  
+bool
+TexturePacker::allocate(const Size& size, Rect& rect, Texture& texture)
+{
+  for(Textures::iterator i = textures.begin(); i != textures.end(); ++i)
+    {
+      if ((*i)->allocate(size, rect, texture))
+        {
+          return true;
+        }
+    }
+
+  textures.push_back(new TexturePackerTexture(texture_size));
+  return textures.back()->allocate(size, rect, texture);
+}
+
+Surface
+TexturePacker::upload(const SoftwareSurface& surface)
+{
+  Size    size(surface.get_width(), surface.get_height());
+  Rect    rect;
+  Texture texture;
+
+  if (!allocate(size, rect, texture))
+    {
+      throw std::runtime_error("TexturePacker::upload: texture space allocation failed");
+    }
+  else
+    {
+      texture.put(surface, rect.left, rect.top);
+
+      return Surface(texture,
+                     Rectf(float(rect.left)  / texture.get_width(), float(rect.top)    / texture.get_height(),
+                           float(rect.right) / texture.get_width(), float(rect.bottom) / texture.get_height()),
+                     surface.get_width(), surface.get_height());
+    }
+}
+
+/* EOF */


Property changes on: trunk/windstille/src/display/texture_packer.cpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Added: trunk/windstille/src/display/texture_packer.hpp
===================================================================
--- trunk/windstille/src/display/texture_packer.hpp	2009-04-05 17:53:54 UTC (rev 2872)
+++ trunk/windstille/src/display/texture_packer.hpp	2009-04-05 18:13:29 UTC (rev 2873)
@@ -0,0 +1,54 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#ifndef HEADER_WINDSTILLE_DISPLAY_TEXTURE_PACKER_HPP
+#define HEADER_WINDSTILLE_DISPLAY_TEXTURE_PACKER_HPP
+
+#include <vector>
+
+#include "math/rect.hpp"
+#include "math/size.hpp"
+
+#include "display/surface.hpp"
+
+class SoftwareSurface;
+class Texture;
+class TexturePackerTexture;
+
+class TexturePacker
+{
+private:
+  typedef std::vector<TexturePackerTexture*> Textures;
+  Size     texture_size;
+  Textures textures;
+
+public:
+  TexturePacker(const Size& texture_size);
+  ~TexturePacker();
+  
+  Surface upload(const SoftwareSurface& surface);
+  bool    allocate(const Size& size, Rect& rect, Texture& texture);
+  
+private:
+  TexturePacker(const TexturePacker&);
+  TexturePacker& operator=(const TexturePacker&);
+};
+
+#endif
+
+/* EOF */


Property changes on: trunk/windstille/src/display/texture_packer.hpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native



From grumbel at mail.berlios.de  Sun Apr  5 20:19:11 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sun, 5 Apr 2009 20:19:11 +0200
Subject: [Windstille-commit] r2874 - trunk/windstille/src/display
Message-ID: <200904051819.n35IJBo5017016@sheep.berlios.de>

Author: grumbel
Date: 2009-04-05 20:19:11 +0200 (Sun, 05 Apr 2009)
New Revision: 2874

Modified:
   trunk/windstille/src/display/software_surface.cpp
Log:
Fixed non-RGBA handling in SoftwareSurface::is_at()

Modified: trunk/windstille/src/display/software_surface.cpp
===================================================================
--- trunk/windstille/src/display/software_surface.cpp	2009-04-05 18:13:29 UTC (rev 2873)
+++ trunk/windstille/src/display/software_surface.cpp	2009-04-05 18:19:11 UTC (rev 2874)
@@ -155,9 +155,16 @@
   if (x >= 0 && x < impl->surface->w &&
       y >= 0 && y < impl->surface->h)
     {
-      uint8_t* pixels = (uint8_t*)impl->surface->pixels;
-      
-      return pixels[y * impl->surface->pitch + x*4 + 3] > 128;
+      if (get_bits_per_pixel() == 32)
+        {
+          uint8_t* pixels = (uint8_t*)impl->surface->pixels;
+          
+          return pixels[y * impl->surface->pitch + x*4 + 3] > 128;
+        }
+      else
+        {
+          return true;
+        }
     }
   else
     {



From grumbel at mail.berlios.de  Sun Apr  5 21:07:17 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sun, 5 Apr 2009 21:07:17 +0200
Subject: [Windstille-commit] r2875 - in trunk/windstille: . src/display
Message-ID: <200904051907.n35J7H0H023261@sheep.berlios.de>

Author: grumbel
Date: 2009-04-05 21:07:16 +0200 (Sun, 05 Apr 2009)
New Revision: 2875

Modified:
   trunk/windstille/TODO
   trunk/windstille/src/display/software_surface.cpp
   trunk/windstille/src/display/software_surface.hpp
   trunk/windstille/src/display/surface_manager.cpp
   trunk/windstille/src/display/texture_packer.cpp
Log:
Implemented proper 1px border (slow, but working)

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-04-05 18:19:11 UTC (rev 2874)
+++ trunk/windstille/TODO	2009-04-05 19:07:16 UTC (rev 2875)
@@ -186,11 +186,13 @@
 Miscellaneous
 =============
 
+* replace power_of_two function with one not based on a slow while() loop
+
 * maybe add special support for opaque textures, i.e. Textures with
   1-bit alpha, which could be used to bucket sort drawing requests and
   reduce texture switches (in case those ever start posing a problem)
 
-* http://www.blackpawn.com/texts/lightmaps/default.html
+* Write a texture packer: http://www.blackpawn.com/texts/lightmaps/default.html
 
 * Display::aspect_size is ugly, turn that into a Display::set_size();
 
@@ -514,6 +516,13 @@
 Editor
 ======
 
+* Texture::put can't handle non-RGBA surface
+
+* add a SoftwareSurface::grow() which creates a new SoftwareSurface
+  with a 1px boarder for fixing texture blend issue
+
+* add way to convert Texture to SoftwareSurface for debugging
+
 * share SoftwareSurface via Manager class
 
 * add binlocate support

Modified: trunk/windstille/src/display/software_surface.cpp
===================================================================
--- trunk/windstille/src/display/software_surface.cpp	2009-04-05 18:19:11 UTC (rev 2874)
+++ trunk/windstille/src/display/software_surface.cpp	2009-04-05 19:07:16 UTC (rev 2875)
@@ -171,5 +171,21 @@
       return false;
     }
 }
+
+SoftwareSurface
+SoftwareSurface::add_1px_border() const
+{
+  SoftwareSurface surface(get_width()+2, get_height()+2);
+
+  // FIXME: Really slow
+  blit(surface, 0, 0);
+  blit(surface, 2, 0);
+  blit(surface, 0, 2);
+  blit(surface, 2, 2);
+
+  blit(surface, 1, 1);
+
+  return surface;
+}
 
 /* EOF */

Modified: trunk/windstille/src/display/software_surface.hpp
===================================================================
--- trunk/windstille/src/display/software_surface.hpp	2009-04-05 18:19:11 UTC (rev 2874)
+++ trunk/windstille/src/display/software_surface.hpp	2009-04-05 19:07:16 UTC (rev 2875)
@@ -52,6 +52,11 @@
   void blit(SoftwareSurface& dst, int x, int y) const;
   void blit(const Rect& src_rect, SoftwareSurface& dst, int x, int y) const;
 
+  /** Creates a copy of the original surface with an added a 1pix
+      border around the original. The border contains duplicates the
+      edge pixels.  */
+  SoftwareSurface add_1px_border() const;
+
   SDL_Surface* get_surface() const;
 
   bool is_at(int x, int y) const;

Modified: trunk/windstille/src/display/surface_manager.cpp
===================================================================
--- trunk/windstille/src/display/surface_manager.cpp	2009-04-05 18:19:11 UTC (rev 2874)
+++ trunk/windstille/src/display/surface_manager.cpp	2009-04-05 19:07:16 UTC (rev 2875)
@@ -73,7 +73,6 @@
 
       if (1)
         {
-          // FIXME: Need to 'grow' the image by 1 pixel, so we don't get blending artifacts
           Surface result = texture_packer->upload(image);
           surfaces.insert(std::make_pair(filename, result));
           return result;              

Modified: trunk/windstille/src/display/texture_packer.cpp
===================================================================
--- trunk/windstille/src/display/texture_packer.cpp	2009-04-05 18:19:11 UTC (rev 2874)
+++ trunk/windstille/src/display/texture_packer.cpp	2009-04-05 19:07:16 UTC (rev 2875)
@@ -16,6 +16,7 @@
 **  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
 
+#include <iostream>
 #include <stdexcept>
 #include <memory>
 
@@ -141,8 +142,11 @@
 }
 
 Surface
-TexturePacker::upload(const SoftwareSurface& surface)
+TexturePacker::upload(const SoftwareSurface& in_surface)
 {
+  // Add a 1px border around surfaces to avoid blending artifacts
+  SoftwareSurface surface = in_surface.add_1px_border();
+
   Size    size(surface.get_width(), surface.get_height());
   Rect    rect;
   Texture texture;
@@ -155,10 +159,12 @@
     {
       texture.put(surface, rect.left, rect.top);
 
+      //std::cout << "Texture: " << texture.get_handle() << " " << rect << std::endl;
+
       return Surface(texture,
-                     Rectf(float(rect.left)  / texture.get_width(), float(rect.top)    / texture.get_height(),
-                           float(rect.right) / texture.get_width(), float(rect.bottom) / texture.get_height()),
-                     surface.get_width(), surface.get_height());
+                     Rectf(float(rect.left+1)  / texture.get_width(), float(rect.top+1)    / texture.get_height(),
+                           float(rect.right-1) / texture.get_width(), float(rect.bottom-1) / texture.get_height()),
+                     in_surface.get_width(), in_surface.get_height());
     }
 }
 



From grumbel at mail.berlios.de  Sun Apr  5 23:14:40 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sun, 5 Apr 2009 23:14:40 +0200
Subject: [Windstille-commit] r2876 - trunk/windstille/src/util
Message-ID: <200904052114.n35LEegb005207@sheep.berlios.de>

Author: grumbel
Date: 2009-04-05 23:14:39 +0200 (Sun, 05 Apr 2009)
New Revision: 2876

Modified:
   trunk/windstille/src/util/getter.cpp
Log:
Fixed swap between blue and green

Modified: trunk/windstille/src/util/getter.cpp
===================================================================
--- trunk/windstille/src/util/getter.cpp	2009-04-05 19:07:16 UTC (rev 2875)
+++ trunk/windstille/src/util/getter.cpp	2009-04-05 21:14:39 UTC (rev 2876)
@@ -105,8 +105,8 @@
     else if (floats.size() == 4)
       {
         value.r = floats[0];
-        value.b = floats[1];
-        value.g = floats[2];
+        value.g = floats[1];
+        value.b = floats[2];
         value.a = floats[3];
         return true;
       }



From grumbel at mail.berlios.de  Mon Apr  6 05:01:22 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Mon, 6 Apr 2009 05:01:22 +0200
Subject: [Windstille-commit] r2877 - trunk/windstille/src/util
Message-ID: <200904060301.n3631M1b020319@sheep.berlios.de>

Author: grumbel
Date: 2009-04-06 05:01:19 +0200 (Mon, 06 Apr 2009)
New Revision: 2877

Modified:
   trunk/windstille/src/util/sexpr_file_reader.cpp
   trunk/windstille/src/util/sexpr_file_reader.hpp
Log:
Micro cleanup

Modified: trunk/windstille/src/util/sexpr_file_reader.cpp
===================================================================
--- trunk/windstille/src/util/sexpr_file_reader.cpp	2009-04-05 21:14:39 UTC (rev 2876)
+++ trunk/windstille/src/util/sexpr_file_reader.cpp	2009-04-06 03:01:19 UTC (rev 2877)
@@ -26,7 +26,7 @@
 #include "math/vector3.hpp"
 #include "file_reader_impl.hpp"
 #include "sexpr_file_reader.hpp"
-
+
 class SExprFileReaderImpl: public FileReaderImpl
 {
 public:
@@ -243,7 +243,7 @@
   } 
 
 };
-
+
 SExprFileReader::SExprFileReader(const lisp::Lisp* sexpr, bool delete_sexpr)
   : FileReader(boost::shared_ptr<FileReaderImpl>(new SExprFileReaderImpl(sexpr, delete_sexpr)))
 {
@@ -253,5 +253,5 @@
   : FileReader(boost::shared_ptr<FileReaderImpl>(new SExprFileReaderImpl(root, sexpr)))
 {
 }
-
+
 /* EOF */

Modified: trunk/windstille/src/util/sexpr_file_reader.hpp
===================================================================
--- trunk/windstille/src/util/sexpr_file_reader.hpp	2009-04-05 21:14:39 UTC (rev 2876)
+++ trunk/windstille/src/util/sexpr_file_reader.hpp	2009-04-06 03:01:19 UTC (rev 2877)
@@ -21,8 +21,7 @@
 
 #include "file_reader.hpp"
 #include "lisp/lisp.hpp"
-
-/** */
+
 class SExprFileReader : public FileReader
 {
 private:
@@ -30,7 +29,7 @@
   SExprFileReader(const lisp::Lisp* root, const lisp::Lisp* lisp);
   SExprFileReader(const lisp::Lisp* lisp, bool delete_sexpr = false);
 };
-
+
 #endif
 
 /* EOF */



From grumbel at mail.berlios.de  Mon Apr  6 05:02:33 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Mon, 6 Apr 2009 05:02:33 +0200
Subject: [Windstille-commit] r2878 - in trunk/windstille/src: display editor
Message-ID: <200904060302.n3632XDa020387@sheep.berlios.de>

Author: grumbel
Date: 2009-04-06 05:02:31 +0200 (Mon, 06 Apr 2009)
New Revision: 2878

Modified:
   trunk/windstille/src/display/software_surface.cpp
   trunk/windstille/src/display/software_surface.hpp
   trunk/windstille/src/display/surface_manager.cpp
   trunk/windstille/src/display/surface_manager.hpp
   trunk/windstille/src/display/texture.cpp
   trunk/windstille/src/display/texture.hpp
   trunk/windstille/src/display/texture_packer.cpp
   trunk/windstille/src/display/texture_packer.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
Log:
Hacked together function to dump all Textures in the TexturePacker

Modified: trunk/windstille/src/display/software_surface.cpp
===================================================================
--- trunk/windstille/src/display/software_surface.cpp	2009-04-06 03:01:19 UTC (rev 2877)
+++ trunk/windstille/src/display/software_surface.cpp	2009-04-06 03:02:31 UTC (rev 2878)
@@ -16,6 +16,9 @@
 **  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
 
+#include <boost/scoped_array.hpp>
+#include <png.h>
+#include <errno.h>
 #include <iostream>
 #include <sstream>
 #include <stdexcept>
@@ -177,15 +180,68 @@
 {
   SoftwareSurface surface(get_width()+2, get_height()+2);
 
-  // FIXME: Really slow
-  blit(surface, 0, 0);
-  blit(surface, 2, 0);
-  blit(surface, 0, 2);
-  blit(surface, 2, 2);
+  // FIXME: Really slow and leaves out the edge pixels
+  blit(surface, 1, 0);
+  blit(surface, 1, 2);
+  blit(surface, 0, 1);
+  blit(surface, 2, 1);
 
   blit(surface, 1, 1);
 
   return surface;
 }
+
+void
+SoftwareSurface::save_png(const std::string& filename) const
+{
+  // FIXME: This is upside down  
+  if (get_bits_per_pixel() != 32)
+    {
+      std::cout << "SoftwareSurface::save_png(): Unsupported pixel format" << std::endl;
+      return;
+    }
+
+  FILE* fp = fopen(filename.c_str(), "w");
+
+  if (!fp)
+    {
+      std::cout << "Error: Couldn't save screenshot: " << strerror(errno) << std::endl;
+      return;
+    }
+  else
+    {
+      int pitch   = get_pitch();
+      png_structp png_ptr;
+      png_infop   info_ptr;
+      png_byte* pixels = static_cast<png_byte*>(get_pixels());
+
+      png_ptr  = png_create_write_struct(PNG_LIBPNG_VER_STRING, NULL, NULL, NULL);
+      info_ptr = png_create_info_struct(png_ptr);
+
+      png_init_io(png_ptr, fp);
+
+      png_set_IHDR(png_ptr, info_ptr, 
+                   get_width(), get_height(), 8 /* bitdepth */,
+                   PNG_COLOR_TYPE_RGBA,
+                   PNG_INTERLACE_NONE, 
+                   PNG_COMPRESSION_TYPE_BASE, 
+                   PNG_FILTER_TYPE_BASE);
+      
+      png_set_compression_level(png_ptr, 6);
+      png_write_info(png_ptr, info_ptr);
+
+      boost::scoped_array<png_bytep> row_pointers(new png_bytep[get_height()]);
+   
+      // generate row pointers
+      for (int k = 0; k < get_height(); k++)
+        row_pointers[k] = reinterpret_cast<png_byte*>(pixels + ((get_height() - k - 1) * pitch));
+
+      png_write_image(png_ptr, row_pointers.get());
+
+      png_write_end(png_ptr, info_ptr);
+
+      fclose(fp);
+    }
+}
 
 /* EOF */

Modified: trunk/windstille/src/display/software_surface.hpp
===================================================================
--- trunk/windstille/src/display/software_surface.hpp	2009-04-06 03:01:19 UTC (rev 2877)
+++ trunk/windstille/src/display/software_surface.hpp	2009-04-06 03:02:31 UTC (rev 2878)
@@ -57,6 +57,8 @@
       edge pixels.  */
   SoftwareSurface add_1px_border() const;
 
+  void save_png(const std::string& filename) const;
+
   SDL_Surface* get_surface() const;
 
   bool is_at(int x, int y) const;

Modified: trunk/windstille/src/display/surface_manager.cpp
===================================================================
--- trunk/windstille/src/display/surface_manager.cpp	2009-04-06 03:01:19 UTC (rev 2877)
+++ trunk/windstille/src/display/surface_manager.cpp	2009-04-06 03:02:31 UTC (rev 2878)
@@ -172,5 +172,11 @@
         }
     }
 }
+
+void
+SurfaceManager::save_all_as_png() const
+{
+  texture_packer->save_all_as_png();
+}
 
 /* EOF */

Modified: trunk/windstille/src/display/surface_manager.hpp
===================================================================
--- trunk/windstille/src/display/surface_manager.hpp	2009-04-06 03:01:19 UTC (rev 2877)
+++ trunk/windstille/src/display/surface_manager.hpp	2009-04-06 03:02:31 UTC (rev 2878)
@@ -40,7 +40,11 @@
 public:
   static SurfaceManager* current() { return current_; } 
 
+private:
   std::auto_ptr<TexturePacker> texture_packer;
+  
+  typedef std::map<std::string, Surface> Surfaces;
+  Surfaces surfaces;
 
 public:
   SurfaceManager();
@@ -61,9 +65,8 @@
 
   /** Removes all cached Sprites that are no longer in use */
   void cleanup();
-  
-  typedef std::map<std::string, Surface> Surfaces;
-  Surfaces surfaces;
+
+  void save_all_as_png() const;
 };
 
 #endif

Modified: trunk/windstille/src/display/texture.cpp
===================================================================
--- trunk/windstille/src/display/texture.cpp	2009-04-06 03:01:19 UTC (rev 2877)
+++ trunk/windstille/src/display/texture.cpp	2009-04-06 03:02:31 UTC (rev 2878)
@@ -226,6 +226,20 @@
   glTexParameteri(impl->target, GL_TEXTURE_MAG_FILTER, mode);
 }
 
+SoftwareSurface
+Texture::get_software_surface() const
+{
+  OpenGLState state;
+  state.bind_texture(*this);
+  state.activate();
+
+  SoftwareSurface surface(impl->width, impl->height);
+
+  glGetTexImage(GL_TEXTURE_2D, 0, GL_RGBA, GL_UNSIGNED_BYTE, surface.get_pixels());
+
+  return surface;
+}
+
 Texture::operator bool() const
 {
   return impl.get();

Modified: trunk/windstille/src/display/texture.hpp
===================================================================
--- trunk/windstille/src/display/texture.hpp	2009-04-06 03:01:19 UTC (rev 2877)
+++ trunk/windstille/src/display/texture.hpp	2009-04-06 03:02:31 UTC (rev 2878)
@@ -75,6 +75,8 @@
    */ 
   GLenum get_target() const;
 
+  SoftwareSurface get_software_surface() const;
+
   /** true if the Texture is valid and usable, false if not */
   operator bool() const;
 

Modified: trunk/windstille/src/display/texture_packer.cpp
===================================================================
--- trunk/windstille/src/display/texture_packer.cpp	2009-04-06 03:01:19 UTC (rev 2877)
+++ trunk/windstille/src/display/texture_packer.cpp	2009-04-06 03:02:31 UTC (rev 2878)
@@ -96,6 +96,8 @@
   ~TexturePackerTexture()
   {}
 
+  Texture get_texture() const { return texture; }
+
   bool allocate(const Size& size, Rect& out_rect, Texture& out_texture)
   {
     if (space.allocate(size, out_rect))
@@ -167,5 +169,20 @@
                      in_surface.get_width(), in_surface.get_height());
     }
 }
+
+void
+TexturePacker::save_all_as_png() const
+{
+  for(Textures::const_iterator i = textures.begin(); i != textures.end(); ++i)
+    {
+      Texture texture = (*i)->get_texture();
+      SoftwareSurface surface = texture.get_software_surface();
+
+      char filename[1024];
+      sprintf(filename, "/tmp/texture_packer%04d.png", int(i - textures.begin()));
+      std::cout << "Saving: " << filename << std::endl;
+      surface.save_png(filename);
+    }
+}
 
 /* EOF */

Modified: trunk/windstille/src/display/texture_packer.hpp
===================================================================
--- trunk/windstille/src/display/texture_packer.hpp	2009-04-06 03:01:19 UTC (rev 2877)
+++ trunk/windstille/src/display/texture_packer.hpp	2009-04-06 03:02:31 UTC (rev 2878)
@@ -44,6 +44,8 @@
   Surface upload(const SoftwareSurface& surface);
   bool    allocate(const Size& size, Rect& rect, Texture& texture);
   
+  void save_all_as_png() const;
+
 private:
   TexturePacker(const TexturePacker&);
   TexturePacker& operator=(const TexturePacker&);

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-06 03:01:19 UTC (rev 2877)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-06 03:02:31 UTC (rev 2878)
@@ -576,6 +576,10 @@
         selection_duplicate();
         break;
 
+      case GDK_s:
+        SurfaceManager::current()->save_all_as_png();
+        break;
+
       case GDK_Delete:
         selection_delete();
         break;



From grumbel at mail.berlios.de  Mon Apr  6 05:04:36 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Mon, 6 Apr 2009 05:04:36 +0200
Subject: [Windstille-commit] r2879 - trunk/windstille/data/images/decal
Message-ID: <200904060304.n3634a1p020571@sheep.berlios.de>

Author: grumbel
Date: 2009-04-06 05:04:32 +0200 (Mon, 06 Apr 2009)
New Revision: 2879

Added:
   trunk/windstille/data/images/decal/apartment_ground1.png
   trunk/windstille/data/images/decal/apartment_ground2.png
   trunk/windstille/data/images/decal/apartment_ground3.png
   trunk/windstille/data/images/decal/bath_tile.png
   trunk/windstille/data/images/decal/shadow.png
   trunk/windstille/data/images/decal/stair_base.png
   trunk/windstille/data/images/decal/stair_handle.png
   trunk/windstille/data/images/decal/stair_stairs.png
   trunk/windstille/data/images/decal/test_grid.png
Log:
More graphics

Added: trunk/windstille/data/images/decal/apartment_ground1.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/apartment_ground1.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/apartment_ground2.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/apartment_ground2.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/apartment_ground3.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/apartment_ground3.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/bath_tile.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/bath_tile.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/shadow.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/shadow.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/stair_base.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/stair_base.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/stair_handle.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/stair_handle.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/stair_stairs.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/stair_stairs.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/test_grid.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/test_grid.png
___________________________________________________________________
Name: svn:mime-type
   + image/png



From grumbel at mail.berlios.de  Mon Apr  6 05:07:47 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Mon, 6 Apr 2009 05:07:47 +0200
Subject: [Windstille-commit] r2880 -
	trunk/windstille/data/sectors/trainstation
Message-ID: <200904060307.n3637l5q020715@sheep.berlios.de>

Author: grumbel
Date: 2009-04-06 05:07:44 +0200 (Mon, 06 Apr 2009)
New Revision: 2880

Added:
   trunk/windstille/data/sectors/trainstation/bathroom.wst
   trunk/windstille/data/sectors/trainstation/steelplatetest.wst
Modified:
   trunk/windstille/data/sectors/trainstation/bar.wst
   trunk/windstille/data/sectors/trainstation/city.wst
   trunk/windstille/data/sectors/trainstation/mine.wst
   trunk/windstille/data/sectors/trainstation/toilet.wst
   trunk/windstille/data/sectors/trainstation/trainstation.wst
Log:
Some new experimental sectors

Modified: trunk/windstille/data/sectors/trainstation/bar.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/bar.wst	2009-04-06 03:04:32 UTC (rev 2879)
+++ trunk/windstille/data/sectors/trainstation/bar.wst	2009-04-06 03:07:44 UTC (rev 2880)
@@ -3,7 +3,7 @@
 (windstille-sector
   (version 2)
   (name "")
-  (ambient-color 0 0 0 1)
+  (ambient-color 0.5 0.5 0.5 1)
   (init-script "init.nut")
   (layer
     (name "Scene")

Added: trunk/windstille/data/sectors/trainstation/bathroom.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/bathroom.wst	2009-04-06 03:04:32 UTC (rev 2879)
+++ trunk/windstille/data/sectors/trainstation/bathroom.wst	2009-04-06 03:07:44 UTC (rev 2880)
@@ -0,0 +1,838 @@
+;; -*- scheme -*-
+
+(windstille-sector
+  (version 2)
+  (name "")
+  (ambient-color 0 0 0 1)
+  (init-script "init.nut")
+  (layer
+    (name "Scene")
+    (visible #t)
+    (locked #t)
+    (objects
+      (decal
+        (id "0x99bfda8")
+        (pos 958 491)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/humanreference.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f)))
+    (child-layers
+      (layer
+        (name "Light")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x99c2fa0")
+            (pos 575 244)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp_bloom.png")
+            (type 2)
+            (scale 0.595588 0.549077)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99c32f8")
+            (pos 878 246)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp_bloom.png")
+            (type 2)
+            (scale 0.595588 0.549077)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99c37f8")
+            (pos 1167 242)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/rooflamp_bloom.png")
+            (type 2)
+            (scale 0.595588 0.549077)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "Black")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x99c39a8")
+            (pos 1409 210)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99c3da0")
+            (pos 1437 666)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99f7480")
+            (pos 318 663)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99f83f8")
+            (pos 294 191)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99f76a0")
+            (pos 852 159)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/shadow.png")
+            (type 0)
+            (scale 10.2773 1.21973)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99f7a38")
+            (pos 857 156)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/shadow.png")
+            (type 0)
+            (scale 10.2773 1.21973)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99f7b80")
+            (pos 864 684)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/shadow.png")
+            (type 0)
+            (scale 10.2773 1.21973)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x9a38dc8")
+            (pos 867 687)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/shadow.png")
+            (type 0)
+            (scale 10.2773 1.21973)
+            (angle 0)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x9a38e88")
+            (pos 301 432)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/shadow.png")
+            (type 0)
+            (scale 3.31934 1.58594)
+            (angle 1.58324)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x9a490d0")
+            (pos 280 438)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/shadow.png")
+            (type 0)
+            (scale 3.31934 1.58594)
+            (angle 1.58324)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x9a59238")
+            (pos 1471 416)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/shadow.png")
+            (type 0)
+            (scale 3.31934 1.58594)
+            (angle 1.58324)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9a69458")
+            (pos 1471 408)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/shadow.png")
+            (type 0)
+            (scale 3.31934 1.58594)
+            (angle 1.58324)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "Ground")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x9a79630")
+            (pos 422 672)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground3.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9abb278")
+            (pos 550 672)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9acb600")
+            (pos 678 672)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9afc1a0")
+            (pos 806 672)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground3.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9b1cb20")
+            (pos 934 672)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9b3cd70")
+            (pos 1062 672)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9b3cdf8")
+            (pos 1190 672)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground3.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9b4d0a8")
+            (pos 1318 672)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9b5d268")
+            (pos 422 160)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground3.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9b6d410")
+            (pos 550 160)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9b7d620")
+            (pos 678 160)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9b8d7a8")
+            (pos 806 160)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground3.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9b8d888")
+            (pos 934 160)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9badac0")
+            (pos 1062 160)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9bbdc28")
+            (pos 1190 160)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground3.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9bcdf58")
+            (pos 1318 160)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9bde0a0")
+            (pos 1443 543)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 1.56813)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9bee310")
+            (pos 1442 415)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 1.56813)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9bfe4a0")
+            (pos 1441 289)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 1.56813)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9c0e678")
+            (pos 297 291)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 1.56813)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x9c0e780")
+            (pos 298 418)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 1.56813)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0x9c2e940")
+            (pos 297 544)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/apartment_ground1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 1.56813)
+            (hflip #f)
+            (vflip #t)))
+        (child-layers))
+      (layer
+        (name "Objects")
+        (visible #t)
+        (locked #f)
+        (objects
+          (decal
+            (id "0x9c3eb30")
+            (pos 1141 415)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/city_housewall.png")
+            (type 0)
+            (scale 0.156915 0.249564)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99f7348")
+            (pos 1289 519)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9c4eda8")
+            (pos 569 227)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/streetlamp.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99d60b8")
+            (pos 1163 229)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/streetlamp.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99f7d50")
+            (pos 877 229)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/streetlamp.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99d68c8")
+            (pos 1140 496)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/sink.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "Shadow2")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x99d66f0")
+            (pos 1142 549)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.383545 0.456787)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99d6228")
+            (pos 1275 590)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.383545 0.456787)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "Shadow")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x99d70f8")
+            (pos 870 247)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/shadow.png")
+            (type 0)
+            (scale 8 0.453125)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99d6420")
+            (pos 868 590)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/shadow.png")
+            (type 0)
+            (scale 8 1.51562)
+            (angle 0)
+            (hflip #t)
+            (vflip #t))
+          (decal
+            (id "0x9cad268")
+            (pos 1341 418)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/shadow.png")
+            (type 0)
+            (scale 3.37656 0.970145)
+            (angle 1.56816)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99d7298")
+            (pos 399 421)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/shadow.png")
+            (type 0)
+            (scale 3.37656 0.970145)
+            (angle 1.56816)
+            (hflip #t)
+            (vflip #t)))
+        (child-layers))
+      (layer
+        (name "Background")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0x9ccd738")
+            (pos 422 544)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x99c20c8")
+            (pos 550 544)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9d0e9b8")
+            (pos 422 416)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9d1ecd8")
+            (pos 550 416)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9d0eac0")
+            (pos 422 288)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9d2ee28")
+            (pos 550 288)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9d3f150")
+            (pos 678 544)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9d5f2c0")
+            (pos 678 416)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9d6f4e0")
+            (pos 678 288)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9d3efe8")
+            (pos 806 288)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9d7f780")
+            (pos 1062 544)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9d8f9b8")
+            (pos 1062 416)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9dafce8")
+            (pos 934 288)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9dafda0")
+            (pos 1062 288)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9dd0090")
+            (pos 1190 544)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9de0138")
+            (pos 1318 544)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9df03a0")
+            (pos 1190 416)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9dcff28")
+            (pos 1318 416)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9e00668")
+            (pos 1190 288)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9e20b10")
+            (pos 1318 288)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/bath_tile.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9e108d0")
+            (pos 875 467)
+            (parent "")
+            (select-mask 1)
+            (path "images/objects/showerdoors.png")
+            (type 0)
+            (scale 2.09222 2.069)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers)))))
+
+;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/city.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/city.wst	2009-04-06 03:04:32 UTC (rev 2879)
+++ trunk/windstille/data/sectors/trainstation/city.wst	2009-04-06 03:07:44 UTC (rev 2880)
@@ -3,7 +3,7 @@
 (windstille-sector
   (version 2)
   (name "")
-  (ambient-color 0 0 0 1)
+  (ambient-color 0.1 0.1 0.2 1)
   (init-script "init.nut")
   (layer
     (name "Scene")
@@ -17,7 +17,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0x92ae190")
+            (id "0x9581190")
             (pos 689 326)
             (parent "")
             (select-mask 1)
@@ -28,7 +28,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92ad630")
+            (id "0x9580630")
             (pos -2229 315)
             (parent "")
             (select-mask 1)
@@ -39,7 +39,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92ad6d0")
+            (id "0x95806d0")
             (pos 2213 674)
             (parent "")
             (select-mask 1)
@@ -50,7 +50,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92ad790")
+            (id "0x9580790")
             (pos 909 162)
             (parent "")
             (select-mask 1)
@@ -61,7 +61,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92ae6b8")
+            (id "0x95816b8")
             (pos -1070 626)
             (parent "")
             (select-mask 1)
@@ -72,7 +72,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92ae770")
+            (id "0x9581770")
             (pos -1064 624)
             (parent "")
             (select-mask 1)
@@ -89,7 +89,7 @@
         (locked #f)
         (objects
           (decal
-            (id "0x92c4b40")
+            (id "0x9580de8")
             (pos 2998 558)
             (parent "")
             (select-mask 1)
@@ -100,7 +100,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92ab5d8")
+            (id "0x957ea78")
             (pos 836 212)
             (parent "")
             (select-mask 1)
@@ -111,7 +111,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92ab690")
+            (id "0x957fd00")
             (pos 985 221)
             (parent "")
             (select-mask 1)
@@ -122,7 +122,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92abad0")
+            (id "0x957fd78")
             (pos 949 214)
             (parent "")
             (select-mask 1)
@@ -133,7 +133,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92ac708")
+            (id "0x957fe20")
             (pos -1207 634)
             (parent "")
             (select-mask 1)
@@ -144,7 +144,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92acee8")
+            (id "0x95a99c8")
             (pos -910 639)
             (parent "")
             (select-mask 1)
@@ -155,7 +155,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92ac7d0")
+            (id "0x95a9a68")
             (pos -912 619)
             (parent "")
             (select-mask 1)
@@ -166,7 +166,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92acb90")
+            (id "0x95a9b70")
             (pos -1208 615)
             (parent "")
             (select-mask 1)
@@ -177,7 +177,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8c36558")
+            (id "0x95aa478")
             (pos 2992 368)
             (parent "")
             (select-mask 1)
@@ -188,7 +188,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92c6718")
+            (id "0x95aa618")
             (pos 2999 380)
             (parent "")
             (select-mask 1)
@@ -199,7 +199,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8c365a0")
+            (id "0x95aaf48")
             (pos 3542 559)
             (parent "")
             (select-mask 1)
@@ -210,7 +210,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8c37530")
+            (id "0x9657e38")
             (pos 3536 369)
             (parent "")
             (select-mask 1)
@@ -221,7 +221,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x982ff68")
+            (id "0x9657f20")
             (pos 3543 381)
             (parent "")
             (select-mask 1)
@@ -232,7 +232,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92c3970")
+            (id "0x9658008")
             (pos 4050 558)
             (parent "")
             (select-mask 1)
@@ -243,7 +243,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x921a780")
+            (id "0x96580f0")
             (pos 4044 368)
             (parent "")
             (select-mask 1)
@@ -254,7 +254,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92c2b60")
+            (id "0x96581d8")
             (pos 4051 380)
             (parent "")
             (select-mask 1)
@@ -265,7 +265,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92c4a50")
+            (id "0x96582c0")
             (pos 3549 485)
             (parent "")
             (select-mask 1)
@@ -276,7 +276,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92bdd20")
+            (id "0x96583a8")
             (pos -3945 517)
             (parent "")
             (select-mask 1)
@@ -287,7 +287,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92c4fb0")
+            (id "0x9658490")
             (pos -3951 327)
             (parent "")
             (select-mask 1)
@@ -298,7 +298,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8f5b508")
+            (id "0x9658578")
             (pos -3944 339)
             (parent "")
             (select-mask 1)
@@ -315,7 +315,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0x92adde8")
+            (id "0x957e828")
             (pos 525 612)
             (parent "")
             (select-mask 1)
@@ -332,7 +332,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0x92d0880")
+            (id "0x9659c40")
             (pos 1271 855)
             (parent "")
             (select-mask 1)
@@ -343,7 +343,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x93ae0f0")
+            (id "0x9659d60")
             (pos 759 855)
             (parent "")
             (select-mask 1)
@@ -354,7 +354,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d10e8")
+            (id "0x965a210")
             (pos 247 855)
             (parent "")
             (select-mask 1)
@@ -365,7 +365,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d1190")
+            (id "0x965a2b8")
             (pos 2807 855)
             (parent "")
             (select-mask 1)
@@ -376,7 +376,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d1278")
+            (id "0x95a6d38")
             (pos 2295 855)
             (parent "")
             (select-mask 1)
@@ -387,7 +387,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d1360")
+            (id "0x95a6e20")
             (pos 1783 855)
             (parent "")
             (select-mask 1)
@@ -398,7 +398,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d1448")
+            (id "0x95a6f08")
             (pos -777 855)
             (parent "")
             (select-mask 1)
@@ -409,7 +409,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d1530")
+            (id "0x95a6ff0")
             (pos -1289 855)
             (parent "")
             (select-mask 1)
@@ -420,7 +420,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d1618")
+            (id "0x95a70d8")
             (pos -1801 855)
             (parent "")
             (select-mask 1)
@@ -431,7 +431,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d1700")
+            (id "0x95a71c0")
             (pos -265 855)
             (parent "")
             (select-mask 1)
@@ -442,7 +442,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d17e8")
+            (id "0x95a72a8")
             (pos -2313 855)
             (parent "")
             (select-mask 1)
@@ -453,7 +453,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d18d0")
+            (id "0x95a7390")
             (pos -2825 855)
             (parent "")
             (select-mask 1)
@@ -464,7 +464,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d19b8")
+            (id "0x95a7478")
             (pos -3337 855)
             (parent "")
             (select-mask 1)
@@ -475,7 +475,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d1aa0")
+            (id "0x95a7560")
             (pos -3849 854)
             (parent "")
             (select-mask 1)
@@ -486,7 +486,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d1b88")
+            (id "0x95a7648")
             (pos -4361 854)
             (parent "")
             (select-mask 1)
@@ -497,7 +497,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d1c70")
+            (id "0x95a7730")
             (pos -4873 854)
             (parent "")
             (select-mask 1)
@@ -508,7 +508,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d1d58")
+            (id "0x95a7818")
             (pos -5385 854)
             (parent "")
             (select-mask 1)
@@ -519,7 +519,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d1e40")
+            (id "0x95a7900")
             (pos -5897 854)
             (parent "")
             (select-mask 1)
@@ -530,7 +530,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d1f28")
+            (id "0x95a79e8")
             (pos -6409 854)
             (parent "")
             (select-mask 1)
@@ -541,7 +541,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d2010")
+            (id "0x95a7ad0")
             (pos -6921 854)
             (parent "")
             (select-mask 1)
@@ -552,7 +552,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d20f8")
+            (id "0x95a7bb8")
             (pos -7433 854)
             (parent "")
             (select-mask 1)
@@ -563,7 +563,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d21e0")
+            (id "0x95a7ca0")
             (pos -7945 854)
             (parent "")
             (select-mask 1)
@@ -574,7 +574,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d22c8")
+            (id "0x95a7d88")
             (pos -2215 -873)
             (parent "")
             (select-mask 1)
@@ -585,7 +585,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d23b0")
+            (id "0x9741e28")
             (pos -1959 -873)
             (parent "")
             (select-mask 1)
@@ -596,7 +596,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x93ac4e0")
+            (id "0x9742038")
             (pos -1703 -873)
             (parent "")
             (select-mask 1)
@@ -607,7 +607,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x93ac588")
+            (id "0x95a85d8")
             (pos -1447 -873)
             (parent "")
             (select-mask 1)
@@ -618,7 +618,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x93ac670")
+            (id "0x95a86c0")
             (pos 601 -873)
             (parent "")
             (select-mask 1)
@@ -629,7 +629,7 @@
             (hflip #t)
             (vflip #f))
           (decal
-            (id "0x93ac758")
+            (id "0x95a87a8")
             (pos 345 -873)
             (parent "")
             (select-mask 1)
@@ -640,7 +640,7 @@
             (hflip #t)
             (vflip #f))
           (decal
-            (id "0x93ac920")
+            (id "0x95a8890")
             (pos 89 -873)
             (parent "")
             (select-mask 1)
@@ -651,7 +651,7 @@
             (hflip #t)
             (vflip #f))
           (decal
-            (id "0x93ac9d8")
+            (id "0x95a8978")
             (pos -167 -873)
             (parent "")
             (select-mask 1)
@@ -662,7 +662,7 @@
             (hflip #t)
             (vflip #f))
           (decal
-            (id "0x93acac0")
+            (id "0x973fbb0")
             (pos -679 -873)
             (parent "")
             (select-mask 1)
@@ -673,7 +673,7 @@
             (hflip #t)
             (vflip #f))
           (decal
-            (id "0x93acba8")
+            (id "0x973fc98")
             (pos -423 -873)
             (parent "")
             (select-mask 1)
@@ -684,7 +684,7 @@
             (hflip #t)
             (vflip #f))
           (decal
-            (id "0x93acc90")
+            (id "0x973fd80")
             (pos -935 -873)
             (parent "")
             (select-mask 1)
@@ -695,7 +695,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x93acd78")
+            (id "0x973fe68")
             (pos -1191 -873)
             (parent "")
             (select-mask 1)
@@ -706,7 +706,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x93ace60")
+            (id "0x973ff50")
             (pos 3831 853)
             (parent "")
             (select-mask 1)
@@ -717,7 +717,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x93acf48")
+            (id "0x9740038")
             (pos 3319 853)
             (parent "")
             (select-mask 1)
@@ -728,7 +728,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x93ad030")
+            (id "0x9740120")
             (pos 5367 853)
             (parent "")
             (select-mask 1)
@@ -739,7 +739,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x93ad118")
+            (id "0x9740208")
             (pos 4855 853)
             (parent "")
             (select-mask 1)
@@ -750,7 +750,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x93ad200")
+            (id "0x97402f0")
             (pos 4343 853)
             (parent "")
             (select-mask 1)
@@ -761,7 +761,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x93ad2e8")
+            (id "0x97403d8")
             (pos 6903 852)
             (parent "")
             (select-mask 1)
@@ -772,7 +772,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x93ad3d0")
+            (id "0x97404c0")
             (pos 6391 852)
             (parent "")
             (select-mask 1)
@@ -783,7 +783,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x93ad4b8")
+            (id "0x97405a8")
             (pos 5879 852)
             (parent "")
             (select-mask 1)
@@ -800,7 +800,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0x92d0678")
+            (id "0x9659a38")
             (pos 1470 471)
             (parent "")
             (select-mask 1)
@@ -817,7 +817,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0x92d3c08")
+            (id "0x9659b30")
             (pos -2749 423)
             (parent "")
             (select-mask 1)
@@ -828,7 +828,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x92d04f8")
+            (id "0x9659420")
             (pos -3388 422)
             (parent "")
             (select-mask 1)
@@ -845,7 +845,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0x948ad78")
+            (id "0x976c368")
             (pos 217 471)
             (parent "")
             (select-mask 1)
@@ -856,7 +856,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x948b770")
+            (id "0x976cde8")
             (pos 217 -41)
             (parent "")
             (select-mask 1)
@@ -867,7 +867,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9488298")
+            (id "0x976dce0")
             (pos 217 -553)
             (parent "")
             (select-mask 1)
@@ -878,7 +878,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9488340")
+            (id "0x976dd88")
             (pos 643 -38)
             (parent "")
             (select-mask 1)
@@ -889,7 +889,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9488ed8")
+            (id "0x976e138")
             (pos 645 -550)
             (parent "")
             (select-mask 1)
@@ -900,7 +900,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9489028")
+            (id "0x97d3c10")
             (pos -131 -559)
             (parent "")
             (select-mask 1)
@@ -911,7 +911,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9489b18")
+            (id "0x987c6a0")
             (pos 48 -558)
             (parent "")
             (select-mask 1)
@@ -922,7 +922,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9489868")
+            (id "0x97cf028")
             (pos 236 -556)
             (parent "")
             (select-mask 1)
@@ -933,7 +933,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9489910")
+            (id "0x97cf0d0")
             (pos -126 -45)
             (parent "")
             (select-mask 1)
@@ -944,7 +944,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ec690")
+            (id "0x97cf198")
             (pos 53 -44)
             (parent "")
             (select-mask 1)
@@ -955,7 +955,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ec778")
+            (id "0x97cf280")
             (pos 241 -42)
             (parent "")
             (select-mask 1)
@@ -966,7 +966,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ec860")
+            (id "0x97cf368")
             (pos 438 817)
             (parent "")
             (select-mask 1)
@@ -977,7 +977,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94f08c8")
+            (id "0x97d3370")
             (pos -807 471)
             (parent "")
             (select-mask 1)
@@ -988,7 +988,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94f0940")
+            (id "0x97d1a38")
             (pos -807 -41)
             (parent "")
             (select-mask 1)
@@ -999,7 +999,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94f09e8")
+            (id "0x97d1af8")
             (pos -807 -553)
             (parent "")
             (select-mask 1)
@@ -1010,7 +1010,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94f0ad0")
+            (id "0x97d1bc0")
             (pos -1831 471)
             (parent "")
             (select-mask 1)
@@ -1021,7 +1021,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94eede8")
+            (id "0x97d1ca8")
             (pos -1831 -41)
             (parent "")
             (select-mask 1)
@@ -1032,7 +1032,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94eeed0")
+            (id "0x97d1d90")
             (pos -1831 -553)
             (parent "")
             (select-mask 1)
@@ -1043,7 +1043,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94eefb8")
+            (id "0x97d1e78")
             (pos 49 457)
             (parent "")
             (select-mask 1)
@@ -1054,7 +1054,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94eebb8")
+            (id "0x97d15d0")
             (pos -1495 498)
             (parent "")
             (select-mask 1)
@@ -1065,7 +1065,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ecf40")
+            (id "0x97cf408")
             (pos -1003 -564)
             (parent "")
             (select-mask 1)
@@ -1076,7 +1076,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ecfb8")
+            (id "0x97cf4b0")
             (pos -824 -563)
             (parent "")
             (select-mask 1)
@@ -1087,7 +1087,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ed060")
+            (id "0x97cf558")
             (pos -636 -561)
             (parent "")
             (select-mask 1)
@@ -1098,7 +1098,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ed128")
+            (id "0x97cf640")
             (pos -998 -50)
             (parent "")
             (select-mask 1)
@@ -1109,7 +1109,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ed210")
+            (id "0x97cf728")
             (pos -819 -49)
             (parent "")
             (select-mask 1)
@@ -1120,7 +1120,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ed2f8")
+            (id "0x97cf810")
             (pos -631 -47)
             (parent "")
             (select-mask 1)
@@ -1131,7 +1131,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ed3e0")
+            (id "0x97cf8f8")
             (pos -1527 -34)
             (parent "")
             (select-mask 1)
@@ -1142,7 +1142,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ed4c8")
+            (id "0x97cf9e0")
             (pos -1715 -39)
             (parent "")
             (select-mask 1)
@@ -1153,7 +1153,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ed5b0")
+            (id "0x97cfac8")
             (pos -1894 -40)
             (parent "")
             (select-mask 1)
@@ -1164,7 +1164,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ed698")
+            (id "0x97cfbb0")
             (pos -1532 -563)
             (parent "")
             (select-mask 1)
@@ -1175,7 +1175,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ed780")
+            (id "0x97cfc98")
             (pos -1720 -565)
             (parent "")
             (select-mask 1)
@@ -1186,7 +1186,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ed868")
+            (id "0x97cfd80")
             (pos -1899 -566)
             (parent "")
             (select-mask 1)
@@ -1197,7 +1197,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ed950")
+            (id "0x97cfe68")
             (pos -2237 -561)
             (parent "")
             (select-mask 1)
@@ -1208,7 +1208,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94eda40")
+            (id "0x97cff58")
             (pos -2239 -41)
             (parent "")
             (select-mask 1)
@@ -1219,7 +1219,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94edb30")
+            (id "0x97d0048")
             (pos -1061 582)
             (parent "")
             (select-mask 1)
@@ -1230,7 +1230,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963f3f0")
+            (id "0x97d0238")
             (pos -810 477)
             (parent "")
             (select-mask 1)
@@ -1241,7 +1241,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94edcc8")
+            (id "0x97d0b98")
             (pos -628 478)
             (parent "")
             (select-mask 1)
@@ -1252,7 +1252,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94edd70")
+            (id "0x97d0c40")
             (pos -437 671)
             (parent "")
             (select-mask 1)
@@ -1269,7 +1269,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0x94ee660")
+            (id "0x9a0bf88")
             (pos 858 689)
             (parent "")
             (select-mask 1)
@@ -1280,7 +1280,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ee6a8")
+            (id "0x9a0bfd0")
             (pos 704 418)
             (parent "")
             (select-mask 1)
@@ -1291,7 +1291,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x94ee738")
+            (id "0x999f5b0")
             (pos 1974 744)
             (parent "")
             (select-mask 1)
@@ -1302,7 +1302,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x948b468")
+            (id "0x976ca70")
             (pos 1397 489)
             (parent "")
             (select-mask 1)
@@ -1313,7 +1313,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x948b518")
+            (id "0x976cb20")
             (pos -2291 573)
             (parent "")
             (select-mask 1)
@@ -1324,7 +1324,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x948b5c8")
+            (id "0x976cbd0")
             (pos -2855 737)
             (parent "")
             (select-mask 1)
@@ -1335,7 +1335,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963ca20")
+            (id "0x97d0fa8")
             (pos 2870 735)
             (parent "")
             (select-mask 1)
@@ -1346,7 +1346,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963cad0")
+            (id "0x97d1058")
             (pos 4870 739)
             (parent "")
             (select-mask 1)
@@ -1363,7 +1363,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0x94ee618")
+            (id "0x9a0bf40")
             (pos 613 398)
             (parent "")
             (select-mask 1)
@@ -1374,7 +1374,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963d188")
+            (id "0x97d12a0")
             (pos 1145 398)
             (parent "")
             (select-mask 1)
@@ -1385,7 +1385,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963db00")
+            (id "0x9921288")
             (pos 1677 397)
             (parent "")
             (select-mask 1)
@@ -1396,7 +1396,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963dba8")
+            (id "0x9921330")
             (pos 2209 397)
             (parent "")
             (select-mask 1)
@@ -1407,7 +1407,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963dc70")
+            (id "0x99213f8")
             (pos 2741 397)
             (parent "")
             (select-mask 1)
@@ -1418,7 +1418,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963dd58")
+            (id "0x99214e0")
             (pos -2609 407)
             (parent "")
             (select-mask 1)
@@ -1429,7 +1429,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963de40")
+            (id "0x99215c8")
             (pos -2077 407)
             (parent "")
             (select-mask 1)
@@ -1440,7 +1440,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963df28")
+            (id "0x99216b0")
             (pos -3141 407)
             (parent "")
             (select-mask 1)
@@ -1451,7 +1451,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963e010")
+            (id "0x9921798")
             (pos -4205 407)
             (parent "")
             (select-mask 1)
@@ -1462,7 +1462,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963e0f8")
+            (id "0x9921880")
             (pos -3673 407)
             (parent "")
             (select-mask 1)
@@ -1473,7 +1473,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963e1e0")
+            (id "0x9921968")
             (pos -4737 407)
             (parent "")
             (select-mask 1)
@@ -1484,7 +1484,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963e2c8")
+            (id "0x9921a50")
             (pos -5801 407)
             (parent "")
             (select-mask 1)
@@ -1495,7 +1495,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963e3b0")
+            (id "0x9921b38")
             (pos -5269 407)
             (parent "")
             (select-mask 1)
@@ -1506,7 +1506,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963e498")
+            (id "0x9921c20")
             (pos -6333 407)
             (parent "")
             (select-mask 1)
@@ -1517,7 +1517,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963e580")
+            (id "0x9921d08")
             (pos 3273 396)
             (parent "")
             (select-mask 1)
@@ -1528,7 +1528,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963e668")
+            (id "0x9921df0")
             (pos 3805 397)
             (parent "")
             (select-mask 1)
@@ -1539,7 +1539,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963e750")
+            (id "0x999d190")
             (pos 4337 396)
             (parent "")
             (select-mask 1)
@@ -1550,7 +1550,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963e838")
+            (id "0x999d278")
             (pos 4869 396)
             (parent "")
             (select-mask 1)
@@ -1561,7 +1561,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963e920")
+            (id "0x999d360")
             (pos 5401 396)
             (parent "")
             (select-mask 1)
@@ -1572,7 +1572,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x963ea08")
+            (id "0x999d448")
             (pos 5933 396)
             (parent "")
             (select-mask 1)
@@ -1583,7 +1583,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x96ed618")
+            (id "0x999d530")
             (pos 6465 396)
             (parent "")
             (select-mask 1)
@@ -1594,7 +1594,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x96ed6e8")
+            (id "0x999d618")
             (pos 4631 455)
             (parent "")
             (select-mask 1)
@@ -1605,7 +1605,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x96ed7a0")
+            (id "0x999d6f8")
             (pos 4558 464)
             (parent "")
             (select-mask 1)
@@ -1616,7 +1616,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x96ed880")
+            (id "0x999d7d8")
             (pos 4599 378)
             (parent "")
             (select-mask 1)
@@ -1633,7 +1633,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0x96efa28")
+            (id "0x999d950")
             (pos 1328 80)
             (parent "")
             (select-mask 1)
@@ -1644,7 +1644,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x96efaa0")
+            (id "0x9741a80")
             (pos 2513 80)
             (parent "")
             (select-mask 1)

Modified: trunk/windstille/data/sectors/trainstation/mine.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/mine.wst	2009-04-06 03:04:32 UTC (rev 2879)
+++ trunk/windstille/data/sectors/trainstation/mine.wst	2009-04-06 03:07:44 UTC (rev 2880)
@@ -7,678 +7,860 @@
   (init-script "init.nut")
   (layer
     (name "Mine")
-    (visible 1)
-    (locked 0)
+    (visible #t)
+    (locked #t)
     (objects)
     (child-layers
       (layer
         (name "Ground")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x9b77ca8")
+            (id "0x9f2c0b8")
             (pos 549 593)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b70ce8")
+            (id "0x9f2c9b0")
             (pos 1347 593)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b70d90")
+            (id "0x9f2cfa0")
             (pos -249 593)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b70e38")
+            (id "0x9f2b1f8")
             (pos -2297 593)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b70f20")
+            (id "0x9f2b3b8")
             (pos -700.997 593)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b71008")
+            (id "0x9f2b4a0")
             (pos -1499 593)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Light")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x9b71200")
+            (id "0x9f2cd38")
             (pos 72.8123 428.586)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b712b8")
+            (id "0x9f2cba8")
             (pos 957.187 478)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b71398")
+            (id "0xa18e670")
             (pos -2024.01 398.313)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b71478")
+            (id "0xa18e870")
             (pos -1088.37 457.98)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b71558")
+            (id "0xa18e9c0")
             (pos -1595.5 531.125)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b71638")
+            (id "0xa18eb10")
             (pos -626.089 548.147)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b71718")
+            (id "0xa18ed40")
             (pos 452.5 531.125)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b717f8")
+            (id "0xa18efa0")
             (pos -1090.81 479.953)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers
           (layer
             (name "Lamps")
-            (visible 1)
-            (locked 0)
+            (visible #t)
+            (locked #t)
             (objects
               (decal
-                (id "0x9b71f40")
+                (id "0xa129cc8")
                 (pos 523 227.062)
                 (parent "")
                 (select-mask 1)
                 (path "images/objects/apartmentlamp_light.png")
                 (type 1)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9b72030")
+                (id "0x9f2ae40")
                 (pos -1525 227.062)
                 (parent "")
                 (select-mask 1)
                 (path "images/objects/apartmentlamp_light.png")
                 (type 1)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9b72120")
+                (id "0x9f2b010")
                 (pos -1490.94 161.75)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp_bloom.png")
                 (type 2)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9b72208")
+                (id "0xa127848")
                 (pos 552.57 42.1211)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9b722f0")
+                (id "0xa128468")
                 (pos 561.945 159.309)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp_bloom.png")
                 (type 2)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9b723d8")
+                (id "0xa1293d0")
                 (pos -1495.43 42.1211)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/rooflamp.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0)))
+                (angle 0)
+                (hflip #f)
+                (vflip #f)))
             (child-layers))))
       (layer
         (name "Wood")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x9b71eb0")
+            (id "0xa129510")
             (pos -2170.5 332.688)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree1.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b6e4a8")
+            (id "0xa129660")
             (pos -954.877 340.5)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b700b0")
+            (id "0xa128930")
             (pos -122.5 332.688)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree1.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b63f08")
+            (id "0xa59c2f0")
             (pos 1093.12 340.5)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b6f920")
+            (id "0xa3e8e70")
             (pos -122.5 -180.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree1.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9b6f9e8")
+            (id "0xa3e8760")
             (pos 1093.12 -171.5)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9c6c900")
+            (id "0xa3e9030")
             (pos -954.877 -171.5)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9c6c9e8")
+            (id "0xa3e91e8")
             (pos -2170.5 -180.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_tree1.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Items")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #f)
         (objects
           (decal
-            (id "0x9b77c18")
+            (id "0xa3e9390")
             (pos 750.812 468)
             (parent "")
             (select-mask 1)
             (path "images/decal/trashcan.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9c6cba0")
+            (id "0xa3e8c50")
             (pos 425.812 460.188)
             (parent "")
             (select-mask 1)
             (path "images/decal/trashcan.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9c6cc58")
+            (id "0xa3e9668")
             (pos -445.623 466.047)
             (parent "")
             (select-mask 1)
             (path "images/decal/trashcan.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9c6cd10")
+            (id "0xa59a610")
             (pos -1903.44 466.047)
             (parent "")
             (select-mask 1)
             (path "images/decal/trashcan.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9f2d5b0")
+            (pos 178 511)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/plant1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9f2f650")
+            (pos 1257 457)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/plant5.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9b243b0")
+            (pos 935 459)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/plant3.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9b287c0")
+            (pos -1195 398)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/plant4.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Player")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x9c6ce78")
+            (id "0xa59a6f8")
             (pos 638.516 439.91)
             (parent "")
             (select-mask 1)
             (path "images/decal/humanreference.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Shadows")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x9cd50c8")
+            (id "0xa3e7d28")
             (pos -103.75 531.125)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9c6d6a8")
+            (id "0xa59b4d0")
             (pos 1075.94 526.438)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9c6e038")
+            (id "0xa59c000")
             (pos 613.437 582.688)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9c6e118")
+            (id "0xa59c168")
             (pos 211.875 567.062)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9c6e1f8")
+            (id "0xa3e6fe8")
             (pos -450.186 557.297)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9c6e2d8")
+            (id "0xa3e79a8")
             (pos -1840.03 590.5)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd2da8")
+            (id "0xa7ed150")
             (pos -2149.79 531.125)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd2e88")
+            (id "0xa7ed338")
             (pos -2179.87 298.703)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd2f68")
+            (id "0xa3e66f8")
             (pos 1073.56 306.875)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd3048")
+            (id "0xa3e67d8")
             (pos -131.875 296.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd3128")
+            (id "0xa7ed050")
             (pos -974.437 306.875)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd3208")
+            (id "0xa3e6908")
             (pos -972.057 526.438)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Wall")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x9c6e8c0")
+            (id "0xa3e6ca8")
             (pos 803.06 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9e2bdf8")
+            (id "0xa3e6150")
             (pos 803.063 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd4290")
+            (id "0xa3e6258")
             (pos 1315.06 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd4340")
+            (id "0xa3e6418")
             (pos 1315.06 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd4410")
+            (id "0xa3e6588")
             (pos 803.06 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd4500")
+            (id "0xa3e76e8")
             (pos 1315.06 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd45f0")
+            (id "0xa869bd8")
             (pos -732.937 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd46e0")
+            (id "0xa86aab8")
             (pos -732.937 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd47d0")
+            (id "0xa86a5a0")
             (pos -732.937 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd48c0")
+            (id "0xa86b020")
             (pos -1244.94 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd49b0")
+            (id "0xa86ae88")
             (pos -1244.93 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd4aa0")
+            (id "0xa86ad80")
             (pos -1244.94 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd4b90")
+            (id "0xa86a700")
             (pos -220.937 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd4c80")
+            (id "0xa86a100")
             (pos -220.937 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9cd4d70")
+            (id "0xa869f40")
             (pos 291.063 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9e29b10")
+            (id "0xa869e28")
             (pos 291.063 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9e29c00")
+            (id "0xa867a98")
             (pos 291.063 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9e29cf0")
+            (id "0xa867db8")
             (pos -220.937 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9e29de0")
+            (id "0xa869098")
             (pos -1756.93 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9e29ed0")
+            (id "0xa869b70")
             (pos -1756.93 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9e29fc0")
+            (id "0xa867ca0")
             (pos -1756.93 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9e2a0b0")
+            (id "0xa8692d8")
             (pos -2268.93 -52.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9e2a1a0")
+            (id "0xa869490")
             (pos -2268.93 203.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9e2a290")
+            (id "0xa869a28")
             (pos -2268.93 459.25)
             (parent "")
             (select-mask 1)
             (path "images/decal/mine_background.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers)))))
 
 ;; EOF ;;

Added: trunk/windstille/data/sectors/trainstation/steelplatetest.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/steelplatetest.wst	2009-04-06 03:04:32 UTC (rev 2879)
+++ trunk/windstille/data/sectors/trainstation/steelplatetest.wst	2009-04-06 03:07:44 UTC (rev 2880)
@@ -0,0 +1,389 @@
+;; -*- scheme -*-
+
+(windstille-sector
+  (version 2)
+  (name "")
+  (ambient-color 0 0 0 1)
+  (init-script "init.nut")
+  (layer
+    (name "Scene")
+    (visible #t)
+    (locked #f)
+    (objects
+      (decal
+        (id "0xa1a6c58")
+        (pos 1494 414)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0xa407900")
+        (pos 982 672)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0xa425d20")
+        (pos 982 416)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x9be2b60")
+        (pos 2006 672)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0xa425da0")
+        (pos 2006 416)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0xa408cb8")
+        (pos 1884 717)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 1.72268 1.06486)
+        (angle -1.56411)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x9bdb760")
+        (pos 2006 160)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x9f41580")
+        (pos 1494 160)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x9bdb7b0")
+        (pos 982 160)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0xa44ca00")
+        (pos 470 160)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0xa1c48b0")
+        (pos 470 416)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0xa1af6d0")
+        (pos 470 672)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0xa43d690")
+        (pos 1268 698)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 1.72268 1.06486)
+        (angle -1.56411)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x9ed87f8")
+        (pos 1304 480)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steeltile2.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0xa1c4468")
+        (pos 1302 608)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steeltile3.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x9b40448")
+        (pos 1302 736)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steeltile6.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0xa420620")
+        (pos 1814 734)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steeltile3.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #t)
+        (vflip #f))
+      (decal
+        (id "0xa44cad8")
+        (pos 1558 672)
+        (parent "")
+        (select-mask 1)
+        (path "images/objects/door.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0xa4261d8")
+        (pos 1814 606)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steeltile5.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #t)
+        (vflip #f))
+      (decal
+        (id "0x9be3030")
+        (pos 1555 549)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 0.139274 0.594062)
+        (angle -1.56411)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0xa1c27f0")
+        (pos 1560 480)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steeltile6.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #t)
+        (vflip #f))
+      (decal
+        (id "0x9ed3e70")
+        (pos 1489 673)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 0.131086 0.898949)
+        (angle -0.00282016)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0xa1aacb0")
+        (pos 1432 480)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steeltile4.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #t)
+        (vflip #f))
+      (decal
+        (id "0xa41fe08")
+        (pos 1430 608)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steeltile1.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #t)
+        (vflip #f))
+      (decal
+        (id "0xa41fe88")
+        (pos 1814 478)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steeltile3.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #t)
+        (vflip #f))
+      (decal
+        (id "0xa43f050")
+        (pos 1688 480)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steeltile2.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x9b3f478")
+        (pos 1634 682)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 0.131086 0.898949)
+        (angle -0.00282016)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x9bdcd68")
+        (pos 1686 735)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steeltile6.png")
+        (type 0)
+        (scale 1 0.984375)
+        (angle 0)
+        (hflip #t)
+        (vflip #f))
+      (decal
+        (id "0xa4405b0")
+        (pos 1430 736)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steeltile4.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #t)
+        (vflip #f))
+      (decal
+        (id "0xa440630")
+        (pos 1686 608)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steeltile1.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #t)
+        (vflip #f))
+      (decal
+        (id "0xa41ef40")
+        (pos 1238 864)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/stone2.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0xa41ef90")
+        (pos 1750 864)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/stone2.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x9eca2b0")
+        (pos 726 864)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/stone2.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0xa4404c8")
+        (pos 2262 864)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/stone2.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f)))
+    (child-layers)))
+
+;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/toilet.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/toilet.wst	2009-04-06 03:04:32 UTC (rev 2879)
+++ trunk/windstille/data/sectors/trainstation/toilet.wst	2009-04-06 03:07:44 UTC (rev 2880)
@@ -17,8 +17,8 @@
         (locked #t)
         (objects
           (decal
-            (id "0x8fa9330")
-            (pos 1283 392)
+            (id "0x9fbe068")
+            (pos 1292 294)
             (parent "")
             (select-mask 1)
             (path "images/streetlamp-light.png")
@@ -28,8 +28,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fa9950")
-            (pos 940 336)
+            (id "0x9fbd698")
+            (pos 949 238)
             (parent "")
             (select-mask 1)
             (path "images/objects/apartmentlamp_light.png")
@@ -39,8 +39,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8faa688")
-            (pos 949 103)
+            (id "0x9fbd378")
+            (pos 958 5)
             (parent "")
             (select-mask 1)
             (path "images/objects/apartmentlamp_highlight.png")
@@ -56,8 +56,8 @@
         (locked #t)
         (objects
           (decal
-            (id "0x8fa7068")
-            (pos 1572 367)
+            (id "0x9fbeb00")
+            (pos 1581 269)
             (parent "")
             (select-mask 1)
             (path "images/decal/humanreference.png")
@@ -73,8 +73,8 @@
         (locked #t)
         (objects
           (decal
-            (id "0x88704b8")
-            (pos 1674 45)
+            (id "0x9fbb330")
+            (pos 1683 -53)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -84,8 +84,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8edc3c0")
-            (pos 1707 498)
+            (id "0x9fbb5a0")
+            (pos 1716 400)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -95,8 +95,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8e9fe90")
-            (pos 326 503)
+            (id "0x9fbba48")
+            (pos 335 405)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -106,8 +106,8 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x922b8a0")
-            (pos 357 49)
+            (id "0x9fbbc08")
+            (pos 366 -49)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -117,8 +117,8 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x8fa7fe8")
-            (pos 1463 546)
+            (id "0x9fbbdc8")
+            (pos 1472 448)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -128,8 +128,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbf538")
-            (pos 1335 546)
+            (id "0x9fbbf88")
+            (pos 1344 448)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -139,8 +139,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbf5b0")
-            (pos 1207 546)
+            (id "0x9fbc148")
+            (pos 1216 448)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -150,8 +150,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbf658")
-            (pos 1079 546)
+            (id "0x9fbc308")
+            (pos 1088 448)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -161,8 +161,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbf720")
-            (pos 951 546)
+            (id "0x9fbc4c8")
+            (pos 960 448)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -172,8 +172,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbf808")
-            (pos 823 546)
+            (id "0x9fbc688")
+            (pos 832 448)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -183,8 +183,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbf8f0")
-            (pos 695 546)
+            (id "0x9fbc848")
+            (pos 704 448)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -194,8 +194,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbf9d8")
-            (pos 567 546)
+            (id "0x9fbca08")
+            (pos 576 448)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -205,8 +205,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbfac0")
-            (pos 439 546)
+            (id "0x9fbcbc8")
+            (pos 448 448)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -216,8 +216,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbfba8")
-            (pos 1463 34)
+            (id "0x9fbcd88")
+            (pos 1472 -64)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -227,8 +227,8 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x8fbfc90")
-            (pos 1335 34)
+            (id "0x9fbcf48")
+            (pos 1344 -64)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -238,8 +238,8 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x8fbfd78")
-            (pos 1207 34)
+            (id "0x9fd94b8")
+            (pos 1216 -64)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -249,8 +249,8 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x8fbfe60")
-            (pos 1079 34)
+            (id "0x9fd9560")
+            (pos 1088 -64)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -260,8 +260,8 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x8fbff48")
-            (pos 951 34)
+            (id "0xa10da28")
+            (pos 960 -64)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -271,8 +271,8 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x8fc0030")
-            (pos 823 34)
+            (id "0xa119bf0")
+            (pos 832 -64)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -282,8 +282,8 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x8fc0118")
-            (pos 695 34)
+            (id "0xa125d98")
+            (pos 704 -64)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -293,8 +293,8 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x8fc0200")
-            (pos 567 34)
+            (id "0xa131f20")
+            (pos 576 -64)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -304,8 +304,8 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x8fc02e8")
-            (pos 439 34)
+            (id "0xa13e120")
+            (pos 448 -64)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -315,8 +315,8 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x8fc03d0")
-            (pos 1591 34)
+            (id "0xa14a2c0")
+            (pos 1600 -64)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -326,8 +326,8 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x8fc04b8")
-            (pos 1591 546)
+            (id "0xa1564c0")
+            (pos 1600 448)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -337,8 +337,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbc110")
-            (pos 1719 418)
+            (id "0xa162660")
+            (pos 1728 320)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -348,8 +348,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9140120")
-            (pos 1719 290)
+            (id "0xa16e860")
+            (pos 1728 192)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -359,8 +359,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8870400")
-            (pos 1719 162)
+            (id "0xa17aa00")
+            (pos 1728 64)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -370,8 +370,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8eed6e8")
-            (pos 311 162)
+            (id "0xa186c00")
+            (pos 320 64)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -381,8 +381,8 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x922b180")
-            (pos 311 290)
+            (id "0xa192da0")
+            (pos 320 192)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -392,8 +392,8 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x8faf6b0")
-            (pos 311 418)
+            (id "0xa19efa0")
+            (pos 320 320)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_ground.png")
@@ -406,11 +406,11 @@
       (layer
         (name "Objects")
         (visible #t)
-        (locked #f)
+        (locked #t)
         (objects
           (decal
-            (id "0x8fc0bf0")
-            (pos 775 391)
+            (id "0xa1b72e8")
+            (pos 784 293)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet1.png")
@@ -420,8 +420,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fa7610")
-            (pos 983 356)
+            (id "0x9fbe288")
+            (pos 992 258)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet2.png")
@@ -431,8 +431,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x903d8f0")
-            (pos 1100 356)
+            (id "0xa1b77e0")
+            (pos 1109 258)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet2.png")
@@ -442,21 +442,10 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x903d998")
-            (pos 781 355)
+            (id "0x9fbd0f8")
+            (pos 639 297)
             (parent "")
             (select-mask 1)
-            (path "images/decal/toilet_door.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x903e398")
-            (pos 630 395)
-            (parent "")
-            (select-mask 1)
             (path "images/decal/toilet1.png")
             (type 0)
             (scale 1 1)
@@ -464,8 +453,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x903e410")
-            (pos 637 355)
+            (id "0xa1b7d40")
+            (pos 646 257)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_door.png")
@@ -475,8 +464,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x903e4b8")
-            (pos 485 395)
+            (id "0xa1b8100")
+            (pos 494 297)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet1.png")
@@ -486,8 +475,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x903e5a0")
-            (pos 493 355)
+            (id "0xa1b83a0")
+            (pos 502 257)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_door.png")
@@ -497,8 +486,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbb920")
-            (pos 853 354)
+            (id "0xa1b7b28")
+            (pos 862 256)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_door2.png")
@@ -508,8 +497,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8ed7fe0")
-            (pos 709 354)
+            (id "0x9fbb6d8")
+            (pos 718 256)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_door2.png")
@@ -519,8 +508,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8e99f40")
-            (pos 565 354)
+            (id "0x9fbb770")
+            (pos 574 256)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_door2.png")
@@ -530,8 +519,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8eaac58")
-            (pos 421 354)
+            (id "0xa1bed98")
+            (pos 430 256)
             (parent "")
             (select-mask 1)
             (path "images/decal/toilet_door2.png")
@@ -541,8 +530,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9244780")
-            (pos 1288 272)
+            (id "0xa1bef38")
+            (pos 1297 174)
             (parent "")
             (select-mask 1)
             (path "images/decal/city_housewall.png")
@@ -552,8 +541,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9245f30")
-            (pos 1284 349)
+            (id "0xa030f78")
+            (pos 1293 251)
             (parent "")
             (select-mask 1)
             (path "images/decal/sink.png")
@@ -561,6 +550,17 @@
             (scale 1 1)
             (angle 0)
             (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa02f2f8")
+            (pos 840 257)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/toilet_door_open2.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
             (vflip #f)))
         (child-layers))
       (layer
@@ -569,8 +569,8 @@
         (locked #t)
         (objects
           (decal
-            (id "0x903ec80")
-            (pos 986 391)
+            (id "0xa02f1a8")
+            (pos 995 293)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -580,8 +580,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x903edc0")
-            (pos 1103 396)
+            (id "0xa02ee28")
+            (pos 1112 298)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -591,8 +591,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x903e950")
-            (pos 1293 378)
+            (id "0xa030788")
+            (pos 1302 280)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -602,8 +602,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x903e9f0")
-            (pos 797 478)
+            (id "0xa030878")
+            (pos 806 380)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -613,8 +613,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x903ead0")
-            (pos 579 483)
+            (id "0xa030a60")
+            (pos 588 385)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -624,8 +624,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8e86530")
-            (pos 378 446)
+            (id "0xa2cf7d0")
+            (pos 387 348)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -635,8 +635,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8870448")
-            (pos 352 60)
+            (id "0xa030540")
+            (pos 361 -38)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -646,8 +646,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x891b880")
-            (pos 1670 53)
+            (id "0xa030678")
+            (pos 1679 -45)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -657,8 +657,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9244730")
-            (pos 1761 518)
+            (id "0xa2cfdc0")
+            (pos 1770 420)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -668,8 +668,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x922ba00")
-            (pos 1658 260)
+            (id "0xa2cfc60")
+            (pos 1667 162)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -679,8 +679,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fb99a8")
-            (pos 1141 494)
+            (id "0xa2cf8b0")
+            (pos 1150 396)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -690,8 +690,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbb968")
-            (pos 1320 423)
+            (id "0xa2cf9c0")
+            (pos 1329 325)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -701,8 +701,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9245fd0")
-            (pos 1125 511)
+            (id "0xa0300c8")
+            (pos 1134 413)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -712,8 +712,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fc0af0")
-            (pos 992 512)
+            (id "0xa030288")
+            (pos 1001 414)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -723,8 +723,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8faa8d0")
-            (pos 827 333)
+            (id "0xa02fc10")
+            (pos 836 235)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -737,11 +737,11 @@
       (layer
         (name "Background")
         (visible #t)
-        (locked #t)
+        (locked #f)
         (objects
           (decal
-            (id "0x8fa82e0")
-            (pos 439 418)
+            (id "0xa2d0190")
+            (pos 448 320)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -751,8 +751,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbda20")
-            (pos 439 162)
+            (id "0xa2d08e0")
+            (pos 448 64)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -762,8 +762,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbda98")
-            (pos 439 290)
+            (id "0xa301a40")
+            (pos 448 192)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -773,8 +773,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbe1f0")
-            (pos 567 418)
+            (id "0xa2d0f80")
+            (pos 576 320)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -784,8 +784,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbe2d8")
-            (pos 567 162)
+            (id "0xa301b68")
+            (pos 576 64)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -795,8 +795,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbe3c0")
-            (pos 567 290)
+            (id "0xa311cc0")
+            (pos 576 192)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -806,8 +806,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbe4a8")
-            (pos 695 290)
+            (id "0xa321ed0")
+            (pos 704 192)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -817,8 +817,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbe590")
-            (pos 695 162)
+            (id "0xa342110")
+            (pos 704 64)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -828,8 +828,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbe678")
-            (pos 695 418)
+            (id "0xa3524b8")
+            (pos 704 320)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -839,8 +839,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbe760")
-            (pos 823 418)
+            (id "0xa3523c0")
+            (pos 832 320)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -850,8 +850,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbe848")
-            (pos 823 162)
+            (id "0xa3625e8")
+            (pos 832 64)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -861,8 +861,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b74b0")
-            (pos 823 290)
+            (id "0xa3727d8")
+            (pos 832 192)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -872,8 +872,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b7598")
-            (pos 951 418)
+            (id "0xa3829a0")
+            (pos 960 320)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -883,8 +883,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b7680")
-            (pos 951 162)
+            (id "0xa3a2bd8")
+            (pos 960 64)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -894,8 +894,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b7768")
-            (pos 951 290)
+            (id "0xa3b2de8")
+            (pos 960 192)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -905,8 +905,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b7850")
-            (pos 1079 290)
+            (id "0xa3b2ee8")
+            (pos 1088 192)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -916,8 +916,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b7938")
-            (pos 1079 162)
+            (id "0xa3c3098")
+            (pos 1088 64)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -927,8 +927,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b7a20")
-            (pos 1079 418)
+            (id "0xa3d3218")
+            (pos 1088 320)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -938,8 +938,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b7b08")
-            (pos 1463 162)
+            (id "0xa3e35c0")
+            (pos 1472 64)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -949,8 +949,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b7bf0")
-            (pos 1336 290)
+            (id "0xa4037e8")
+            (pos 1345 192)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -960,8 +960,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b7cd8")
-            (pos 1335 162)
+            (id "0xa4138a8")
+            (pos 1344 64)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -971,8 +971,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b7dc0")
-            (pos 1335 418)
+            (id "0xa423bf8")
+            (pos 1344 320)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -982,8 +982,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b7ea8")
-            (pos 1207 290)
+            (id "0xa433db8")
+            (pos 1216 192)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -993,8 +993,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b7f90")
-            (pos 1207 162)
+            (id "0xa413998")
+            (pos 1216 64)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -1004,8 +1004,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b8078")
-            (pos 1207 418)
+            (id "0xa443ee8")
+            (pos 1216 320)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -1015,8 +1015,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b8160")
-            (pos 1591 290)
+            (id "0xa454290")
+            (pos 1600 192)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -1026,8 +1026,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b8248")
-            (pos 1591 162)
+            (id "0xa4744b8")
+            (pos 1600 64)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -1037,8 +1037,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b8330")
-            (pos 1591 418)
+            (id "0xa484578")
+            (pos 1600 320)
             (parent "")
             (select-mask 1)
             (path "images/decal/walltiles.png")
@@ -1054,8 +1054,8 @@
         (locked #t)
         (objects
           (decal
-            (id "0x8fbcf10")
-            (pos 1463 354)
+            (id "0xa02fe58")
+            (pos 1472 256)
             (parent "")
             (select-mask 1)
             (path "images/objects/door.png")
@@ -1065,8 +1065,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fa8228")
-            (pos 1389 365)
+            (id "0xa02ff00")
+            (pos 1398 267)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -1076,8 +1076,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x8fbce00")
-            (pos 1580 364)
+            (id "0x9fbb240")
+            (pos 1589 266)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -1087,8 +1087,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b86c8")
-            (pos 1439 222)
+            (id "0xa4846d8")
+            (pos 1448 124)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
@@ -1098,8 +1098,8 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x90b8780")
-            (pos 953 104)
+            (id "0xa2d0cb0")
+            (pos 962 6)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")

Modified: trunk/windstille/data/sectors/trainstation/trainstation.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/trainstation.wst	2009-04-06 03:04:32 UTC (rev 2879)
+++ trunk/windstille/data/sectors/trainstation/trainstation.wst	2009-04-06 03:07:44 UTC (rev 2880)
@@ -7,2670 +7,3335 @@
   (init-script "init.nut")
   (layer
     (name "Trainstation")
-    (visible 1)
-    (locked 0)
+    (visible #t)
+    (locked #t)
     (objects)
     (child-layers
       (layer
         (name "Daylight")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x91291d8")
+            (id "0xa2d7478")
             (pos -855.442 319.354)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")
             (type 2)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9128438")
+            (id "0xa2d7c70")
             (pos -1297.52 365.776)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 2)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x912a340")
+            (id "0xa2d8010")
             (pos -1402.7 340.058)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")
             (type 2)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x912a3b8")
+            (id "0xa2d8550")
             (pos -1099.97 336.543)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")
             (type 2)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9126380")
+            (id "0xa2d8718")
             (pos -1569.48 329.078)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")
             (type 2)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Lights")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x9128da0")
+            (id "0xa2d8168")
             (pos 1630.08 1070.32)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9126728")
+            (id "0xa2d8290")
             (pos 983.756 904.953)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9126808")
+            (id "0xa3241e0")
             (pos 315.072 868.593)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x91268e8")
+            (id "0xa324698")
             (pos -1636 909.933)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x91269c8")
+            (id "0xa3244e8")
             (pos -810.844 849.183)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9126aa8")
+            (id "0xa324380")
             (pos 1559.83 804.374)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9126b88")
+            (id "0xa324c30")
             (pos -259.112 903.761)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x91270a8")
+            (id "0xa324dc8")
             (pos -477.046 760.753)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9127188")
+            (id "0xa324f40")
             (pos -1553.29 729.292)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9127268")
+            (id "0xa2d45f0")
             (pos -1169.49 799.75)
             (parent "")
             (select-mask 1)
             (path "images/decal/light.png")
             (type 1)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers
           (layer
             (name "ExtraLight")
-            (visible 1)
-            (locked 0)
+            (visible #t)
+            (locked #t)
             (objects
               (decal
-                (id "0x9127f78")
+                (id "0xa2d5fc0")
                 (pos -402.054 1017.24)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
                 (type 1)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9128170")
+                (id "0xa2d60d0")
                 (pos 161.91 1097.81)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
                 (type 1)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9128250")
+                (id "0xa2d57f8")
                 (pos 860.719 704.086)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
                 (type 1)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x91273e8")
+                (id "0xa2d6400")
                 (pos 208.559 708.054)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
                 (type 1)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x91274c8")
+                (id "0xa2d5948")
                 (pos -845.605 1035.11)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
                 (type 1)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x91275a8")
+                (id "0xa2d5ee0")
                 (pos -332.91 1098.59)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
                 (type 1)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9127688")
+                (id "0xa2d4b28")
                 (pos -1151.04 1059.27)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
                 (type 1)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9127768")
+                (id "0xa2d4cc0")
                 (pos -1663.74 995.791)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
                 (type 1)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9127848")
+                (id "0xa2d4e40")
                 (pos 943.16 1149.08)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/light.png")
                 (type 1)
                 (scale 1 1)
-                (angle 0)))
+                (angle 0)
+                (hflip #f)
+                (vflip #f)))
             (child-layers))))
       (layer
+        (name "Train2")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0xa324110")
+            (pos -752 0)
+            (parent "0xa2d5590")
+            (select-mask 1)
+            (path "images/decal/train_front.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa2d56f0")
+            (pos 696 0)
+            (parent "0xa2d5590")
+            (select-mask 1)
+            (path "images/decal/train_back.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa2d5590")
+            (pos -2098.65 942.97)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/train_middle.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa2d51e0")
+            (pos -586.991 241.125)
+            (parent "0xa2d5590")
+            (select-mask 1)
+            (path "images/decal/train_engine_front.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa3274c0")
+            (pos 593.009 242.125)
+            (parent "0xa2d5590")
+            (select-mask 1)
+            (path "images/decal/train_engine_back.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa3223b0")
+            (pos -206.991 241.125)
+            (parent "0xa2d5590")
+            (select-mask 1)
+            (path "images/decal/train_engine_middle.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa321dc0")
+            (pos 249.009 241.125)
+            (parent "0xa2d5590")
+            (select-mask 1)
+            (path "images/decal/train_engine_middle.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa321f80")
+            (pos 0.719482 -14.875)
+            (parent "0xa2d5590")
+            (select-mask 1)
+            (path "images/decal/train_door.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
         (name "Shadow")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x9128080")
+            (id "0xa3226b8")
             (pos -2249.87 1060.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9127ff0")
+            (id "0xa322970")
             (pos -2244.5 972.452)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9159730")
+            (id "0xa322ac0")
             (pos -2151.95 1070.86)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x91597f0")
+            (id "0xa323630")
             (pos -2223.31 378.014)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x91598d0")
+            (id "0xa3237c8")
             (pos -2222.56 441.264)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x91599b0")
+            (id "0xa3238f0")
             (pos -2231.18 652.952)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9159a90")
+            (id "0xa6b3010")
             (pos -2231.93 589.702)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9159b70")
+            (id "0xa323278")
             (pos -2223.79 825.967)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9159c50")
+            (id "0xa323448")
             (pos -2016.48 1029.67)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9159d30")
+            (id "0xa6b3ae0")
             (pos -2047.33 560.924)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9159e10")
+            (id "0xa6b3138")
             (pos -2080.6 782.737)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Roof")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x9126608")
+            (id "0xa6b3c38")
             (pos -132.297 329.766)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x915c5a0")
+            (id "0xa6b37b8")
             (pos 378.703 329.766)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x915d210")
+            (id "0xa6b38e0")
             (pos 1400.7 331.719)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x915d2b0")
+            (id "0xa329c78")
             (pos 889.703 331.719)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x915d370")
+            (id "0xa329e20")
             (pos 2422.7 331.719)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x915d450")
+            (id "0xa3255c0")
             (pos 1911.7 331.719)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x915d530")
+            (id "0xa326b58")
             (pos -1652.53 298.683)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x915d610")
+            (id "0xa327098")
             (pos -771.438 410.719)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x915a700")
+            (id "0xa326f48")
             (pos -1141.53 298.683)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x915a7a0")
+            (id "0xa326858")
             (pos -2163.53 298.683)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x915a840")
+            (id "0xa326a18")
             (pos -2674.53 298.683)
             (parent "")
             (select-mask 1)
             (path "images/decal/roof2.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
-        (name "Train2")
-        (visible 1)
-        (locked 0)
-        (objects
-          (decal
-            (id "0x915af20")
-            (pos -752 0)
-            (parent "0x915bb30")
-            (select-mask 1)
-            (path "images/decal/train_front.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0x915a948")
-            (pos 696 0)
-            (parent "0x915bb30")
-            (select-mask 1)
-            (path "images/decal/train_back.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0x915bb30")
-            (pos -2098.65 942.97)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/train_middle.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0x915edf8")
-            (pos -586.991 241.125)
-            (parent "0x915bb30")
-            (select-mask 1)
-            (path "images/decal/train_engine_front.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0x915efa0")
-            (pos 593.009 242.125)
-            (parent "0x915bb30")
-            (select-mask 1)
-            (path "images/decal/train_engine_back.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0x915faf8")
-            (pos -206.991 241.125)
-            (parent "0x915bb30")
-            (select-mask 1)
-            (path "images/decal/train_engine_middle.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0x925d700")
-            (pos 249.009 241.125)
-            (parent "0x915bb30")
-            (select-mask 1)
-            (path "images/decal/train_engine_middle.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0x925d7d0")
-            (pos 0.719482 -14.875)
-            (parent "0x915bb30")
-            (select-mask 1)
-            (path "images/decal/train_door.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
         (name "Lamps")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x915cb00")
+            (id "0xa325728")
             (pos 266.7 554.465)
             (parent "")
             (select-mask 1)
             (path "images/objects/apartmentlamp_light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x925e4f8")
+            (id "0xa325bc8")
             (pos 999.122 579.855)
             (parent "")
             (select-mask 1)
             (path "images/objects/apartmentlamp_light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x925e768")
+            (id "0xa327ff8")
             (pos 1651.47 577.902)
             (parent "")
             (select-mask 1)
             (path "images/objects/apartmentlamp_light.png")
             (type 1)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x925ef18")
+            (id "0xa328198")
             (pos 1660.56 541.188)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")
             (type 2)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x925efd0")
+            (id "0xa3295f8")
             (pos 998.057 533.375)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")
             (type 2)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x925f0b8")
+            (id "0xa329758")
             (pos 237.12 549)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp_bloom.png")
             (type 2)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x925f1a0")
+            (id "0xa329888")
             (pos 1642.66 434.301)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9163878")
+            (id "0xa325c78")
             (pos 982.958 428.895)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9163908")
+            (id "0xa328dc0")
             (pos 231.267 426.715)
             (parent "")
             (select-mask 1)
             (path "images/decal/rooflamp.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Decor Items")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x92f3cb8")
+            (id "0xa329008")
             (pos 240.218 886.438)
             (parent "")
             (select-mask 1)
             (path "images/decal/board.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9162c60")
+            (id "0xa3283d0")
             (pos 934.407 913.438)
             (parent "")
             (select-mask 1)
             (path "images/decal/terminal.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x93a0fc8")
+            (id "0xa328a28")
             (pos -163.625 985.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/bench.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x92f21c8")
+            (id "0xa8780f8")
             (pos 578.562 985.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/bench.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x92f2c20")
+            (id "0xa878360")
             (pos 1244.19 985.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/bench.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x92f2cc0")
+            (id "0xa878200")
             (pos 1689.49 985.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/bench.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x92f2da0")
+            (id "0xa799f40")
             (pos 2006.69 985.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/bench.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x92f2e80")
+            (id "0xaa76460")
             (pos 424.131 1013.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/plant.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x92f36f8")
+            (id "0xaa0f368")
             (pos -1002.18 1013.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/plant.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x92f3770")
+            (id "0xaa0f3c0")
             (pos -914.086 1013.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/plant.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9162968")
+            (id "0xa79a478")
             (pos -832.618 1013.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/plant.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9162a50")
+            (id "0xa79a608")
             (pos 1064.43 1014.67)
             (parent "")
             (select-mask 1)
             (path "images/objects/plant.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x940f230")
+            (id "0xaa76778")
             (pos 676.954 1029.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/box.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9162590")
+            (id "0xa6b8918")
             (pos 612.954 1029.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/box.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x91622f8")
+            (id "0xaadfaf0")
             (pos 648.954 965.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/box.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9162398")
+            (id "0xaaf0428")
             (pos 740.954 1029.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/box.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9160780")
+            (id "0xaaf3600")
             (pos 584.954 965.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/box.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9160860")
+            (id "0xaaf6748")
             (pos 548.954 1029.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/box.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9160940")
+            (id "0xa79a308")
             (pos 706.554 965.44)
             (parent "")
             (select-mask 1)
             (path "images/objects/box.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9160a20")
+            (id "0xaafca30")
             (pos 28.218 973.438)
             (parent "")
             (select-mask 1)
             (path "images/decal/trashcan.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9160fa8")
+            (id "0xaaffcb8")
             (pos 1448.12 973.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/trashcan.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Railground")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x9161940")
+            (id "0xab26e68")
             (pos -249.032 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x940fa00")
+            (id "0xaaec698")
             (pos -761.032 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x940faa0")
+            (id "0xab4c700")
             (pos -2297.03 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x940fb40")
+            (id "0xab4c848")
             (pos -1785.03 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x940fc00")
+            (id "0xab4c520")
             (pos -1273.03 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x940fce0")
+            (id "0xaaecce0")
             (pos 262.968 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x940fdc0")
+            (id "0xaaec748")
             (pos 774.968 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x940fea0")
+            (id "0xaaec878")
             (pos 1798.97 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x940ff80")
+            (id "0xaaeca18")
             (pos 1286.97 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9410060")
+            (id "0xaaebc80")
             (pos 1670.97 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9410a40")
+            (id "0xaaecfe0")
             (pos 1926.97 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9410ae0")
+            (id "0xaaec170")
             (pos 1414.97 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9410b80")
+            (id "0xadcdf10")
             (pos 1158.97 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9410c60")
+            (id "0xadcddb0")
             (pos 2214.14 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9411440")
+            (id "0xaaebfc8")
             (pos 1702.14 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9410f88")
+            (id "0xaaebeb8")
             (pos 1958.14 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9411010")
+            (id "0xaaeb430")
             (pos 1446.14 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x968c2d8")
+            (id "0xadce128")
             (pos -121.032 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x968c390")
+            (id "0xadce2d0")
             (pos -377.032 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x968c470")
+            (id "0xaee5c58")
             (pos 646.968 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x968c550")
+            (id "0xaee5d88")
             (pos 902.968 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x968c630")
+            (id "0xaaeb9d0")
             (pos 390.968 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9515330")
+            (id "0xaaeb3a8")
             (pos 134.968 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9515410")
+            (id "0xaaebb58")
             (pos 1190.13 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x95154f0")
+            (id "0xaf26428")
             (pos 934.13 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x95155d0")
+            (id "0xaf26590")
             (pos 422.13 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x95156b0")
+            (id "0xaefb520")
             (pos 166.13 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9515790")
+            (id "0xaf7c7d8")
             (pos 678.13 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9515870")
+            (id "0xafa7968")
             (pos -89.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9515950")
+            (id "0xafa7a28")
             (pos -889.032 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9515a30")
+            (id "0xafa7b40")
             (pos -633.032 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9515b10")
+            (id "0xafd2678")
             (pos -345.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9515bf0")
+            (id "0xafd2408")
             (pos -601.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9515cd0")
+            (id "0xb012518")
             (pos -1369.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9515db0")
+            (id "0xb03d840")
             (pos -1881.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9515e90")
+            (id "0xaf7c8b8")
             (pos -1625.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9515f70")
+            (id "0xaf7cad0")
             (pos -1113.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9516050")
+            (id "0xb03d910")
             (pos -857.872 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9516130")
+            (id "0xb03da40")
             (pos -1145.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9516210")
+            (id "0xb0a8478")
             (pos -1657.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x95162f0")
+            (id "0xb0a87a8")
             (pos -1401.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x95163d0")
+            (id "0xb0a86c0")
             (pos -1913.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x95164b0")
+            (id "0xb0d3348")
             (pos -2169.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9516590")
+            (id "0xb0d3100")
             (pos -3193.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9516670")
+            (id "0xb0fe4e0")
             (pos -2937.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9516750")
+            (id "0xb0fe6a8")
             (pos -2681.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9516830")
+            (id "0xb0fe788")
             (pos -2649.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9516910")
+            (id "0xb068510")
             (pos -2905.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x95169f0")
+            (id "0xb16a518")
             (pos -2809.03 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9516ad0")
+            (id "0xb13f220")
             (pos -3321.03 1380.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone2.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9516bb0")
+            (id "0xb13f2e0")
             (pos -2393.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9516c90")
+            (id "0xb195670")
             (pos -2137.87 1187.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/rail.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9516d70")
+            (id "0xb195730")
             (pos -2425.03 1273.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/stone.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Endwall")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x9161690")
-            (pos -1681.93 441.438)
+            (id "0xb195888")
+            (pos -1539 508)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor_left.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x95765c8")
-            (pos -1681.93 313.438)
+            (id "0xaa98e08")
+            (pos -1539 380)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor_left.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9161e58")
-            (pos -1681.93 953.438)
+            (id "0xab26b40")
+            (pos -1539 1020)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor_left.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9161ed8")
-            (pos -1681.93 825.438)
+            (id "0xa325d58")
+            (pos -1539 892)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor_left.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9517378")
-            (pos -1681.93 569.438)
+            (id "0xab26c88")
+            (pos -1539 636)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor_left.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x91639f0")
-            (pos -1681.93 697.438)
+            (id "0xaaeb538")
+            (pos -1539 764)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor_left.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9163ae0")
-            (pos -1681.93 1081.44)
+            (id "0xaaeb7a8")
+            (pos -1539 1148)
             (parent "")
             (select-mask 1)
             (path "images/objects/elevatordoor_left.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9574178")
-            (pos -1883.06 1017.44)
+            (id "0xb1ab298")
+            (pos -1741 1084)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x96e3e68")
-            (pos -2253.06 1017.44)
+            (id "0xb16a598")
+            (pos -2111 1084)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x95749f8")
-            (pos -2253.06 757.687)
+            (id "0xb16a688")
+            (pos -2111 824)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9574aa0")
-            (pos -1883.06 757.687)
+            (id "0xb1ab8c8")
+            (pos -1741 824)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9574b88")
-            (pos -2253.06 501.687)
+            (id "0xb1ab9d0")
+            (pos -2111 568)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9574c70")
-            (pos -1883.06 501.687)
+            (id "0xb1abb08")
+            (pos -1741 568)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9574d58")
-            (pos -2251.49 245.687)
+            (id "0xb458b28")
+            (pos -2109 312)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9574e40")
-            (pos -1881.49 245.687)
+            (id "0xb458bf0")
+            (pos -1739 312)
             (parent "")
             (select-mask 1)
             (path "images/decal/steelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9574f28")
+            (id "0xb458cd0")
             (pos -1763.88 1198.81)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9574fe0")
+            (id "0xb56edb8")
             (pos -2080.29 1241.78)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x95750c0")
+            (id "0xb56eca0")
             (pos -2400.6 1212.48)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x95751a0")
-            (pos -2376.41 267.922)
+            (id "0xb56e958")
+            (pos -2239 276)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9575280")
-            (pos -2118.6 301.125)
+            (id "0xb2882e0")
+            (pos -1976 368)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9575360")
-            (pos -1854.93 254.25)
+            (id "0xb288760")
+            (pos -1717 263)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Ground")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x9161760")
+            (id "0xb1ab158")
             (pos 1836.13 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9576208")
+            (id "0xb288450")
             (pos 2144.13 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x974e358")
+            (id "0xb2885b0")
             (pos -1551.87 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x974e3e0")
+            (id "0xb628308")
             (pos -1243.87 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x974e4a0")
+            (id "0xb288ae0")
             (pos -935.87 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x974e580")
+            (id "0xb6a8a48")
             (pos -627.87 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x96e1ac0")
+            (id "0xb288df0")
             (pos -319.87 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x96e1ba0")
+            (id "0xb288c60")
             (pos -11.87 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x96e1c80")
+            (id "0xb6a8b70")
             (pos 296.13 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x96e1d60")
+            (id "0xb6a8d58")
             (pos 604.13 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x96e1e40")
+            (id "0xb6294a8")
             (pos 912.13 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x96e1f20")
+            (id "0xb6295d8")
             (pos 1220.13 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x96e2000")
+            (id "0xb6296a0")
             (pos 1528.13 1103.44)
             (parent "")
             (select-mask 1)
             (path "images/decal/ground.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Stairs")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects)
         (child-layers
           (layer
             (name "Shadow")
-            (visible 1)
-            (locked 0)
+            (visible #t)
+            (locked #t)
             (objects
               (decal
-                (id "0x96f1838")
+                (id "0xab02f60")
                 (pos -1672.24 1055.45)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/dark.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96f1918")
-                (pos -1743.76 802.297)
+                (id "0xb6f4c08")
+                (pos -1529 861)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/dark.png")
                 (type 0)
-                (scale 1 1)
-                (angle 0))
+                (scale 0.833984 1.60059)
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96e21d8")
-                (pos -1723.47 1039.37)
+                (id "0xb6f4cd8")
+                (pos -1557 564)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/dark.png")
                 (type 0)
-                (scale 1 1)
-                (angle 0))
+                (scale 0.750977 1.16602)
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96e22b8")
-                (pos -1744.37 547.859)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/dark.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0x96e2398")
+                (id "0xb740dd0")
                 (pos -1484.44 1141.69)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/dark.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96e29c0")
+                (id "0xb740ea0")
                 (pos -937.569 1133.87)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/dark.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0)))
+                (angle 0)
+                (hflip #f)
+                (vflip #f)))
             (child-layers))
           (layer
             (name "StairHandle")
-            (visible 1)
-            (locked 0)
+            (visible #t)
+            (locked #f)
             (objects
               (decal
-                (id "0x96e2490")
-                (pos -616.808 986.023)
+                (id "0xab4a678")
+                (pos -964 844)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96e3b40")
-                (pos -747.308 903.961)
+                (id "0xaaeb130")
+                (pos -1058 746)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96e2e30")
-                (pos -866.058 819.586)
+                (id "0xab4ab30")
+                (pos -1155 652)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96e2ef8")
-                (pos -994.995 739.086)
+                (id "0xab4af58")
+                (pos -1250 547)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96e3050")
-                (pos -1121.56 643.773)
+                (id "0xab4b220")
+                (pos -1347 456)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96e3138")
-                (pos -1266.12 541.398)
+                (id "0xab4b6e8")
+                (pos -1440 363)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96ef8b0")
-                (pos -1417.24 435.273)
+                (id "0xab4b7b0")
+                (pos -863 930)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96ef998")
-                (pos -616.808 986.023)
+                (id "0xab4b428")
+                (pos -1537 273)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/handrail.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96efa80")
-                (pos -1548.99 346.023)
+                (id "0xab4bb20")
+                (pos -841 864)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/handrail.png")
+                (path "images/decal/stair_handle.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96efb68")
-                (pos -1513.04 261.304)
+                (id "0xab4ac88")
+                (pos -969 736)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/handrail2.png")
+                (path "images/decal/stair_handle.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x97e9dd0")
-                (pos -1401.54 337.804)
+                (id "0xab4bca8")
+                (pos -1097 608)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/handrail2.png")
+                (path "images/decal/stair_handle.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96f03e8")
-                (pos -1284.79 418.304)
+                (id "0xb83a928")
+                (pos -1225 480)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/handrail2.png")
+                (path "images/decal/stair_handle.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96f0490")
-                (pos -1168.6 497.851)
+                (id "0xb83a9d0")
+                (pos -1353 352)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/handrail2.png")
+                (path "images/decal/stair_handle.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f)))
+            (child-layers))
+          (layer
+            (name "Stairs")
+            (visible #t)
+            (locked #t)
+            (objects
               (decal
-                (id "0x96f0558")
-                (pos -1055.1 576.164)
+                (id "0xb860df0")
+                (pos -1040 739)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/handrail2.png")
+                (path "images/decal/shadow.png")
                 (type 0)
+                (scale 9.94316 1.38132)
+                (angle -2.42953)
+                (hflip #f)
+                (vflip #f))
+              (decal
+                (id "0xab4be38")
+                (pos -1358 869)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/stair_base.png")
+                (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96f0640")
-                (pos -951.354 648.164)
+                (id "0xb8a53d8")
+                (pos -849 997)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/handrail2.png")
+                (path "images/decal/stair_stairs.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96f0728")
-                (pos -951.354 648.164)
+                (id "0xb8d5f18")
+                (pos -974 997)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/handrail2.png")
+                (path "images/decal/stair_base.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96f0810")
-                (pos -840.354 724.914)
+                (id "0xb8f6930")
+                (pos -974 869)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/handrail2.png")
+                (path "images/decal/stair_stairs.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96f08f8")
-                (pos -727.167 804.352)
+                (id "0xb8f6a30")
+                (pos -1102 997)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/handrail2.png")
+                (path "images/decal/stair_base.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96f09e0")
-                (pos -618.354 880.164)
+                (id "0xb906b48")
+                (pos -1102 869)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/handrail2.png")
+                (path "images/decal/stair_base.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0)))
-            (child-layers))
-          (layer
-            (name "Stairs")
-            (visible 1)
-            (locked 0)
-            (objects
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x97e9ca8")
-                (pos -1136.93 991.617)
+                (id "0xb926d68")
+                (pos -1102 741)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/stairs.png")
+                (path "images/decal/stair_stairs.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96e2d50")
-                (pos -908.368 955.628)
+                (id "0xb937070")
+                (pos -1230 613)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/stairs.png")
+                (path "images/decal/stair_stairs.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x96f0f28")
-                (pos -1135.37 789.851)
+                (id "0xb947248")
+                (pos -1358 613)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/stairs.png")
+                (path "images/decal/stair_base.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9843800")
-                (pos -1585.06 933.992)
+                (id "0xb9573d8")
+                (pos -1358 485)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/stairs.png")
+                (path "images/decal/stair_stairs.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x98438a8")
-                (pos -1360.81 868.503)
+                (id "0xb9574f0")
+                (pos -1486 613)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/stairs.png")
+                (path "images/decal/stair_base.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9843988")
-                (pos -1356.49 631.226)
+                (id "0xb9675f0")
+                (pos -1486 485)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/stairs.png")
+                (path "images/decal/stair_base.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9843a68")
-                (pos -1583.49 700.43)
+                (id "0xb987850")
+                (pos -1486 357)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/stairs.png")
+                (path "images/decal/stair_stairs.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x97e7b48")
-                (pos -1583.49 453.94)
+                (id "0xb997b60")
+                (pos -1358 741)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/stairs.png")
+                (path "images/decal/stair_base.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x97e7c28")
-                (pos -1196.46 916.438)
+                (id "0xb9a7d38")
+                (pos -1486 741)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/door.png")
+                (path "images/decal/stair_base.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9813280")
-                (pos -681.368 1109.43)
+                (id "0xb9b7ec8")
+                (pos -1230 741)
                 (parent "")
                 (select-mask 1)
-                (path "images/decal/stairs.png")
+                (path "images/decal/stair_base.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0)))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
+              (decal
+                (id "0xb9c8068")
+                (pos -1486 869)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/stair_base.png")
+                (type 0)
+                (scale 1 1)
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
+              (decal
+                (id "0xb9c8140")
+                (pos -1230 869)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/stair_base.png")
+                (type 0)
+                (scale 1 1)
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
+              (decal
+                (id "0xb9e8360")
+                (pos -1358 997)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/stair_base.png")
+                (type 0)
+                (scale 1 1)
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
+              (decal
+                (id "0xb9f86a0")
+                (pos -1486 997)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/stair_base.png")
+                (type 0)
+                (scale 1 1)
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
+              (decal
+                (id "0xba08800")
+                (pos -1230 997)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/stair_base.png")
+                (type 0)
+                (scale 1 1)
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
+              (decal
+                (id "0xba189a0")
+                (pos -1347 917)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/door.png")
+                (type 0)
+                (scale 1 1)
+                (angle 0)
+                (hflip #f)
+                (vflip #f)))
             (child-layers))
           (layer
             (name "StairWall")
-            (visible 1)
-            (locked 0)
+            (visible #t)
+            (locked #t)
             (objects
               (decal
-                (id "0x96e3940")
+                (id "0xb895090")
                 (pos -658.251 306.508)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x97e8858")
+                (id "0xb874470")
                 (pos -658.251 434.508)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x97e96a0")
+                (id "0xba38e28")
                 (pos -656.688 690.508)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x97e9748")
+                (id "0xbae5490")
                 (pos -656.688 562.508)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x97e9830")
-                (pos -1424.46 307.117)
+                (id "0xbae5590")
+                (pos -1425 307)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x97e9918")
+                (id "0xbb1e3e8")
                 (pos -656.462 935.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/tunnelplate_bottom.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x97e9a98")
+                (id "0xbb4e678")
                 (pos -656.688 818.508)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9811670")
-                (pos -656.688 946.508)
+                (id "0xbb97240")
+                (pos -657 946)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9811718")
-                (pos -656.688 1074.51)
+                (id "0xbae5120")
+                (pos -657 1074)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9811800")
+                (id "0xbb97318")
                 (pos -1424.46 563.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x98118e8")
+                (id "0xbb97040")
                 (pos -1424.46 691.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x98119d0")
+                (id "0xbb97180")
                 (pos -1424.46 435.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9811ab8")
+                (id "0xbb7ea28")
                 (pos -1424.46 819.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9811ba0")
+                (id "0xbcee790")
                 (pos -1168.46 819.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9811c88")
+                (id "0xbcee998")
                 (pos -1168.46 435.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9811d70")
+                (id "0xbd36f08")
                 (pos -1168.46 691.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9811e58")
+                (id "0xbd36d98")
                 (pos -1168.46 563.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9811f40")
-                (pos -1168.46 307.117)
+                (id "0xbd67210")
+                (pos -1169 307)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9812028")
+                (id "0xbd1ea70")
                 (pos -912.462 307.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x9812110")
+                (id "0xbd1ec48")
                 (pos -912.462 563.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x98121f8")
+                (id "0xbd97400")
                 (pos -912.462 691.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x98122e0")
+                (id "0xbd97608")
                 (pos -912.462 435.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
               (decal
-                (id "0x98123c8")
+                (id "0xbddfb20")
                 (pos -912.462 819.117)
                 (parent "")
                 (select-mask 1)
                 (path "images/decal/wallplate.png")
                 (type 0)
                 (scale 1 1)
-                (angle 0)))
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
+              (decal
+                (id "0xbddfc20")
+                (pos -1169 947)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/wallplate.png")
+                (type 0)
+                (scale 1 1)
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
+              (decal
+                (id "0xbdc7898")
+                (pos -913 946)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/wallplate.png")
+                (type 0)
+                (scale 1 1)
+                (angle 0)
+                (hflip #f)
+                (vflip #f))
+              (decal
+                (id "0xbe0fd18")
+                (pos -913 1074)
+                (parent "")
+                (select-mask 1)
+                (path "images/decal/wallplate.png")
+                (type 0)
+                (scale 1 1)
+                (angle 0)
+                (hflip #f)
+                (vflip #f)))
             (child-layers))))
       (layer
         (name "WallShadow")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x97e85d0")
+            (id "0xbe0ff70")
             (pos -498.687 804.29)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x97e8618")
+            (id "0xab4c1f8")
             (pos -418.187 492.016)
             (parent "")
             (select-mask 1)
             (path "images/decal/dark.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Train")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x97e8498")
+            (id "0xba39378")
             (pos -752 0)
-            (parent "0x96e38e8")
+            (parent "0xbe40278")
             (select-mask 1)
             (path "images/decal/train_front.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x96e37c0")
+            (id "0xbe40058")
             (pos 696 0)
-            (parent "0x96e38e8")
+            (parent "0xbe40278")
             (select-mask 1)
             (path "images/decal/train_back.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x96e38e8")
+            (id "0xbe40278")
             (pos 1705.54 939.785)
             (parent "")
             (select-mask 1)
             (path "images/decal/train_middle.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9812e48")
+            (id "0xbb96bb8")
             (pos -586.991 241.125)
-            (parent "0x96e38e8")
+            (parent "0xbe40278")
             (select-mask 1)
             (path "images/decal/train_engine_front.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9812500")
+            (id "0xbb96d98")
             (pos 593.009 242.125)
-            (parent "0x96e38e8")
+            (parent "0xbe40278")
             (select-mask 1)
             (path "images/decal/train_engine_back.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9812630")
+            (id "0xbe70550")
             (pos -206.991 241.125)
-            (parent "0x96e38e8")
+            (parent "0xbe40278")
             (select-mask 1)
             (path "images/decal/train_engine_middle.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9812760")
+            (id "0xbe89708")
             (pos 249.009 241.125)
-            (parent "0x96e38e8")
+            (parent "0xbe40278")
             (select-mask 1)
             (path "images/decal/train_engine_middle.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9812890")
+            (id "0xbecdda0")
             (pos 0.719482 -14.875)
-            (parent "0x96e38e8")
+            (parent "0xbe40278")
             (select-mask 1)
             (path "images/decal/train_door.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers))
       (layer
         (name "Tunnel Wall")
-        (visible 1)
-        (locked 0)
+        (visible #t)
+        (locked #t)
         (objects
           (decal
-            (id "0x989fd50")
+            (id "0xbf01e78")
             (pos 1790.43 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x989fe40")
+            (id "0xbf02020")
             (pos 2046.43 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x989ff30")
+            (id "0xb7a8ae0")
             (pos 1278.43 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x98a0020")
+            (id "0xb7a89a0")
             (pos 1534.43 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x98a0110")
+            (id "0xb7a6808")
             (pos 1022.43 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x98a0200")
+            (id "0xb7a6cc0")
             (pos 2165.35 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x98a0c58")
+            (id "0xb7a6dd8")
             (pos 2101.35 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x99c1778")
+            (id "0xb7a70b8")
             (pos 2037.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x99c1828")
+            (id "0xb7a71c8")
             (pos 1781.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x99c18d8")
+            (id "0xb7a7a28")
             (pos 1845.35 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x99c1990")
+            (id "0xb7a7438")
             (pos 1909.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x99c1a80")
+            (id "0xb7a80f0")
             (pos 1397.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9932888")
+            (id "0xb7a82c0")
             (pos 1333.35 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9932970")
+            (id "0xb7a7588")
             (pos 1269.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9932a60")
+            (id "0xb7a83a0")
             (pos 1525.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9932b50")
+            (id "0xb7a84e0")
             (pos 1589.35 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9932c38")
+            (id "0xb7a86b0")
             (pos 1653.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9932d28")
+            (id "0xb7a7740")
             (pos 629.352 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9932e18")
+            (id "0xc390ac0")
             (pos 565.354 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9932f00")
+            (id "0xb7a7890")
             (pos 501.352 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9932ff0")
+            (id "0xc390d10")
             (pos 245.352 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x99330e0")
+            (id "0xb7a7b08")
             (pos 309.354 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x99331c8")
+            (id "0xb7a7ec8")
             (pos 373.352 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x99332b8")
+            (id "0xb7a7cf8")
             (pos 885.352 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x99333a8")
+            (id "0xc451290")
             (pos 821.354 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9933490")
+            (id "0xc451408")
             (pos 757.352 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9933580")
+            (id "0xc4b1968")
             (pos 1013.35 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9933670")
+            (id "0xc4b16e0")
             (pos 1077.35 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9933758")
+            (id "0xc4b17e0")
             (pos 1141.34 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9933848")
+            (id "0xc3f0f60")
             (pos -394.638 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9933938")
+            (id "0xc390630")
             (pos -138.648 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9933a28")
+            (id "0xc5623c0")
             (pos -202.646 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9933b10")
+            (id "0xc562480")
             (pos -266.648 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9933c00")
+            (id "0xc3907d8")
             (pos -10.6475 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9933cf0")
+            (id "0xc512050")
             (pos 53.3544 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9933dd8")
+            (id "0xc511f60")
             (pos 117.352 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9933ec8")
+            (id "0xc5d2a48")
             (pos 766.427 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9933fb8")
+            (id "0xc582580")
             (pos 510.427 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x99340a8")
+            (id "0xc5826e8")
             (pos 254.427 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9934198")
+            (id "0xc632fd8")
             (pos -458.636 464.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9934280")
+            (id "0xc6330c0")
             (pos -522.638 656.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_small.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9934370")
+            (id "0xc6e73a8")
             (pos -1.57263 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9934460")
+            (id "0xc7818e0")
             (pos -257.573 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
             (type 0)
             (scale 1 1)
-            (angle 0))
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
           (decal
-            (id "0x9934550")
+            (id "0xc6e7538")
             (pos -513.573 900.717)
             (parent "")
             (select-mask 1)
             (path "images/decal/tunnelplate_bottom.png")
             (type 0)
             (scale 1 1)
-            (angle 0)))
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
         (child-layers)))))
 
 ;; EOF ;;



From grumbel at mail.berlios.de  Tue Apr  7 01:31:32 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 7 Apr 2009 01:31:32 +0200
Subject: [Windstille-commit] r2881 - trunk/windstille/src/display
Message-ID: <200904062331.n36NVWoT032708@sheep.berlios.de>

Author: grumbel
Date: 2009-04-07 01:31:21 +0200 (Tue, 07 Apr 2009)
New Revision: 2881

Modified:
   trunk/windstille/src/display/software_surface.cpp
   trunk/windstille/src/display/software_surface.hpp
   trunk/windstille/src/display/texture.cpp
   trunk/windstille/src/display/texture.hpp
   trunk/windstille/src/display/texture_packer.cpp
Log:
Generate the 1px border via OpenGL calls, instead of via in software

Modified: trunk/windstille/src/display/software_surface.cpp
===================================================================
--- trunk/windstille/src/display/software_surface.cpp	2009-04-06 03:07:44 UTC (rev 2880)
+++ trunk/windstille/src/display/software_surface.cpp	2009-04-06 23:31:21 UTC (rev 2881)
@@ -175,22 +175,6 @@
     }
 }
 
-SoftwareSurface
-SoftwareSurface::add_1px_border() const
-{
-  SoftwareSurface surface(get_width()+2, get_height()+2);
-
-  // FIXME: Really slow and leaves out the edge pixels
-  blit(surface, 1, 0);
-  blit(surface, 1, 2);
-  blit(surface, 0, 1);
-  blit(surface, 2, 1);
-
-  blit(surface, 1, 1);
-
-  return surface;
-}
-
 void
 SoftwareSurface::save_png(const std::string& filename) const
 {

Modified: trunk/windstille/src/display/software_surface.hpp
===================================================================
--- trunk/windstille/src/display/software_surface.hpp	2009-04-06 03:07:44 UTC (rev 2880)
+++ trunk/windstille/src/display/software_surface.hpp	2009-04-06 23:31:21 UTC (rev 2881)
@@ -52,11 +52,6 @@
   void blit(SoftwareSurface& dst, int x, int y) const;
   void blit(const Rect& src_rect, SoftwareSurface& dst, int x, int y) const;
 
-  /** Creates a copy of the original surface with an added a 1pix
-      border around the original. The border contains duplicates the
-      edge pixels.  */
-  SoftwareSurface add_1px_border() const;
-
   void save_png(const std::string& filename) const;
 
   SDL_Surface* get_surface() const;

Modified: trunk/windstille/src/display/texture.cpp
===================================================================
--- trunk/windstille/src/display/texture.cpp	2009-04-06 03:07:44 UTC (rev 2880)
+++ trunk/windstille/src/display/texture.cpp	2009-04-06 23:31:21 UTC (rev 2881)
@@ -21,6 +21,8 @@
 #include <iostream>
 #include <GL/glew.h>
 #include <GL/gl.h>
+
+#include "math/rect.hpp"
 #include "texture.hpp"
 #include "display/software_surface.hpp"
 #include "display/opengl_state.hpp"
@@ -172,6 +174,40 @@
 }
 
 void
+Texture::put(const SoftwareSurface& image, const Rect& srcrect, int x, int y)
+{
+  GLint sdl_format;
+
+  if (image.get_bytes_per_pixel() == 3)
+    {
+      sdl_format = GL_RGB;
+    }
+  else if (image.get_bytes_per_pixel() == 4)
+    {
+      sdl_format = GL_RGBA;
+    }
+  else
+    {
+      throw std::runtime_error("Texture: Image format not supported");
+    }
+
+  OpenGLState state;
+  state.bind_texture(*this);
+  state.activate();
+
+  // FIXME: Add some checks here to make sure image has the right format 
+  glPixelStorei(GL_UNPACK_ALIGNMENT, 1);
+  glPixelStorei(GL_UNPACK_ROW_LENGTH,
+                image.get_pitch() / image.get_bytes_per_pixel());
+
+  glTexSubImage2D(impl->target, 0, x, y,
+                  srcrect.get_width(), srcrect.get_height(), sdl_format, GL_UNSIGNED_BYTE,
+                  static_cast<uint8_t*>(image.get_pixels())
+                  + srcrect.top  * image.get_pitch()
+                  + srcrect.left * image.get_bytes_per_pixel());
+}
+
+void
 Texture::put(const SoftwareSurface& image, int x, int y)
 {
   GLint sdl_format;

Modified: trunk/windstille/src/display/texture.hpp
===================================================================
--- trunk/windstille/src/display/texture.hpp	2009-04-06 03:07:44 UTC (rev 2880)
+++ trunk/windstille/src/display/texture.hpp	2009-04-06 23:31:21 UTC (rev 2881)
@@ -27,6 +27,7 @@
 
 class SoftwareSurface;
 class TextureImpl;
+class Rect;
 
 class Texture
 {
@@ -66,6 +67,10 @@
 
   /** Uploads the given image to the given coordinates */
   void put(const SoftwareSurface& image, int x, int y);
+  
+  /** Uploads the given subsection \a srcrect of \a image to the given
+      coordinates */
+  void put(const SoftwareSurface& image, const Rect& srcrect, int x, int y);
 
   GLuint get_handle() const;
   

Modified: trunk/windstille/src/display/texture_packer.cpp
===================================================================
--- trunk/windstille/src/display/texture_packer.cpp	2009-04-06 03:07:44 UTC (rev 2880)
+++ trunk/windstille/src/display/texture_packer.cpp	2009-04-06 23:31:21 UTC (rev 2881)
@@ -52,7 +52,10 @@
             used = true;
             out_rect = Rect(Point(rect.left, rect.top), size);
 
-            // FIXME: Make this alterate between horizontal and vertical splitting
+            // FIXME: Make this alterate between horizontal and
+            // vertical splitting or chose whichever split options
+            // leads to less 'ugly' rectangle (how much different does
+            // this make in terms of packing density?)
             left.reset(new TextureSpace(Rect(out_rect.left,  out_rect.bottom,
                                              out_rect.right, rect.bottom)));
 
@@ -144,12 +147,12 @@
 }
 
 Surface
-TexturePacker::upload(const SoftwareSurface& in_surface)
+TexturePacker::upload(const SoftwareSurface& surface)
 {
   // Add a 1px border around surfaces to avoid blending artifacts
-  SoftwareSurface surface = in_surface.add_1px_border();
+  //SoftwareSurface surface = in_surface.add_1px_border();
 
-  Size    size(surface.get_width(), surface.get_height());
+  Size    size(surface.get_width()+2, surface.get_height()+2);
   Rect    rect;
   Texture texture;
 
@@ -159,14 +162,38 @@
     }
   else
     {
-      texture.put(surface, rect.left, rect.top);
+      // duplicate border pixel
 
-      //std::cout << "Texture: " << texture.get_handle() << " " << rect << std::endl;
+      // top
+      texture.put(surface, Rect(Point(0, 0), Size(surface.get_width(), 1)), 
+                  rect.left+1, rect.top);
+      // bottom
+      texture.put(surface, Rect(Point(0, surface.get_height()-1), Size(surface.get_width(), 1)), 
+                  rect.left+1, rect.bottom-1);
+      // left
+      texture.put(surface, Rect(Point(0, 0), Size(1, surface.get_height())), 
+                  rect.left, rect.top+1);
+      // right
+      texture.put(surface, Rect(Point(surface.get_width()-1, 0), Size(1, surface.get_height())),
+                  rect.right-1, rect.top+1);
 
+      // duplicate corner pixels
+      texture.put(surface, Rect(Point(0, 0), Size(1, 1)), 
+                  rect.left, rect.top);     
+      texture.put(surface, Rect(Point(surface.get_width()-1, 0), Size(1, 1)), 
+                  rect.right-1, rect.top);
+      texture.put(surface, Rect(Point(surface.get_width()-1, surface.get_height()-1), Size(1, 1)), 
+                  rect.right-1, rect.bottom-1);
+      texture.put(surface, Rect(Point(0, surface.get_height()-1), Size(1, 1)),
+                  rect.left, rect.bottom-1);
+
+      // draw the main surface
+      texture.put(surface, rect.left+1, rect.top+1);
+
       return Surface(texture,
                      Rectf(float(rect.left+1)  / texture.get_width(), float(rect.top+1)    / texture.get_height(),
                            float(rect.right-1) / texture.get_width(), float(rect.bottom-1) / texture.get_height()),
-                     in_surface.get_width(), in_surface.get_height());
+                     surface.get_width(), surface.get_height());
     }
 }
 



From grumbel at mail.berlios.de  Tue Apr  7 02:13:57 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 7 Apr 2009 02:13:57 +0200
Subject: [Windstille-commit] r2882 - trunk/windstille/src/display
Message-ID: <200904070013.n370Dvn2015803@sheep.berlios.de>

Author: grumbel
Date: 2009-04-07 02:13:57 +0200 (Tue, 07 Apr 2009)
New Revision: 2882

Modified:
   trunk/windstille/src/display/software_surface.cpp
   trunk/windstille/src/display/texture.cpp
Log:
Fixed(?) some issues with RGB images

Modified: trunk/windstille/src/display/software_surface.cpp
===================================================================
--- trunk/windstille/src/display/software_surface.cpp	2009-04-06 23:31:21 UTC (rev 2881)
+++ trunk/windstille/src/display/software_surface.cpp	2009-04-07 00:13:57 UTC (rev 2882)
@@ -179,7 +179,9 @@
 SoftwareSurface::save_png(const std::string& filename) const
 {
   // FIXME: This is upside down  
-  if (get_bits_per_pixel() != 32)
+
+  if (get_bytes_per_pixel() != 4 &&
+      get_bytes_per_pixel() != 3)
     {
       std::cout << "SoftwareSurface::save_png(): Unsupported pixel format" << std::endl;
       return;
@@ -206,7 +208,7 @@
 
       png_set_IHDR(png_ptr, info_ptr, 
                    get_width(), get_height(), 8 /* bitdepth */,
-                   PNG_COLOR_TYPE_RGBA,
+                   (get_bytes_per_pixel() == 32) ? PNG_COLOR_TYPE_RGBA : PNG_COLOR_TYPE_RGB,
                    PNG_INTERLACE_NONE, 
                    PNG_COMPRESSION_TYPE_BASE, 
                    PNG_FILTER_TYPE_BASE);

Modified: trunk/windstille/src/display/texture.cpp
===================================================================
--- trunk/windstille/src/display/texture.cpp	2009-04-06 23:31:21 UTC (rev 2881)
+++ trunk/windstille/src/display/texture.cpp	2009-04-07 00:13:57 UTC (rev 2882)
@@ -196,7 +196,7 @@
   state.activate();
 
   // FIXME: Add some checks here to make sure image has the right format 
-  glPixelStorei(GL_UNPACK_ALIGNMENT, 1);
+  glPixelStorei(GL_UNPACK_ALIGNMENT, 4);
   glPixelStorei(GL_UNPACK_ROW_LENGTH,
                 image.get_pitch() / image.get_bytes_per_pixel());
 
@@ -210,33 +210,7 @@
 void
 Texture::put(const SoftwareSurface& image, int x, int y)
 {
-  GLint sdl_format;
-
-  if (image.get_bytes_per_pixel() == 3)
-    {
-      sdl_format = GL_RGB;
-    }
-  else if (image.get_bytes_per_pixel() == 4)
-    {
-      sdl_format = GL_RGBA;
-    }
-  else
-    {
-      throw std::runtime_error("Texture: Image format not supported");
-    }
-
-  OpenGLState state;
-  state.bind_texture(*this);
-  state.activate();
-
-  // FIXME: Add some checks here to make sure image has the right format 
-  glPixelStorei(GL_UNPACK_ALIGNMENT, 1);
-  glPixelStorei(GL_UNPACK_ROW_LENGTH,
-                image.get_pitch() / image.get_bytes_per_pixel());
-
-  glTexSubImage2D(impl->target, 0, x, y,
-                  image.get_width(), image.get_height(), sdl_format, GL_UNSIGNED_BYTE,
-                  image.get_pixels());
+  put(image, Rect(0, 0, image.get_width(), image.get_height()), x, y);
 }
 
 void



From grumbel at mail.berlios.de  Tue Apr  7 15:05:12 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 7 Apr 2009 15:05:12 +0200
Subject: [Windstille-commit] r2883 - in trunk/windstille/src: display math
Message-ID: <200904071305.n37D5CmL015685@sheep.berlios.de>

Author: grumbel
Date: 2009-04-07 15:05:11 +0200 (Tue, 07 Apr 2009)
New Revision: 2883

Modified:
   trunk/windstille/src/display/surface.cpp
   trunk/windstille/src/display/surface_manager.cpp
   trunk/windstille/src/math/math.hpp
Log:
Added proper power_of_two round function

Modified: trunk/windstille/src/display/surface.cpp
===================================================================
--- trunk/windstille/src/display/surface.cpp	2009-04-07 00:13:57 UTC (rev 2882)
+++ trunk/windstille/src/display/surface.cpp	2009-04-07 13:05:11 UTC (rev 2883)
@@ -54,20 +54,12 @@
   *this = SurfaceManager::current()->get(filename);
 }
 
-static int power_of_two(int val) {
-  // FIXME: Replace this with a non-while loop based one
-  int result = 1;
-  while(result < val)
-    result *= 2;
-  return result;
-}
-
 Surface::Surface(int width, int height)
   : impl(new SurfaceImpl())
 {
   impl->size  = Size(width, height);
 
-  impl->texture = Texture(GL_TEXTURE_2D, power_of_two(width), power_of_two(height));
+  impl->texture = Texture(GL_TEXTURE_2D, math::round_to_power_of_two(width), math::round_to_power_of_two(height));
   impl->uv      = Rectf(0, 0,
                         float(impl->size.width)  / impl->texture.get_width(),
                         float(impl->size.height) / impl->texture.get_height());

Modified: trunk/windstille/src/display/surface_manager.cpp
===================================================================
--- trunk/windstille/src/display/surface_manager.cpp	2009-04-07 00:13:57 UTC (rev 2882)
+++ trunk/windstille/src/display/surface_manager.cpp	2009-04-07 13:05:11 UTC (rev 2883)
@@ -24,14 +24,15 @@
 #include <GL/glew.h>
 #include <GL/gl.h>
 
-#include "util/util.hpp"
 #include "app/globals.hpp"
-#include "texture.hpp"
-#include "surface.hpp"
+#include "math/math.hpp"
+#include "physfs/physfs_sdl.hpp"
 #include "software_surface.hpp"
+#include "surface.hpp"
+#include "texture.hpp"
 #include "texture_manager.hpp"
 #include "texture_packer.hpp"
-#include "physfs/physfs_sdl.hpp"
+#include "util/util.hpp"
 
 SurfaceManager* SurfaceManager::current_ = 0;
 
@@ -135,19 +136,12 @@
     }
 }
 
-static int power_of_two(int val) {
-  int result = 1;
-  while(result < val)
-    result *= 2;
-  return result;
-}
-
 Texture
 SurfaceManager::create_texture(const SoftwareSurface& image,
                                float& maxu, float& maxv)
 {
-  int texture_w = power_of_two(image.get_width());
-  int texture_h = power_of_two(image.get_height());
+  int texture_w = math::round_to_power_of_two(image.get_width());
+  int texture_h = math::round_to_power_of_two(image.get_height());
 
   SoftwareSurface convert(texture_w, texture_h);
 

Modified: trunk/windstille/src/math/math.hpp
===================================================================
--- trunk/windstille/src/math/math.hpp	2009-04-07 00:13:57 UTC (rev 2882)
+++ trunk/windstille/src/math/math.hpp	2009-04-07 13:05:11 UTC (rev 2883)
@@ -20,6 +20,7 @@
 #define HEADER_WINDSTILLE_MATH_MATH_HPP
 
 #include <assert.h>
+#include <limits>
 #include <math.h>
 
 namespace math {
@@ -50,7 +51,7 @@
 
 inline float normalize_angle(float radians)
 {
-  radians = fmod (radians, static_cast<float>(2.0 * M_PI));
+  radians = fmodf(radians, static_cast<float>(2.0 * M_PI));
   if (radians < 0.0)
     radians += 2.0 * M_PI;
   // Floating point math is so loathsome.  In sp98test, the assertion
@@ -64,6 +65,25 @@
   return radians;
 }
 
+inline bool is_power_of_two(int n)
+{
+  return (n > 0) && ((n & (n - 1)) == 0);
+}
+
+template<typename T>
+inline T round_to_power_of_two(T n)
+{
+  n = n - 1;
+
+  int bits = std::numeric_limits<T>::digits;
+  for(int i = 1; i < bits; i *= 2)
+    n = n | (n >> i);
+  
+  n = n + 1;
+  
+  return n;
+}
+
 inline float deg2rad(float degree)
 {
   return degree / 180.0f * M_PI;



From grumbel at mail.berlios.de  Tue Apr  7 15:23:31 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 7 Apr 2009 15:23:31 +0200
Subject: [Windstille-commit] r2884 - trunk/windstille/src/display
Message-ID: <200904071323.n37DNVMj017184@sheep.berlios.de>

Author: grumbel
Date: 2009-04-07 15:23:31 +0200 (Tue, 07 Apr 2009)
New Revision: 2884

Modified:
   trunk/windstille/src/display/texture.cpp
Log:
Added FIXME

Modified: trunk/windstille/src/display/texture.cpp
===================================================================
--- trunk/windstille/src/display/texture.cpp	2009-04-07 13:05:11 UTC (rev 2883)
+++ trunk/windstille/src/display/texture.cpp	2009-04-07 13:23:31 UTC (rev 2884)
@@ -196,7 +196,7 @@
   state.activate();
 
   // FIXME: Add some checks here to make sure image has the right format 
-  glPixelStorei(GL_UNPACK_ALIGNMENT, 4);
+  glPixelStorei(GL_UNPACK_ALIGNMENT, 4); // FIXME: Does SDL always use 4?
   glPixelStorei(GL_UNPACK_ROW_LENGTH,
                 image.get_pitch() / image.get_bytes_per_pixel());
 



From grumbel at mail.berlios.de  Tue Apr  7 15:24:02 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 7 Apr 2009 15:24:02 +0200
Subject: [Windstille-commit] r2885 - trunk/windstille/src/editor
Message-ID: <200904071324.n37DO2iX017227@sheep.berlios.de>

Author: grumbel
Date: 2009-04-07 15:24:02 +0200 (Tue, 07 Apr 2009)
New Revision: 2885

Modified:
   trunk/windstille/src/editor/decal_object_model.cpp
Log:
Added x-only/y-only scale ControlPoints

Modified: trunk/windstille/src/editor/decal_object_model.cpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.cpp	2009-04-07 13:23:31 UTC (rev 2884)
+++ trunk/windstille/src/editor/decal_object_model.cpp	2009-04-07 13:24:02 UTC (rev 2885)
@@ -224,13 +224,17 @@
   DecalObjectModel* object;
   float ctrl_angle;
   Vector2f orig_scale;
+  bool x_scale;
+  bool y_scale;
 
 public:
-  DecalScaleControlPoint(DecalObjectModel* object_, float ctrl_angle_, const Vector2f& pos_)
+  DecalScaleControlPoint(DecalObjectModel* object_, float ctrl_angle_, const Vector2f& pos_, bool x_scale_ = true, bool y_scale_ = true)
     : ControlPoint(Surface("editor/scale_handle.png"), pos_),
       object(object_),
       ctrl_angle(ctrl_angle_),
-      orig_scale(object_->get_scale())
+      orig_scale(object_->get_scale()),
+      x_scale(x_scale_),
+      y_scale(y_scale_)
   {}
 
   void on_move_start() 
@@ -247,12 +251,19 @@
     start    = start.rotate(-object->get_angle());
     current = current.rotate(-object->get_angle());
     
-    //std::cout << "on_move_update: " << current.x << " " << current.y << std::endl;  
+    Vector2f new_scale = orig_scale;
 
-    Vector2f new_scale = current / start;
+    if (x_scale)
+      {
+        new_scale.x = current.x / start.x;
+        new_scale.x *= orig_scale.x;
+      }
 
-    new_scale.x *= orig_scale.x;
-    new_scale.y *= orig_scale.y;
+    if (y_scale)
+      {
+        new_scale.y = current.y / start.y;
+        new_scale.y *= orig_scale.y;
+      }
 
     object->set_scale(new_scale);
   }
@@ -312,11 +323,22 @@
   Quad quad2(rect.grow(32));
   quad2.rotate(angle);
 
+  Quad quad3(Vector2f( 0, -h),
+             Vector2f( w,  0),
+             Vector2f( 0,  h),
+             Vector2f(-w,  0));
+  quad3.rotate(angle);
+
   control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, angle + 0*M_PI/2, get_world_pos() + quad1.p1)));
   control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, angle + 1*M_PI/2, get_world_pos() + quad1.p2)));
   control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, angle + 2*M_PI/2, get_world_pos() + quad1.p3)));
   control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, angle + 3*M_PI/2, get_world_pos() + quad1.p4)));
 
+  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, M_PI/4 + angle + 0*M_PI/2, get_world_pos() + quad3.p1, false, true)));
+  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, M_PI/4 + angle + 1*M_PI/2, get_world_pos() + quad3.p2, true,  false)));
+  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, M_PI/4 + angle + 2*M_PI/2, get_world_pos() + quad3.p3, false, true)));
+  control_points.push_back(ControlPointHandle(new DecalScaleControlPoint(this, M_PI/4 + angle + 3*M_PI/2, get_world_pos() + quad3.p4, true,  false)));
+
   control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, angle + 0*M_PI/2, get_world_pos() + quad2.p1)));
   control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, angle + 1*M_PI/2, get_world_pos() + quad2.p2)));
   control_points.push_back(ControlPointHandle(new DecalRotateControlPoint(this, angle + 2*M_PI/2, get_world_pos() + quad2.p3)));



From grumbel at mail.berlios.de  Tue Apr  7 17:50:37 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 7 Apr 2009 17:50:37 +0200
Subject: [Windstille-commit] r2886 - trunk/windstille/src/display
Message-ID: <200904071550.n37Fobxk000585@sheep.berlios.de>

Author: grumbel
Date: 2009-04-07 17:50:37 +0200 (Tue, 07 Apr 2009)
New Revision: 2886

Modified:
   trunk/windstille/src/display/display.hpp
Log:
Removed unneeded SDL header

Modified: trunk/windstille/src/display/display.hpp
===================================================================
--- trunk/windstille/src/display/display.hpp	2009-04-07 13:24:02 UTC (rev 2885)
+++ trunk/windstille/src/display/display.hpp	2009-04-07 15:50:37 UTC (rev 2886)
@@ -20,7 +20,7 @@
 #define HEADER_WINDSTILLE_DISPLAY_DISPLAY_HPP
 
 #include <vector>
-#include <SDL.h>
+
 #include "math/size.hpp"
 #include "math/rect.hpp"
 #include "math/quad.hpp"



From grumbel at mail.berlios.de  Tue Apr  7 17:50:55 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 7 Apr 2009 17:50:55 +0200
Subject: [Windstille-commit] r2887 - trunk/windstille/src/display
Message-ID: <200904071550.n37FotYT000621@sheep.berlios.de>

Author: grumbel
Date: 2009-04-07 17:50:54 +0200 (Tue, 07 Apr 2009)
New Revision: 2887

Modified:
   trunk/windstille/src/display/drawing_context.cpp
   trunk/windstille/src/display/drawing_context.hpp
Log:
Added draw_line(Line...)

Modified: trunk/windstille/src/display/drawing_context.cpp
===================================================================
--- trunk/windstille/src/display/drawing_context.cpp	2009-04-07 15:50:37 UTC (rev 2886)
+++ trunk/windstille/src/display/drawing_context.cpp	2009-04-07 15:50:54 UTC (rev 2887)
@@ -439,6 +439,12 @@
 }
 
 void
+DrawingContext::draw_line(const Line& line, const Color& color, float z_pos)
+{
+  draw_line(line.p1, line.p2, color, z_pos);
+}
+
+void
 DrawingContext::draw_line(const Vector2f& pos1, const Vector2f& pos2, const Color& color, float z_pos)
 {
   VertexArrayDrawingRequest* array = new VertexArrayDrawingRequest(Vector2f(0, 0), z_pos, modelview_stack.back());

Modified: trunk/windstille/src/display/drawing_context.hpp
===================================================================
--- trunk/windstille/src/display/drawing_context.hpp	2009-04-07 15:50:37 UTC (rev 2886)
+++ trunk/windstille/src/display/drawing_context.hpp	2009-04-07 15:50:54 UTC (rev 2887)
@@ -33,6 +33,7 @@
 class SceneContext;
 class Sprite;
 class Quad;
+class Line;
 
 /** The DrawingContext collects all DrawingRequests and allows you to
     flush them all down to the graphics card in one run, this has the
@@ -65,6 +66,7 @@
 
   void fill_pattern(const Texture& pattern, const Vector2f& offset);
 
+  void draw_line(const Line& line, const Color& color, float z_pos = 0);
   void draw_line(const Vector2f& pos1, const Vector2f& pos2, const Color& color, float z_pos = 0);
 
   void draw_rect(const Rectf& rect, const Color& color, float z_pos = 0);



From grumbel at mail.berlios.de  Tue Apr  7 17:51:20 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 7 Apr 2009 17:51:20 +0200
Subject: [Windstille-commit] r2888 - trunk/windstille/src/navigation
Message-ID: <200904071551.n37FpKpH000660@sheep.berlios.de>

Author: grumbel
Date: 2009-04-07 17:51:20 +0200 (Tue, 07 Apr 2009)
New Revision: 2888

Modified:
   trunk/windstille/src/navigation/navigation_graph.cpp
   trunk/windstille/src/navigation/navigation_graph.hpp
Log:
Minor cleanup

Modified: trunk/windstille/src/navigation/navigation_graph.cpp
===================================================================
--- trunk/windstille/src/navigation/navigation_graph.cpp	2009-04-07 15:50:54 UTC (rev 2887)
+++ trunk/windstille/src/navigation/navigation_graph.cpp	2009-04-07 15:51:20 UTC (rev 2888)
@@ -26,12 +26,12 @@
 #include "util/file_reader.hpp"
 #include "edge_position.hpp"
 #include "navigation_graph.hpp"
-
+
 NavigationGraph::NavigationGraph()
 {
   
 }
-
+
 NavigationGraph::~NavigationGraph()
 {
   for(Edges::iterator i = edges.begin(); i != edges.end(); ++i)
@@ -42,7 +42,7 @@
     delete *i;
   nodes.clear();
 }
-
+
 NodeHandle
 NavigationGraph::add_node(const Vector2f& pos)
 {
@@ -50,7 +50,7 @@
   nodes.push_back(node);
   return NodeHandle(node);
 }
-
+
 void
 NavigationGraph::remove_edge(EdgeHandle edge)
 {
@@ -64,7 +64,7 @@
 
   // FIXME: Throw exception here
 }
-
+
 void
 NavigationGraph::remove_node(NodeHandle node)
 {
@@ -95,7 +95,7 @@
       delete node.get();
     }  
 }
-
+
 EdgeHandle
 NavigationGraph::add_edge(NodeHandle node1, NodeHandle node2)
 {
@@ -110,7 +110,7 @@
       return EdgeHandle();
     }
 }
-
+
 void
 NavigationGraph::split_edge(EdgeHandle edge)
 {
@@ -122,7 +122,7 @@
   add_edge(node1, node2);  
   add_edge(node2, node3);  
 }
-
+
 std::vector<EdgePosition>
 NavigationGraph::find_intersections(const Line& line)
 {
@@ -144,7 +144,7 @@
 
   return ret;
 }
-
+
 std::vector<NodeHandle>
 NavigationGraph::find_nodes(const Vector2f& pos, float radius)
 {
@@ -162,7 +162,7 @@
   
   return ret;
 }
-
+
 std::vector<EdgeHandle>
 NavigationGraph::find_edges(const Vector2f& pos, float radius)
 {
@@ -180,7 +180,7 @@
 
   return ret;
 }
-
+
 NodeHandle
 NavigationGraph::find_closest_node(const Vector2f& pos, float radius)
 {
@@ -200,7 +200,7 @@
   
   return NodeHandle(node);
 }
-
+
 EdgeHandle
 NavigationGraph::find_closest_edge(const Vector2f& pos, float radius)
 {
@@ -220,7 +220,7 @@
 
   return EdgeHandle(edge);
 }
-
+
 void
 NavigationGraph::draw()
 {
@@ -237,7 +237,7 @@
                          Color(1.0f, 1.0f, 0.0f));
     }
 }
-
+
 void
 NavigationGraph::load(FileReader& reader)
 {
@@ -344,14 +344,14 @@
 
   out.flags(old_flags); // restore flags
 }
-
+
 bool
 NavigationGraph::valid(Edge* edge)
 {
   // FIXME: Slow
   return std::find(edges.begin(), edges.end(), edge) != edges.end();
 }
-
+
 bool
 NavigationGraph::valid(Node* node)
 {

Modified: trunk/windstille/src/navigation/navigation_graph.hpp
===================================================================
--- trunk/windstille/src/navigation/navigation_graph.hpp	2009-04-07 15:50:54 UTC (rev 2887)
+++ trunk/windstille/src/navigation/navigation_graph.hpp	2009-04-07 15:51:20 UTC (rev 2888)
@@ -22,12 +22,12 @@
 #include <iosfwd>
 #include <vector>
 #include "math/line.hpp"
-
+
 class Node;
 class FileReader;
 class Edge;
 class EdgePosition;
-
+
 template<typename Data>
 class PointerHandle
 {
@@ -59,17 +59,17 @@
     return data != 0;
   }
 };
-
+
 typedef PointerHandle<Node> NodeHandle; 
 typedef PointerHandle<Edge> EdgeHandle; 
-
-/** */
+
 class NavigationGraph
 {
-private:
+public:
   typedef std::vector<Node*> Nodes;
   typedef std::vector<Edge*> Edges;
 
+private:
   Nodes nodes;
   Edges edges;
   
@@ -79,6 +79,9 @@
   NavigationGraph();
   ~NavigationGraph();
 
+  Nodes& get_nodes() { return nodes; }
+  Edges& get_edges() { return edges; }
+
   // FIXME: It might be worth it to return handles that can be
   // validated instead of pure pointers
   NodeHandle add_node(const Vector2f& pos);
@@ -116,7 +119,7 @@
   NavigationGraph (const NavigationGraph&);
   NavigationGraph& operator= (const NavigationGraph&);
 };
-
+
 #endif
 
 /* EOF */



From grumbel at mail.berlios.de  Tue Apr  7 17:54:23 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 7 Apr 2009 17:54:23 +0200
Subject: [Windstille-commit] r2889 - in trunk/windstille/src: . editor
Message-ID: <200904071554.n37FsN5S001805@sheep.berlios.de>

Author: grumbel
Date: 2009-04-07 17:54:22 +0200 (Tue, 07 Apr 2009)
New Revision: 2889

Modified:
   trunk/windstille/src/SConscript
   trunk/windstille/src/editor/sector_model.cpp
   trunk/windstille/src/editor/sector_model.hpp
Log:
Added NavigationGraph to the SectorModel

Modified: trunk/windstille/src/SConscript
===================================================================
--- trunk/windstille/src/SConscript	2009-04-07 15:51:20 UTC (rev 2888)
+++ trunk/windstille/src/SConscript	2009-04-07 15:54:22 UTC (rev 2889)
@@ -58,6 +58,16 @@
         'math/vector2f.cpp',
         ])
 
+navgraph_env = conf_env.Clone()
+navgraph_env['CPPPATH'] = ['.']
+navgraph_lib = navgraph_env.StaticLibrary('navgraph', [
+        'navigation/navigation_graph.cpp',
+        'navigation/node.cpp',
+        'navigation/properties.cpp',
+        'navigation/edge.cpp',
+        'navigation/edge_position.cpp',
+        ])
+
 display_env = conf_env.Clone()
 display_env['CPPPATH'] = ['.', '..']
 display_env.ParseConfig('sdl-config --cflags --libs')
@@ -97,7 +107,7 @@
         ])
 
 env = conf_env.Clone()
-env.Append(LIBS    = [display_lib, physfs_lib, util_lib, math_lib,
+env.Append(LIBS    = [navgraph_lib, display_lib, physfs_lib, util_lib, math_lib,
                       'GL', 'GLU', 'GLEW', 'squirrel', 'physfs', 'SDL_image', 'openal', 'ogg', 'vorbis', 'vorbisfile', 'png', 'boost_signals'])
 env.Append(LIBPATH = ['../external/'] )
 env.Append(CPPPATH = ['.', '..', '../external/SQUIRREL2/include/'])
@@ -164,11 +174,6 @@
         'input/input_manager_impl.cpp',
         'input/input_manager_sdl.cpp',
         'input/wiimote.cpp',
-        'navigation/navigation_graph.cpp',
-        'navigation/node.cpp',
-        'navigation/properties.cpp',
-        'navigation/edge.cpp',
-        'navigation/edge_position.cpp',
         'objects/background_gradient.cpp',
         'objects/bomb.cpp',
         'objects/box.cpp',
@@ -226,7 +231,7 @@
 
 editor_env = Environment(CPPPATH=['.'],
                          CXXFLAGS=['-Wall', '-Werror', '-O2', '-g'],
-                         LIBS = [display_lib, util_lib, physfs_lib, math_lib, 'GL', 'GLEW', 'SDL_image', 'physfs'])
+                         LIBS = [navgraph_lib, display_lib, util_lib, physfs_lib, math_lib, 'GL', 'GLEW', 'SDL_image', 'physfs'])
 
 editor_env.ParseConfig('pkg-config libpng --libs --cflags')
 editor_env.ParseConfig('sdl-config --cflags --libs')

Modified: trunk/windstille/src/editor/sector_model.cpp
===================================================================
--- trunk/windstille/src/editor/sector_model.cpp	2009-04-07 15:51:20 UTC (rev 2888)
+++ trunk/windstille/src/editor/sector_model.cpp	2009-04-07 15:54:22 UTC (rev 2889)
@@ -22,6 +22,9 @@
 #include <iostream>
 #include <gdkmm/pixbuf.h>
 
+#include "navigation/navigation_graph.hpp"
+#include "navigation/edge.hpp"
+#include "navigation/node.hpp"
 #include "editor_window.hpp"
 #include "windstille_widget.hpp"
 #include "util/file_reader.hpp"
@@ -33,7 +36,15 @@
 LayerManagerColumns* LayerManagerColumns::instance_ = 0;
 
 SectorModel::SectorModel()
+ : nav_graph(new NavigationGraph())
 {  
+  try {
+    FileReader reader = FileReader::parse("navigation.nav");
+    nav_graph->load(reader);
+  } catch(std::exception& err) {
+    std::cout << "NavigationTest: " << err.what() << std::endl;
+  }
+
   layer_tree = Gtk::TreeStore::create(LayerManagerColumns::instance());
 
   Gtk::TreeStore::iterator it = layer_tree->append();
@@ -53,6 +64,10 @@
   layer_tree->signal_rows_reordered().connect(sigc::mem_fun(*this, &SectorModel::on_rows_reordered));
 }
 
+SectorModel::~SectorModel()
+{
+}
+
 void
 SectorModel::add_layer(const std::string& name, const Gtk::TreeModel::Path& path)
 {
@@ -156,6 +171,7 @@
 void
 SectorModel::draw(SceneContext& sc, const SelectMask& layermask)
 {
+  // Draw Layers
   const Layers& layers = get_layers();
  
   for(Layers::const_reverse_iterator i = layers.rbegin(); i != layers.rend(); ++i)
@@ -163,6 +179,20 @@
       if ((*i)->is_visible())
         (*i)->draw(sc, layermask);
     }
+
+  // Draw Navgraph
+  for(NavigationGraph::Edges::iterator i = nav_graph->get_edges().begin(); i != nav_graph->get_edges().end(); ++i)
+    {
+      sc.control().draw_line(Line((*i)->get_node1()->get_pos(),
+                                  (*i)->get_node2()->get_pos()),
+                             Color(1.0f, 0.0f, 0.0f));
+    }
+
+  for(NavigationGraph::Nodes::iterator i = nav_graph->get_nodes().begin(); i != nav_graph->get_nodes().end(); ++i)
+    {
+      sc.control().fill_rect(Rectf((*i)->get_pos() - Vector2f(4,4), Sizef(9, 9)),
+                             Color(1.0f, 1.0f, 0.0f));
+    }
 }
 
 void

Modified: trunk/windstille/src/editor/sector_model.hpp
===================================================================
--- trunk/windstille/src/editor/sector_model.hpp	2009-04-07 15:51:20 UTC (rev 2888)
+++ trunk/windstille/src/editor/sector_model.hpp	2009-04-07 15:54:22 UTC (rev 2889)
@@ -31,6 +31,7 @@
 #include "object_model.hpp"
 #include "math/vector2f.hpp"
 
+class NavigationGraph;
 class SceneContext;
 class LayerManagerColumns;
 
@@ -66,6 +67,7 @@
 class SectorModel
 {
 private:
+  std::auto_ptr<NavigationGraph> nav_graph;
   Glib::RefPtr<Gtk::TreeStore> layer_tree;
   Color ambient_color;
   
@@ -74,6 +76,7 @@
   typedef std::vector<LayerHandle> Layers;
 
   SectorModel();
+  ~SectorModel();
 
   void draw(SceneContext& sc, const SelectMask& layers);
 
@@ -123,6 +126,8 @@
   void write(FileWriter& writer) const;
   void write(FileWriter& writer, const Gtk::TreeRow& row) const;
 
+  NavigationGraph* get_nav_graph() const { return nav_graph.get(); }
+
   void queue_draw();
 
   //iterator begin() { return objects.begin(); }



From grumbel at mail.berlios.de  Tue Apr  7 18:24:07 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 7 Apr 2009 18:24:07 +0200
Subject: [Windstille-commit] r2890 - in trunk/windstille/src: . editor
Message-ID: <200904071624.n37GO71Z005130@sheep.berlios.de>

Author: grumbel
Date: 2009-04-07 18:24:06 +0200 (Tue, 07 Apr 2009)
New Revision: 2890

Added:
   trunk/windstille/src/editor/navgraph_tool.cpp
   trunk/windstille/src/editor/navgraph_tool.hpp
Modified:
   trunk/windstille/src/SConscript
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/editor_window.hpp
   trunk/windstille/src/editor/select_tool.hpp
   trunk/windstille/src/editor/tool.hpp
Log:
Added NavgraphTool

Modified: trunk/windstille/src/SConscript
===================================================================
--- trunk/windstille/src/SConscript	2009-04-07 15:54:22 UTC (rev 2889)
+++ trunk/windstille/src/SConscript	2009-04-07 16:24:06 UTC (rev 2890)
@@ -252,6 +252,7 @@
         'editor/object_model_factory.cpp',
         'editor/object_selector.cpp',
         'editor/layer_manager.cpp',
+        'editor/navgraph_tool.cpp',
         'editor/scroll_tool.cpp',
         'editor/sector_model.cpp',
         'editor/select_tool.cpp',

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-07 15:54:22 UTC (rev 2889)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-07 16:24:06 UTC (rev 2890)
@@ -36,6 +36,7 @@
 #include "editor_window.hpp"
 #include "zoom_tool.hpp"
 #include "select_tool.hpp"
+#include "navgraph_tool.hpp"
 #include "sector_model.hpp"
 #include "layer_widget.hpp"
 #include "editor_window.hpp"
@@ -50,6 +51,7 @@
     layer_manager(*this),
     minimap_widget(glconfig_),
     select_tool(new SelectTool()),
+    navgraph_tool(new NavgraphTool()),
     zoom_tool(new ZoomTool()),
     current_tool(select_tool.get())
 {
@@ -127,7 +129,7 @@
     "    </menu>"
     "    <menu action='MenuTools'>"
     "      <menuitem action='SelectTool'/>"
-    "      <menuitem action='NodeTool'/>"
+    "      <menuitem action='NavgraphTool'/>"
     "      <menuitem action='ZoomTool'/>"
     "    </menu>"
     "    <menu action='MenuHelp'>"
@@ -174,7 +176,7 @@
     ""
     "  <toolbar  name='ToolBox'>"
     "    <toolitem action='SelectTool'/>"
-    "    <toolitem action='NodeTool'/>"
+    "    <toolitem action='NavgraphTool'/>"
     "    <toolitem action='ZoomTool'/>"
     "    <separator/>"
     "    <toolitem action='ToggleColorLayer'/>"
@@ -315,11 +317,11 @@
   Gtk::RadioButtonGroup tool_group;
   
   select_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "SelectTool", "select_tool", "Select Tool", "Select Tool");
-  node_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "NodeTool",   "node_tool",   "Node Tool", "Node Tool");
+  node_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "NavgraphTool",   "node_tool",   "Navgraph Tool", "Navgraph Tool");
   zoom_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "ZoomTool",   "zoom_tool",   "Zoom Tool", "Zoom Tool");
 
   action_group->add(select_tool_action, sigc::bind(sigc::mem_fun(*this, &EditorWindow::on_tool_select), select_tool_action, select_tool.get()));
-  action_group->add(node_tool_action,   sigc::bind(sigc::mem_fun(*this, &EditorWindow::on_tool_select), node_tool_action, select_tool.get()));
+  action_group->add(node_tool_action,   sigc::bind(sigc::mem_fun(*this, &EditorWindow::on_tool_select), node_tool_action, navgraph_tool.get()));
   action_group->add(zoom_tool_action,   sigc::bind(sigc::mem_fun(*this, &EditorWindow::on_tool_select), zoom_tool_action, zoom_tool.get()));
 
   // signal_size_allocate().connect (sigc::mem_fun (*this, &EditorWindow::on_window_size_allocate), false);

Modified: trunk/windstille/src/editor/editor_window.hpp
===================================================================
--- trunk/windstille/src/editor/editor_window.hpp	2009-04-07 15:54:22 UTC (rev 2889)
+++ trunk/windstille/src/editor/editor_window.hpp	2009-04-07 16:24:06 UTC (rev 2890)
@@ -39,6 +39,7 @@
 class SelectTool;
 class ZoomTool;
 class LayerWidget;
+class NavgraphTool;
 
 class EditorWindow : public Gtk::Window
 {
@@ -82,6 +83,7 @@
   Glib::RefPtr<Gtk::ToggleAction> snap_action;
 
   std::auto_ptr<SelectTool> select_tool;
+  std::auto_ptr<NavgraphTool> navgraph_tool;
   std::auto_ptr<ZoomTool>   zoom_tool;
   Tool* current_tool;
   LayerWidget* layer_widget;

Added: trunk/windstille/src/editor/navgraph_tool.cpp
===================================================================
--- trunk/windstille/src/editor/navgraph_tool.cpp	2009-04-07 15:54:22 UTC (rev 2889)
+++ trunk/windstille/src/editor/navgraph_tool.cpp	2009-04-07 16:24:06 UTC (rev 2890)
@@ -0,0 +1,85 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#include "windstille_widget.hpp"
+#include "navgraph_tool.hpp"
+
+NavgraphTool::NavgraphTool()
+{
+}
+
+bool
+NavgraphTool::mouse_down (GdkEventButton* event, WindstilleWidget& wst)
+{
+  click_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+
+  {
+    rect.left   = click_pos.x;
+    rect.top    = click_pos.y;
+    rect.right  = click_pos.x;
+    rect.bottom = click_pos.y;
+      
+    mode = SELECT_MODE;
+  }
+
+  return true;
+}
+
+bool
+NavgraphTool::mouse_move(GdkEventMotion* event, WindstilleWidget& wst)
+{
+  Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+
+  switch(mode)
+    {
+      case DRAG_MODE:
+        break;
+
+      case SELECT_MODE:
+        rect.right  = pos.x;
+        rect.bottom = pos.y;
+        break;
+
+      case NO_MODE:
+        break;
+    }
+
+  return true;
+}
+
+bool
+NavgraphTool::mouse_up(GdkEventButton* event, WindstilleWidget& wst)
+{
+  Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+
+  mode = NO_MODE;
+
+  return true;
+}
+  
+void
+NavgraphTool::draw(SceneContext& sc)
+{
+  if (mode == SELECT_MODE)
+    {
+      sc.control().fill_rect(rect, Color(1.0f, 0.5f, 0.5f, 0.25));
+      sc.control().draw_rect(rect, Color(1.0f, 0.5f, 0.5f)); 
+    }
+}
+  
+/* EOF */


Property changes on: trunk/windstille/src/editor/navgraph_tool.cpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Added: trunk/windstille/src/editor/navgraph_tool.hpp
===================================================================
--- trunk/windstille/src/editor/navgraph_tool.hpp	2009-04-07 15:54:22 UTC (rev 2889)
+++ trunk/windstille/src/editor/navgraph_tool.hpp	2009-04-07 16:24:06 UTC (rev 2890)
@@ -0,0 +1,53 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#ifndef HEADER_WINDSTILLE_EDITOR_NAVGRAPH_TOOL_HPP
+#define HEADER_WINDSTILLE_EDITOR_NAVGRAPH_TOOL_HPP
+
+#include "math/rect.hpp"
+#include "tool.hpp"
+
+class NavgraphTool : public Tool
+{
+private:
+  Vector2f click_pos;
+  Rectf    rect;
+
+  enum { 
+    SELECT_MODE,
+    DRAG_MODE,
+    NO_MODE
+  } mode;
+
+public:
+  NavgraphTool();
+
+  bool mouse_down (GdkEventButton* event, WindstilleWidget& wst);
+  bool mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
+  bool mouse_up(GdkEventButton* event, WindstilleWidget& wst);
+  
+  void draw(SceneContext& sc);
+
+private:
+  NavgraphTool(const NavgraphTool&);
+  NavgraphTool& operator=(const NavgraphTool&);
+};
+
+#endif
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/navgraph_tool.hpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Modified: trunk/windstille/src/editor/select_tool.hpp
===================================================================
--- trunk/windstille/src/editor/select_tool.hpp	2009-04-07 15:54:22 UTC (rev 2889)
+++ trunk/windstille/src/editor/select_tool.hpp	2009-04-07 16:24:06 UTC (rev 2890)
@@ -46,6 +46,7 @@
   bool mouse_down (GdkEventButton* event, WindstilleWidget& wst);
   bool mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
   bool mouse_up(GdkEventButton* event, WindstilleWidget& wst);
+
   void draw(SceneContext& sc);
 
 private:

Modified: trunk/windstille/src/editor/tool.hpp
===================================================================
--- trunk/windstille/src/editor/tool.hpp	2009-04-07 15:54:22 UTC (rev 2889)
+++ trunk/windstille/src/editor/tool.hpp	2009-04-07 16:24:06 UTC (rev 2890)
@@ -21,6 +21,7 @@
 
 #include <gdkmm.h>
 
+class SceneContext;
 class WindstilleWidget;
 
 class Tool



From grumbel at mail.berlios.de  Wed Apr  8 00:05:31 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 8 Apr 2009 00:05:31 +0200
Subject: [Windstille-commit] r2891 - trunk/windstille/src/navigation
Message-ID: <200904072205.n37M5VQA030340@sheep.berlios.de>

Author: grumbel
Date: 2009-04-08 00:05:31 +0200 (Wed, 08 Apr 2009)
New Revision: 2891

Modified:
   trunk/windstille/src/navigation/navigation_graph.cpp
   trunk/windstille/src/navigation/navigation_graph.hpp
Log:
Added find_nodes(Rect)

Modified: trunk/windstille/src/navigation/navigation_graph.cpp
===================================================================
--- trunk/windstille/src/navigation/navigation_graph.cpp	2009-04-07 16:24:06 UTC (rev 2890)
+++ trunk/windstille/src/navigation/navigation_graph.cpp	2009-04-07 22:05:31 UTC (rev 2891)
@@ -20,11 +20,14 @@
 #include <iomanip>
 #include <map>
 #include <algorithm>
+
+#include "math/rect.hpp"
 #include "display/display.hpp"
+#include "edge.hpp"
+#include "edge_position.hpp"
 #include "node.hpp"
-#include "edge.hpp"
 #include "util/file_reader.hpp"
-#include "edge_position.hpp"
+
 #include "navigation_graph.hpp"
 
 NavigationGraph::NavigationGraph()
@@ -163,6 +166,22 @@
   return ret;
 }
 
+std::vector<NodeHandle>
+NavigationGraph::find_nodes(const Rectf& rect)
+{
+  std::vector<NodeHandle> ret;
+
+  for(Nodes::iterator i = nodes.begin(); i != nodes.end(); ++i)
+    {  
+      if (rect.is_inside((*i)->get_pos()))
+        {
+          ret.push_back(*i);
+        }
+    }
+
+  return ret;
+}
+
 std::vector<EdgeHandle>
 NavigationGraph::find_edges(const Vector2f& pos, float radius)
 {

Modified: trunk/windstille/src/navigation/navigation_graph.hpp
===================================================================
--- trunk/windstille/src/navigation/navigation_graph.hpp	2009-04-07 16:24:06 UTC (rev 2890)
+++ trunk/windstille/src/navigation/navigation_graph.hpp	2009-04-07 22:05:31 UTC (rev 2891)
@@ -23,6 +23,7 @@
 #include <vector>
 #include "math/line.hpp"
 
+class Rectf;
 class Node;
 class FileReader;
 class Edge;
@@ -98,6 +99,8 @@
   /** Find nodes that are near within the \a radius */
   std::vector<NodeHandle> find_nodes(const Vector2f& pos, float radius);
 
+  std::vector<NodeHandle> find_nodes(const Rectf& rect);
+
   /** Find the closest node, limit search to nodes in radius */
   NodeHandle find_closest_node(const Vector2f& pos, float radius);
 



From grumbel at mail.berlios.de  Wed Apr  8 01:10:31 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 8 Apr 2009 01:10:31 +0200
Subject: [Windstille-commit] r2892 - trunk/windstille/src/navigation
Message-ID: <200904072310.n37NAVQb007448@sheep.berlios.de>

Author: grumbel
Date: 2009-04-08 01:10:29 +0200 (Wed, 08 Apr 2009)
New Revision: 2892

Modified:
   trunk/windstille/src/navigation/navigation_graph.cpp
   trunk/windstille/src/navigation/navigation_graph.hpp
Log:
Some const and comparism stuff to allow Nodes to be placed in a set

Modified: trunk/windstille/src/navigation/navigation_graph.cpp
===================================================================
--- trunk/windstille/src/navigation/navigation_graph.cpp	2009-04-07 22:05:31 UTC (rev 2891)
+++ trunk/windstille/src/navigation/navigation_graph.cpp	2009-04-07 23:10:29 UTC (rev 2892)
@@ -175,7 +175,7 @@
     {  
       if (rect.is_inside((*i)->get_pos()))
         {
-          ret.push_back(*i);
+          ret.push_back(NodeHandle(*i));
         }
     }
 

Modified: trunk/windstille/src/navigation/navigation_graph.hpp
===================================================================
--- trunk/windstille/src/navigation/navigation_graph.hpp	2009-04-07 22:05:31 UTC (rev 2891)
+++ trunk/windstille/src/navigation/navigation_graph.hpp	2009-04-07 23:10:29 UTC (rev 2892)
@@ -52,14 +52,27 @@
     return data;
   }
 
+  inline const Data* operator->() const {
+    return data;
+  }
+
   inline Data& operator*()  {
     return *data;
   }
 
+  inline const Data& operator*() const {
+    return *data;
+  }
+
   operator bool() {
     return data != 0;
   }
+
+  bool operator<(const PointerHandle<Data>& other) const {
+    return this->data < other.data;
+  }
 };
+
 
 typedef PointerHandle<Node> NodeHandle; 
 typedef PointerHandle<Edge> EdgeHandle; 



From grumbel at mail.berlios.de  Wed Apr  8 01:11:11 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 8 Apr 2009 01:11:11 +0200
Subject: [Windstille-commit] r2893 - in trunk/windstille/src: editor screen
Message-ID: <200904072311.n37NBBSQ008172@sheep.berlios.de>

Author: grumbel
Date: 2009-04-08 01:11:07 +0200 (Wed, 08 Apr 2009)
New Revision: 2893

Modified:
   trunk/windstille/src/editor/navgraph_tool.cpp
   trunk/windstille/src/editor/navgraph_tool.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
   trunk/windstille/src/screen/navigation_test.cpp
Log:
Some basic work on navigation graph

Modified: trunk/windstille/src/editor/navgraph_tool.cpp
===================================================================
--- trunk/windstille/src/editor/navgraph_tool.cpp	2009-04-07 23:10:29 UTC (rev 2892)
+++ trunk/windstille/src/editor/navgraph_tool.cpp	2009-04-07 23:11:07 UTC (rev 2893)
@@ -16,7 +16,11 @@
 **  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
 
+#include "sector_model.hpp"
+#include "navigation/navigation_graph.hpp"
+#include "navigation/node.hpp"
 #include "windstille_widget.hpp"
+
 #include "navgraph_tool.hpp"
 
 NavgraphTool::NavgraphTool()
@@ -27,15 +31,32 @@
 NavgraphTool::mouse_down (GdkEventButton* event, WindstilleWidget& wst)
 {
   click_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+  NavigationGraph& navgraph = *wst.get_sector_model()->get_nav_graph();
 
-  {
-    rect.left   = click_pos.x;
-    rect.top    = click_pos.y;
-    rect.right  = click_pos.x;
-    rect.bottom = click_pos.y;
+  NodeHandle node = navgraph.find_closest_node(click_pos, 16.0f); // FIXME: Radius should scale with zoom
+  EdgeHandle edge = navgraph.find_closest_edge(click_pos, 16.0f);
+
+  if (node)
+    {
+      mode = DRAG_MODE;
+      selection.clear();
+      selection.insert(node);
+    }
+  else if (edge)
+    {
+      navgraph.remove_edge(edge);
+      mode = NO_MODE;
+    }
+  else
+    {
+      rect.left   = click_pos.x;
+      rect.top    = click_pos.y;
+      rect.right  = click_pos.x;
+      rect.bottom = click_pos.y;
       
-    mode = SELECT_MODE;
-  }
+      selection.clear();
+      mode = SELECT_MODE;
+    }
 
   return true;
 }
@@ -47,7 +68,14 @@
 
   switch(mode)
     {
+      case EDGE_MODE:
+        break;
+
       case DRAG_MODE:
+        {
+          NodeHandle node = *selection.begin();
+          node->set_pos(pos);
+        }
         break;
 
       case SELECT_MODE:
@@ -66,7 +94,30 @@
 NavgraphTool::mouse_up(GdkEventButton* event, WindstilleWidget& wst)
 {
   Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+  NavigationGraph& navgraph = *wst.get_sector_model()->get_nav_graph();
 
+  switch(mode)
+    {
+      case DRAG_MODE:
+        break;
+
+      case EDGE_MODE:
+        break;
+
+      case SELECT_MODE:
+        {
+          rect.normalize();
+          const std::vector<NodeHandle>& lst = navgraph.find_nodes(rect);
+          selection.insert(lst.begin(), lst.end());
+          std::cout << "NavgraphTool::select: " << selection.size() << std::endl;
+          wst.queue_draw();
+        }
+        break;
+
+      case NO_MODE:
+        break;
+    }
+
   mode = NO_MODE;
 
   return true;
@@ -80,6 +131,12 @@
       sc.control().fill_rect(rect, Color(1.0f, 0.5f, 0.5f, 0.25));
       sc.control().draw_rect(rect, Color(1.0f, 0.5f, 0.5f)); 
     }
+
+  std::cout << "NavgraphTool::draw: " << selection.size() << std::endl;
+  for(std::set<NodeHandle>::const_iterator i = selection.begin(); i != selection.end(); ++i)
+    {
+      sc.control().draw_rect(Rectf((*i)->get_pos() - Vector2f(16,16), Sizef(32,32)), Color(1.0f, 1.0f, 1.0f));
+    }
 }
   
 /* EOF */

Modified: trunk/windstille/src/editor/navgraph_tool.hpp
===================================================================
--- trunk/windstille/src/editor/navgraph_tool.hpp	2009-04-07 23:10:29 UTC (rev 2892)
+++ trunk/windstille/src/editor/navgraph_tool.hpp	2009-04-07 23:11:07 UTC (rev 2893)
@@ -19,8 +19,11 @@
 #ifndef HEADER_WINDSTILLE_EDITOR_NAVGRAPH_TOOL_HPP
 #define HEADER_WINDSTILLE_EDITOR_NAVGRAPH_TOOL_HPP
 
+#include <set>
+
 #include "math/rect.hpp"
 #include "tool.hpp"
+#include "navigation/navigation_graph.hpp"
 
 class NavgraphTool : public Tool
 {
@@ -29,11 +32,14 @@
   Rectf    rect;
 
   enum { 
-    SELECT_MODE,
-    DRAG_MODE,
-    NO_MODE
+    SELECT_MODE, // select multiple nodes at once
+    DRAG_MODE,   // move nodes around
+    EDGE_MODE,   // create an edge between two nodes
+    NO_MODE      // mode is determined by next click
   } mode;
 
+  std::set<NodeHandle> selection;
+
 public:
   NavgraphTool();
 

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-07 23:10:29 UTC (rev 2892)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-07 23:11:07 UTC (rev 2893)
@@ -271,8 +271,8 @@
           (*i)->draw(*sc);
         }
 
-      if (active_tool)
-        active_tool->draw(*sc);
+      if (EditorWindow::current()->get_current_tool())
+        EditorWindow::current()->get_current_tool()->draw(*sc);
 
       sc->render();
       state.pop(*sc);

Modified: trunk/windstille/src/screen/navigation_test.cpp
===================================================================
--- trunk/windstille/src/screen/navigation_test.cpp	2009-04-07 23:10:29 UTC (rev 2892)
+++ trunk/windstille/src/screen/navigation_test.cpp	2009-04-07 23:11:07 UTC (rev 2893)
@@ -34,11 +34,7 @@
 NavigationTest::NavigationTest()
   : cursor(400, 300),
     player(200,200),
-    graph(new NavigationGraph()),
-    connection(0),
-    selected_edge(0),
-    selected_node(0),
-    node_to_connect(0)
+    graph(new NavigationGraph())
 {
   try {
     FileReader reader = FileReader::parse("navigation.nav");



From grumbel at mail.berlios.de  Wed Apr  8 04:33:12 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 8 Apr 2009 04:33:12 +0200
Subject: [Windstille-commit] r2894 - in trunk/windstille/src: . editor
Message-ID: <200904080233.n382XCS4005612@sheep.berlios.de>

Author: grumbel
Date: 2009-04-08 04:33:09 +0200 (Wed, 08 Apr 2009)
New Revision: 2894

Added:
   trunk/windstille/src/editor/navgraph_insert_tool.cpp
   trunk/windstille/src/editor/navgraph_insert_tool.hpp
   trunk/windstille/src/editor/navgraph_select_tool.cpp
   trunk/windstille/src/editor/navgraph_select_tool.hpp
Removed:
   trunk/windstille/src/editor/navgraph_tool.cpp
   trunk/windstille/src/editor/navgraph_tool.hpp
Modified:
   trunk/windstille/src/SConscript
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/editor_window.hpp
Log:
Splitted NavgraphTool into select and insert tool

Modified: trunk/windstille/src/SConscript
===================================================================
--- trunk/windstille/src/SConscript	2009-04-07 23:11:07 UTC (rev 2893)
+++ trunk/windstille/src/SConscript	2009-04-08 02:33:09 UTC (rev 2894)
@@ -252,7 +252,8 @@
         'editor/object_model_factory.cpp',
         'editor/object_selector.cpp',
         'editor/layer_manager.cpp',
-        'editor/navgraph_tool.cpp',
+        'editor/navgraph_insert_tool.cpp',
+        'editor/navgraph_select_tool.cpp',
         'editor/scroll_tool.cpp',
         'editor/sector_model.cpp',
         'editor/select_tool.cpp',

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-07 23:11:07 UTC (rev 2893)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-08 02:33:09 UTC (rev 2894)
@@ -36,7 +36,8 @@
 #include "editor_window.hpp"
 #include "zoom_tool.hpp"
 #include "select_tool.hpp"
-#include "navgraph_tool.hpp"
+#include "navgraph_insert_tool.hpp"
+#include "navgraph_select_tool.hpp"
 #include "sector_model.hpp"
 #include "layer_widget.hpp"
 #include "editor_window.hpp"
@@ -51,7 +52,8 @@
     layer_manager(*this),
     minimap_widget(glconfig_),
     select_tool(new SelectTool()),
-    navgraph_tool(new NavgraphTool()),
+    navgraph_insert_tool(new NavgraphInsertTool()),
+    navgraph_select_tool(new NavgraphSelectTool()),
     zoom_tool(new ZoomTool()),
     current_tool(select_tool.get())
 {
@@ -129,7 +131,8 @@
     "    </menu>"
     "    <menu action='MenuTools'>"
     "      <menuitem action='SelectTool'/>"
-    "      <menuitem action='NavgraphTool'/>"
+    "      <menuitem action='NavgraphInsertTool'/>"
+    "      <menuitem action='NavgraphSelectTool'/>"
     "      <menuitem action='ZoomTool'/>"
     "    </menu>"
     "    <menu action='MenuHelp'>"
@@ -176,7 +179,8 @@
     ""
     "  <toolbar  name='ToolBox'>"
     "    <toolitem action='SelectTool'/>"
-    "    <toolitem action='NavgraphTool'/>"
+    "    <toolitem action='NavgraphInsertTool'/>"
+    "    <toolitem action='NavgraphSelectTool'/>"
     "    <toolitem action='ZoomTool'/>"
     "    <separator/>"
     "    <toolitem action='ToggleColorLayer'/>"
@@ -317,11 +321,14 @@
   Gtk::RadioButtonGroup tool_group;
   
   select_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "SelectTool", "select_tool", "Select Tool", "Select Tool");
-  node_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "NavgraphTool",   "node_tool",   "Navgraph Tool", "Navgraph Tool");
+  navgraph_insert_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "NavgraphInsertTool", "node_tool",   "Navgraph Insert Tool", "Navgraph Insert Tool");
+  navgraph_select_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "NavgraphSelectTool", "node_tool",   "Navgraph Select Tool", "Navgraph Select Tool");
   zoom_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "ZoomTool",   "zoom_tool",   "Zoom Tool", "Zoom Tool");
 
   action_group->add(select_tool_action, sigc::bind(sigc::mem_fun(*this, &EditorWindow::on_tool_select), select_tool_action, select_tool.get()));
-  action_group->add(node_tool_action,   sigc::bind(sigc::mem_fun(*this, &EditorWindow::on_tool_select), node_tool_action, navgraph_tool.get()));
+  action_group->add(navgraph_insert_tool_action, sigc::bind(sigc::mem_fun(*this, &EditorWindow::on_tool_select), navgraph_insert_tool_action, navgraph_insert_tool.get()));
+
+  action_group->add(navgraph_select_tool_action, sigc::bind(sigc::mem_fun(*this, &EditorWindow::on_tool_select), navgraph_select_tool_action, navgraph_select_tool.get()));
   action_group->add(zoom_tool_action,   sigc::bind(sigc::mem_fun(*this, &EditorWindow::on_tool_select), zoom_tool_action, zoom_tool.get()));
 
   // signal_size_allocate().connect (sigc::mem_fun (*this, &EditorWindow::on_window_size_allocate), false);

Modified: trunk/windstille/src/editor/editor_window.hpp
===================================================================
--- trunk/windstille/src/editor/editor_window.hpp	2009-04-07 23:11:07 UTC (rev 2893)
+++ trunk/windstille/src/editor/editor_window.hpp	2009-04-08 02:33:09 UTC (rev 2894)
@@ -39,7 +39,8 @@
 class SelectTool;
 class ZoomTool;
 class LayerWidget;
-class NavgraphTool;
+class NavgraphInsertTool;
+class NavgraphSelectTool;
 
 class EditorWindow : public Gtk::Window
 {
@@ -67,7 +68,8 @@
   MinimapWidget  minimap_widget;
 
   Glib::RefPtr<Gtk::RadioAction> select_tool_action;
-  Glib::RefPtr<Gtk::RadioAction> node_tool_action;
+  Glib::RefPtr<Gtk::RadioAction> navgraph_insert_tool_action;
+  Glib::RefPtr<Gtk::RadioAction> navgraph_select_tool_action;
   Glib::RefPtr<Gtk::RadioAction> zoom_tool_action;
 
   Glib::RefPtr<Gtk::ToggleAction> toggle_color_layer;
@@ -82,9 +84,10 @@
   Glib::RefPtr<Gtk::ToggleAction> play_action;
   Glib::RefPtr<Gtk::ToggleAction> snap_action;
 
-  std::auto_ptr<SelectTool> select_tool;
-  std::auto_ptr<NavgraphTool> navgraph_tool;
-  std::auto_ptr<ZoomTool>   zoom_tool;
+  std::auto_ptr<SelectTool>   select_tool;
+  std::auto_ptr<NavgraphInsertTool> navgraph_insert_tool;
+  std::auto_ptr<NavgraphSelectTool> navgraph_select_tool;
+  std::auto_ptr<ZoomTool>     zoom_tool;
   Tool* current_tool;
   LayerWidget* layer_widget;
 

Copied: trunk/windstille/src/editor/navgraph_insert_tool.cpp (from rev 2893, trunk/windstille/src/editor/navgraph_tool.cpp)
===================================================================
--- trunk/windstille/src/editor/navgraph_tool.cpp	2009-04-07 23:11:07 UTC (rev 2893)
+++ trunk/windstille/src/editor/navgraph_insert_tool.cpp	2009-04-08 02:33:09 UTC (rev 2894)
@@ -0,0 +1,142 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#include "sector_model.hpp"
+#include "navigation/navigation_graph.hpp"
+#include "navigation/node.hpp"
+#include "windstille_widget.hpp"
+
+#include "navgraph_insert_tool.hpp"
+
+NavgraphInsertTool::NavgraphInsertTool()
+{
+}
+
+bool
+NavgraphInsertTool::mouse_down (GdkEventButton* event, WindstilleWidget& wst)
+{
+  click_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+  NavigationGraph& navgraph = *wst.get_sector_model()->get_nav_graph();
+
+  NodeHandle node = navgraph.find_closest_node(click_pos, 16.0f); // FIXME: Radius should scale with zoom
+  EdgeHandle edge = navgraph.find_closest_edge(click_pos, 16.0f);
+
+  if (node)
+    {
+      mode = DRAG_MODE;
+      selection.clear();
+      selection.insert(node);
+    }
+  else if (edge)
+    {
+      navgraph.remove_edge(edge);
+      mode = NO_MODE;
+    }
+  else
+    {
+      rect.left   = click_pos.x;
+      rect.top    = click_pos.y;
+      rect.right  = click_pos.x;
+      rect.bottom = click_pos.y;
+      
+      selection.clear();
+      mode = SELECT_MODE;
+    }
+
+  return true;
+}
+
+bool
+NavgraphInsertTool::mouse_move(GdkEventMotion* event, WindstilleWidget& wst)
+{
+  Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+
+  switch(mode)
+    {
+      case EDGE_MODE:
+        break;
+
+      case DRAG_MODE:
+        {
+          NodeHandle node = *selection.begin();
+          node->set_pos(pos);
+        }
+        break;
+
+      case SELECT_MODE:
+        rect.right  = pos.x;
+        rect.bottom = pos.y;
+        break;
+
+      case NO_MODE:
+        break;
+    }
+
+  return true;
+}
+
+bool
+NavgraphInsertTool::mouse_up(GdkEventButton* event, WindstilleWidget& wst)
+{
+  Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+  NavigationGraph& navgraph = *wst.get_sector_model()->get_nav_graph();
+
+  switch(mode)
+    {
+      case DRAG_MODE:
+        break;
+
+      case EDGE_MODE:
+        break;
+
+      case SELECT_MODE:
+        {
+          rect.normalize();
+          const std::vector<NodeHandle>& lst = navgraph.find_nodes(rect);
+          selection.insert(lst.begin(), lst.end());
+          std::cout << "NavgraphInsertTool::select: " << selection.size() << std::endl;
+          wst.queue_draw();
+        }
+        break;
+
+      case NO_MODE:
+        break;
+    }
+
+  mode = NO_MODE;
+
+  return true;
+}
+  
+void
+NavgraphInsertTool::draw(SceneContext& sc)
+{
+  if (mode == SELECT_MODE)
+    {
+      sc.control().fill_rect(rect, Color(1.0f, 0.5f, 0.5f, 0.25));
+      sc.control().draw_rect(rect, Color(1.0f, 0.5f, 0.5f)); 
+    }
+
+  std::cout << "NavgraphInsertTool::draw: " << selection.size() << std::endl;
+  for(std::set<NodeHandle>::const_iterator i = selection.begin(); i != selection.end(); ++i)
+    {
+      sc.control().draw_rect(Rectf((*i)->get_pos() - Vector2f(16,16), Sizef(32,32)), Color(1.0f, 1.0f, 1.0f));
+    }
+}
+  
+/* EOF */


Property changes on: trunk/windstille/src/editor/navgraph_insert_tool.cpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:mergeinfo
   + 
Name: svn:eol-style
   + native

Copied: trunk/windstille/src/editor/navgraph_insert_tool.hpp (from rev 2893, trunk/windstille/src/editor/navgraph_tool.hpp)
===================================================================
--- trunk/windstille/src/editor/navgraph_tool.hpp	2009-04-07 23:11:07 UTC (rev 2893)
+++ trunk/windstille/src/editor/navgraph_insert_tool.hpp	2009-04-08 02:33:09 UTC (rev 2894)
@@ -0,0 +1,59 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#ifndef HEADER_WINDSTILLE_EDITOR_NAVGRAPH_INSERT_TOOL_HPP
+#define HEADER_WINDSTILLE_EDITOR_NAVGRAPH_INSERT_TOOL_HPP
+
+#include <set>
+
+#include "math/rect.hpp"
+#include "tool.hpp"
+#include "navigation/navigation_graph.hpp"
+
+class NavgraphInsertTool : public Tool
+{
+private:
+  Vector2f click_pos;
+  Rectf    rect;
+
+  enum { 
+    SELECT_MODE, // select multiple nodes at once
+    DRAG_MODE,   // move nodes around
+    EDGE_MODE,   // create an edge between two nodes
+    NO_MODE      // mode is determined by next click
+  } mode;
+
+  std::set<NodeHandle> selection;
+
+public:
+  NavgraphInsertTool();
+
+  bool mouse_down(GdkEventButton* event, WindstilleWidget& wst);
+  bool mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
+  bool mouse_up(GdkEventButton* event, WindstilleWidget& wst);
+  
+  void draw(SceneContext& sc);
+
+private:
+  NavgraphInsertTool(const NavgraphInsertTool&);
+  NavgraphInsertTool& operator=(const NavgraphInsertTool&);
+};
+
+#endif
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/navgraph_insert_tool.hpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:mergeinfo
   + 
Name: svn:eol-style
   + native

Added: trunk/windstille/src/editor/navgraph_select_tool.cpp
===================================================================
--- trunk/windstille/src/editor/navgraph_select_tool.cpp	2009-04-07 23:11:07 UTC (rev 2893)
+++ trunk/windstille/src/editor/navgraph_select_tool.cpp	2009-04-08 02:33:09 UTC (rev 2894)
@@ -0,0 +1,52 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#include "navgraph_select_tool.hpp"
+
+NavgraphSelectTool::NavgraphSelectTool()
+{
+}
+
+NavgraphSelectTool::~NavgraphSelectTool()
+{
+}
+
+bool
+NavgraphSelectTool::mouse_down(GdkEventButton* event, WindstilleWidget& wst)
+{
+  return true;
+}
+
+bool
+NavgraphSelectTool::mouse_move(GdkEventMotion* event, WindstilleWidget& wst)
+{
+  return true;
+}
+
+bool
+NavgraphSelectTool::mouse_up(GdkEventButton* event, WindstilleWidget& wst)
+{
+  return true;
+}
+
+void
+NavgraphSelectTool::draw(SceneContext& sc)
+{
+}
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/navgraph_select_tool.cpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Added: trunk/windstille/src/editor/navgraph_select_tool.hpp
===================================================================
--- trunk/windstille/src/editor/navgraph_select_tool.hpp	2009-04-07 23:11:07 UTC (rev 2893)
+++ trunk/windstille/src/editor/navgraph_select_tool.hpp	2009-04-08 02:33:09 UTC (rev 2894)
@@ -0,0 +1,48 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#ifndef HEADER_WINDSTILLE_EDITOR_NAVGRAPH_SELECT_TOOL_HPP
+#define HEADER_WINDSTILLE_EDITOR_NAVGRAPH_SELECT_TOOL_HPP
+
+#include <set>
+
+#include "math/rect.hpp"
+#include "tool.hpp"
+#include "navigation/navigation_graph.hpp"
+
+class NavgraphSelectTool : public Tool
+{
+private:
+public:
+  NavgraphSelectTool();
+  ~NavgraphSelectTool();
+
+  bool mouse_down(GdkEventButton* event, WindstilleWidget& wst);
+  bool mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
+  bool mouse_up(GdkEventButton* event, WindstilleWidget& wst);
+  
+  void draw(SceneContext& sc);
+
+private:
+  NavgraphSelectTool(const NavgraphSelectTool&);
+  NavgraphSelectTool& operator=(const NavgraphSelectTool&);
+};
+
+#endif
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/navgraph_select_tool.hpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Deleted: trunk/windstille/src/editor/navgraph_tool.cpp
===================================================================
--- trunk/windstille/src/editor/navgraph_tool.cpp	2009-04-07 23:11:07 UTC (rev 2893)
+++ trunk/windstille/src/editor/navgraph_tool.cpp	2009-04-08 02:33:09 UTC (rev 2894)
@@ -1,142 +0,0 @@
-/*
-**  Windstille - A Sci-Fi Action-Adventure Game
-**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
-**
-**  This program is free software: you can redistribute it and/or modify
-**  it under the terms of the GNU General Public License as published by
-**  the Free Software Foundation, either version 3 of the License, or
-**  (at your option) any later version.
-**  
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-**  
-**  You should have received a copy of the GNU General Public License
-**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
-*/
-
-#include "sector_model.hpp"
-#include "navigation/navigation_graph.hpp"
-#include "navigation/node.hpp"
-#include "windstille_widget.hpp"
-
-#include "navgraph_tool.hpp"
-
-NavgraphTool::NavgraphTool()
-{
-}
-
-bool
-NavgraphTool::mouse_down (GdkEventButton* event, WindstilleWidget& wst)
-{
-  click_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
-  NavigationGraph& navgraph = *wst.get_sector_model()->get_nav_graph();
-
-  NodeHandle node = navgraph.find_closest_node(click_pos, 16.0f); // FIXME: Radius should scale with zoom
-  EdgeHandle edge = navgraph.find_closest_edge(click_pos, 16.0f);
-
-  if (node)
-    {
-      mode = DRAG_MODE;
-      selection.clear();
-      selection.insert(node);
-    }
-  else if (edge)
-    {
-      navgraph.remove_edge(edge);
-      mode = NO_MODE;
-    }
-  else
-    {
-      rect.left   = click_pos.x;
-      rect.top    = click_pos.y;
-      rect.right  = click_pos.x;
-      rect.bottom = click_pos.y;
-      
-      selection.clear();
-      mode = SELECT_MODE;
-    }
-
-  return true;
-}
-
-bool
-NavgraphTool::mouse_move(GdkEventMotion* event, WindstilleWidget& wst)
-{
-  Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
-
-  switch(mode)
-    {
-      case EDGE_MODE:
-        break;
-
-      case DRAG_MODE:
-        {
-          NodeHandle node = *selection.begin();
-          node->set_pos(pos);
-        }
-        break;
-
-      case SELECT_MODE:
-        rect.right  = pos.x;
-        rect.bottom = pos.y;
-        break;
-
-      case NO_MODE:
-        break;
-    }
-
-  return true;
-}
-
-bool
-NavgraphTool::mouse_up(GdkEventButton* event, WindstilleWidget& wst)
-{
-  Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
-  NavigationGraph& navgraph = *wst.get_sector_model()->get_nav_graph();
-
-  switch(mode)
-    {
-      case DRAG_MODE:
-        break;
-
-      case EDGE_MODE:
-        break;
-
-      case SELECT_MODE:
-        {
-          rect.normalize();
-          const std::vector<NodeHandle>& lst = navgraph.find_nodes(rect);
-          selection.insert(lst.begin(), lst.end());
-          std::cout << "NavgraphTool::select: " << selection.size() << std::endl;
-          wst.queue_draw();
-        }
-        break;
-
-      case NO_MODE:
-        break;
-    }
-
-  mode = NO_MODE;
-
-  return true;
-}
-  
-void
-NavgraphTool::draw(SceneContext& sc)
-{
-  if (mode == SELECT_MODE)
-    {
-      sc.control().fill_rect(rect, Color(1.0f, 0.5f, 0.5f, 0.25));
-      sc.control().draw_rect(rect, Color(1.0f, 0.5f, 0.5f)); 
-    }
-
-  std::cout << "NavgraphTool::draw: " << selection.size() << std::endl;
-  for(std::set<NodeHandle>::const_iterator i = selection.begin(); i != selection.end(); ++i)
-    {
-      sc.control().draw_rect(Rectf((*i)->get_pos() - Vector2f(16,16), Sizef(32,32)), Color(1.0f, 1.0f, 1.0f));
-    }
-}
-  
-/* EOF */

Deleted: trunk/windstille/src/editor/navgraph_tool.hpp
===================================================================
--- trunk/windstille/src/editor/navgraph_tool.hpp	2009-04-07 23:11:07 UTC (rev 2893)
+++ trunk/windstille/src/editor/navgraph_tool.hpp	2009-04-08 02:33:09 UTC (rev 2894)
@@ -1,59 +0,0 @@
-/*
-**  Windstille - A Sci-Fi Action-Adventure Game
-**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
-**
-**  This program is free software: you can redistribute it and/or modify
-**  it under the terms of the GNU General Public License as published by
-**  the Free Software Foundation, either version 3 of the License, or
-**  (at your option) any later version.
-**  
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-**  
-**  You should have received a copy of the GNU General Public License
-**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
-*/
-
-#ifndef HEADER_WINDSTILLE_EDITOR_NAVGRAPH_TOOL_HPP
-#define HEADER_WINDSTILLE_EDITOR_NAVGRAPH_TOOL_HPP
-
-#include <set>
-
-#include "math/rect.hpp"
-#include "tool.hpp"
-#include "navigation/navigation_graph.hpp"
-
-class NavgraphTool : public Tool
-{
-private:
-  Vector2f click_pos;
-  Rectf    rect;
-
-  enum { 
-    SELECT_MODE, // select multiple nodes at once
-    DRAG_MODE,   // move nodes around
-    EDGE_MODE,   // create an edge between two nodes
-    NO_MODE      // mode is determined by next click
-  } mode;
-
-  std::set<NodeHandle> selection;
-
-public:
-  NavgraphTool();
-
-  bool mouse_down (GdkEventButton* event, WindstilleWidget& wst);
-  bool mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
-  bool mouse_up(GdkEventButton* event, WindstilleWidget& wst);
-  
-  void draw(SceneContext& sc);
-
-private:
-  NavgraphTool(const NavgraphTool&);
-  NavgraphTool& operator=(const NavgraphTool&);
-};
-
-#endif
-
-/* EOF */



From grumbel at mail.berlios.de  Wed Apr  8 05:12:03 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 8 Apr 2009 05:12:03 +0200
Subject: [Windstille-commit] r2895 - trunk/windstille/src/editor
Message-ID: <200904080312.n383C3Qx012417@sheep.berlios.de>

Author: grumbel
Date: 2009-04-08 05:12:01 +0200 (Wed, 08 Apr 2009)
New Revision: 2895

Modified:
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/navgraph_insert_tool.cpp
   trunk/windstille/src/editor/navgraph_insert_tool.hpp
   trunk/windstille/src/editor/navgraph_select_tool.cpp
   trunk/windstille/src/editor/navgraph_select_tool.hpp
Log:
Some more work on NavigationGraph editing tools

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-08 02:33:09 UTC (rev 2894)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-08 03:12:01 UTC (rev 2895)
@@ -323,7 +323,7 @@
   select_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "SelectTool", "select_tool", "Select Tool", "Select Tool");
   navgraph_insert_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "NavgraphInsertTool", "node_tool",   "Navgraph Insert Tool", "Navgraph Insert Tool");
   navgraph_select_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "NavgraphSelectTool", "node_tool",   "Navgraph Select Tool", "Navgraph Select Tool");
-  zoom_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "ZoomTool",   "zoom_tool",   "Zoom Tool", "Zoom Tool");
+  zoom_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "ZoomTool", "zoom_tool",   "Zoom Tool", "Zoom Tool");
 
   action_group->add(select_tool_action, sigc::bind(sigc::mem_fun(*this, &EditorWindow::on_tool_select), select_tool_action, select_tool.get()));
   action_group->add(navgraph_insert_tool_action, sigc::bind(sigc::mem_fun(*this, &EditorWindow::on_tool_select), navgraph_insert_tool_action, navgraph_insert_tool.get()));

Modified: trunk/windstille/src/editor/navgraph_insert_tool.cpp
===================================================================
--- trunk/windstille/src/editor/navgraph_insert_tool.cpp	2009-04-08 02:33:09 UTC (rev 2894)
+++ trunk/windstille/src/editor/navgraph_insert_tool.cpp	2009-04-08 03:12:01 UTC (rev 2895)
@@ -24,101 +24,99 @@
 #include "navgraph_insert_tool.hpp"
 
 NavgraphInsertTool::NavgraphInsertTool()
+  : mode(NO_MODE)
 {
 }
 
 bool
 NavgraphInsertTool::mouse_down (GdkEventButton* event, WindstilleWidget& wst)
 {
-  click_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+  mouse_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
   NavigationGraph& navgraph = *wst.get_sector_model()->get_nav_graph();
 
-  NodeHandle node = navgraph.find_closest_node(click_pos, 16.0f); // FIXME: Radius should scale with zoom
-  EdgeHandle edge = navgraph.find_closest_edge(click_pos, 16.0f);
+  NodeHandle node = navgraph.find_closest_node(mouse_pos, 16.0f); // FIXME: Radius should scale with zoom
+  EdgeHandle edge = navgraph.find_closest_edge(mouse_pos, 16.0f);
 
-  if (node)
+  switch(mode)
     {
-      mode = DRAG_MODE;
-      selection.clear();
-      selection.insert(node);
+      case EDGE_MODE:
+        {
+          if (node)
+            { // connect last node with existing node
+              navgraph.add_edge(last_node, node);
+              last_node = NodeHandle();
+            }
+          else
+            { // connect last node with newly created node
+              node = navgraph.add_node(mouse_pos);
+              navgraph.add_edge(last_node, node);
+              last_node = NodeHandle();
+            }
+          mode = NO_MODE;        
+        }
+        break;
+
+      case NO_MODE:
+        {
+          if (node)
+            {
+              last_node = node;
+              mode = EDGE_MODE;
+            }
+          else if (edge)
+            {
+              navgraph.remove_edge(edge);
+              mode = NO_MODE;
+            }
+          else
+            {
+              last_node = navgraph.add_node(mouse_pos);
+              mode = EDGE_MODE;
+            }
+        }
+        break;
     }
-  else if (edge)
-    {
-      navgraph.remove_edge(edge);
-      mode = NO_MODE;
-    }
-  else
-    {
-      rect.left   = click_pos.x;
-      rect.top    = click_pos.y;
-      rect.right  = click_pos.x;
-      rect.bottom = click_pos.y;
-      
-      selection.clear();
-      mode = SELECT_MODE;
-    }
 
+  wst.queue_draw();
+
   return true;
 }
 
 bool
 NavgraphInsertTool::mouse_move(GdkEventMotion* event, WindstilleWidget& wst)
 {
-  Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+  mouse_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
 
   switch(mode)
     {
       case EDGE_MODE:
         break;
 
-      case DRAG_MODE:
-        {
-          NodeHandle node = *selection.begin();
-          node->set_pos(pos);
-        }
-        break;
-
-      case SELECT_MODE:
-        rect.right  = pos.x;
-        rect.bottom = pos.y;
-        break;
-
       case NO_MODE:
         break;
     }
 
+  wst.queue_draw();
+
   return true;
 }
 
 bool
 NavgraphInsertTool::mouse_up(GdkEventButton* event, WindstilleWidget& wst)
 {
-  Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
-  NavigationGraph& navgraph = *wst.get_sector_model()->get_nav_graph();
+  mouse_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+  //NavigationGraph& navgraph = *wst.get_sector_model()->get_nav_graph();
 
   switch(mode)
     {
-      case DRAG_MODE:
-        break;
-
       case EDGE_MODE:
         break;
 
-      case SELECT_MODE:
-        {
-          rect.normalize();
-          const std::vector<NodeHandle>& lst = navgraph.find_nodes(rect);
-          selection.insert(lst.begin(), lst.end());
-          std::cout << "NavgraphInsertTool::select: " << selection.size() << std::endl;
-          wst.queue_draw();
-        }
-        break;
-
       case NO_MODE:
         break;
     }
 
-  mode = NO_MODE;
+  wst.queue_draw();
 
   return true;
 }
@@ -126,17 +124,12 @@
 void
 NavgraphInsertTool::draw(SceneContext& sc)
 {
-  if (mode == SELECT_MODE)
+  std::cout << "Draw: " << last_node << std::endl;
+  if (last_node)
     {
-      sc.control().fill_rect(rect, Color(1.0f, 0.5f, 0.5f, 0.25));
-      sc.control().draw_rect(rect, Color(1.0f, 0.5f, 0.5f)); 
+      //sc.control().draw_line(last_node->get_pos(), mouse_pos, Color(1,1,1));
+      sc.control().draw_rect(Rectf(last_node->get_pos() - Vector2f(16,16), Sizef(32,32)), Color(1.0f, 1.0f, 1.0f));
     }
-
-  std::cout << "NavgraphInsertTool::draw: " << selection.size() << std::endl;
-  for(std::set<NodeHandle>::const_iterator i = selection.begin(); i != selection.end(); ++i)
-    {
-      sc.control().draw_rect(Rectf((*i)->get_pos() - Vector2f(16,16), Sizef(32,32)), Color(1.0f, 1.0f, 1.0f));
-    }
 }
   
 /* EOF */

Modified: trunk/windstille/src/editor/navgraph_insert_tool.hpp
===================================================================
--- trunk/windstille/src/editor/navgraph_insert_tool.hpp	2009-04-08 02:33:09 UTC (rev 2894)
+++ trunk/windstille/src/editor/navgraph_insert_tool.hpp	2009-04-08 03:12:01 UTC (rev 2895)
@@ -28,17 +28,14 @@
 class NavgraphInsertTool : public Tool
 {
 private:
-  Vector2f click_pos;
-  Rectf    rect;
+  Vector2f mouse_pos;
 
   enum { 
-    SELECT_MODE, // select multiple nodes at once
-    DRAG_MODE,   // move nodes around
     EDGE_MODE,   // create an edge between two nodes
     NO_MODE      // mode is determined by next click
   } mode;
 
-  std::set<NodeHandle> selection;
+  NodeHandle last_node;
 
 public:
   NavgraphInsertTool();

Modified: trunk/windstille/src/editor/navgraph_select_tool.cpp
===================================================================
--- trunk/windstille/src/editor/navgraph_select_tool.cpp	2009-04-08 02:33:09 UTC (rev 2894)
+++ trunk/windstille/src/editor/navgraph_select_tool.cpp	2009-04-08 03:12:01 UTC (rev 2895)
@@ -16,6 +16,11 @@
 **  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
 
+#include "sector_model.hpp"
+#include "navigation/navigation_graph.hpp"
+#include "navigation/node.hpp"
+#include "windstille_widget.hpp"
+
 #include "navgraph_select_tool.hpp"
 
 NavgraphSelectTool::NavgraphSelectTool()
@@ -29,24 +34,107 @@
 bool
 NavgraphSelectTool::mouse_down(GdkEventButton* event, WindstilleWidget& wst)
 {
+  click_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+  NavigationGraph& navgraph = *wst.get_sector_model()->get_nav_graph();
+
+  NodeHandle node = navgraph.find_closest_node(click_pos, 16.0f); // FIXME: Radius should scale with zoom
+  EdgeHandle edge = navgraph.find_closest_edge(click_pos, 16.0f);
+
+  if (node)
+    {
+      mode = DRAG_MODE;
+      selection.clear();
+      selection.insert(node);
+    }
+  else if (edge)
+    {
+      navgraph.remove_edge(edge);
+      mode = NO_MODE;
+    }
+  else
+    {
+      rect.left   = click_pos.x;
+      rect.top    = click_pos.y;
+      rect.right  = click_pos.x;
+      rect.bottom = click_pos.y;
+      
+      selection.clear();
+      mode = SELECT_MODE;
+    }
+
   return true;
 }
 
 bool
 NavgraphSelectTool::mouse_move(GdkEventMotion* event, WindstilleWidget& wst)
 {
+  Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+
+  switch(mode)
+    {
+      case DRAG_MODE:
+        {
+          NodeHandle node = *selection.begin();
+          node->set_pos(pos);
+        }
+        break;
+
+      case SELECT_MODE:
+        rect.right  = pos.x;
+        rect.bottom = pos.y;
+        break;
+
+      case NO_MODE:
+        break;
+    }
+
   return true;
 }
 
 bool
 NavgraphSelectTool::mouse_up(GdkEventButton* event, WindstilleWidget& wst)
 {
+  Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+  NavigationGraph& navgraph = *wst.get_sector_model()->get_nav_graph();
+
+  switch(mode)
+    {
+      case DRAG_MODE:
+        break;
+
+      case SELECT_MODE:
+        {
+          rect.normalize();
+          const std::vector<NodeHandle>& lst = navgraph.find_nodes(rect);
+          selection.insert(lst.begin(), lst.end());
+          std::cout << "NavgraphInsertTool::select: " << selection.size() << std::endl;
+          wst.queue_draw();
+        }
+        break;
+
+      case NO_MODE:
+        break;
+    }
+
+  mode = NO_MODE;
+
   return true;
 }
 
 void
 NavgraphSelectTool::draw(SceneContext& sc)
 {
+  if (mode == SELECT_MODE)
+    {
+      sc.control().fill_rect(rect, Color(1.0f, 0.5f, 0.5f, 0.25));
+      sc.control().draw_rect(rect, Color(1.0f, 0.5f, 0.5f)); 
+    }
+
+  std::cout << "NavgraphInsertTool::draw: " << selection.size() << std::endl;
+  for(std::set<NodeHandle>::const_iterator i = selection.begin(); i != selection.end(); ++i)
+    {
+      sc.control().draw_rect(Rectf((*i)->get_pos() - Vector2f(16,16), Sizef(32,32)), Color(1.0f, 1.0f, 1.0f));
+    }
 }
 
 /* EOF */

Modified: trunk/windstille/src/editor/navgraph_select_tool.hpp
===================================================================
--- trunk/windstille/src/editor/navgraph_select_tool.hpp	2009-04-08 02:33:09 UTC (rev 2894)
+++ trunk/windstille/src/editor/navgraph_select_tool.hpp	2009-04-08 03:12:01 UTC (rev 2895)
@@ -28,6 +28,17 @@
 class NavgraphSelectTool : public Tool
 {
 private:
+  Vector2f click_pos;  
+  Rectf    rect;
+
+  enum { 
+    SELECT_MODE, // select multiple nodes at once
+    DRAG_MODE,   // move nodes around
+    NO_MODE      // mode is determined by next click
+  } mode;
+
+  std::set<NodeHandle> selection;
+
 public:
   NavgraphSelectTool();
   ~NavgraphSelectTool();



From grumbel at mail.berlios.de  Wed Apr  8 05:14:21 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 8 Apr 2009 05:14:21 +0200
Subject: [Windstille-commit] r2896 - trunk/windstille
Message-ID: <200904080314.n383ELKZ012510@sheep.berlios.de>

Author: grumbel
Date: 2009-04-08 05:14:21 +0200 (Wed, 08 Apr 2009)
New Revision: 2896

Modified:
   trunk/windstille/TODO
Log:
TODO updates

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-04-08 03:12:01 UTC (rev 2895)
+++ trunk/windstille/TODO	2009-04-08 03:14:21 UTC (rev 2896)
@@ -186,6 +186,9 @@
 Miscellaneous
 =============
 
+* SurfaceManager::load_grid() bypasses TexturePacker, doesn't do
+  border pixel duplication
+
 * replace power_of_two function with one not based on a slow while() loop
 
 * maybe add special support for opaque textures, i.e. Textures with
@@ -494,8 +497,11 @@
 Graphics
 ========
 
+* do not make light larger then 256, maybe even smaller is ok
+
 * do *NOT* use power of two textures, use multiple of 64/128 instead
-  (128 is easy to snap, power of two doesn't help, since textures are packed)
+  (128 is easy to snap, power of two doesn't help, since textures are
+  packed and get a 1px border added)
 
 * generate .png's automatically from .xcf's via scons
 
@@ -516,15 +522,47 @@
 Editor
 ======
 
-* Texture::put can't handle non-RGBA surface
+* tools are not drawn/updated when no button is pressed
 
-* add a SoftwareSurface::grow() which creates a new SoftwareSurface
-  with a 1px boarder for fixing texture blend issue
+* NavgraphTool (see Construo):
+ 
+  - in Construo insertion and selection are two different tool
 
-* add way to convert Texture to SoftwareSurface for debugging
+  Insert Tool:
+  ============
+  click on empty space: insert_node, start_edge
+  click on node: start_edge
+  right click on edge: delete_edge
+  right click on node: delete_node, delete_connected_edges
 
-* share SoftwareSurface via Manager class
+  needed modifier (shift, ctrl, alt):
 
+   - horizontal/vertical/45 degree
+   - continue-line, allowing the insertion of a multiple control point
+     line in a single step
+
+  Select Tool:
+  ============
+   click on node: nothing 
+   click on empty space: selection rect
+   click on selection: drag
+ 
+   right click&drag rotates
+  
+* replace PointerHandle in NavigationGraph with boost::shared_ptr or
+  boost::weak_ptr, tricky, since it easily leads to recuriseve links
+
+* turn the Selection into a kind-of ControlPoint, this would allow to
+  keep the move/offset logic out of the ObjectModel
+
+* maybe have different RGB and RGBA Textures in the TexturePacker
+
+* add a tiny timeout before an objects can be moved, so that its
+  easier to mark an object without accidently moving it
+
+* share SoftwareSurface via Manager class, generalize Manager classes
+  -> template
+
 * add binlocate support
 
 * add an icon to the editor
@@ -641,6 +679,9 @@
     layer or a color gradient layer, that doesn't contain objects, but
     is meaningful by itself
 
+  - having structured layers (tree) doesn't seem all that useful,
+    maybe flat layer list would be enough and easier to use
+
 * add button and keyboard shortcut to mark/unmark all layers in the layermask
 
 * add a way to move object to a different layer



From grumbel at mail.berlios.de  Wed Apr  8 18:34:21 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 8 Apr 2009 18:34:21 +0200
Subject: [Windstille-commit] r2897 - in trunk/windstille/src: editor
	navigation
Message-ID: <200904081634.n38GYLDi016666@sheep.berlios.de>

Author: grumbel
Date: 2009-04-08 18:34:18 +0200 (Wed, 08 Apr 2009)
New Revision: 2897

Modified:
   trunk/windstille/src/editor/sector_model.cpp
   trunk/windstille/src/navigation/navigation_graph.cpp
   trunk/windstille/src/navigation/navigation_graph.hpp
Log:
Added NavGraph loading and saving to the editor

Modified: trunk/windstille/src/editor/sector_model.cpp
===================================================================
--- trunk/windstille/src/editor/sector_model.cpp	2009-04-08 03:14:21 UTC (rev 2896)
+++ trunk/windstille/src/editor/sector_model.cpp	2009-04-08 16:34:18 UTC (rev 2897)
@@ -379,6 +379,10 @@
           ambient_color = Color(0,0,0,1);
           reader.get("ambient-color", ambient_color);
 
+          FileReader navigation_section;
+          reader.get("navigation", navigation_section);
+          nav_graph->load(navigation_section);
+
           const std::vector<FileReader>& sections = reader.get_sections();
           for(std::vector<FileReader>::const_iterator i = sections.begin(); i != sections.end(); ++i)
             {
@@ -416,6 +420,10 @@
   writer.write("ambient-color", ambient_color);
   writer.write("init-script", "init.nut");
 
+  writer.start_section("navigation");
+  nav_graph->write(writer);
+  writer.end_section();
+
   write(writer, *(layer_tree->children().begin()));
 
   writer.end_section();

Modified: trunk/windstille/src/navigation/navigation_graph.cpp
===================================================================
--- trunk/windstille/src/navigation/navigation_graph.cpp	2009-04-08 03:14:21 UTC (rev 2896)
+++ trunk/windstille/src/navigation/navigation_graph.cpp	2009-04-08 16:34:18 UTC (rev 2897)
@@ -27,6 +27,7 @@
 #include "edge_position.hpp"
 #include "node.hpp"
 #include "util/file_reader.hpp"
+#include "util/file_writer.hpp"
 
 #include "navigation_graph.hpp"
 
@@ -260,6 +261,9 @@
 void
 NavigationGraph::load(FileReader& reader)
 {
+  nodes.clear();
+  edges.clear();
+
   int id_count = 1;
   std::map<int, Node*> id2ptr;
 
@@ -335,7 +339,7 @@
 
 void
 NavigationGraph::save(std::ostream& out)
-{
+{ // FIXME: Obsolete
   int id = 1;
   std::map<Node*, int> ptr2id;
 
@@ -364,6 +368,38 @@
   out.flags(old_flags); // restore flags
 }
 
+void
+NavigationGraph::write(FileWriter& writer)
+{
+  std::map<Node*, int> ptr2id;
+
+  {
+    for(Nodes::iterator i = nodes.begin(); i != nodes.end(); ++i)
+      ptr2id[*i] = i - nodes.begin() + 1;
+  }
+
+  writer.start_section("nodes");
+  for(Nodes::iterator i = nodes.begin(); i != nodes.end(); ++i)
+    {
+      writer.start_section("node");
+      writer.write("id", ptr2id[*i]);
+      writer.write("pos", (*i)->get_pos());
+      writer.end_section();
+    }
+  writer.end_section();
+
+  writer.start_section("edges");
+  for(Edges::iterator i = edges.begin(); i != edges.end(); ++i)  
+    {
+      writer.start_section("edge");
+      writer.write("node1", ptr2id[(*i)->get_node1()]);
+      writer.write("node2", ptr2id[(*i)->get_node2()]);
+      writer.write("properties", (int)(*i)->get_properties());
+      writer.end_section();
+    }
+  writer.end_section();
+}
+
 bool
 NavigationGraph::valid(Edge* edge)
 {

Modified: trunk/windstille/src/navigation/navigation_graph.hpp
===================================================================
--- trunk/windstille/src/navigation/navigation_graph.hpp	2009-04-08 03:14:21 UTC (rev 2896)
+++ trunk/windstille/src/navigation/navigation_graph.hpp	2009-04-08 16:34:18 UTC (rev 2897)
@@ -26,6 +26,7 @@
 class Rectf;
 class Node;
 class FileReader;
+class FileWriter;
 class Edge;
 class EdgePosition;
 
@@ -127,6 +128,7 @@
 
   void load(FileReader& reader);
   void save(std::ostream& out);
+  void write(FileWriter& writer);
 
   bool valid(Edge* edge);
   bool valid(Node* node);



From grumbel at mail.berlios.de  Wed Apr  8 18:55:00 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 8 Apr 2009 18:55:00 +0200
Subject: [Windstille-commit] r2898 - in trunk/windstille: data/editor
	src/editor
Message-ID: <200904081655.n38Gt0gh032419@sheep.berlios.de>

Author: grumbel
Date: 2009-04-08 18:54:59 +0200 (Wed, 08 Apr 2009)
New Revision: 2898

Added:
   trunk/windstille/data/editor/navgraph_insert_tool.png
   trunk/windstille/data/editor/navgraph_select_tool.png
Modified:
   trunk/windstille/src/editor/editor_window.cpp
Log:
Added seperate icons for select and insert navgraph tools

Added: trunk/windstille/data/editor/navgraph_insert_tool.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/editor/navgraph_insert_tool.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/editor/navgraph_select_tool.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/editor/navgraph_select_tool.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-08 16:34:18 UTC (rev 2897)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-08 16:54:59 UTC (rev 2898)
@@ -321,8 +321,8 @@
   Gtk::RadioButtonGroup tool_group;
   
   select_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "SelectTool", "select_tool", "Select Tool", "Select Tool");
-  navgraph_insert_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "NavgraphInsertTool", "node_tool",   "Navgraph Insert Tool", "Navgraph Insert Tool");
-  navgraph_select_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "NavgraphSelectTool", "node_tool",   "Navgraph Select Tool", "Navgraph Select Tool");
+  navgraph_insert_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "NavgraphInsertTool", "navgraph_insert_tool",   "Navgraph Insert Tool", "Navgraph Insert Tool");
+  navgraph_select_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "NavgraphSelectTool", "navgraph_select_tool",   "Navgraph Select Tool", "Navgraph Select Tool");
   zoom_tool_action = Gtk::RadioAction::create_with_icon_name(tool_group, "ZoomTool", "zoom_tool",   "Zoom Tool", "Zoom Tool");
 
   action_group->add(select_tool_action, sigc::bind(sigc::mem_fun(*this, &EditorWindow::on_tool_select), select_tool_action, select_tool.get()));



From grumbel at mail.berlios.de  Wed Apr  8 19:14:43 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 8 Apr 2009 19:14:43 +0200
Subject: [Windstille-commit] r2899 - trunk/windstille/src/editor
Message-ID: <200904081714.n38HEhq9019645@sheep.berlios.de>

Author: grumbel
Date: 2009-04-08 19:14:40 +0200 (Wed, 08 Apr 2009)
New Revision: 2899

Modified:
   trunk/windstille/src/editor/navgraph_insert_tool.cpp
   trunk/windstille/src/editor/navgraph_insert_tool.hpp
   trunk/windstille/src/editor/navgraph_select_tool.cpp
   trunk/windstille/src/editor/navgraph_select_tool.hpp
   trunk/windstille/src/editor/scroll_tool.cpp
   trunk/windstille/src/editor/scroll_tool.hpp
   trunk/windstille/src/editor/select_tool.cpp
   trunk/windstille/src/editor/select_tool.hpp
   trunk/windstille/src/editor/tool.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
   trunk/windstille/src/editor/zoom_tool.cpp
   trunk/windstille/src/editor/zoom_tool.hpp
Log:
Removed bool return type from Tool move functions

Modified: trunk/windstille/src/editor/navgraph_insert_tool.cpp
===================================================================
--- trunk/windstille/src/editor/navgraph_insert_tool.cpp	2009-04-08 16:54:59 UTC (rev 2898)
+++ trunk/windstille/src/editor/navgraph_insert_tool.cpp	2009-04-08 17:14:40 UTC (rev 2899)
@@ -28,7 +28,7 @@
 {
 }
 
-bool
+void
 NavgraphInsertTool::mouse_down (GdkEventButton* event, WindstilleWidget& wst)
 {
   mouse_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
@@ -78,11 +78,9 @@
     }
 
   wst.queue_draw();
-
-  return true;
 }
 
-bool
+void
 NavgraphInsertTool::mouse_move(GdkEventMotion* event, WindstilleWidget& wst)
 {
   mouse_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
@@ -97,11 +95,9 @@
     }
 
   wst.queue_draw();
-
-  return true;
 }
 
-bool
+void
 NavgraphInsertTool::mouse_up(GdkEventButton* event, WindstilleWidget& wst)
 {
   mouse_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
@@ -117,8 +113,6 @@
     }
 
   wst.queue_draw();
-
-  return true;
 }
   
 void
@@ -127,7 +121,7 @@
   std::cout << "Draw: " << last_node << std::endl;
   if (last_node)
     {
-      //sc.control().draw_line(last_node->get_pos(), mouse_pos, Color(1,1,1));
+      sc.control().draw_line(last_node->get_pos(), mouse_pos, Color(1,1,1));
       sc.control().draw_rect(Rectf(last_node->get_pos() - Vector2f(16,16), Sizef(32,32)), Color(1.0f, 1.0f, 1.0f));
     }
 }

Modified: trunk/windstille/src/editor/navgraph_insert_tool.hpp
===================================================================
--- trunk/windstille/src/editor/navgraph_insert_tool.hpp	2009-04-08 16:54:59 UTC (rev 2898)
+++ trunk/windstille/src/editor/navgraph_insert_tool.hpp	2009-04-08 17:14:40 UTC (rev 2899)
@@ -40,9 +40,9 @@
 public:
   NavgraphInsertTool();
 
-  bool mouse_down(GdkEventButton* event, WindstilleWidget& wst);
-  bool mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
-  bool mouse_up(GdkEventButton* event, WindstilleWidget& wst);
+  void mouse_down(GdkEventButton* event, WindstilleWidget& wst);
+  void mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
+  void mouse_up(GdkEventButton* event, WindstilleWidget& wst);
   
   void draw(SceneContext& sc);
 

Modified: trunk/windstille/src/editor/navgraph_select_tool.cpp
===================================================================
--- trunk/windstille/src/editor/navgraph_select_tool.cpp	2009-04-08 16:54:59 UTC (rev 2898)
+++ trunk/windstille/src/editor/navgraph_select_tool.cpp	2009-04-08 17:14:40 UTC (rev 2899)
@@ -31,7 +31,7 @@
 {
 }
 
-bool
+void
 NavgraphSelectTool::mouse_down(GdkEventButton* event, WindstilleWidget& wst)
 {
   click_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
@@ -61,11 +61,9 @@
       selection.clear();
       mode = SELECT_MODE;
     }
-
-  return true;
 }
 
-bool
+void
 NavgraphSelectTool::mouse_move(GdkEventMotion* event, WindstilleWidget& wst)
 {
   Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
@@ -87,11 +85,9 @@
       case NO_MODE:
         break;
     }
-
-  return true;
 }
 
-bool
+void
 NavgraphSelectTool::mouse_up(GdkEventButton* event, WindstilleWidget& wst)
 {
   Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
@@ -117,8 +113,6 @@
     }
 
   mode = NO_MODE;
-
-  return true;
 }
 
 void

Modified: trunk/windstille/src/editor/navgraph_select_tool.hpp
===================================================================
--- trunk/windstille/src/editor/navgraph_select_tool.hpp	2009-04-08 16:54:59 UTC (rev 2898)
+++ trunk/windstille/src/editor/navgraph_select_tool.hpp	2009-04-08 17:14:40 UTC (rev 2899)
@@ -43,9 +43,9 @@
   NavgraphSelectTool();
   ~NavgraphSelectTool();
 
-  bool mouse_down(GdkEventButton* event, WindstilleWidget& wst);
-  bool mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
-  bool mouse_up(GdkEventButton* event, WindstilleWidget& wst);
+  void mouse_down(GdkEventButton* event, WindstilleWidget& wst);
+  void mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
+  void mouse_up(GdkEventButton* event, WindstilleWidget& wst);
   
   void draw(SceneContext& sc);
 

Modified: trunk/windstille/src/editor/scroll_tool.cpp
===================================================================
--- trunk/windstille/src/editor/scroll_tool.cpp	2009-04-08 16:54:59 UTC (rev 2898)
+++ trunk/windstille/src/editor/scroll_tool.cpp	2009-04-08 17:14:40 UTC (rev 2899)
@@ -21,36 +21,37 @@
 #include "scroll_tool.hpp"
 
 ScrollTool::ScrollTool()
+  : mode(NO_MODE)
 {
 }
 
-bool
+void
 ScrollTool::mouse_down(GdkEventButton* event, WindstilleWidget& wst)
 {
   orig_state = wst.get_state().clone();
   orig_click = orig_state.screen_to_world(Vector2f(event->x, event->y));
-  
-  return true;
+  mode = SCROLLING;
 }
 
-bool
+void
 ScrollTool::mouse_move(GdkEventMotion* event, WindstilleWidget& wst)
 {
-  Vector2f offset = orig_click - orig_state.screen_to_world(Vector2f(event->x, event->y));
-
-  wst.get_state().set_pos(orig_state.get_pos() + offset);
-
-  return true;
+  if (mode == SCROLLING)
+    {
+      Vector2f offset = orig_click - orig_state.screen_to_world(Vector2f(event->x, event->y));
+      wst.get_state().set_pos(orig_state.get_pos() + offset);
+    }
 }
 
-bool
+void
 ScrollTool::mouse_up(GdkEventButton* event, WindstilleWidget& wst)
 {
-  Vector2f offset = orig_click - orig_state.screen_to_world(Vector2f(event->x, event->y));
-
-  wst.get_state().set_pos(orig_state.get_pos() + offset);
-
-  return true;
+  if (mode == SCROLLING)
+    {
+      Vector2f offset = orig_click - orig_state.screen_to_world(Vector2f(event->x, event->y));
+      wst.get_state().set_pos(orig_state.get_pos() + offset);
+      mode = NO_MODE;
+    }
 }
 
 /* EOF */

Modified: trunk/windstille/src/editor/scroll_tool.hpp
===================================================================
--- trunk/windstille/src/editor/scroll_tool.hpp	2009-04-08 16:54:59 UTC (rev 2898)
+++ trunk/windstille/src/editor/scroll_tool.hpp	2009-04-08 17:14:40 UTC (rev 2899)
@@ -28,13 +28,14 @@
 private:
   GraphicContextState orig_state;
   Vector2f orig_click;
+  enum { SCROLLING, NO_MODE } mode;
 
 public:
   ScrollTool();
 
-  virtual bool mouse_down(GdkEventButton* event, WindstilleWidget& wst);
-  virtual bool mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
-  virtual bool mouse_up(GdkEventButton* event, WindstilleWidget& wst);
+  virtual void mouse_down(GdkEventButton* event, WindstilleWidget& wst);
+  virtual void mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
+  virtual void mouse_up(GdkEventButton* event, WindstilleWidget& wst);
 
 private:
   ScrollTool(const ScrollTool&);

Modified: trunk/windstille/src/editor/select_tool.cpp
===================================================================
--- trunk/windstille/src/editor/select_tool.cpp	2009-04-08 16:54:59 UTC (rev 2898)
+++ trunk/windstille/src/editor/select_tool.cpp	2009-04-08 17:14:40 UTC (rev 2899)
@@ -27,7 +27,7 @@
 {
 }
 
-bool
+void
 SelectTool::mouse_down(GdkEventButton* event, WindstilleWidget& wst)
 {
   click_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
@@ -84,8 +84,6 @@
           mode = SELECT_MODE;
         }
     }
-
-  return true;
 }
 
 Vector2f
@@ -115,7 +113,7 @@
   return best_snap.offset;
 }
 
-bool
+void
 SelectTool::mouse_move(GdkEventMotion* event, WindstilleWidget& wst)
 {
   Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
@@ -140,11 +138,9 @@
       rect.right  = pos.x;
       rect.bottom = pos.y;
     }
-  
-  return true;
 }
 
-bool
+void
 SelectTool::mouse_up(GdkEventButton* event, WindstilleWidget& wst)
 {
   Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
@@ -184,8 +180,6 @@
     }
 
   mode = NO_MODE;
-
-  return true;
 }
 
 void

Modified: trunk/windstille/src/editor/select_tool.hpp
===================================================================
--- trunk/windstille/src/editor/select_tool.hpp	2009-04-08 16:54:59 UTC (rev 2898)
+++ trunk/windstille/src/editor/select_tool.hpp	2009-04-08 17:14:40 UTC (rev 2899)
@@ -43,9 +43,9 @@
 public:
   SelectTool();
   
-  bool mouse_down (GdkEventButton* event, WindstilleWidget& wst);
-  bool mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
-  bool mouse_up(GdkEventButton* event, WindstilleWidget& wst);
+  void mouse_down (GdkEventButton* event, WindstilleWidget& wst);
+  void mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
+  void mouse_up(GdkEventButton* event, WindstilleWidget& wst);
 
   void draw(SceneContext& sc);
 

Modified: trunk/windstille/src/editor/tool.hpp
===================================================================
--- trunk/windstille/src/editor/tool.hpp	2009-04-08 16:54:59 UTC (rev 2898)
+++ trunk/windstille/src/editor/tool.hpp	2009-04-08 17:14:40 UTC (rev 2899)
@@ -30,9 +30,9 @@
   Tool() {}
   virtual ~Tool() {}
 
-  virtual bool mouse_down (GdkEventButton* event, WindstilleWidget& wst) = 0;
-  virtual bool mouse_move(GdkEventMotion* event, WindstilleWidget& wst) = 0;
-  virtual bool mouse_up(GdkEventButton* event, WindstilleWidget& wst) = 0;
+  virtual void mouse_down (GdkEventButton* event, WindstilleWidget& wst) = 0;
+  virtual void mouse_move(GdkEventMotion* event, WindstilleWidget& wst) = 0;
+  virtual void mouse_up(GdkEventButton* event, WindstilleWidget& wst) = 0;
   virtual void draw(SceneContext& sc) {}
 
 private:

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-08 16:54:59 UTC (rev 2898)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-08 17:14:40 UTC (rev 2899)
@@ -271,8 +271,11 @@
           (*i)->draw(*sc);
         }
 
+      std::cout << "Drawing stuff" << (EditorWindow::current()->get_current_tool()) << std::endl;
       if (EditorWindow::current()->get_current_tool())
-        EditorWindow::current()->get_current_tool()->draw(*sc);
+        {
+          EditorWindow::current()->get_current_tool()->draw(*sc);
+        }
 
       sc->render();
       state.pop(*sc);

Modified: trunk/windstille/src/editor/zoom_tool.cpp
===================================================================
--- trunk/windstille/src/editor/zoom_tool.cpp	2009-04-08 16:54:59 UTC (rev 2898)
+++ trunk/windstille/src/editor/zoom_tool.cpp	2009-04-08 17:14:40 UTC (rev 2899)
@@ -25,15 +25,14 @@
 {
 }
 
-bool
+void
 ZoomTool::mouse_down (GdkEventButton* event, WindstilleWidget& wst)
 {
   click_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
   rect_valid = false;
-  return true;
 }
 
-bool
+void
 ZoomTool::mouse_move(GdkEventMotion* event, WindstilleWidget& wst)
 {
   Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
@@ -44,17 +43,15 @@
   rect.bottom = pos.y;
   
   rect_valid = true;
-  return true;
 }
 
-bool
+void
 ZoomTool::mouse_up(GdkEventButton* event, WindstilleWidget& wst)
 {
   //std::cout << "Zoom To: " << rect << std::endl;
   rect.normalize();
   wst.get_state().zoom_to(rect);
   rect_valid = false;
-  return true;
 }
 
 void

Modified: trunk/windstille/src/editor/zoom_tool.hpp
===================================================================
--- trunk/windstille/src/editor/zoom_tool.hpp	2009-04-08 16:54:59 UTC (rev 2898)
+++ trunk/windstille/src/editor/zoom_tool.hpp	2009-04-08 17:14:40 UTC (rev 2899)
@@ -32,9 +32,9 @@
 public:
   ZoomTool();
   
-  bool mouse_down (GdkEventButton* event, WindstilleWidget& wst);
-  bool mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
-  bool mouse_up(GdkEventButton* event, WindstilleWidget& wst);
+  void mouse_down (GdkEventButton* event, WindstilleWidget& wst);
+  void mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
+  void mouse_up(GdkEventButton* event, WindstilleWidget& wst);
   void draw(SceneContext& sc);
 
 private:



From grumbel at mail.berlios.de  Wed Apr  8 19:29:58 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 8 Apr 2009 19:29:58 +0200
Subject: [Windstille-commit] r2900 - trunk/windstille/src/editor
Message-ID: <200904081729.n38HTvNX006359@sheep.berlios.de>

Author: grumbel
Date: 2009-04-08 19:29:56 +0200 (Wed, 08 Apr 2009)
New Revision: 2900

Modified:
   trunk/windstille/src/editor/navgraph_insert_tool.cpp
   trunk/windstille/src/editor/navgraph_insert_tool.hpp
   trunk/windstille/src/editor/navgraph_select_tool.cpp
   trunk/windstille/src/editor/tool.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
   trunk/windstille/src/editor/windstille_widget.hpp
Log:
Removed active_tool thing from WindstilleWidget so that tools can draw things properly

Modified: trunk/windstille/src/editor/navgraph_insert_tool.cpp
===================================================================
--- trunk/windstille/src/editor/navgraph_insert_tool.cpp	2009-04-08 17:14:40 UTC (rev 2899)
+++ trunk/windstille/src/editor/navgraph_insert_tool.cpp	2009-04-08 17:29:56 UTC (rev 2900)
@@ -45,6 +45,7 @@
             { // connect last node with existing node
               navgraph.add_edge(last_node, node);
               last_node = NodeHandle();
+              connection_node = NodeHandle();
             }
           else
             { // connect last node with newly created node
@@ -83,18 +84,20 @@
 void
 NavgraphInsertTool::mouse_move(GdkEventMotion* event, WindstilleWidget& wst)
 {
+  NavigationGraph& navgraph = *wst.get_sector_model()->get_nav_graph();
+
   mouse_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
 
   switch(mode)
     {
       case EDGE_MODE:
+        connection_node = navgraph.find_closest_node(mouse_pos, 16.0f); // FIXME: Radius should scale with zoom
+        wst.queue_draw();
         break;
 
       case NO_MODE:
         break;
     }
-
-  wst.queue_draw();
 }
 
 void
@@ -106,22 +109,32 @@
   switch(mode)
     {
       case EDGE_MODE:
+        connection_node = NodeHandle();
+        wst.queue_draw();
         break;
 
       case NO_MODE:
         break;
     }
-
-  wst.queue_draw();
 }
   
 void
 NavgraphInsertTool::draw(SceneContext& sc)
 {
   std::cout << "Draw: " << last_node << std::endl;
+
   if (last_node)
     {
-      sc.control().draw_line(last_node->get_pos(), mouse_pos, Color(1,1,1));
+      if (connection_node)
+        {
+          sc.control().draw_line(last_node->get_pos(), connection_node->get_pos(), Color(1,1,1));
+          sc.control().draw_rect(Rectf(connection_node->get_pos() - Vector2f(16,16), Sizef(32,32)), Color(1.0f, 1.0f, 1.0f));
+        }
+      else
+        {
+          sc.control().draw_line(last_node->get_pos(), mouse_pos, Color(1,1,1));
+        }
+
       sc.control().draw_rect(Rectf(last_node->get_pos() - Vector2f(16,16), Sizef(32,32)), Color(1.0f, 1.0f, 1.0f));
     }
 }

Modified: trunk/windstille/src/editor/navgraph_insert_tool.hpp
===================================================================
--- trunk/windstille/src/editor/navgraph_insert_tool.hpp	2009-04-08 17:14:40 UTC (rev 2899)
+++ trunk/windstille/src/editor/navgraph_insert_tool.hpp	2009-04-08 17:29:56 UTC (rev 2900)
@@ -36,6 +36,7 @@
   } mode;
 
   NodeHandle last_node;
+  NodeHandle connection_node;
 
 public:
   NavgraphInsertTool();

Modified: trunk/windstille/src/editor/navgraph_select_tool.cpp
===================================================================
--- trunk/windstille/src/editor/navgraph_select_tool.cpp	2009-04-08 17:14:40 UTC (rev 2899)
+++ trunk/windstille/src/editor/navgraph_select_tool.cpp	2009-04-08 17:29:56 UTC (rev 2900)
@@ -74,12 +74,14 @@
         {
           NodeHandle node = *selection.begin();
           node->set_pos(pos);
+          wst.queue_draw();
         }
         break;
 
       case SELECT_MODE:
         rect.right  = pos.x;
         rect.bottom = pos.y;
+        wst.queue_draw();
         break;
 
       case NO_MODE:
@@ -96,6 +98,7 @@
   switch(mode)
     {
       case DRAG_MODE:
+        wst.queue_draw();
         break;
 
       case SELECT_MODE:

Modified: trunk/windstille/src/editor/tool.hpp
===================================================================
--- trunk/windstille/src/editor/tool.hpp	2009-04-08 17:14:40 UTC (rev 2899)
+++ trunk/windstille/src/editor/tool.hpp	2009-04-08 17:29:56 UTC (rev 2900)
@@ -33,6 +33,7 @@
   virtual void mouse_down (GdkEventButton* event, WindstilleWidget& wst) = 0;
   virtual void mouse_move(GdkEventMotion* event, WindstilleWidget& wst) = 0;
   virtual void mouse_up(GdkEventButton* event, WindstilleWidget& wst) = 0;
+
   virtual void draw(SceneContext& sc) {}
 
 private:

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-08 17:14:40 UTC (rev 2899)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-08 17:29:56 UTC (rev 2900)
@@ -41,7 +41,6 @@
                                    const Glib::RefPtr<const Gdk::GL::Context>& share_list)
   : editor(editor_),
     sector_model(new SectorModel()),
-    active_tool(0),
     scroll_tool(new ScrollTool()),
     map_type(DecalObjectModel::COLORMAP),
     draw_background_pattern(true),
@@ -493,14 +492,12 @@
   //ewer->on_mouse_button_down(Vector2i(event->x, event->y), event->button);
   if (event->button == 1)
     { // Tool
-      active_tool = EditorWindow::current()->get_current_tool();
-      active_tool->mouse_down(event, *this);
+      EditorWindow::current()->get_current_tool()->mouse_down(event, *this);
       return true;
     }
   else if (event->button == 2)
     { // Scroll
-      active_tool = scroll_tool.get();
-      active_tool->mouse_down(event, *this);
+      scroll_tool->mouse_down(event, *this);
       return true;
     }
   else if (event->button == 3)
@@ -520,11 +517,8 @@
 {
   //std::cout << "Motion: " << event->x << ", " << event->y << std::endl;
   
-  if (active_tool)
-    {
-      active_tool->mouse_move(event, *this);
-      queue_draw();
-    }
+  EditorWindow::current()->get_current_tool()->mouse_move(event, *this);
+  scroll_tool->mouse_move(event, *this);
   
   return true;
 }
@@ -532,8 +526,6 @@
 bool
 WindstilleWidget::mouse_up(GdkEventButton* event)
 {
-  active_tool = 0;
-
   //std::cout << "Button Release: " << event->x << ", " << event->y << " - " << event->button << std::endl;
   //viewer->on_mouse_button_up(Vector2i(event->x, event->y), event->button);
   if (event->button == 1)
@@ -546,6 +538,7 @@
       scroll_tool->mouse_up(event, *this);
       queue_draw();
     }
+
   return false;
 }
 

Modified: trunk/windstille/src/editor/windstille_widget.hpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.hpp	2009-04-08 17:14:40 UTC (rev 2899)
+++ trunk/windstille/src/editor/windstille_widget.hpp	2009-04-08 17:29:56 UTC (rev 2900)
@@ -60,7 +60,6 @@
 
   GraphicContextState   state;
   std::auto_ptr<SceneContext> sc;
-  Tool* active_tool;
   std::auto_ptr<ScrollTool> scroll_tool;
   SelectionHandle selection;
   DecalObjectModel::MapType map_type;



From grumbel at mail.berlios.de  Wed Apr  8 22:29:47 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 8 Apr 2009 22:29:47 +0200
Subject: [Windstille-commit] r2901 - in trunk/windstille/src: . editor
Message-ID: <200904082029.n38KTlaO016077@sheep.berlios.de>

Author: grumbel
Date: 2009-04-08 22:29:46 +0200 (Wed, 08 Apr 2009)
New Revision: 2901

Added:
   trunk/windstille/src/editor/node_selection.cpp
Modified:
   trunk/windstille/src/SConscript
   trunk/windstille/src/editor/navgraph_insert_tool.cpp
   trunk/windstille/src/editor/navgraph_insert_tool.hpp
   trunk/windstille/src/editor/navgraph_select_tool.cpp
   trunk/windstille/src/editor/scroll_tool.cpp
   trunk/windstille/src/editor/sector_model.cpp
   trunk/windstille/src/editor/select_tool.cpp
   trunk/windstille/src/editor/select_tool.hpp
   trunk/windstille/src/editor/tool.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
   trunk/windstille/src/editor/zoom_tool.cpp
   trunk/windstille/src/editor/zoom_tool.hpp
Log:
Fixed a bunch of drawing bugs to due changes in active_tool handling

Modified: trunk/windstille/src/SConscript
===================================================================
--- trunk/windstille/src/SConscript	2009-04-08 17:29:56 UTC (rev 2900)
+++ trunk/windstille/src/SConscript	2009-04-08 20:29:46 UTC (rev 2901)
@@ -258,6 +258,7 @@
         'editor/sector_model.cpp',
         'editor/select_tool.cpp',
         'editor/selection.cpp',
+        'editor/node_selection.cpp',
         'editor/sprite_object_model.cpp',
         'editor/windstille_widget.cpp',
         'editor/zoom_tool.cpp',

Modified: trunk/windstille/src/editor/navgraph_insert_tool.cpp
===================================================================
--- trunk/windstille/src/editor/navgraph_insert_tool.cpp	2009-04-08 17:29:56 UTC (rev 2900)
+++ trunk/windstille/src/editor/navgraph_insert_tool.cpp	2009-04-08 20:29:46 UTC (rev 2901)
@@ -19,7 +19,9 @@
 #include "sector_model.hpp"
 #include "navigation/navigation_graph.hpp"
 #include "navigation/node.hpp"
+#include "navigation/edge.hpp"
 #include "windstille_widget.hpp"
+#include "editor_window.hpp"
 
 #include "navgraph_insert_tool.hpp"
 
@@ -85,9 +87,22 @@
 NavgraphInsertTool::mouse_move(GdkEventMotion* event, WindstilleWidget& wst)
 {
   NavigationGraph& navgraph = *wst.get_sector_model()->get_nav_graph();
-
   mouse_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
 
+  {
+    NodeHandle new_mouse_over_node = navgraph.find_closest_node(mouse_pos, 16.0f); // FIXME: Radius should scale with zoom
+    EdgeHandle new_mouse_over_edge = navgraph.find_closest_edge(mouse_pos, 16.0f);
+
+    if (new_mouse_over_node != mouse_over_node ||
+        new_mouse_over_edge != mouse_over_edge)
+      {
+        mouse_over_node = new_mouse_over_node; 
+        mouse_over_edge = new_mouse_over_edge; 
+
+        wst.queue_draw();
+      }
+  }
+
   switch(mode)
     {
       case EDGE_MODE:
@@ -117,12 +132,42 @@
         break;
     }
 }
+
+void
+NavgraphInsertTool::mouse_right_down(GdkEventButton* event, WindstilleWidget& wst)
+{
+  NavigationGraph& navgraph = *wst.get_sector_model()->get_nav_graph();
+
+  NodeHandle node = navgraph.find_closest_node(mouse_pos, 16.0f); // FIXME: Radius should scale with zoom
+  EdgeHandle edge = navgraph.find_closest_edge(mouse_pos, 16.0f);
+
+  if (node)
+    {
+      navgraph.remove_node(node);
+
+      mouse_over_edge = EdgeHandle();
+      mouse_over_node = NodeHandle();
+
+      wst.queue_draw();
+    }
+  else if (edge)
+    {
+      navgraph.remove_edge(edge);
+
+      mouse_over_edge = EdgeHandle();
+      mouse_over_node = NodeHandle();
+
+      wst.queue_draw();
+    }
+  else
+    {
+      
+    }
+}  
   
 void
 NavgraphInsertTool::draw(SceneContext& sc)
 {
-  std::cout << "Draw: " << last_node << std::endl;
-
   if (last_node)
     {
       if (connection_node)
@@ -137,6 +182,16 @@
 
       sc.control().draw_rect(Rectf(last_node->get_pos() - Vector2f(16,16), Sizef(32,32)), Color(1.0f, 1.0f, 1.0f));
     }
+
+  if (mouse_over_node)
+    {
+      sc.control().draw_rect(Rectf(mouse_over_node->get_pos() - Vector2f(16,16), Sizef(32,32)), Color(1.0f, 1.0f, 1.0f));      
+    }
+  else if (mouse_over_edge)
+    {
+      sc.control().draw_line(mouse_over_edge->get_node1()->get_pos(), 
+                             mouse_over_edge->get_node2()->get_pos(), Color(1,1,1));
+    }
 }
   
 /* EOF */

Modified: trunk/windstille/src/editor/navgraph_insert_tool.hpp
===================================================================
--- trunk/windstille/src/editor/navgraph_insert_tool.hpp	2009-04-08 17:29:56 UTC (rev 2900)
+++ trunk/windstille/src/editor/navgraph_insert_tool.hpp	2009-04-08 20:29:46 UTC (rev 2901)
@@ -38,6 +38,9 @@
   NodeHandle last_node;
   NodeHandle connection_node;
 
+  NodeHandle mouse_over_node;
+  EdgeHandle mouse_over_edge;
+
 public:
   NavgraphInsertTool();
 
@@ -45,6 +48,8 @@
   void mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
   void mouse_up(GdkEventButton* event, WindstilleWidget& wst);
   
+  void mouse_right_down(GdkEventButton* event, WindstilleWidget& wst);
+
   void draw(SceneContext& sc);
 
 private:

Modified: trunk/windstille/src/editor/navgraph_select_tool.cpp
===================================================================
--- trunk/windstille/src/editor/navgraph_select_tool.cpp	2009-04-08 17:29:56 UTC (rev 2900)
+++ trunk/windstille/src/editor/navgraph_select_tool.cpp	2009-04-08 20:29:46 UTC (rev 2901)
@@ -48,7 +48,6 @@
     }
   else if (edge)
     {
-      navgraph.remove_edge(edge);
       mode = NO_MODE;
     }
   else
@@ -127,7 +126,6 @@
       sc.control().draw_rect(rect, Color(1.0f, 0.5f, 0.5f)); 
     }
 
-  std::cout << "NavgraphInsertTool::draw: " << selection.size() << std::endl;
   for(std::set<NodeHandle>::const_iterator i = selection.begin(); i != selection.end(); ++i)
     {
       sc.control().draw_rect(Rectf((*i)->get_pos() - Vector2f(16,16), Sizef(32,32)), Color(1.0f, 1.0f, 1.0f));

Added: trunk/windstille/src/editor/node_selection.cpp
===================================================================
--- trunk/windstille/src/editor/node_selection.cpp	2009-04-08 17:29:56 UTC (rev 2900)
+++ trunk/windstille/src/editor/node_selection.cpp	2009-04-08 20:29:46 UTC (rev 2901)
@@ -0,0 +1,29 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#include "node_selection.hpp"
+
+NodeSelection::NodeSelection()
+{
+}
+
+NodeSelection::~NodeSelection()
+{
+}
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/node_selection.cpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Modified: trunk/windstille/src/editor/scroll_tool.cpp
===================================================================
--- trunk/windstille/src/editor/scroll_tool.cpp	2009-04-08 17:29:56 UTC (rev 2900)
+++ trunk/windstille/src/editor/scroll_tool.cpp	2009-04-08 20:29:46 UTC (rev 2901)
@@ -31,6 +31,7 @@
   orig_state = wst.get_state().clone();
   orig_click = orig_state.screen_to_world(Vector2f(event->x, event->y));
   mode = SCROLLING;
+  wst.queue_draw();
 }
 
 void
@@ -40,6 +41,7 @@
     {
       Vector2f offset = orig_click - orig_state.screen_to_world(Vector2f(event->x, event->y));
       wst.get_state().set_pos(orig_state.get_pos() + offset);
+      wst.queue_draw();
     }
 }
 
@@ -51,6 +53,7 @@
       Vector2f offset = orig_click - orig_state.screen_to_world(Vector2f(event->x, event->y));
       wst.get_state().set_pos(orig_state.get_pos() + offset);
       mode = NO_MODE;
+      wst.queue_draw();
     }
 }
 

Modified: trunk/windstille/src/editor/sector_model.cpp
===================================================================
--- trunk/windstille/src/editor/sector_model.cpp	2009-04-08 17:29:56 UTC (rev 2900)
+++ trunk/windstille/src/editor/sector_model.cpp	2009-04-08 20:29:46 UTC (rev 2901)
@@ -37,14 +37,7 @@
 
 SectorModel::SectorModel()
  : nav_graph(new NavigationGraph())
-{  
-  try {
-    FileReader reader = FileReader::parse("navigation.nav");
-    nav_graph->load(reader);
-  } catch(std::exception& err) {
-    std::cout << "NavigationTest: " << err.what() << std::endl;
-  }
-
+{
   layer_tree = Gtk::TreeStore::create(LayerManagerColumns::instance());
 
   Gtk::TreeStore::iterator it = layer_tree->append();

Modified: trunk/windstille/src/editor/select_tool.cpp
===================================================================
--- trunk/windstille/src/editor/select_tool.cpp	2009-04-08 17:29:56 UTC (rev 2900)
+++ trunk/windstille/src/editor/select_tool.cpp	2009-04-08 20:29:46 UTC (rev 2901)
@@ -16,9 +16,12 @@
 **  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
 
+#include <gtkmm/menu.h>
+
 #include "display/scene_context.hpp"
 #include "sector_model.hpp"
 #include "windstille_widget.hpp"
+#include "editor_window.hpp"
 #include "select_tool.hpp"
 
 SelectTool::SelectTool()
@@ -84,6 +87,8 @@
           mode = SELECT_MODE;
         }
     }
+
+  wst.queue_draw();
 }
 
 Vector2f
@@ -121,6 +126,7 @@
   if (mode == CONTROL_DRAG_MODE)
     {
       ctrl_point->on_move_update(pos - click_pos);
+      wst.queue_draw();
     }
   else if (mode == OBJECT_DRAG_MODE)
     {
@@ -130,6 +136,8 @@
         {
           selection->on_move_update(pos - click_pos + process_snap(wst));
         }
+
+      wst.queue_draw();
     }
   else if (mode == SELECT_MODE)
     {
@@ -137,6 +145,8 @@
       rect.top    = click_pos.y;
       rect.right  = pos.x;
       rect.bottom = pos.y;
+
+      wst.queue_draw();
     }
 }
 
@@ -150,6 +160,7 @@
     {
       ctrl_point->on_move_end(pos - click_pos);
       wst.create_control_points();
+      wst.queue_draw();
     }
   else if (mode == OBJECT_DRAG_MODE)
     {
@@ -163,6 +174,7 @@
         {
           selection->on_move_end(pos - click_pos);
         }
+      wst.queue_draw();
     }
   else if (mode == SELECT_MODE)
     {
@@ -177,12 +189,20 @@
         {
           wst.set_selection(wst.get_sector_model()->get_selection(rect, wst.get_select_mask()));
         }
+      wst.queue_draw();
     }
 
   mode = NO_MODE;
 }
 
 void
+SelectTool::mouse_right_down(GdkEventButton* event, WindstilleWidget& wst)
+{
+  Gtk::Menu* menu = static_cast<Gtk::Menu*>(EditorWindow::current()->get_ui_manager()->get_widget("/PopupMenu"));
+  menu->popup(event->button, event->time);
+}
+
+void
 SelectTool::draw(SceneContext& sc)
 {
   if (mode == SELECT_MODE)

Modified: trunk/windstille/src/editor/select_tool.hpp
===================================================================
--- trunk/windstille/src/editor/select_tool.hpp	2009-04-08 17:29:56 UTC (rev 2900)
+++ trunk/windstille/src/editor/select_tool.hpp	2009-04-08 20:29:46 UTC (rev 2901)
@@ -44,9 +44,11 @@
   SelectTool();
   
   void mouse_down (GdkEventButton* event, WindstilleWidget& wst);
+  void mouse_up(GdkEventButton* event, WindstilleWidget& wst);
   void mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
-  void mouse_up(GdkEventButton* event, WindstilleWidget& wst);
 
+  void mouse_right_down(GdkEventButton* event, WindstilleWidget& wst);
+
   void draw(SceneContext& sc);
 
 private:

Modified: trunk/windstille/src/editor/tool.hpp
===================================================================
--- trunk/windstille/src/editor/tool.hpp	2009-04-08 17:29:56 UTC (rev 2900)
+++ trunk/windstille/src/editor/tool.hpp	2009-04-08 20:29:46 UTC (rev 2901)
@@ -31,9 +31,11 @@
   virtual ~Tool() {}
 
   virtual void mouse_down (GdkEventButton* event, WindstilleWidget& wst) = 0;
+  virtual void mouse_up(GdkEventButton* event, WindstilleWidget& wst) = 0;
   virtual void mouse_move(GdkEventMotion* event, WindstilleWidget& wst) = 0;
-  virtual void mouse_up(GdkEventButton* event, WindstilleWidget& wst) = 0;
 
+  virtual void mouse_right_down(GdkEventButton* event, WindstilleWidget& wst) {}
+
   virtual void draw(SceneContext& sc) {}
 
 private:

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-08 17:29:56 UTC (rev 2900)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-08 20:29:46 UTC (rev 2901)
@@ -270,7 +270,6 @@
           (*i)->draw(*sc);
         }
 
-      std::cout << "Drawing stuff" << (EditorWindow::current()->get_current_tool()) << std::endl;
       if (EditorWindow::current()->get_current_tool())
         {
           EditorWindow::current()->get_current_tool()->draw(*sc);
@@ -502,8 +501,7 @@
     }
   else if (event->button == 3)
     { // Context Menu
-      Gtk::Menu* menu = static_cast<Gtk::Menu*>(editor.get_ui_manager()->get_widget("/PopupMenu"));
-      menu->popup(event->button, event->time);
+      EditorWindow::current()->get_current_tool()->mouse_right_down(event, *this);
       return true;
     }
   else

Modified: trunk/windstille/src/editor/zoom_tool.cpp
===================================================================
--- trunk/windstille/src/editor/zoom_tool.cpp	2009-04-08 17:29:56 UTC (rev 2900)
+++ trunk/windstille/src/editor/zoom_tool.cpp	2009-04-08 20:29:46 UTC (rev 2901)
@@ -21,44 +21,62 @@
 #include "zoom_tool.hpp"
 
 ZoomTool::ZoomTool()
-  : rect_valid(false)
+  : mode(NO_MODE)
 {
 }
 
 void
 ZoomTool::mouse_down (GdkEventButton* event, WindstilleWidget& wst)
 {
-  click_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
-  rect_valid = false;
+  if (mode == NO_MODE)
+    {
+      mouse_pos = click_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+
+      mode = RECT_MODE;
+
+      wst.queue_draw();
+    }
 }
 
 void
 ZoomTool::mouse_move(GdkEventMotion* event, WindstilleWidget& wst)
 {
-  Vector2f pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
-
-  rect.left   = click_pos.x;
-  rect.top    = click_pos.y;
-  rect.right  = pos.x;
-  rect.bottom = pos.y;
-  
-  rect_valid = true;
+  if (mode == RECT_MODE)
+    {
+      mouse_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
+      wst.queue_draw();
+    }
 }
 
 void
 ZoomTool::mouse_up(GdkEventButton* event, WindstilleWidget& wst)
 {
-  //std::cout << "Zoom To: " << rect << std::endl;
-  rect.normalize();
-  wst.get_state().zoom_to(rect);
-  rect_valid = false;
+  if (mode == RECT_MODE)
+    {
+      Rectf rect(click_pos, mouse_pos);
+      rect.normalize();
+      wst.get_state().zoom_to(rect);
+
+      mode = NO_MODE;
+
+      wst.queue_draw();
+    }
 }
 
 void
+ZoomTool::mouse_right_down(GdkEventButton* event, WindstilleWidget& wst)
+{
+  wst.on_zoom_out();
+}
+
+void
 ZoomTool::draw(SceneContext& sc)
 {
-  if (rect_valid)
+  if (mode == RECT_MODE)
     {
+      Rectf rect(click_pos, mouse_pos);
+      rect.normalize();
+
       sc.control().fill_rect(rect, Color(1.0f, 1.0f, 0.0f, 0.25));
       sc.control().draw_rect(rect, Color(1.0f, 1.0f, 0.0f)); 
     }

Modified: trunk/windstille/src/editor/zoom_tool.hpp
===================================================================
--- trunk/windstille/src/editor/zoom_tool.hpp	2009-04-08 17:29:56 UTC (rev 2900)
+++ trunk/windstille/src/editor/zoom_tool.hpp	2009-04-08 20:29:46 UTC (rev 2901)
@@ -26,15 +26,22 @@
 {
 private:
   Vector2f click_pos;
-  Rectf    rect;
-  bool     rect_valid;
+  Vector2f mouse_pos;
 
+  enum { 
+    RECT_MODE,
+    NO_MODE
+  } mode;
+
 public:
   ZoomTool();
   
   void mouse_down (GdkEventButton* event, WindstilleWidget& wst);
   void mouse_move(GdkEventMotion* event, WindstilleWidget& wst);
   void mouse_up(GdkEventButton* event, WindstilleWidget& wst);
+
+  void mouse_right_down(GdkEventButton* event, WindstilleWidget& wst);
+
   void draw(SceneContext& sc);
 
 private:



From grumbel at mail.berlios.de  Thu Apr  9 01:11:41 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 9 Apr 2009 01:11:41 +0200
Subject: [Windstille-commit] r2902 - trunk/windstille/src/editor
Message-ID: <200904082311.n38NBfRH031974@sheep.berlios.de>

Author: grumbel
Date: 2009-04-09 01:11:39 +0200 (Thu, 09 Apr 2009)
New Revision: 2902

Modified:
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/editor_window.hpp
   trunk/windstille/src/editor/sector_model.cpp
   trunk/windstille/src/editor/sector_model.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
Log:
Only show navgraph when a navgraph tool is active

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-08 20:29:46 UTC (rev 2901)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-08 23:11:39 UTC (rev 2902)
@@ -612,6 +612,8 @@
   if (action->get_active())
     {
       current_tool = tool;
+      if (WindstilleWidget* wst = get_windstille_widget())
+        wst->queue_draw();
     }
 }
 
@@ -764,6 +766,16 @@
     }
 }
 
+bool
+EditorWindow::get_draw_navgraph() const
+{
+  if (current_tool == navgraph_insert_tool.get() ||
+      current_tool == navgraph_select_tool.get())
+    return true;
+  else
+    return false;
+}
+
 void
 EditorWindow::on_switch_page(GtkNotebookPage* page, guint page_num)
 {

Modified: trunk/windstille/src/editor/editor_window.hpp
===================================================================
--- trunk/windstille/src/editor/editor_window.hpp	2009-04-08 20:29:46 UTC (rev 2901)
+++ trunk/windstille/src/editor/editor_window.hpp	2009-04-08 23:11:39 UTC (rev 2902)
@@ -156,6 +156,8 @@
 
   void add_recent_file(const std::string& filename);
 
+  bool get_draw_navgraph() const;
+
   void print(const std::string& text);
   bool remove_message(guint id);
 

Modified: trunk/windstille/src/editor/sector_model.cpp
===================================================================
--- trunk/windstille/src/editor/sector_model.cpp	2009-04-08 20:29:46 UTC (rev 2901)
+++ trunk/windstille/src/editor/sector_model.cpp	2009-04-08 23:11:39 UTC (rev 2902)
@@ -162,7 +162,7 @@
 }
 
 void
-SectorModel::draw(SceneContext& sc, const SelectMask& layermask)
+SectorModel::draw(SceneContext& sc, const SelectMask& layermask, bool draw_navgraph)
 {
   // Draw Layers
   const Layers& layers = get_layers();
@@ -174,17 +174,20 @@
     }
 
   // Draw Navgraph
-  for(NavigationGraph::Edges::iterator i = nav_graph->get_edges().begin(); i != nav_graph->get_edges().end(); ++i)
+  if (draw_navgraph)
     {
-      sc.control().draw_line(Line((*i)->get_node1()->get_pos(),
-                                  (*i)->get_node2()->get_pos()),
-                             Color(1.0f, 0.0f, 0.0f));
-    }
+      for(NavigationGraph::Edges::iterator i = nav_graph->get_edges().begin(); i != nav_graph->get_edges().end(); ++i)
+        {
+          sc.control().draw_line(Line((*i)->get_node1()->get_pos(),
+                                      (*i)->get_node2()->get_pos()),
+                                 Color(1.0f, 0.0f, 0.0f));
+        }
 
-  for(NavigationGraph::Nodes::iterator i = nav_graph->get_nodes().begin(); i != nav_graph->get_nodes().end(); ++i)
-    {
-      sc.control().fill_rect(Rectf((*i)->get_pos() - Vector2f(4,4), Sizef(9, 9)),
-                             Color(1.0f, 1.0f, 0.0f));
+      for(NavigationGraph::Nodes::iterator i = nav_graph->get_nodes().begin(); i != nav_graph->get_nodes().end(); ++i)
+        {
+          sc.control().fill_rect(Rectf((*i)->get_pos() - Vector2f(4,4), Sizef(9, 9)),
+                                 Color(1.0f, 1.0f, 0.0f));
+        }
     }
 }
 

Modified: trunk/windstille/src/editor/sector_model.hpp
===================================================================
--- trunk/windstille/src/editor/sector_model.hpp	2009-04-08 20:29:46 UTC (rev 2901)
+++ trunk/windstille/src/editor/sector_model.hpp	2009-04-08 23:11:39 UTC (rev 2902)
@@ -78,7 +78,7 @@
   SectorModel();
   ~SectorModel();
 
-  void draw(SceneContext& sc, const SelectMask& layers);
+  void draw(SceneContext& sc, const SelectMask& layers, bool draw_navgraph);
 
   void update(float delta);
   void update(float delta, const Gtk::TreeRow& row);

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-08 20:29:46 UTC (rev 2901)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-08 23:11:39 UTC (rev 2902)
@@ -250,9 +250,9 @@
         }
 
       if (draw_only_active_layers)
-        sector_model->draw(*sc, SelectMask());
+        sector_model->draw(*sc, SelectMask(), editor.get_draw_navgraph());
       else
-        sector_model->draw(*sc, select_mask);
+        sector_model->draw(*sc, select_mask, editor.get_draw_navgraph());
 
       if (!selection->empty())
         {



From grumbel at mail.berlios.de  Thu Apr  9 17:22:04 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 9 Apr 2009 17:22:04 +0200
Subject: [Windstille-commit] r2903 - trunk/windstille/src/editor
Message-ID: <200904091522.n39FM4vp005530@sheep.berlios.de>

Author: grumbel
Date: 2009-04-09 17:22:03 +0200 (Thu, 09 Apr 2009)
New Revision: 2903

Modified:
   trunk/windstille/src/editor/sector_model.cpp
Log:
Replaced Path::operator bool with \!Path::empty

Modified: trunk/windstille/src/editor/sector_model.cpp
===================================================================
--- trunk/windstille/src/editor/sector_model.cpp	2009-04-08 23:11:39 UTC (rev 2902)
+++ trunk/windstille/src/editor/sector_model.cpp	2009-04-09 15:22:03 UTC (rev 2903)
@@ -66,7 +66,7 @@
 {
   Gtk::TreeStore::iterator it;
 
-  if (!path)
+  if (path.empty())
     it = layer_tree->append();
   else
     it = layer_tree->append(layer_tree->get_iter(path)->children());
@@ -81,7 +81,7 @@
 void
 SectorModel::delete_layer(const Gtk::TreeModel::Path& path)
 {
-  if (!path)
+  if (path.empty())
     {
       EditorWindow::current()->print("SectorModel::delete_layer(): invalid empty path");
     }
@@ -94,7 +94,7 @@
 void
 SectorModel::add(const ObjectModelHandle& object, const Gtk::TreeModel::Path& path)
 {
-  if (!path)
+  if (path.empty())
     {
       EditorWindow::current()->print("SectorModel::add(): invalid empty path");
     }
@@ -132,7 +132,7 @@
 LayerHandle
 SectorModel::get_layer(const Gtk::TreeModel::Path& path) const
 {
-  if (path)
+  if (!path.empty())
     {
       Gtk::TreeModel::iterator it = layer_tree->get_iter(path);
       if (it)



From grumbel at mail.berlios.de  Thu Apr  9 20:05:08 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 9 Apr 2009 20:05:08 +0200
Subject: [Windstille-commit] r2904 - trunk/windstille/src/editor
Message-ID: <200904091805.n39I58ED028377@sheep.berlios.de>

Author: grumbel
Date: 2009-04-09 20:05:07 +0200 (Thu, 09 Apr 2009)
New Revision: 2904

Modified:
   trunk/windstille/src/editor/control_point.cpp
   trunk/windstille/src/editor/control_point.hpp
   trunk/windstille/src/editor/decal_object_model.cpp
   trunk/windstille/src/editor/select_tool.cpp
Log:
Pass GdkEventButton around

Modified: trunk/windstille/src/editor/control_point.cpp
===================================================================
--- trunk/windstille/src/editor/control_point.cpp	2009-04-09 15:22:03 UTC (rev 2903)
+++ trunk/windstille/src/editor/control_point.cpp	2009-04-09 18:05:07 UTC (rev 2904)
@@ -38,19 +38,19 @@
 
 
 void
-ControlPoint::on_move_start()
+ControlPoint::on_move_start(GdkEventButton* event)
 {
 }
 
 void
-ControlPoint::on_move_update(const Vector2f& offset_)
+ControlPoint::on_move_update(GdkEventMotion* event, const Vector2f& offset_)
 {
   offset = offset_;
   std::cout << "on_move_update: " << offset << std::endl;
 }
 
 void
-ControlPoint::on_move_end(const Vector2f& offset_)
+ControlPoint::on_move_end(GdkEventButton* event, const Vector2f& offset_)
 {
   offset = offset_;
   std::cout << "on_move_end: " << offset << std::endl;

Modified: trunk/windstille/src/editor/control_point.hpp
===================================================================
--- trunk/windstille/src/editor/control_point.hpp	2009-04-09 15:22:03 UTC (rev 2903)
+++ trunk/windstille/src/editor/control_point.hpp	2009-04-09 18:05:07 UTC (rev 2904)
@@ -20,6 +20,7 @@
 #define HEADER_WINDSTILLE_EDITOR_CONTROL_POINT_HPP
 
 #include <boost/shared_ptr.hpp>
+#include <gdkmm/event.h>
 
 #include "display/surface.hpp"
 #include "math/rect.hpp"
@@ -47,9 +48,9 @@
 
   virtual Rectf get_bounding_box() const;
 
-  virtual void on_move_start();
-  virtual void on_move_update(const Vector2f& offset);
-  virtual void on_move_end(const Vector2f& offset);
+  virtual void on_move_start(GdkEventButton* event);
+  virtual void on_move_update(GdkEventMotion* event, const Vector2f& offset);
+  virtual void on_move_end(GdkEventButton* event, const Vector2f& offset);
 
 private:
   ControlPoint(const ControlPoint&);

Modified: trunk/windstille/src/editor/decal_object_model.cpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.cpp	2009-04-09 15:22:03 UTC (rev 2903)
+++ trunk/windstille/src/editor/decal_object_model.cpp	2009-04-09 18:05:07 UTC (rev 2904)
@@ -17,11 +17,13 @@
 */
 
 #include <iostream>
+
 #include "util/file_reader.hpp"
 #include "display/surface.hpp"
 #include "display/drawing_parameters.hpp"
 #include "display/surface_drawing_parameters.hpp"
 #include "display/scene_context.hpp"
+
 #include "decal_object_model.hpp"
 
 ObjectModelHandle
@@ -187,11 +189,11 @@
   {
   }
 
-  void on_move_start() 
+  void on_move_start(GdkEventMotion* event) 
   {
   }
 
-  void on_move_update(const Vector2f& offset_) 
+  void on_move_update(GdkEventMotion* event, const Vector2f& offset_) 
   {
     offset = offset_;
 
@@ -205,9 +207,9 @@
     object->set_angle(new_angle);
   }
   
-  void on_move_end(const Vector2f& offset_)
+  void on_move_end(GdkEventMotion* event, const Vector2f& offset_)
   {
-    on_move_update(offset_);
+    on_move_update(event, offset_);
   }
 
   void draw(SceneContext& sc)
@@ -237,11 +239,11 @@
       y_scale(y_scale_)
   {}
 
-  void on_move_start() 
+  void on_move_start(GdkEventButton* event) 
   {
   }
 
-  void on_move_update(const Vector2f& offset_) 
+  void on_move_update(GdkEventMotion* event, const Vector2f& offset_) 
   {
     offset = offset_; 
 
@@ -268,9 +270,9 @@
     object->set_scale(new_scale);
   }
   
-  void on_move_end(const Vector2f& offset_)
+  void on_move_end(GdkEventButton* event, const Vector2f& offset_)
   {
-    on_move_update(offset_);
+    on_move_update(0/*event*/, offset_);
   }
 
   void draw(SceneContext& sc)

Modified: trunk/windstille/src/editor/select_tool.cpp
===================================================================
--- trunk/windstille/src/editor/select_tool.cpp	2009-04-09 15:22:03 UTC (rev 2903)
+++ trunk/windstille/src/editor/select_tool.cpp	2009-04-09 18:05:07 UTC (rev 2904)
@@ -40,7 +40,7 @@
     {
       mode = CONTROL_DRAG_MODE;
       wst.clear_control_points();
-      ctrl_point->on_move_start();
+      ctrl_point->on_move_start(event);
     }
   else
     {  
@@ -125,7 +125,7 @@
 
   if (mode == CONTROL_DRAG_MODE)
     {
-      ctrl_point->on_move_update(pos - click_pos);
+      ctrl_point->on_move_update(event, pos - click_pos);
       wst.queue_draw();
     }
   else if (mode == OBJECT_DRAG_MODE)
@@ -158,7 +158,7 @@
   // Select objects
   if (mode == CONTROL_DRAG_MODE)
     {
-      ctrl_point->on_move_end(pos - click_pos);
+      ctrl_point->on_move_end(event, pos - click_pos);
       wst.create_control_points();
       wst.queue_draw();
     }



From grumbel at mail.berlios.de  Thu Apr  9 20:08:38 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 9 Apr 2009 20:08:38 +0200
Subject: [Windstille-commit] r2905 - trunk/windstille/src/editor
Message-ID: <200904091808.n39I8cx3028676@sheep.berlios.de>

Author: grumbel
Date: 2009-04-09 20:08:38 +0200 (Thu, 09 Apr 2009)
New Revision: 2905

Added:
   trunk/windstille/src/editor/decal_rotate_control_point.hpp
   trunk/windstille/src/editor/decal_scale_control_point.hpp
   trunk/windstille/src/editor/node_selection.hpp
Modified:
   trunk/windstille/src/editor/decal_object_model.cpp
Log:
Splitted of DecalScale/RotateControlPoint

Modified: trunk/windstille/src/editor/decal_object_model.cpp
===================================================================
--- trunk/windstille/src/editor/decal_object_model.cpp	2009-04-09 18:05:07 UTC (rev 2904)
+++ trunk/windstille/src/editor/decal_object_model.cpp	2009-04-09 18:08:38 UTC (rev 2905)
@@ -23,6 +23,8 @@
 #include "display/drawing_parameters.hpp"
 #include "display/surface_drawing_parameters.hpp"
 #include "display/scene_context.hpp"
+#include "decal_scale_control_point.hpp"
+#include "decal_rotate_control_point.hpp"
 
 #include "decal_object_model.hpp"
 
@@ -171,118 +173,6 @@
   writer.end_section();
 }
 
-class DecalRotateControlPoint : public ControlPoint
-{
-private:
-  DecalObjectModel* object;
-  float ctrl_angle;
-  float orig_angle;
-  Vector2f center;
-
-public:
-  DecalRotateControlPoint(DecalObjectModel* object_, float ctrl_angle_, const Vector2f& pos_)
-    : ControlPoint(Surface("editor/rotate_handle.png"), pos_),
-      object(object_),
-      ctrl_angle(ctrl_angle_),
-      orig_angle(object->get_angle()),
-      center(object->get_world_pos())
-  {
-  }
-
-  void on_move_start(GdkEventMotion* event) 
-  {
-  }
-
-  void on_move_update(GdkEventMotion* event, const Vector2f& offset_) 
-  {
-    offset = offset_;
-
-    Vector2f base = pos - center;
-    float base_angle = atan2(base.y, base.x);
-
-    Vector2f current = (pos+offset) - center;
-    float current_angle = atan2(current.y, current.x);
-
-    float new_angle = orig_angle + current_angle - base_angle;
-    object->set_angle(new_angle);
-  }
-  
-  void on_move_end(GdkEventMotion* event, const Vector2f& offset_)
-  {
-    on_move_update(event, offset_);
-  }
-
-  void draw(SceneContext& sc)
-  {
-    Rectf rect = get_bounding_box();
-    rect += offset;
-    sc.control().draw_control(surface, pos, ctrl_angle);
-  }
-};
-
-class DecalScaleControlPoint : public ControlPoint
-{
-private:
-  DecalObjectModel* object;
-  float ctrl_angle;
-  Vector2f orig_scale;
-  bool x_scale;
-  bool y_scale;
-
-public:
-  DecalScaleControlPoint(DecalObjectModel* object_, float ctrl_angle_, const Vector2f& pos_, bool x_scale_ = true, bool y_scale_ = true)
-    : ControlPoint(Surface("editor/scale_handle.png"), pos_),
-      object(object_),
-      ctrl_angle(ctrl_angle_),
-      orig_scale(object_->get_scale()),
-      x_scale(x_scale_),
-      y_scale(y_scale_)
-  {}
-
-  void on_move_start(GdkEventButton* event) 
-  {
-  }
-
-  void on_move_update(GdkEventMotion* event, const Vector2f& offset_) 
-  {
-    offset = offset_; 
-
-    Vector2f start   = pos - object->get_world_pos();
-    Vector2f current = (pos + offset) - object->get_world_pos();
-
-    start    = start.rotate(-object->get_angle());
-    current = current.rotate(-object->get_angle());
-    
-    Vector2f new_scale = orig_scale;
-
-    if (x_scale)
-      {
-        new_scale.x = current.x / start.x;
-        new_scale.x *= orig_scale.x;
-      }
-
-    if (y_scale)
-      {
-        new_scale.y = current.y / start.y;
-        new_scale.y *= orig_scale.y;
-      }
-
-    object->set_scale(new_scale);
-  }
-  
-  void on_move_end(GdkEventButton* event, const Vector2f& offset_)
-  {
-    on_move_update(0/*event*/, offset_);
-  }
-
-  void draw(SceneContext& sc)
-  {
-    Rectf rect = get_bounding_box();
-    rect += offset;
-    sc.control().draw_control(surface, pos, ctrl_angle);
-  }
-};
-
 bool
 DecalObjectModel::is_at(const Vector2f& pos) const
 {

Added: trunk/windstille/src/editor/decal_rotate_control_point.hpp
===================================================================
--- trunk/windstille/src/editor/decal_rotate_control_point.hpp	2009-04-09 18:05:07 UTC (rev 2904)
+++ trunk/windstille/src/editor/decal_rotate_control_point.hpp	2009-04-09 18:08:38 UTC (rev 2905)
@@ -0,0 +1,76 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#ifndef HEADER_WINDSTILLE_EDITOR_DECAL_ROTATE_CONTROL_POINT_HPP
+#define HEADER_WINDSTILLE_EDITOR_DECAL_ROTATE_CONTROL_POINT_HPP
+
+#include "decal_object_model.hpp"
+#include "control_point.hpp"
+
+class DecalRotateControlPoint : public ControlPoint
+{
+private:
+  DecalObjectModel* object;
+  float ctrl_angle;
+  float orig_angle;
+  Vector2f center;
+
+public:
+  DecalRotateControlPoint(DecalObjectModel* object_, float ctrl_angle_, const Vector2f& pos_)
+    : ControlPoint(Surface("editor/rotate_handle.png"), pos_),
+      object(object_),
+      ctrl_angle(ctrl_angle_),
+      orig_angle(object->get_angle()),
+      center(object->get_world_pos())
+  {
+  }
+
+  void on_move_start(GdkEventMotion* event) 
+  {
+  }
+
+  void on_move_update(GdkEventMotion* event, const Vector2f& offset_) 
+  {
+    offset = offset_;
+
+    Vector2f base = pos - center;
+    float base_angle = atan2(base.y, base.x);
+
+    Vector2f current = (pos+offset) - center;
+    float current_angle = atan2(current.y, current.x);
+
+    float new_angle = orig_angle + current_angle - base_angle;
+    object->set_angle(new_angle);
+  }
+  
+  void on_move_end(GdkEventMotion* event, const Vector2f& offset_)
+  {
+    on_move_update(event, offset_);
+  }
+
+  void draw(SceneContext& sc)
+  {
+    Rectf rect = get_bounding_box();
+    rect += offset;
+    sc.control().draw_control(surface, pos, ctrl_angle);
+  }
+};
+
+#endif
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/decal_rotate_control_point.hpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Added: trunk/windstille/src/editor/decal_scale_control_point.hpp
===================================================================
--- trunk/windstille/src/editor/decal_scale_control_point.hpp	2009-04-09 18:05:07 UTC (rev 2904)
+++ trunk/windstille/src/editor/decal_scale_control_point.hpp	2009-04-09 18:08:38 UTC (rev 2905)
@@ -0,0 +1,91 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#ifndef HEADER_WINDSTILLE_EDITOR_DECAL_SCALE_CONTROL_POINT_HPP
+#define HEADER_WINDSTILLE_EDITOR_DECAL_SCALE_CONTROL_POINT_HPP
+
+#include "math/vector2f.hpp"
+#include "control_point.hpp"
+#include "decal_object_model.hpp"
+
+class DecalScaleControlPoint : public ControlPoint
+{
+private:
+  DecalObjectModel* object;
+  float ctrl_angle;
+  Vector2f orig_scale;
+  bool x_scale;
+  bool y_scale;
+
+public:
+  DecalScaleControlPoint(DecalObjectModel* object_, float ctrl_angle_, const Vector2f& pos_, bool x_scale_ = true, bool y_scale_ = true)
+    : ControlPoint(Surface("editor/scale_handle.png"), pos_),
+      object(object_),
+      ctrl_angle(ctrl_angle_),
+      orig_scale(object_->get_scale()),
+      x_scale(x_scale_),
+      y_scale(y_scale_)
+  {}
+
+  void on_move_start(GdkEventButton* event) 
+  {
+  }
+
+  void on_move_update(GdkEventMotion* event, const Vector2f& offset_) 
+  {
+    offset = offset_; 
+
+    Vector2f start   = pos - object->get_world_pos();
+    Vector2f current = (pos + offset) - object->get_world_pos();
+
+    start    = start.rotate(-object->get_angle());
+    current = current.rotate(-object->get_angle());
+    
+    Vector2f new_scale = orig_scale;
+
+    if (x_scale)
+      {
+        new_scale.x = current.x / start.x;
+        new_scale.x *= orig_scale.x;
+      }
+
+    if (y_scale)
+      {
+        new_scale.y = current.y / start.y;
+        new_scale.y *= orig_scale.y;
+      }
+
+    object->set_scale(new_scale);
+  }
+  
+  void on_move_end(GdkEventButton* event, const Vector2f& offset_)
+  {
+    on_move_update(0/*event*/, offset_);
+  }
+
+  void draw(SceneContext& sc)
+  {
+    Rectf rect = get_bounding_box();
+    rect += offset;
+    sc.control().draw_control(surface, pos, ctrl_angle);
+  }
+};
+
+#endif
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/decal_scale_control_point.hpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Added: trunk/windstille/src/editor/node_selection.hpp
===================================================================
--- trunk/windstille/src/editor/node_selection.hpp	2009-04-09 18:05:07 UTC (rev 2904)
+++ trunk/windstille/src/editor/node_selection.hpp	2009-04-09 18:08:38 UTC (rev 2905)
@@ -0,0 +1,47 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#ifndef HEADER_WINDSTILLE_EDITOR_NODE_SELECTION_HPP
+#define HEADER_WINDSTILLE_EDITOR_NODE_SELECTION_HPP
+
+#include <set>
+
+#include "navigation/navigation_graph.hpp"
+
+class NodeSelection
+{
+private:
+  std::set<NodeHandle> nodes;
+
+public:
+  typedef std::set<NodeHandle>::iterator iterator;
+
+  NodeSelection();
+  ~NodeSelection();
+
+  iterator begin() { return nodes.begin(); }
+  iterator end()   { return nodes.end(); }
+
+private:
+  NodeSelection(const NodeSelection&);
+  NodeSelection& operator=(const NodeSelection&);
+};
+
+#endif
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/node_selection.hpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native



From grumbel at mail.berlios.de  Thu Apr  9 20:09:39 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 9 Apr 2009 20:09:39 +0200
Subject: [Windstille-commit] r2906 - trunk/windstille/data/images/decal
Message-ID: <200904091809.n39I9d74028903@sheep.berlios.de>

Author: grumbel
Date: 2009-04-09 20:09:38 +0200 (Thu, 09 Apr 2009)
New Revision: 2906

Added:
   trunk/windstille/data/images/decal/light2.png
Log:
New smaller light source

Added: trunk/windstille/data/images/decal/light2.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/light2.png
___________________________________________________________________
Name: svn:mime-type
   + image/png



From grumbel at mail.berlios.de  Thu Apr  9 20:28:40 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 9 Apr 2009 20:28:40 +0200
Subject: [Windstille-commit] r2907 - trunk/windstille
Message-ID: <200904091828.n39ISePX030712@sheep.berlios.de>

Author: grumbel
Date: 2009-04-09 20:28:40 +0200 (Thu, 09 Apr 2009)
New Revision: 2907

Modified:
   trunk/windstille/TODO
Log:
TODO updates

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-04-09 18:09:38 UTC (rev 2906)
+++ trunk/windstille/TODO	2009-04-09 18:28:40 UTC (rev 2907)
@@ -6,8 +6,9 @@
 be done, its a collection of random things that pop up during
 development, therefore not everything in here might be well thought
 out or worth to implement. Use your brain before implementing anything
-on this list and always thing about how useful a new feature would be
-in the context of the whole game.
+on this list and always think about how useful a new feature would be
+in the context of the whole game or if a potential performance
+enhanchment, actually enhanchmes anything at all.
 
 Scripting
 =========
@@ -186,6 +187,9 @@
 Miscellaneous
 =============
 
+* sorting DrawingRequest can be speed up by a bucket sort, as most
+  requests don't make use of z-pos
+
 * SurfaceManager::load_grid() bypasses TexturePacker, doesn't do
   border pixel duplication
 
@@ -388,6 +392,9 @@
 Bugs
 ====
 
+* drawing is broken after loading a level, only get fixed when
+  toggling Light layer, (bug in OpenGLState maybe?)
+
 * quickly tapping forward-back-hold down forward makes your character
   play the walking animation without actually moving anywhere
    
@@ -522,8 +529,28 @@
 Editor
 ======
 
-* tools are not drawn/updated when no button is pressed
+* add support for collision shapes, to mark lights or other objects as
+  shootable/interactable
 
+* a type of NavGraphNode that only sits on the graph without the
+  ability to deform it could be very useful to represent doors and
+  such
+
+* a trapezoid deformation for quads could be useful for lights
+
+* add glLineWidth() to OpenGL state and use it in NavGraph drawing/highlighting
+
+* make NavGraph insert tool automatically split edge when new nodes is
+  on edge
+
+* add keyboard shortcuts to flatten current NodeSelection
+
+* add a way to delete navgraph nodes (need to move Selection out of
+  tool, generalize it or just use right button)
+
+* tools are not drawn/updated when no button is pressed (active_tool
+  variable is at fault)
+
 * NavgraphTool (see Construo):
  
   - in Construo insertion and selection are two different tool
@@ -549,8 +576,9 @@
  
    right click&drag rotates
   
-* replace PointerHandle in NavigationGraph with boost::shared_ptr or
-  boost::weak_ptr, tricky, since it easily leads to recuriseve links
+* replace PointerHandle in NavigationGraph with boost::shared_ptr
+  and/or boost::weak_ptr, tricky, since it easily leads to recuriseve
+  links
 
 * turn the Selection into a kind-of ControlPoint, this would allow to
   keep the move/offset logic out of the ObjectModel
@@ -686,9 +714,6 @@
 
 * add a way to move object to a different layer
 
-* drawing is broken after loading a level, only get fixed when
-  toggling Light layer, (bug in OpenGLState maybe?)
-
 * background pattern goes away when Color pattern is disabled, since
   its draw to the Colormap
 



From grumbel at mail.berlios.de  Thu Apr  9 23:05:31 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 9 Apr 2009 23:05:31 +0200
Subject: [Windstille-commit] r2908 - in trunk/windstille/data: images/decal
	sectors sectors/trainstation
Message-ID: <200904092105.n39L5Vv9018573@sheep.berlios.de>

Author: grumbel
Date: 2009-04-09 23:05:12 +0200 (Thu, 09 Apr 2009)
New Revision: 2908

Added:
   trunk/windstille/data/images/decal/elevator.png
   trunk/windstille/data/images/decal/elevator_engine.png
   trunk/windstille/data/images/decal/elevator_stone.png
   trunk/windstille/data/images/decal/elevator_wheel.png
   trunk/windstille/data/images/decal/elevator_wood.png
   trunk/windstille/data/sectors/trainstation/boxstack_test.wst
   trunk/windstille/data/sectors/trainstation/elevator.wst
Modified:
   trunk/windstille/data/sectors/bar.wst
   trunk/windstille/data/sectors/trainstation/bathroom.wst
   trunk/windstille/data/sectors/trainstation/trainstation.wst
Log:
Some more gfx and test sectors

Added: trunk/windstille/data/images/decal/elevator.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/elevator.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/elevator_engine.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/elevator_engine.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/elevator_stone.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/elevator_stone.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/elevator_wheel.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/elevator_wheel.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/elevator_wood.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/elevator_wood.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/windstille/data/sectors/bar.wst
===================================================================
--- trunk/windstille/data/sectors/bar.wst	2009-04-09 18:28:40 UTC (rev 2907)
+++ trunk/windstille/data/sectors/bar.wst	2009-04-09 21:05:12 UTC (rev 2908)
@@ -3,7 +3,7 @@
 (windstille-sector
   (version 1)
   (name "")
-  (ambient-color 0 0 0 1)
+  (ambient-color 0.6 0.6 0.6 1)
   (init-script "init.nut")
   (layer
     (name "Scene")

Modified: trunk/windstille/data/sectors/trainstation/bathroom.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/bathroom.wst	2009-04-09 18:28:40 UTC (rev 2907)
+++ trunk/windstille/data/sectors/trainstation/bathroom.wst	2009-04-09 21:05:12 UTC (rev 2908)
@@ -5,13 +5,44 @@
   (name "")
   (ambient-color 0 0 0 1)
   (init-script "init.nut")
+  (navigation
+    (nodes
+      (node
+        (id 1)
+        (pos 362.219 227.562))
+      (node
+        (id 2)
+        (pos 361.219 605.562))
+      (node
+        (id 3)
+        (pos 1379.22 603.562))
+      (node
+        (id 4)
+        (pos 1380.22 216.562)))
+    (edges
+      (edge
+        (node1 1)
+        (node2 2)
+        (properties 0))
+      (edge
+        (node1 2)
+        (node2 3)
+        (properties 0))
+      (edge
+        (node1 3)
+        (node2 4)
+        (properties 0))
+      (edge
+        (node1 4)
+        (node2 1)
+        (properties 0))))
   (layer
     (name "Scene")
     (visible #t)
     (locked #t)
     (objects
       (decal
-        (id "0x99bfda8")
+        (id "0x9d1bdd8")
         (pos 958 491)
         (parent "")
         (select-mask 1)
@@ -23,12 +54,84 @@
         (vflip #f)))
     (child-layers
       (layer
+        (name "LightLight")
+        (visible #t)
+        (locked #f)
+        (objects
+          (decal
+            (id "0xa167988")
+            (pos 548 546)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light2.png")
+            (type 1)
+            (scale 3.57812 2.56836)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9d18430")
+            (pos 559 291)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light2.png")
+            (type 1)
+            (scale 3.23438 1.83594)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9d2f100")
+            (pos 870 563)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light2.png")
+            (type 1)
+            (scale 3.57812 2.56836)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa168798")
+            (pos 881 308)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light2.png")
+            (type 1)
+            (scale 3.23438 1.83594)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0x9d26380")
+            (pos 1218 284)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light2.png")
+            (type 1)
+            (scale 3.23438 1.83594)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa16c198")
+            (pos 1187 554)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light2.png")
+            (type 1)
+            (scale 3.57812 2.56836)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
         (name "Light")
         (visible #t)
         (locked #t)
         (objects
           (decal
-            (id "0x99c2fa0")
+            (id "0x9d34330")
             (pos 575 244)
             (parent "")
             (select-mask 1)
@@ -39,7 +142,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99c32f8")
+            (id "0x9d1f0e8")
             (pos 878 246)
             (parent "")
             (select-mask 1)
@@ -50,7 +153,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99c37f8")
+            (id "0x9d1fa78")
             (pos 1167 242)
             (parent "")
             (select-mask 1)
@@ -67,7 +170,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0x99c39a8")
+            (id "0x9d1fbb8")
             (pos 1409 210)
             (parent "")
             (select-mask 1)
@@ -78,7 +181,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99c3da0")
+            (id "0x9d1fd80")
             (pos 1437 666)
             (parent "")
             (select-mask 1)
@@ -89,7 +192,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99f7480")
+            (id "0x9d1fe98")
             (pos 318 663)
             (parent "")
             (select-mask 1)
@@ -100,7 +203,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99f83f8")
+            (id "0x9d494c0")
             (pos 294 191)
             (parent "")
             (select-mask 1)
@@ -111,7 +214,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99f76a0")
+            (id "0x9d49658")
             (pos 852 159)
             (parent "")
             (select-mask 1)
@@ -122,7 +225,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99f7a38")
+            (id "0x9d490e8")
             (pos 857 156)
             (parent "")
             (select-mask 1)
@@ -133,7 +236,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99f7b80")
+            (id "0x9d492c8")
             (pos 864 684)
             (parent "")
             (select-mask 1)
@@ -144,7 +247,7 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x9a38dc8")
+            (id "0x9d48f08")
             (pos 867 687)
             (parent "")
             (select-mask 1)
@@ -155,7 +258,7 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x9a38e88")
+            (id "0x9d79c68")
             (pos 301 432)
             (parent "")
             (select-mask 1)
@@ -166,7 +269,7 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x9a490d0")
+            (id "0x9d89e18")
             (pos 280 438)
             (parent "")
             (select-mask 1)
@@ -177,7 +280,7 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x9a59238")
+            (id "0x9d89f00")
             (pos 1471 416)
             (parent "")
             (select-mask 1)
@@ -188,7 +291,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9a69458")
+            (id "0x9daa0b0")
             (pos 1471 408)
             (parent "")
             (select-mask 1)
@@ -205,7 +308,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0x9a79630")
+            (id "0x9dca4a8")
             (pos 422 672)
             (parent "")
             (select-mask 1)
@@ -216,7 +319,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9abb278")
+            (id "0x9ddae78")
             (pos 550 672)
             (parent "")
             (select-mask 1)
@@ -227,7 +330,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9acb600")
+            (id "0x9dfb130")
             (pos 678 672)
             (parent "")
             (select-mask 1)
@@ -238,7 +341,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9afc1a0")
+            (id "0x9e1b3a0")
             (pos 806 672)
             (parent "")
             (select-mask 1)
@@ -249,7 +352,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9b1cb20")
+            (id "0x9e1b4b8")
             (pos 934 672)
             (parent "")
             (select-mask 1)
@@ -260,7 +363,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9b3cd70")
+            (id "0x9e2b558")
             (pos 1062 672)
             (parent "")
             (select-mask 1)
@@ -271,7 +374,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9b3cdf8")
+            (id "0x9e3b868")
             (pos 1190 672)
             (parent "")
             (select-mask 1)
@@ -282,7 +385,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9b4d0a8")
+            (id "0x9e4b978")
             (pos 1318 672)
             (parent "")
             (select-mask 1)
@@ -293,7 +396,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9b5d268")
+            (id "0x9e4ba38")
             (pos 422 160)
             (parent "")
             (select-mask 1)
@@ -304,7 +407,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9b6d410")
+            (id "0x9e7be00")
             (pos 550 160)
             (parent "")
             (select-mask 1)
@@ -315,7 +418,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9b7d620")
+            (id "0x9e8bfd8")
             (pos 678 160)
             (parent "")
             (select-mask 1)
@@ -326,7 +429,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9b8d7a8")
+            (id "0x9e7bf60")
             (pos 806 160)
             (parent "")
             (select-mask 1)
@@ -337,7 +440,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9b8d888")
+            (id "0x9eac518")
             (pos 934 160)
             (parent "")
             (select-mask 1)
@@ -348,7 +451,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9badac0")
+            (id "0x9ebc660")
             (pos 1062 160)
             (parent "")
             (select-mask 1)
@@ -359,7 +462,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9bbdc28")
+            (id "0x9e9c2e8")
             (pos 1190 160)
             (parent "")
             (select-mask 1)
@@ -370,7 +473,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9bcdf58")
+            (id "0x9ecc870")
             (pos 1318 160)
             (parent "")
             (select-mask 1)
@@ -381,7 +484,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9bde0a0")
+            (id "0x9edca28")
             (pos 1443 543)
             (parent "")
             (select-mask 1)
@@ -392,7 +495,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9bee310")
+            (id "0x9eecdd0")
             (pos 1442 415)
             (parent "")
             (select-mask 1)
@@ -403,7 +506,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9bfe4a0")
+            (id "0x9f0cfe0")
             (pos 1441 289)
             (parent "")
             (select-mask 1)
@@ -414,7 +517,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9c0e678")
+            (id "0x9f1d0a0")
             (pos 297 291)
             (parent "")
             (select-mask 1)
@@ -425,7 +528,7 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x9c0e780")
+            (id "0x9f2d298")
             (pos 298 418)
             (parent "")
             (select-mask 1)
@@ -436,7 +539,7 @@
             (hflip #f)
             (vflip #t))
           (decal
-            (id "0x9c2e940")
+            (id "0x9f3d5a0")
             (pos 297 544)
             (parent "")
             (select-mask 1)
@@ -450,10 +553,10 @@
       (layer
         (name "Objects")
         (visible #t)
-        (locked #f)
+        (locked #t)
         (objects
           (decal
-            (id "0x9c3eb30")
+            (id "0x9f4d7f0")
             (pos 1141 415)
             (parent "")
             (select-mask 1)
@@ -464,7 +567,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99f7348")
+            (id "0x9d1f700")
             (pos 1289 519)
             (parent "")
             (select-mask 1)
@@ -475,7 +578,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9c4eda8")
+            (id "0x9d1e058")
             (pos 569 227)
             (parent "")
             (select-mask 1)
@@ -486,7 +589,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99d60b8")
+            (id "0x9ddac08")
             (pos 1163 229)
             (parent "")
             (select-mask 1)
@@ -497,7 +600,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99f7d50")
+            (id "0x9f5d930")
             (pos 877 229)
             (parent "")
             (select-mask 1)
@@ -508,7 +611,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99d68c8")
+            (id "0x9d32830")
             (pos 1140 496)
             (parent "")
             (select-mask 1)
@@ -525,7 +628,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0x99d66f0")
+            (id "0x9d1e230")
             (pos 1142 549)
             (parent "")
             (select-mask 1)
@@ -536,7 +639,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99d6228")
+            (id "0x9d1e160")
             (pos 1275 590)
             (parent "")
             (select-mask 1)
@@ -553,7 +656,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0x99d70f8")
+            (id "0x9d330f8")
             (pos 870 247)
             (parent "")
             (select-mask 1)
@@ -564,7 +667,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99d6420")
+            (id "0x9d33210")
             (pos 868 590)
             (parent "")
             (select-mask 1)
@@ -575,7 +678,7 @@
             (hflip #t)
             (vflip #t))
           (decal
-            (id "0x9cad268")
+            (id "0x9d33e28")
             (pos 1341 418)
             (parent "")
             (select-mask 1)
@@ -586,7 +689,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99d7298")
+            (id "0x9d33a00")
             (pos 399 421)
             (parent "")
             (select-mask 1)
@@ -603,7 +706,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0x9ccd738")
+            (id "0x9d32330")
             (pos 422 544)
             (parent "")
             (select-mask 1)
@@ -614,7 +717,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x99c20c8")
+            (id "0x9fe4e00")
             (pos 550 544)
             (parent "")
             (select-mask 1)
@@ -625,7 +728,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9d0e9b8")
+            (id "0x9d324f8")
             (pos 422 416)
             (parent "")
             (select-mask 1)
@@ -636,7 +739,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9d1ecd8")
+            (id "0x9ff4f48")
             (pos 550 416)
             (parent "")
             (select-mask 1)
@@ -647,7 +750,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9d0eac0")
+            (id "0xa005250")
             (pos 422 288)
             (parent "")
             (select-mask 1)
@@ -658,7 +761,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9d2ee28")
+            (id "0xa0253c0")
             (pos 550 288)
             (parent "")
             (select-mask 1)
@@ -669,7 +772,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9d3f150")
+            (id "0xa0356d0")
             (pos 678 544)
             (parent "")
             (select-mask 1)
@@ -680,7 +783,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9d5f2c0")
+            (id "0xa0458a8")
             (pos 678 416)
             (parent "")
             (select-mask 1)
@@ -691,7 +794,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9d6f4e0")
+            (id "0xa005158")
             (pos 678 288)
             (parent "")
             (select-mask 1)
@@ -702,7 +805,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9d3efe8")
+            (id "0xa0559d8")
             (pos 806 288)
             (parent "")
             (select-mask 1)
@@ -713,7 +816,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9d7f780")
+            (id "0xa065d80")
             (pos 1062 544)
             (parent "")
             (select-mask 1)
@@ -724,7 +827,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9d8f9b8")
+            (id "0xa085fc0")
             (pos 1062 416)
             (parent "")
             (select-mask 1)
@@ -735,7 +838,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9dafce8")
+            (id "0xa096090")
             (pos 934 288)
             (parent "")
             (select-mask 1)
@@ -746,7 +849,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9dafda0")
+            (id "0xa0a63a0")
             (pos 1062 288)
             (parent "")
             (select-mask 1)
@@ -757,7 +860,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9dd0090")
+            (id "0xa0b6578")
             (pos 1190 544)
             (parent "")
             (select-mask 1)
@@ -768,7 +871,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9de0138")
+            (id "0xa085ec8")
             (pos 1318 544)
             (parent "")
             (select-mask 1)
@@ -779,7 +882,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9df03a0")
+            (id "0xa0c66a8")
             (pos 1190 416)
             (parent "")
             (select-mask 1)
@@ -790,7 +893,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9dcff28")
+            (id "0xa0d68a8")
             (pos 1318 416)
             (parent "")
             (select-mask 1)
@@ -801,7 +904,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9e00668")
+            (id "0xa0f6b80")
             (pos 1190 288)
             (parent "")
             (select-mask 1)
@@ -812,7 +915,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9e20b10")
+            (id "0xa106e88")
             (pos 1318 288)
             (parent "")
             (select-mask 1)
@@ -823,7 +926,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0x9e108d0")
+            (id "0xa117070")
             (pos 875 467)
             (parent "")
             (select-mask 1)

Added: trunk/windstille/data/sectors/trainstation/boxstack_test.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/boxstack_test.wst	2009-04-09 18:28:40 UTC (rev 2907)
+++ trunk/windstille/data/sectors/trainstation/boxstack_test.wst	2009-04-09 21:05:12 UTC (rev 2908)
@@ -0,0 +1,578 @@
+;; -*- scheme -*-
+
+(windstille-sector
+  (version 2)
+  (name "")
+  (ambient-color 0 0 0 1)
+  (init-script "init.nut")
+  (navigation
+    (nodes
+      (node
+        (id 1)
+        (pos -285.344 996.641))
+      (node
+        (id 2)
+        (pos 200.383 998.402))
+      (node
+        (id 3)
+        (pos 201.633 869.652))
+      (node
+        (id 4)
+        (pos 261.633 867.152))
+      (node
+        (id 5)
+        (pos 265.383 733.402))
+      (node
+        (id 6)
+        (pos 326.633 734.652))
+      (node
+        (id 7)
+        (pos 326.633 612.152))
+      (node
+        (id 8)
+        (pos 444.133 612.152))
+      (node
+        (id 9)
+        (pos 442.883 732.152))
+      (node
+        (id 10)
+        (pos 511.633 733.402))
+      (node
+        (id 11)
+        (pos 509.133 864.652))
+      (node
+        (id 12)
+        (pos 577.883 865.902))
+      (node
+        (id 13)
+        (pos 577.883 995.902))
+      (node
+        (id 14)
+        (pos 654.133 997.152))
+      (node
+        (id 15)
+        (pos 652.883 863.402))
+      (node
+        (id 16)
+        (pos 709.785 863.169))
+      (node
+        (id 17)
+        (pos 709.133 734.652))
+      (node
+        (id 18)
+        (pos 776 733))
+      (node
+        (id 19)
+        (pos 774.133 607.152))
+      (node
+        (id 20)
+        (pos 902.399 608.001))
+      (node
+        (id 21)
+        (pos 903.575 734.536))
+      (node
+        (id 22)
+        (pos 963.688 734.956))
+      (node
+        (id 23)
+        (pos 962.427 863.169))
+      (node
+        (id 24)
+        (pos 1031.79 863.169))
+      (node
+        (id 25)
+        (pos 1033.47 997.687))
+      (node
+        (id 26)
+        (pos 1742 994.688))
+      (node
+        (id 27)
+        (pos -285.727 224.059))
+      (node
+        (id 28)
+        (pos 1736.79 228.068)))
+    (edges
+      (edge
+        (node1 1)
+        (node2 2)
+        (properties 0))
+      (edge
+        (node1 2)
+        (node2 3)
+        (properties 0))
+      (edge
+        (node1 3)
+        (node2 4)
+        (properties 0))
+      (edge
+        (node1 4)
+        (node2 5)
+        (properties 0))
+      (edge
+        (node1 5)
+        (node2 6)
+        (properties 0))
+      (edge
+        (node1 6)
+        (node2 7)
+        (properties 0))
+      (edge
+        (node1 7)
+        (node2 8)
+        (properties 0))
+      (edge
+        (node1 8)
+        (node2 9)
+        (properties 0))
+      (edge
+        (node1 9)
+        (node2 10)
+        (properties 0))
+      (edge
+        (node1 10)
+        (node2 11)
+        (properties 0))
+      (edge
+        (node1 11)
+        (node2 12)
+        (properties 0))
+      (edge
+        (node1 12)
+        (node2 13)
+        (properties 0))
+      (edge
+        (node1 13)
+        (node2 14)
+        (properties 0))
+      (edge
+        (node1 14)
+        (node2 15)
+        (properties 0))
+      (edge
+        (node1 15)
+        (node2 16)
+        (properties 0))
+      (edge
+        (node1 16)
+        (node2 17)
+        (properties 0))
+      (edge
+        (node1 17)
+        (node2 18)
+        (properties 0))
+      (edge
+        (node1 19)
+        (node2 20)
+        (properties 0))
+      (edge
+        (node1 20)
+        (node2 21)
+        (properties 0))
+      (edge
+        (node1 21)
+        (node2 22)
+        (properties 0))
+      (edge
+        (node1 22)
+        (node2 23)
+        (properties 0))
+      (edge
+        (node1 23)
+        (node2 24)
+        (properties 0))
+      (edge
+        (node1 24)
+        (node2 25)
+        (properties 0))
+      (edge
+        (node1 25)
+        (node2 26)
+        (properties 0))
+      (edge
+        (node1 14)
+        (node2 25)
+        (properties 0))
+      (edge
+        (node1 16)
+        (node2 23)
+        (properties 0))
+      (edge
+        (node1 18)
+        (node2 21)
+        (properties 0))
+      (edge
+        (node1 18)
+        (node2 19)
+        (properties 0))
+      (edge
+        (node1 1)
+        (node2 27)
+        (properties 0))
+      (edge
+        (node1 27)
+        (node2 28)
+        (properties 0))
+      (edge
+        (node1 28)
+        (node2 26)
+        (properties 0))))
+  (layer
+    (name "Scene")
+    (visible #t)
+    (locked #f)
+    (objects
+      (decal
+        (id "0x970bdd8")
+        (pos -1533 -512)
+        (parent "0x970da88")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970ef50")
+        (pos -1533 -256)
+        (parent "0x970da88")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970cab0")
+        (pos -1536 0)
+        (parent "0x970da88")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970cc28")
+        (pos -1021 -512)
+        (parent "0x970da88")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x971e540")
+        (pos -1021 -256)
+        (parent "0x970da88")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970ce28")
+        (pos -1024 0)
+        (parent "0x970da88")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970d038")
+        (pos -512 0)
+        (parent "0x970da88")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970d248")
+        (pos -509 -256)
+        (parent "0x970da88")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970d458")
+        (pos -509 -512)
+        (parent "0x970da88")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970d668")
+        (pos 3 -512)
+        (parent "0x970da88")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970d878")
+        (pos 3 -256)
+        (parent "0x970da88")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970da88")
+        (pos 1486 864)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/mine_background.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970dc58")
+        (pos 837 672)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steelbox.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x971e788")
+        (pos 826 725)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 0.394531 0.363281)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x971e1a0")
+        (pos 899 800)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steelbox.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x971e360")
+        (pos 771 800)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steelbox.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x971d438")
+        (pos 265 929)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steelbox.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x971d570")
+        (pos 393 929)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steelbox.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x971d688")
+        (pos 521 929)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steelbox.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x971dc38")
+        (pos 450 801)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steelbox.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x971def0")
+        (pos 322 801)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steelbox.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970e2e0")
+        (pos 385 673)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steelbox.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970e140")
+        (pos 768 864)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 0.480469 0.363281)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970dd78")
+        (pos 714 928)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steelbox.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970dec8")
+        (pos 894 859)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 0.480469 0.363281)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x971da10")
+        (pos 842 928)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steelbox.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x971db30")
+        (pos 970 928)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/steelbox.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970e9c8")
+        (pos 710 972)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 0.480469 0.363281)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970eb88")
+        (pos 836 967)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 0.480469 0.363281)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x970ec68")
+        (pos 961 974)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/dark.png")
+        (type 0)
+        (scale 0.480469 0.363281)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x97f1bd8")
+        (pos 223 1248)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/city_housewall.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f))
+      (decal
+        (id "0x97f1de8")
+        (pos 1247 1248)
+        (parent "")
+        (select-mask 1)
+        (path "images/decal/city_housewall.png")
+        (type 0)
+        (scale 1 1)
+        (angle 0)
+        (hflip #f)
+        (vflip #f)))
+    (child-layers)))
+
+;; EOF ;;

Added: trunk/windstille/data/sectors/trainstation/elevator.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/elevator.wst	2009-04-09 18:28:40 UTC (rev 2907)
+++ trunk/windstille/data/sectors/trainstation/elevator.wst	2009-04-09 21:05:12 UTC (rev 2908)
@@ -0,0 +1,773 @@
+;; -*- scheme -*-
+
+(windstille-sector
+  (version 2)
+  (name "")
+  (ambient-color 0 0 0 1)
+  (init-script "init.nut")
+  (navigation
+    (nodes)
+    (edges))
+  (layer
+    (name "Scene")
+    (visible #t)
+    (locked #t)
+    (objects)
+    (child-layers
+      (layer
+        (name "Highlights")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0xa95f860")
+            (pos 0 -3)
+            (parent "0xa95f800")
+            (select-mask 1)
+            (path "images/decal/light2.png")
+            (type 2)
+            (scale 0.617188 0.625)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa95f800")
+            (pos 349 576)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light2.png")
+            (type 2)
+            (scale 0.117188 0.125)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa0e42c8")
+            (pos 0 -3)
+            (parent "0xa0e4258")
+            (select-mask 1)
+            (path "images/decal/light2.png")
+            (type 2)
+            (scale 0.617188 0.625)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa0e4258")
+            (pos 578 572)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light2.png")
+            (type 2)
+            (scale 0.117188 0.125)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa0e0f78")
+            (pos 455 572)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light2.png")
+            (type 2)
+            (scale 3.76565 0.294281)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "Lights")
+        (visible #t)
+        (locked #t)
+        (objects
+          (decal
+            (id "0xa6e5800")
+            (pos 454 774)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light2.png")
+            (type 1)
+            (scale 20.453 15.3696)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa07bfb0")
+            (pos 454 623)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/light2.png")
+            (type 1)
+            (scale 4.00336 3.39467)
+            (angle 0)
+            (hflip #f)
+            (vflip #f)))
+        (child-layers))
+      (layer
+        (name "Elevator")
+        (visible #t)
+        (locked #f)
+        (objects
+          (decal
+            (id "0xa0ebe30")
+            (pos 1022 826)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/plant4.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa0ebda0")
+            (pos 370 225)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/ground.png")
+            (type 0)
+            (scale 1.99062 0.165029)
+            (angle -1.56985)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0xa0ebd10")
+            (pos 423 216)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/ground.png")
+            (type 0)
+            (scale 1.99062 0.165029)
+            (angle -1.56985)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0xa91ad70")
+            (pos 545 217)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/ground.png")
+            (type 0)
+            (scale 1.99062 0.165029)
+            (angle -1.56985)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0xa91ace0")
+            (pos -371 814)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/plant5.png")
+            (type 0)
+            (scale 1.48186 1.90226)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa91ac50")
+            (pos 488 227)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/ground.png")
+            (type 0)
+            (scale 1.99062 0.165029)
+            (angle -1.56985)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0xa95b288")
+            (pos 459 708)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/elevator.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa95b1f8")
+            (pos 183 84)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/elevator_wood.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa95b168")
+            (pos 53 340)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/elevator_wood.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa958ee0")
+            (pos -78 596)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/elevator_wood.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa958e50")
+            (pos -208 852)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/elevator_wood.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa958dc0")
+            (pos -211 854)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.472656 0.25)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa983328")
+            (pos 755 84)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/elevator_wood.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0xa983298")
+            (pos 885 340)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/elevator_wood.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0xa983208")
+            (pos 1016 596)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/elevator_wood.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0xa980120")
+            (pos 1146 852)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/elevator_wood.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0xa980090")
+            (pos 599 -236)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/elevator_wheel.png")
+            (type 0)
+            (scale 1 1)
+            (angle -0.676006)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa980000")
+            (pos 317 -235)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/elevator_wheel.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0.102794)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa0e4698")
+            (pos 700 -28)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.549866 0.191284)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa0e4608")
+            (pos 237 -29)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.549866 0.191284)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa978d00")
+            (pos 461 -137)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/elevator_engine.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa978c70")
+            (pos -234 924)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/elevator_stone.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa0e4578")
+            (pos 1160 856)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.472656 0.25)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa49d260")
+            (pos 1164 914)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/elevator_stone.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa49d1d0")
+            (pos 1165 979)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1.08984 0.25)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa49d140")
+            (pos 108 864)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/humanreference.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0xa6c2d20")
+            (pos 1272 954)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.510803 0.3797)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa6c2c90")
+            (pos 1288 944)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/plant1.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa6c2c00")
+            (pos -171.395 900.148)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/plant3.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa745fa0")
+            (pos 483 989)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/ground.png")
+            (type 0)
+            (scale 1.67376 0.258859)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa745f10")
+            (pos 998 1106)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/mine_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa745e80")
+            (pos 998 1362)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/mine_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa0e30a0")
+            (pos 998 1618)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/mine_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa0e3010")
+            (pos 1510 1106)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/mine_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa0e43b0")
+            (pos -258 968)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1.08984 0.25)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa0e8410")
+            (pos -542 1107)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/mine_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa978d78")
+            (pos -30 1107)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/mine_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa0e4320")
+            (pos -30 1363)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/mine_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa92d460")
+            (pos -30 1619)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/mine_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa92d3d0")
+            (pos 963 1680)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/shadow.png")
+            (type 0)
+            (scale 7.86646 1.61989)
+            (angle -1.57154)
+            (hflip #f)
+            (vflip #t))
+          (decal
+            (id "0xa9894f8")
+            (pos 1038 1192)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa945f18")
+            (pos 1206 1579)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.940395 1.53644)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa945eb0")
+            (pos 1238 1611)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.940395 1.53644)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa0e6118")
+            (pos 1201 1587)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.940395 1.53644)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa989d50")
+            (pos 1113 1594)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.940395 1.53644)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa6f7188")
+            (pos 1188 1354)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.940395 1.53644)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa962d08")
+            (pos 1202 1448)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.940395 1.53644)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa91cef0")
+            (pos -308 1481)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.940395 1.53644)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0xa984c80")
+            (pos -340 1513)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.940395 1.53644)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0xa96a200")
+            (pos -303 1489)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.940395 1.53644)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0xa0a0138")
+            (pos -12 1570)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.940395 1.53644)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0xa9471c8")
+            (pos -236 1454)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 0.940395 1.53644)
+            (angle 0)
+            (hflip #t)
+            (vflip #f))
+          (decal
+            (id "0xa0ebc90")
+            (pos -265 1778)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/dark.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa039830")
+            (pos -1054 1107)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/mine_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa6df2b8")
+            (pos -1566 1107)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/mine_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa95b800")
+            (pos 3047 1106)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/mine_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa6d0fa0")
+            (pos 2534 1106)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/mine_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa989800")
+            (pos 2022 1106)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/mine_background.png")
+            (type 0)
+            (scale 1 1)
+            (angle 0)
+            (hflip #f)
+            (vflip #f))
+          (decal
+            (id "0xa989850")
+            (pos -966 1146)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/shadow.png")
+            (type 0)
+            (scale 14.1607 1.61989)
+            (angle 0)
+            (hflip #t)
+            (vflip #t))
+          (decal
+            (id "0xa0e2f80")
+            (pos 1810 1137)
+            (parent "")
+            (select-mask 1)
+            (path "images/decal/shadow.png")
+            (type 0)
+            (scale 11.2615 1.61989)
+            (angle 0)
+            (hflip #f)
+            (vflip #t)))
+        (child-layers)))))
+
+;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/trainstation.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/trainstation.wst	2009-04-09 18:28:40 UTC (rev 2907)
+++ trunk/windstille/data/sectors/trainstation/trainstation.wst	2009-04-09 21:05:12 UTC (rev 2908)
@@ -5,6 +5,75 @@
   (name "")
   (ambient-color 0 0 0 1)
   (init-script "init.nut")
+  (navigation
+    (nodes
+      (node
+        (id 1)
+        (pos -1648.56 171.625))
+      (node
+        (id 2)
+        (pos -787.625 1063.81))
+      (node
+        (id 3)
+        (pos -1532.94 1063.81))
+      (node
+        (id 4)
+        (pos -1526.69 338.813))
+      (node
+        (id 5)
+        (pos 2232.69 1062.25))
+      (node
+        (id 6)
+        (pos 2251.44 370.063))
+      (node
+        (id 7)
+        (pos -390.75 371.625))
+      (node
+        (id 8)
+        (pos -514.187 563.812))
+      (node
+        (id 9)
+        (pos -567.312 562.25))
+      (node
+        (id 10)
+        (pos -903.25 331)))
+    (edges
+      (edge
+        (node1 1)
+        (node2 2)
+        (properties 0))
+      (edge
+        (node1 2)
+        (node2 3)
+        (properties 0))
+      (edge
+        (node1 3)
+        (node2 4)
+        (properties 0))
+      (edge
+        (node1 2)
+        (node2 5)
+        (properties 0))
+      (edge
+        (node1 6)
+        (node2 7)
+        (properties 0))
+      (edge
+        (node1 7)
+        (node2 8)
+        (properties 0))
+      (edge
+        (node1 8)
+        (node2 9)
+        (properties 0))
+      (edge
+        (node1 9)
+        (node2 10)
+        (properties 0))
+      (edge
+        (node1 10)
+        (node2 4)
+        (properties 0))))
   (layer
     (name "Trainstation")
     (visible #t)
@@ -17,7 +86,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0xa2d7478")
+            (id "0xa6bb478")
             (pos -855.442 319.354)
             (parent "")
             (select-mask 1)
@@ -28,7 +97,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa2d7c70")
+            (id "0xa6baa38")
             (pos -1297.52 365.776)
             (parent "")
             (select-mask 1)
@@ -39,7 +108,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa2d8010")
+            (id "0xa6bbd00")
             (pos -1402.7 340.058)
             (parent "")
             (select-mask 1)
@@ -50,7 +119,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa2d8550")
+            (id "0xa6bc510")
             (pos -1099.97 336.543)
             (parent "")
             (select-mask 1)
@@ -61,7 +130,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa2d8718")
+            (id "0xa6bc6d8")
             (pos -1569.48 329.078)
             (parent "")
             (select-mask 1)
@@ -78,7 +147,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0xa2d8168")
+            (id "0xa6bc128")
             (pos 1630.08 1070.32)
             (parent "")
             (select-mask 1)
@@ -89,7 +158,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa2d8290")
+            (id "0xa6bc270")
             (pos 983.756 904.953)
             (parent "")
             (select-mask 1)
@@ -100,7 +169,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa3241e0")
+            (id "0xa707f78")
             (pos 315.072 868.593)
             (parent "")
             (select-mask 1)
@@ -111,7 +180,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa324698")
+            (id "0xa708380")
             (pos -1636 909.933)
             (parent "")
             (select-mask 1)
@@ -122,7 +191,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa3244e8")
+            (id "0xa708538")
             (pos -810.844 849.183)
             (parent "")
             (select-mask 1)
@@ -133,7 +202,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa324380")
+            (id "0xa708080")
             (pos 1559.83 804.374)
             (parent "")
             (select-mask 1)
@@ -144,7 +213,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa324c30")
+            (id "0xa708190")
             (pos -259.112 903.761)
             (parent "")
             (select-mask 1)
@@ -155,7 +224,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa324dc8")
+            (id "0xa708ac0")
             (pos -477.046 760.753)
             (parent "")
             (select-mask 1)
@@ -166,7 +235,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa324f40")
+            (id "0xa708ca8")
             (pos -1553.29 729.292)
             (parent "")
             (select-mask 1)
@@ -177,7 +246,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa2d45f0")
+            (id "0xa708698")
             (pos -1169.49 799.75)
             (parent "")
             (select-mask 1)
@@ -194,7 +263,7 @@
             (locked #t)
             (objects
               (decal
-                (id "0xa2d5fc0")
+                (id "0xa6ba168")
                 (pos -402.054 1017.24)
                 (parent "")
                 (select-mask 1)
@@ -205,7 +274,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xa2d60d0")
+                (id "0xa6ba230")
                 (pos 161.91 1097.81)
                 (parent "")
                 (select-mask 1)
@@ -216,7 +285,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xa2d57f8")
+                (id "0xa6ba370")
                 (pos 860.719 704.086)
                 (parent "")
                 (select-mask 1)
@@ -227,7 +296,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xa2d6400")
+                (id "0xa6b9d90")
                 (pos 208.559 708.054)
                 (parent "")
                 (select-mask 1)
@@ -238,7 +307,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xa2d5948")
+                (id "0xa6b9e88")
                 (pos -845.605 1035.11)
                 (parent "")
                 (select-mask 1)
@@ -249,7 +318,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xa2d5ee0")
+                (id "0xa6b97c8")
                 (pos -332.91 1098.59)
                 (parent "")
                 (select-mask 1)
@@ -260,7 +329,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xa2d4b28")
+                (id "0xa6b99d0")
                 (pos -1151.04 1059.27)
                 (parent "")
                 (select-mask 1)
@@ -271,7 +340,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xa2d4cc0")
+                (id "0xa6b9c28")
                 (pos -1663.74 995.791)
                 (parent "")
                 (select-mask 1)
@@ -282,7 +351,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xa2d4e40")
+                (id "0xa6b89a8")
                 (pos 943.16 1149.08)
                 (parent "")
                 (select-mask 1)
@@ -299,9 +368,9 @@
         (locked #t)
         (objects
           (decal
-            (id "0xa324110")
+            (id "0xa707e68")
             (pos -752 0)
-            (parent "0xa2d5590")
+            (parent "0xa6b8b10")
             (select-mask 1)
             (path "images/decal/train_front.png")
             (type 0)
@@ -310,9 +379,9 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa2d56f0")
+            (id "0xa708778")
             (pos 696 0)
-            (parent "0xa2d5590")
+            (parent "0xa6b8b10")
             (select-mask 1)
             (path "images/decal/train_back.png")
             (type 0)
@@ -321,7 +390,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa2d5590")
+            (id "0xa6b8b10")
             (pos -2098.65 942.97)
             (parent "")
             (select-mask 1)
@@ -332,9 +401,9 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa2d51e0")
+            (id "0xa6b8d40")
             (pos -586.991 241.125)
-            (parent "0xa2d5590")
+            (parent "0xa6b8b10")
             (select-mask 1)
             (path "images/decal/train_engine_front.png")
             (type 0)
@@ -343,9 +412,9 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa3274c0")
+            (id "0xa6b9178")
             (pos 593.009 242.125)
-            (parent "0xa2d5590")
+            (parent "0xa6b8b10")
             (select-mask 1)
             (path "images/decal/train_engine_back.png")
             (type 0)
@@ -354,9 +423,9 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa3223b0")
+            (id "0xa706718")
             (pos -206.991 241.125)
-            (parent "0xa2d5590")
+            (parent "0xa6b8b10")
             (select-mask 1)
             (path "images/decal/train_engine_middle.png")
             (type 0)
@@ -365,9 +434,9 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa321dc0")
+            (id "0xa705f50")
             (pos 249.009 241.125)
-            (parent "0xa2d5590")
+            (parent "0xa6b8b10")
             (select-mask 1)
             (path "images/decal/train_engine_middle.png")
             (type 0)
@@ -376,9 +445,9 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa321f80")
+            (id "0xa705af8")
             (pos 0.719482 -14.875)
-            (parent "0xa2d5590")
+            (parent "0xa6b8b10")
             (select-mask 1)
             (path "images/decal/train_door.png")
             (type 0)
@@ -393,7 +462,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0xa3226b8")
+            (id "0xa706018")
             (pos -2249.87 1060.44)
             (parent "")
             (select-mask 1)
@@ -404,7 +473,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa322970")
+            (id "0xa706f08")
             (pos -2244.5 972.452)
             (parent "")
             (select-mask 1)
@@ -415,7 +484,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa322ac0")
+            (id "0xa7070a0")
             (pos -2151.95 1070.86)
             (parent "")
             (select-mask 1)
@@ -426,7 +495,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa323630")
+            (id "0xa7071c8")
             (pos -2223.31 378.014)
             (parent "")
             (select-mask 1)
@@ -437,7 +506,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa3237c8")
+            (id "0xa707440")
             (pos -2222.56 441.264)
             (parent "")
             (select-mask 1)
@@ -448,7 +517,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa3238f0")
+            (id "0xa707820")
             (pos -2231.18 652.952)
             (parent "")
             (select-mask 1)
@@ -459,7 +528,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa6b3010")
+            (id "0xa707668")
             (pos -2231.93 589.702)
             (parent "")
             (select-mask 1)
@@ -470,7 +539,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa323278")
+            (id "0xa7069a0")
             (pos -2223.79 825.967)
             (parent "")
             (select-mask 1)
@@ -481,7 +550,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa323448")
+            (id "0xa706910")
             (pos -2016.48 1029.67)
             (parent "")
             (select-mask 1)
@@ -492,7 +561,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa6b3ae0")
+            (id "0xa988648")
             (pos -2047.33 560.924)
             (parent "")
             (select-mask 1)
@@ -503,7 +572,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa6b3138")
+            (id "0xa989218")
             (pos -2080.6 782.737)
             (parent "")
             (select-mask 1)
@@ -520,7 +589,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0xa6b3c38")
+            (id "0xa988318")
             (pos -132.297 329.766)
             (parent "")
             (select-mask 1)
@@ -531,7 +600,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa6b37b8")
+            (id "0xa988f40")
             (pos 378.703 329.766)
             (parent "")
             (select-mask 1)
@@ -542,7 +611,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa6b38e0")
+            (id "0xa70b0e8")
             (pos 1400.7 331.719)
             (parent "")
             (select-mask 1)
@@ -553,7 +622,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa329c78")
+            (id "0xa70b250")
             (pos 889.703 331.719)
             (parent "")
             (select-mask 1)
@@ -564,7 +633,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa329e20")
+            (id "0xa70cc18")
             (pos 2422.7 331.719)
             (parent "")
             (select-mask 1)
@@ -575,7 +644,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa3255c0")
+            (id "0xa70c950")
             (pos 1911.7 331.719)
             (parent "")
             (select-mask 1)
@@ -586,7 +655,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa326b58")
+            (id "0xa70af88")
             (pos -1652.53 298.683)
             (parent "")
             (select-mask 1)
@@ -597,7 +666,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa327098")
+            (id "0xa70cd10")
             (pos -771.438 410.719)
             (parent "")
             (select-mask 1)
@@ -608,7 +677,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa326f48")
+            (id "0xa70c6a0")
             (pos -1141.53 298.683)
             (parent "")
             (select-mask 1)
@@ -619,7 +688,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa326858")
+            (id "0xa70cdf0")
             (pos -2163.53 298.683)
             (parent "")
             (select-mask 1)
@@ -630,7 +699,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa326a18")
+            (id "0xa70d290")
             (pos -2674.53 298.683)
             (parent "")
             (select-mask 1)
@@ -647,7 +716,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0xa325728")
+            (id "0xa70cee8")
             (pos 266.7 554.465)
             (parent "")
             (select-mask 1)
@@ -658,7 +727,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa325bc8")
+            (id "0xa70c1b8")
             (pos 999.122 579.855)
             (parent "")
             (select-mask 1)
@@ -669,7 +738,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa327ff8")
+            (id "0xa70a490")
             (pos 1651.47 577.902)
             (parent "")
             (select-mask 1)
@@ -680,7 +749,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa328198")
+            (id "0xa70c240")
             (pos 1660.56 541.188)
             (parent "")
             (select-mask 1)
@@ -691,7 +760,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa3295f8")
+            (id "0xa70a188")
             (pos 998.057 533.375)
             (parent "")
             (select-mask 1)
@@ -702,7 +771,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa329758")
+            (id "0xa70a338")
             (pos 237.12 549)
             (parent "")
             (select-mask 1)
@@ -713,7 +782,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa329888")
+            (id "0xa70a918")
             (pos 1642.66 434.301)
             (parent "")
             (select-mask 1)
@@ -724,7 +793,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa325c78")
+            (id "0xa709f58")
             (pos 982.958 428.895)
             (parent "")
             (select-mask 1)
@@ -735,7 +804,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa328dc0")
+            (id "0xa70acf0")
             (pos 231.267 426.715)
             (parent "")
             (select-mask 1)
@@ -752,7 +821,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0xa329008")
+            (id "0xa70a7c0")
             (pos 240.218 886.438)
             (parent "")
             (select-mask 1)
@@ -763,7 +832,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa3283d0")
+            (id "0xaa41800")
             (pos 934.407 913.438)
             (parent "")
             (select-mask 1)
@@ -774,7 +843,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa328a28")
+            (id "0xa709040")
             (pos -163.625 985.44)
             (parent "")
             (select-mask 1)
@@ -785,7 +854,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa8780f8")
+            (id "0xab69b88")
             (pos 578.562 985.44)
             (parent "")
             (select-mask 1)
@@ -796,7 +865,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa878360")
+            (id "0xab69a28")
             (pos 1244.19 985.44)
             (parent "")
             (select-mask 1)
@@ -807,7 +876,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa878200")
+            (id "0xaa415c8")
             (pos 1689.49 985.44)
             (parent "")
             (select-mask 1)
@@ -818,7 +887,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa799f40")
+            (id "0xaa41538")
             (pos 2006.69 985.44)
             (parent "")
             (select-mask 1)
@@ -829,7 +898,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaa76460")
+            (id "0xa709660")
             (pos 424.131 1013.44)
             (parent "")
             (select-mask 1)
@@ -840,7 +909,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaa0f368")
+            (id "0xaaafb40")
             (pos -1002.18 1013.44)
             (parent "")
             (select-mask 1)
@@ -851,7 +920,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaa0f3c0")
+            (id "0xa709730")
             (pos -914.086 1013.44)
             (parent "")
             (select-mask 1)
@@ -862,7 +931,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa79a478")
+            (id "0xa7098a8")
             (pos -832.618 1013.44)
             (parent "")
             (select-mask 1)
@@ -873,7 +942,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa79a608")
+            (id "0xaaafc50")
             (pos 1064.43 1014.67)
             (parent "")
             (select-mask 1)
@@ -884,7 +953,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaa76778")
+            (id "0xa709d30")
             (pos 676.954 1029.44)
             (parent "")
             (select-mask 1)
@@ -895,7 +964,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa6b8918")
+            (id "0xaca7748")
             (pos 612.954 1029.44)
             (parent "")
             (select-mask 1)
@@ -906,7 +975,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaadfaf0")
+            (id "0xa709a38")
             (pos 648.954 965.44)
             (parent "")
             (select-mask 1)
@@ -917,7 +986,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaf0428")
+            (id "0xac60ff8")
             (pos 740.954 1029.44)
             (parent "")
             (select-mask 1)
@@ -928,7 +997,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaf3600")
+            (id "0xacb0a88")
             (pos 584.954 965.44)
             (parent "")
             (select-mask 1)
@@ -939,7 +1008,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaf6748")
+            (id "0xacb0b70")
             (pos 548.954 1029.44)
             (parent "")
             (select-mask 1)
@@ -950,7 +1019,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa79a308")
+            (id "0xacb6f38")
             (pos 706.554 965.44)
             (parent "")
             (select-mask 1)
@@ -961,7 +1030,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaafca30")
+            (id "0xacb3c60")
             (pos 28.218 973.438)
             (parent "")
             (select-mask 1)
@@ -972,7 +1041,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaffcb8")
+            (id "0xacc0368")
             (pos 1448.12 973.44)
             (parent "")
             (select-mask 1)
@@ -989,7 +1058,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0xab26e68")
+            (id "0xace3ac8")
             (pos -249.032 1380.44)
             (parent "")
             (select-mask 1)
@@ -1000,7 +1069,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaec698")
+            (id "0xa98d9f0")
             (pos -761.032 1380.44)
             (parent "")
             (select-mask 1)
@@ -1011,7 +1080,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xab4c700")
+            (id "0xacf7980")
             (pos -2297.03 1380.44)
             (parent "")
             (select-mask 1)
@@ -1022,7 +1091,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xab4c848")
+            (id "0xa98db38")
             (pos -1785.03 1380.44)
             (parent "")
             (select-mask 1)
@@ -1033,7 +1102,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xab4c520")
+            (id "0xa98d720")
             (pos -1273.03 1380.44)
             (parent "")
             (select-mask 1)
@@ -1044,7 +1113,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaecce0")
+            (id "0xacf7ab0")
             (pos 262.968 1380.44)
             (parent "")
             (select-mask 1)
@@ -1055,7 +1124,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaec748")
+            (id "0xacf7bf8")
             (pos 774.968 1380.44)
             (parent "")
             (select-mask 1)
@@ -1066,7 +1135,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaec878")
+            (id "0xae37df0")
             (pos 1798.97 1380.44)
             (parent "")
             (select-mask 1)
@@ -1077,7 +1146,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaeca18")
+            (id "0xae384a0")
             (pos 1286.97 1380.44)
             (parent "")
             (select-mask 1)
@@ -1088,7 +1157,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaebc80")
+            (id "0xae37f38")
             (pos 1670.97 1273.44)
             (parent "")
             (select-mask 1)
@@ -1099,7 +1168,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaecfe0")
+            (id "0xae380d8")
             (pos 1926.97 1273.44)
             (parent "")
             (select-mask 1)
@@ -1110,7 +1179,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaec170")
+            (id "0xae381d0")
             (pos 1414.97 1273.44)
             (parent "")
             (select-mask 1)
@@ -1121,7 +1190,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xadcdf10")
+            (id "0xa98caf8")
             (pos 1158.97 1273.44)
             (parent "")
             (select-mask 1)
@@ -1132,7 +1201,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xadcddb0")
+            (id "0xa98c158")
             (pos 2214.14 1187.44)
             (parent "")
             (select-mask 1)
@@ -1143,7 +1212,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaebfc8")
+            (id "0xa98c658")
             (pos 1702.14 1187.44)
             (parent "")
             (select-mask 1)
@@ -1154,7 +1223,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaebeb8")
+            (id "0xa98c7a8")
             (pos 1958.14 1187.44)
             (parent "")
             (select-mask 1)
@@ -1165,7 +1234,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaeb430")
+            (id "0xa98c960")
             (pos 1446.14 1187.44)
             (parent "")
             (select-mask 1)
@@ -1176,7 +1245,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xadce128")
+            (id "0xa98d5d0")
             (pos -121.032 1273.44)
             (parent "")
             (select-mask 1)
@@ -1187,7 +1256,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xadce2d0")
+            (id "0xa98be50")
             (pos -377.032 1273.44)
             (parent "")
             (select-mask 1)
@@ -1198,7 +1267,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaee5c58")
+            (id "0xa98bfd8")
             (pos 646.968 1273.44)
             (parent "")
             (select-mask 1)
@@ -1209,7 +1278,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaee5d88")
+            (id "0xb04e998")
             (pos 902.968 1273.44)
             (parent "")
             (select-mask 1)
@@ -1220,7 +1289,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaeb9d0")
+            (id "0xb038f78")
             (pos 390.968 1273.44)
             (parent "")
             (select-mask 1)
@@ -1231,7 +1300,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaeb3a8")
+            (id "0xb04e658")
             (pos 134.968 1273.44)
             (parent "")
             (select-mask 1)
@@ -1242,7 +1311,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaebb58")
+            (id "0xb04e738")
             (pos 1190.13 1187.44)
             (parent "")
             (select-mask 1)
@@ -1253,7 +1322,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaf26428")
+            (id "0xb079a08")
             (pos 934.13 1187.44)
             (parent "")
             (select-mask 1)
@@ -1264,7 +1333,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaf26590")
+            (id "0xb079ac8")
             (pos 422.13 1187.44)
             (parent "")
             (select-mask 1)
@@ -1275,7 +1344,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaefb520")
+            (id "0xb079c48")
             (pos 166.13 1187.44)
             (parent "")
             (select-mask 1)
@@ -1286,7 +1355,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaf7c7d8")
+            (id "0xb0ba660")
             (pos 678.13 1187.44)
             (parent "")
             (select-mask 1)
@@ -1297,7 +1366,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xafa7968")
+            (id "0xb0ba7e0")
             (pos -89.87 1187.44)
             (parent "")
             (select-mask 1)
@@ -1308,7 +1377,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xafa7a28")
+            (id "0xa98d2b8")
             (pos -889.032 1273.44)
             (parent "")
             (select-mask 1)
@@ -1319,7 +1388,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xafa7b40")
+            (id "0xa98d470")
             (pos -633.032 1273.44)
             (parent "")
             (select-mask 1)
@@ -1330,7 +1399,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xafd2678")
+            (id "0xb0e5688")
             (pos -345.87 1187.44)
             (parent "")
             (select-mask 1)
@@ -1341,7 +1410,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xafd2408")
+            (id "0xb0e5808")
             (pos -601.87 1187.44)
             (parent "")
             (select-mask 1)
@@ -1352,7 +1421,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb012518")
+            (id "0xb1102c8")
             (pos -1369.87 1187.44)
             (parent "")
             (select-mask 1)
@@ -1363,7 +1432,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb03d840")
+            (id "0xb1103a8")
             (pos -1881.87 1187.44)
             (parent "")
             (select-mask 1)
@@ -1374,7 +1443,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaf7c8b8")
+            (id "0xb165a80")
             (pos -1625.87 1187.44)
             (parent "")
             (select-mask 1)
@@ -1385,7 +1454,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaf7cad0")
+            (id "0xb165b50")
             (pos -1113.87 1187.44)
             (parent "")
             (select-mask 1)
@@ -1396,7 +1465,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb03d910")
+            (id "0xb165cd8")
             (pos -857.872 1187.44)
             (parent "")
             (select-mask 1)
@@ -1407,7 +1476,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb03da40")
+            (id "0xb1a5f10")
             (pos -1145.03 1273.44)
             (parent "")
             (select-mask 1)
@@ -1418,7 +1487,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb0a8478")
+            (id "0xb1a60a0")
             (pos -1657.03 1273.44)
             (parent "")
             (select-mask 1)
@@ -1429,7 +1498,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb0a87a8")
+            (id "0xb1d0b58")
             (pos -1401.03 1273.44)
             (parent "")
             (select-mask 1)
@@ -1440,7 +1509,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb0a86c0")
+            (id "0xb1d0c38")
             (pos -1913.03 1273.44)
             (parent "")
             (select-mask 1)
@@ -1451,7 +1520,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb0d3348")
+            (id "0xb1fb708")
             (pos -2169.03 1273.44)
             (parent "")
             (select-mask 1)
@@ -1462,7 +1531,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb0d3100")
+            (id "0xb1fb7c8")
             (pos -3193.03 1273.44)
             (parent "")
             (select-mask 1)
@@ -1473,7 +1542,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb0fe4e0")
+            (id "0xb1fb948")
             (pos -2937.03 1273.44)
             (parent "")
             (select-mask 1)
@@ -1484,7 +1553,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb0fe6a8")
+            (id "0xb23bf98")
             (pos -2681.03 1273.44)
             (parent "")
             (select-mask 1)
@@ -1495,7 +1564,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb0fe788")
+            (id "0xb23c118")
             (pos -2649.87 1187.44)
             (parent "")
             (select-mask 1)
@@ -1506,7 +1575,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb068510")
+            (id "0xb2673e8")
             (pos -2905.87 1187.44)
             (parent "")
             (select-mask 1)
@@ -1517,7 +1586,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb16a518")
+            (id "0xb2674c8")
             (pos -2809.03 1380.44)
             (parent "")
             (select-mask 1)
@@ -1528,7 +1597,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb13f220")
+            (id "0xb292790")
             (pos -3321.03 1380.44)
             (parent "")
             (select-mask 1)
@@ -1539,7 +1608,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb13f2e0")
+            (id "0xb292840")
             (pos -2393.87 1187.44)
             (parent "")
             (select-mask 1)
@@ -1550,7 +1619,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb195670")
+            (id "0xb2929e8")
             (pos -2137.87 1187.44)
             (parent "")
             (select-mask 1)
@@ -1561,7 +1630,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb195730")
+            (id "0xa98d1c8")
             (pos -2425.03 1273.44)
             (parent "")
             (select-mask 1)
@@ -1578,7 +1647,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0xb195888")
+            (id "0xb2d3240")
             (pos -1539 508)
             (parent "")
             (select-mask 1)
@@ -1589,7 +1658,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaa98e08")
+            (id "0xb2d3290")
             (pos -1539 380)
             (parent "")
             (select-mask 1)
@@ -1600,7 +1669,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xab26b40")
+            (id "0xa707dd8")
             (pos -1539 1020)
             (parent "")
             (select-mask 1)
@@ -1611,7 +1680,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xa325d58")
+            (id "0xa708e08")
             (pos -1539 892)
             (parent "")
             (select-mask 1)
@@ -1622,7 +1691,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xab26c88")
+            (id "0xa98cf78")
             (pos -1539 636)
             (parent "")
             (select-mask 1)
@@ -1633,7 +1702,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaeb538")
+            (id "0xa98cdd0")
             (pos -1539 764)
             (parent "")
             (select-mask 1)
@@ -1644,7 +1713,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xaaeb7a8")
+            (id "0xb2e8f30")
             (pos -1539 1148)
             (parent "")
             (select-mask 1)
@@ -1655,7 +1724,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb1ab298")
+            (id "0xb2e9078")
             (pos -1741 1084)
             (parent "")
             (select-mask 1)
@@ -1666,7 +1735,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb16a598")
+            (id "0xb2e97f0")
             (pos -2111 1084)
             (parent "")
             (select-mask 1)
@@ -1677,7 +1746,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb16a688")
+            (id "0xb2e8978")
             (pos -2111 824)
             (parent "")
             (select-mask 1)
@@ -1688,7 +1757,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb1ab8c8")
+            (id "0xb2e93d8")
             (pos -1741 824)
             (parent "")
             (select-mask 1)
@@ -1699,7 +1768,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb1ab9d0")
+            (id "0xb2e95c8")
             (pos -2111 568)
             (parent "")
             (select-mask 1)
@@ -1710,7 +1779,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb1abb08")
+            (id "0xb534840")
             (pos -1741 568)
             (parent "")
             (select-mask 1)
@@ -1721,7 +1790,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb458b28")
+            (id "0xb5348d8")
             (pos -2109 312)
             (parent "")
             (select-mask 1)
@@ -1732,7 +1801,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb458bf0")
+            (id "0xb534560")
             (pos -1739 312)
             (parent "")
             (select-mask 1)
@@ -1743,7 +1812,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb458cd0")
+            (id "0xb3c2360")
             (pos -1763.88 1198.81)
             (parent "")
             (select-mask 1)
@@ -1754,7 +1823,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb56edb8")
+            (id "0xb534688")
             (pos -2080.29 1241.78)
             (parent "")
             (select-mask 1)
@@ -1765,7 +1834,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb56eca0")
+            (id "0xb3c2070")
             (pos -2400.6 1212.48)
             (parent "")
             (select-mask 1)
@@ -1776,7 +1845,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb56e958")
+            (id "0xb3c2150")
             (pos -2239 276)
             (parent "")
             (select-mask 1)
@@ -1787,7 +1856,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb2882e0")
+            (id "0xb64a738")
             (pos -1976 368)
             (parent "")
             (select-mask 1)
@@ -1798,7 +1867,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb288760")
+            (id "0xb64a348")
             (pos -1717 263)
             (parent "")
             (select-mask 1)
@@ -1815,7 +1884,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0xb1ab158")
+            (id "0xac3e6c8")
             (pos 1836.13 1103.44)
             (parent "")
             (select-mask 1)
@@ -1826,7 +1895,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb288450")
+            (id "0xb64a568")
             (pos 2144.13 1103.44)
             (parent "")
             (select-mask 1)
@@ -1837,7 +1906,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb2885b0")
+            (id "0xb3c18d0")
             (pos -1551.87 1103.44)
             (parent "")
             (select-mask 1)
@@ -1848,7 +1917,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb628308")
+            (id "0xb3c19c0")
             (pos -1243.87 1103.44)
             (parent "")
             (select-mask 1)
@@ -1859,7 +1928,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb288ae0")
+            (id "0xb3c1ad0")
             (pos -935.87 1103.44)
             (parent "")
             (select-mask 1)
@@ -1870,7 +1939,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb6a8a48")
+            (id "0xb7503e8")
             (pos -627.87 1103.44)
             (parent "")
             (select-mask 1)
@@ -1881,7 +1950,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb288df0")
+            (id "0xb703d08")
             (pos -319.87 1103.44)
             (parent "")
             (select-mask 1)
@@ -1892,7 +1961,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb288c60")
+            (id "0xb750510")
             (pos -11.87 1103.44)
             (parent "")
             (select-mask 1)
@@ -1903,7 +1972,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb6a8b70")
+            (id "0xb7506d8")
             (pos 296.13 1103.44)
             (parent "")
             (select-mask 1)
@@ -1914,7 +1983,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb6a8d58")
+            (id "0xb7043f0")
             (pos 604.13 1103.44)
             (parent "")
             (select-mask 1)
@@ -1925,7 +1994,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb6294a8")
+            (id "0xb7045a8")
             (pos 912.13 1103.44)
             (parent "")
             (select-mask 1)
@@ -1936,7 +2005,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb6295d8")
+            (id "0xb79c5c0")
             (pos 1220.13 1103.44)
             (parent "")
             (select-mask 1)
@@ -1947,7 +2016,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb6296a0")
+            (id "0xb79c708")
             (pos 1528.13 1103.44)
             (parent "")
             (select-mask 1)
@@ -1970,7 +2039,7 @@
             (locked #t)
             (objects
               (decal
-                (id "0xab02f60")
+                (id "0xb704248")
                 (pos -1672.24 1055.45)
                 (parent "")
                 (select-mask 1)
@@ -1981,7 +2050,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb6f4c08")
+                (id "0xb7b5ed8")
                 (pos -1529 861)
                 (parent "")
                 (select-mask 1)
@@ -1992,7 +2061,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb6f4cd8")
+                (id "0xb834968")
                 (pos -1557 564)
                 (parent "")
                 (select-mask 1)
@@ -2003,7 +2072,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb740dd0")
+                (id "0xb834ce8")
                 (pos -1484.44 1141.69)
                 (parent "")
                 (select-mask 1)
@@ -2014,7 +2083,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb740ea0")
+                (id "0xb7b5fe0")
                 (pos -937.569 1133.87)
                 (parent "")
                 (select-mask 1)
@@ -2031,7 +2100,7 @@
             (locked #f)
             (objects
               (decal
-                (id "0xab4a678")
+                (id "0xa989728")
                 (pos -964 844)
                 (parent "")
                 (select-mask 1)
@@ -2042,7 +2111,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xaaeb130")
+                (id "0xa98a078")
                 (pos -1058 746)
                 (parent "")
                 (select-mask 1)
@@ -2053,7 +2122,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xab4ab30")
+                (id "0xa989e48")
                 (pos -1155 652)
                 (parent "")
                 (select-mask 1)
@@ -2064,7 +2133,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xab4af58")
+                (id "0xa989f88")
                 (pos -1250 547)
                 (parent "")
                 (select-mask 1)
@@ -2075,7 +2144,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xab4b220")
+                (id "0xa98a678")
                 (pos -1347 456)
                 (parent "")
                 (select-mask 1)
@@ -2086,7 +2155,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xab4b6e8")
+                (id "0xa98a418")
                 (pos -1440 363)
                 (parent "")
                 (select-mask 1)
@@ -2097,7 +2166,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xab4b7b0")
+                (id "0xa98a520")
                 (pos -863 930)
                 (parent "")
                 (select-mask 1)
@@ -2108,7 +2177,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xab4b428")
+                (id "0xa98a840")
                 (pos -1537 273)
                 (parent "")
                 (select-mask 1)
@@ -2119,7 +2188,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xab4bb20")
+                (id "0xa98aa00")
                 (pos -841 864)
                 (parent "")
                 (select-mask 1)
@@ -2130,7 +2199,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xab4ac88")
+                (id "0xa98b878")
                 (pos -969 736)
                 (parent "")
                 (select-mask 1)
@@ -2141,7 +2210,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xab4bca8")
+                (id "0xa98ade0")
                 (pos -1097 608)
                 (parent "")
                 (select-mask 1)
@@ -2152,7 +2221,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb83a928")
+                (id "0xa98b908")
                 (pos -1225 480)
                 (parent "")
                 (select-mask 1)
@@ -2163,7 +2232,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb83a9d0")
+                (id "0xa98ba38")
                 (pos -1353 352)
                 (parent "")
                 (select-mask 1)
@@ -2180,7 +2249,7 @@
             (locked #t)
             (objects
               (decal
-                (id "0xb860df0")
+                (id "0xa98b4f8")
                 (pos -1040 739)
                 (parent "")
                 (select-mask 1)
@@ -2191,7 +2260,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xab4be38")
+                (id "0xb91a388")
                 (pos -1358 869)
                 (parent "")
                 (select-mask 1)
@@ -2202,7 +2271,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb8a53d8")
+                (id "0xb92a900")
                 (pos -849 997)
                 (parent "")
                 (select-mask 1)
@@ -2213,7 +2282,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb8d5f18")
+                (id "0xb94ad80")
                 (pos -974 997)
                 (parent "")
                 (select-mask 1)
@@ -2224,7 +2293,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb8f6930")
+                (id "0xb95b060")
                 (pos -974 869)
                 (parent "")
                 (select-mask 1)
@@ -2235,7 +2304,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb8f6a30")
+                (id "0xb97b108")
                 (pos -1102 997)
                 (parent "")
                 (select-mask 1)
@@ -2246,7 +2315,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb906b48")
+                (id "0xb98b450")
                 (pos -1102 869)
                 (parent "")
                 (select-mask 1)
@@ -2257,7 +2326,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb926d68")
+                (id "0xb91a7b0")
                 (pos -1102 741)
                 (parent "")
                 (select-mask 1)
@@ -2268,7 +2337,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb937070")
+                (id "0xb99b600")
                 (pos -1230 613)
                 (parent "")
                 (select-mask 1)
@@ -2279,7 +2348,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb947248")
+                (id "0xb9ab758")
                 (pos -1358 613)
                 (parent "")
                 (select-mask 1)
@@ -2290,7 +2359,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb9573d8")
+                (id "0xb9cbae0")
                 (pos -1358 485)
                 (parent "")
                 (select-mask 1)
@@ -2301,7 +2370,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb9574f0")
+                (id "0xb9dbc38")
                 (pos -1486 613)
                 (parent "")
                 (select-mask 1)
@@ -2312,7 +2381,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb9675f0")
+                (id "0xb98b370")
                 (pos -1486 485)
                 (parent "")
                 (select-mask 1)
@@ -2323,7 +2392,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb987850")
+                (id "0xb9ebd68")
                 (pos -1486 357)
                 (parent "")
                 (select-mask 1)
@@ -2334,7 +2403,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb997b60")
+                (id "0xb9fbfd8")
                 (pos -1358 741)
                 (parent "")
                 (select-mask 1)
@@ -2345,7 +2414,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb9a7d38")
+                (id "0xb9fc0a0")
                 (pos -1486 741)
                 (parent "")
                 (select-mask 1)
@@ -2356,7 +2425,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb9b7ec8")
+                (id "0xba2c3f8")
                 (pos -1230 741)
                 (parent "")
                 (select-mask 1)
@@ -2367,7 +2436,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb9c8068")
+                (id "0xba3c710")
                 (pos -1486 869)
                 (parent "")
                 (select-mask 1)
@@ -2378,7 +2447,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb9c8140")
+                (id "0xba1c270")
                 (pos -1230 869)
                 (parent "")
                 (select-mask 1)
@@ -2389,7 +2458,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb9e8360")
+                (id "0xba4c890")
                 (pos -1358 997)
                 (parent "")
                 (select-mask 1)
@@ -2400,7 +2469,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb9f86a0")
+                (id "0xba4c970")
                 (pos -1486 997)
                 (parent "")
                 (select-mask 1)
@@ -2411,7 +2480,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xba08800")
+                (id "0xba7ce28")
                 (pos -1230 997)
                 (parent "")
                 (select-mask 1)
@@ -2422,7 +2491,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xba189a0")
+                (id "0xba8d0a0")
                 (pos -1347 917)
                 (parent "")
                 (select-mask 1)
@@ -2439,7 +2508,7 @@
             (locked #t)
             (objects
               (decal
-                (id "0xb895090")
+                (id "0xb906ea8")
                 (pos -658.251 306.508)
                 (parent "")
                 (select-mask 1)
@@ -2450,7 +2519,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xb874470")
+                (id "0xbaad898")
                 (pos -658.251 434.508)
                 (parent "")
                 (select-mask 1)
@@ -2461,7 +2530,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xba38e28")
+                (id "0xb91a690")
                 (pos -656.688 690.508)
                 (parent "")
                 (select-mask 1)
@@ -2472,7 +2541,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbae5490")
+                (id "0xbb1fc38")
                 (pos -656.688 562.508)
                 (parent "")
                 (select-mask 1)
@@ -2483,7 +2552,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbae5590")
+                (id "0xa98b0a0")
                 (pos -1425 307)
                 (parent "")
                 (select-mask 1)
@@ -2494,7 +2563,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbb1e3e8")
+                (id "0xbb68208")
                 (pos -656.462 935.117)
                 (parent "")
                 (select-mask 1)
@@ -2505,7 +2574,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbb4e678")
+                (id "0xa98b1a8")
                 (pos -656.688 818.508)
                 (parent "")
                 (select-mask 1)
@@ -2516,7 +2585,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbb97240")
+                (id "0xbb4fdf0")
                 (pos -657 946)
                 (parent "")
                 (select-mask 1)
@@ -2527,7 +2596,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbae5120")
+                (id "0xbb4ff40")
                 (pos -657 1074)
                 (parent "")
                 (select-mask 1)
@@ -2538,7 +2607,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbb97318")
+                (id "0xbb1f928")
                 (pos -1424.46 563.117)
                 (parent "")
                 (select-mask 1)
@@ -2549,7 +2618,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbb97040")
+                (id "0xbb98408")
                 (pos -1424.46 691.117)
                 (parent "")
                 (select-mask 1)
@@ -2560,7 +2629,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbb97180")
+                (id "0xbbb0e28")
                 (pos -1424.46 435.117)
                 (parent "")
                 (select-mask 1)
@@ -2571,7 +2640,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbb7ea28")
+                (id "0xbb984d0")
                 (pos -1424.46 819.117)
                 (parent "")
                 (select-mask 1)
@@ -2582,7 +2651,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbcee790")
+                (id "0xbbb0750")
                 (pos -1168.46 819.117)
                 (parent "")
                 (select-mask 1)
@@ -2593,7 +2662,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbcee998")
+                (id "0xbcf5300")
                 (pos -1168.46 435.117)
                 (parent "")
                 (select-mask 1)
@@ -2604,7 +2673,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbd36f08")
+                (id "0xbbb0cf8")
                 (pos -1168.46 691.117)
                 (parent "")
                 (select-mask 1)
@@ -2615,7 +2684,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbd36d98")
+                (id "0xbcf53f8")
                 (pos -1168.46 563.117)
                 (parent "")
                 (select-mask 1)
@@ -2626,7 +2695,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbd67210")
+                (id "0xbd0d738")
                 (pos -1169 307)
                 (parent "")
                 (select-mask 1)
@@ -2637,7 +2706,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbd1ea70")
+                (id "0xbd3d908")
                 (pos -912.462 307.117)
                 (parent "")
                 (select-mask 1)
@@ -2648,7 +2717,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbd1ec48")
+                (id "0xbd3da58")
                 (pos -912.462 563.117)
                 (parent "")
                 (select-mask 1)
@@ -2659,7 +2728,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbd97400")
+                (id "0xbd6dc60")
                 (pos -912.462 691.117)
                 (parent "")
                 (select-mask 1)
@@ -2670,7 +2739,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbd97608")
+                (id "0xbd6dd80")
                 (pos -912.462 435.117)
                 (parent "")
                 (select-mask 1)
@@ -2681,7 +2750,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbddfb20")
+                (id "0xbd9e178")
                 (pos -912.462 819.117)
                 (parent "")
                 (select-mask 1)
@@ -2692,7 +2761,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbddfc20")
+                (id "0xbd9df60")
                 (pos -1169 947)
                 (parent "")
                 (select-mask 1)
@@ -2703,7 +2772,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbdc7898")
+                (id "0xbdce488")
                 (pos -913 946)
                 (parent "")
                 (select-mask 1)
@@ -2714,7 +2783,7 @@
                 (hflip #f)
                 (vflip #f))
               (decal
-                (id "0xbe0fd18")
+                (id "0xbdce310")
                 (pos -913 1074)
                 (parent "")
                 (select-mask 1)
@@ -2731,7 +2800,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0xbe0ff70")
+            (id "0xbdfe930")
             (pos -498.687 804.29)
             (parent "")
             (select-mask 1)
@@ -2742,7 +2811,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xab4c1f8")
+            (id "0xbaad390")
             (pos -418.187 492.016)
             (parent "")
             (select-mask 1)
@@ -2759,9 +2828,9 @@
         (locked #t)
         (objects
           (decal
-            (id "0xba39378")
+            (id "0xb906de8")
             (pos -752 0)
-            (parent "0xbe40278")
+            (parent "0xbe2eb08")
             (select-mask 1)
             (path "images/decal/train_front.png")
             (type 0)
@@ -2770,9 +2839,9 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xbe40058")
+            (id "0xbdfe690")
             (pos 696 0)
-            (parent "0xbe40278")
+            (parent "0xbe2eb08")
             (select-mask 1)
             (path "images/decal/train_back.png")
             (type 0)
@@ -2781,7 +2850,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xbe40278")
+            (id "0xbe2eb08")
             (pos 1705.54 939.785)
             (parent "")
             (select-mask 1)
@@ -2792,9 +2861,9 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xbb96bb8")
+            (id "0xbe2eb88")
             (pos -586.991 241.125)
-            (parent "0xbe40278")
+            (parent "0xbe2eb08")
             (select-mask 1)
             (path "images/decal/train_engine_front.png")
             (type 0)
@@ -2803,9 +2872,9 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xbb96d98")
+            (id "0xbbb0a18")
             (pos 593.009 242.125)
-            (parent "0xbe40278")
+            (parent "0xbe2eb08")
             (select-mask 1)
             (path "images/decal/train_engine_back.png")
             (type 0)
@@ -2814,9 +2883,9 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xbe70550")
+            (id "0xbcacfd8")
             (pos -206.991 241.125)
-            (parent "0xbe40278")
+            (parent "0xbe2eb08")
             (select-mask 1)
             (path "images/decal/train_engine_middle.png")
             (type 0)
@@ -2825,9 +2894,9 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xbe89708")
+            (id "0xbcad060")
             (pos 249.009 241.125)
-            (parent "0xbe40278")
+            (parent "0xbe2eb08")
             (select-mask 1)
             (path "images/decal/train_engine_middle.png")
             (type 0)
@@ -2836,9 +2905,9 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xbecdda0")
+            (id "0xbe47ba0")
             (pos 0.719482 -14.875)
-            (parent "0xbe40278")
+            (parent "0xbe2eb08")
             (select-mask 1)
             (path "images/decal/train_door.png")
             (type 0)
@@ -2853,7 +2922,7 @@
         (locked #t)
         (objects
           (decal
-            (id "0xbf01e78")
+            (id "0xbec0590")
             (pos 1790.43 900.717)
             (parent "")
             (select-mask 1)
@@ -2864,7 +2933,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xbf02020")
+            (id "0xbec0b90")
             (pos 2046.43 900.717)
             (parent "")
             (select-mask 1)
@@ -2875,7 +2944,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a8ae0")
+            (id "0xc013b08")
             (pos 1278.43 900.717)
             (parent "")
             (select-mask 1)
@@ -2886,7 +2955,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a89a0")
+            (id "0xc013d08")
             (pos 1534.43 900.717)
             (parent "")
             (select-mask 1)
@@ -2897,7 +2966,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a6808")
+            (id "0xbec06c0")
             (pos 1022.43 900.717)
             (parent "")
             (select-mask 1)
@@ -2908,7 +2977,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a6cc0")
+            (id "0xbec07e0")
             (pos 2165.35 656.717)
             (parent "")
             (select-mask 1)
@@ -2919,7 +2988,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a6dd8")
+            (id "0xbfb9250")
             (pos 2101.35 464.717)
             (parent "")
             (select-mask 1)
@@ -2930,7 +2999,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a70b8")
+            (id "0xc121ef8")
             (pos 2037.34 656.717)
             (parent "")
             (select-mask 1)
@@ -2941,7 +3010,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a71c8")
+            (id "0xc19c628")
             (pos 1781.34 656.717)
             (parent "")
             (select-mask 1)
@@ -2952,7 +3021,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a7a28")
+            (id "0xc1dcac8")
             (pos 1845.35 464.717)
             (parent "")
             (select-mask 1)
@@ -2963,7 +3032,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a7438")
+            (id "0xc19c350")
             (pos 1909.34 656.717)
             (parent "")
             (select-mask 1)
@@ -2974,7 +3043,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a80f0")
+            (id "0xc19c488")
             (pos 1397.34 656.717)
             (parent "")
             (select-mask 1)
@@ -2985,7 +3054,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a82c0")
+            (id "0xbfb9838")
             (pos 1333.35 464.717)
             (parent "")
             (select-mask 1)
@@ -2996,7 +3065,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a7588")
+            (id "0xbfb9550")
             (pos 1269.34 656.717)
             (parent "")
             (select-mask 1)
@@ -3007,7 +3076,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a83a0")
+            (id "0xc23ce00")
             (pos 1525.34 656.717)
             (parent "")
             (select-mask 1)
@@ -3018,7 +3087,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a84e0")
+            (id "0xbfb9620")
             (pos 1589.35 464.717)
             (parent "")
             (select-mask 1)
@@ -3029,7 +3098,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a86b0")
+            (id "0xc2ed450")
             (pos 1653.34 656.717)
             (parent "")
             (select-mask 1)
@@ -3040,7 +3109,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a7740")
+            (id "0xc23ccf8")
             (pos 629.352 656.717)
             (parent "")
             (select-mask 1)
@@ -3051,7 +3120,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc390ac0")
+            (id "0xc2fd5d8")
             (pos 565.354 464.717)
             (parent "")
             (select-mask 1)
@@ -3062,7 +3131,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a7890")
+            (id "0xc2fd858")
             (pos 501.352 656.717)
             (parent "")
             (select-mask 1)
@@ -3073,7 +3142,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc390d10")
+            (id "0xc2fd7d8")
             (pos 245.352 656.717)
             (parent "")
             (select-mask 1)
@@ -3084,7 +3153,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a7b08")
+            (id "0xc3ade48")
             (pos 309.354 464.717)
             (parent "")
             (select-mask 1)
@@ -3095,7 +3164,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a7ec8")
+            (id "0xc3adef0")
             (pos 373.352 656.717)
             (parent "")
             (select-mask 1)
@@ -3106,7 +3175,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xb7a7cf8")
+            (id "0xc35dcf0")
             (pos 885.352 656.717)
             (parent "")
             (select-mask 1)
@@ -3117,7 +3186,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc451290")
+            (id "0xc3be020")
             (pos 821.354 464.717)
             (parent "")
             (select-mask 1)
@@ -3128,7 +3197,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc451408")
+            (id "0xc3be0f0")
             (pos 757.352 656.717)
             (parent "")
             (select-mask 1)
@@ -3139,7 +3208,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc4b1968")
+            (id "0xc40e4a0")
             (pos 1013.35 656.717)
             (parent "")
             (select-mask 1)
@@ -3150,7 +3219,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc4b16e0")
+            (id "0xc41e668")
             (pos 1077.35 464.717)
             (parent "")
             (select-mask 1)
@@ -3161,7 +3230,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc4b17e0")
+            (id "0xc46eab8")
             (pos 1141.34 656.717)
             (parent "")
             (select-mask 1)
@@ -3172,7 +3241,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc3f0f60")
+            (id "0xc46eba8")
             (pos -394.638 656.717)
             (parent "")
             (select-mask 1)
@@ -3183,7 +3252,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc390630")
+            (id "0xc41e810")
             (pos -138.648 656.717)
             (parent "")
             (select-mask 1)
@@ -3194,7 +3263,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc5623c0")
+            (id "0xc47ecc8")
             (pos -202.646 464.717)
             (parent "")
             (select-mask 1)
@@ -3205,7 +3274,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc562480")
+            (id "0xc47ee40")
             (pos -266.648 656.717)
             (parent "")
             (select-mask 1)
@@ -3216,7 +3285,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc3907d8")
+            (id "0xc4df108")
             (pos -10.6475 656.717)
             (parent "")
             (select-mask 1)
@@ -3227,7 +3296,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc512050")
+            (id "0xc4ef2a0")
             (pos 53.3544 464.717)
             (parent "")
             (select-mask 1)
@@ -3238,7 +3307,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc511f60")
+            (id "0xc4ef370")
             (pos 117.352 656.717)
             (parent "")
             (select-mask 1)
@@ -3249,7 +3318,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc5d2a48")
+            (id "0xc53f720")
             (pos 766.427 900.717)
             (parent "")
             (select-mask 1)
@@ -3260,7 +3329,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc582580")
+            (id "0xc54f8e8")
             (pos 510.427 900.717)
             (parent "")
             (select-mask 1)
@@ -3271,7 +3340,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc5826e8")
+            (id "0xc54fba0")
             (pos 254.427 900.717)
             (parent "")
             (select-mask 1)
@@ -3282,7 +3351,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc632fd8")
+            (id "0xc59fd50")
             (pos -458.636 464.717)
             (parent "")
             (select-mask 1)
@@ -3293,7 +3362,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc6330c0")
+            (id "0xc54faf8")
             (pos -522.638 656.717)
             (parent "")
             (select-mask 1)
@@ -3304,7 +3373,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc6e73a8")
+            (id "0xc6544a8")
             (pos -1.57263 900.717)
             (parent "")
             (select-mask 1)
@@ -3315,7 +3384,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc7818e0")
+            (id "0xc6540f8")
             (pos -257.573 900.717)
             (parent "")
             (select-mask 1)
@@ -3326,7 +3395,7 @@
             (hflip #f)
             (vflip #f))
           (decal
-            (id "0xc6e7538")
+            (id "0xc654320")
             (pos -513.573 900.717)
             (parent "")
             (select-mask 1)



From grumbel at mail.berlios.de  Fri Apr 10 00:24:01 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Fri, 10 Apr 2009 00:24:01 +0200
Subject: [Windstille-commit] r2909 - in trunk/windstille/src: . editor
Message-ID: <200904092224.n39MO1wt028941@sheep.berlios.de>

Author: grumbel
Date: 2009-04-10 00:24:00 +0200 (Fri, 10 Apr 2009)
New Revision: 2909

Added:
   trunk/windstille/src/editor/decal_rotate_control_point.cpp
   trunk/windstille/src/editor/decal_scale_control_point.cpp
Modified:
   trunk/windstille/src/SConscript
   trunk/windstille/src/editor/decal_rotate_control_point.hpp
   trunk/windstille/src/editor/decal_scale_control_point.hpp
Log:
Split of some code from .hpp into .cpp file

Modified: trunk/windstille/src/SConscript
===================================================================
--- trunk/windstille/src/SConscript	2009-04-09 21:05:12 UTC (rev 2908)
+++ trunk/windstille/src/SConscript	2009-04-09 22:24:00 UTC (rev 2909)
@@ -243,6 +243,8 @@
         'editor/about_window.cpp',
         'editor/control_point.cpp',
         'editor/decal_object_model.cpp',
+        'editor/decal_rotate_control_point.cpp',
+        'editor/decal_scale_control_point.cpp',
         'editor/editor_window.cpp',
         'editor/layer_widget.cpp',
         'editor/layer.cpp',

Added: trunk/windstille/src/editor/decal_rotate_control_point.cpp
===================================================================
--- trunk/windstille/src/editor/decal_rotate_control_point.cpp	2009-04-09 21:05:12 UTC (rev 2908)
+++ trunk/windstille/src/editor/decal_rotate_control_point.cpp	2009-04-09 22:24:00 UTC (rev 2909)
@@ -0,0 +1,65 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#include "display/scene_context.hpp"
+#include "decal_rotate_control_point.hpp"
+
+DecalRotateControlPoint::DecalRotateControlPoint(DecalObjectModel* object_, float ctrl_angle_, const Vector2f& pos_)
+  : ControlPoint(Surface("editor/rotate_handle.png"), pos_),
+    object(object_),
+    ctrl_angle(ctrl_angle_),
+    orig_angle(object->get_angle()),
+    center(object->get_world_pos())
+{
+}
+
+void
+DecalRotateControlPoint::on_move_start(GdkEventMotion* event) 
+{
+}
+
+void
+DecalRotateControlPoint::on_move_update(GdkEventMotion* event, const Vector2f& offset_) 
+{
+  offset = offset_;
+
+  Vector2f base = pos - center;
+  float base_angle = atan2(base.y, base.x);
+
+  Vector2f current = (pos+offset) - center;
+  float current_angle = atan2(current.y, current.x);
+
+  float new_angle = orig_angle + current_angle - base_angle;
+  object->set_angle(new_angle);
+}
+  
+void
+DecalRotateControlPoint::on_move_end(GdkEventMotion* event, const Vector2f& offset_)
+{
+  on_move_update(event, offset_);
+}
+
+void
+DecalRotateControlPoint::draw(SceneContext& sc)
+{
+  Rectf rect = get_bounding_box();
+  rect += offset;
+  sc.control().draw_control(surface, pos, ctrl_angle);
+}
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/decal_rotate_control_point.cpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Modified: trunk/windstille/src/editor/decal_rotate_control_point.hpp
===================================================================
--- trunk/windstille/src/editor/decal_rotate_control_point.hpp	2009-04-09 21:05:12 UTC (rev 2908)
+++ trunk/windstille/src/editor/decal_rotate_control_point.hpp	2009-04-09 22:24:00 UTC (rev 2909)
@@ -31,44 +31,13 @@
   Vector2f center;
 
 public:
-  DecalRotateControlPoint(DecalObjectModel* object_, float ctrl_angle_, const Vector2f& pos_)
-    : ControlPoint(Surface("editor/rotate_handle.png"), pos_),
-      object(object_),
-      ctrl_angle(ctrl_angle_),
-      orig_angle(object->get_angle()),
-      center(object->get_world_pos())
-  {
-  }
+  DecalRotateControlPoint(DecalObjectModel* object_, float ctrl_angle_, const Vector2f& pos_);
 
-  void on_move_start(GdkEventMotion* event) 
-  {
-  }
+  void on_move_start(GdkEventMotion* event);
+  void on_move_update(GdkEventMotion* event, const Vector2f& offset_); 
+  void on_move_end(GdkEventMotion* event, const Vector2f& offset_);
 
-  void on_move_update(GdkEventMotion* event, const Vector2f& offset_) 
-  {
-    offset = offset_;
-
-    Vector2f base = pos - center;
-    float base_angle = atan2(base.y, base.x);
-
-    Vector2f current = (pos+offset) - center;
-    float current_angle = atan2(current.y, current.x);
-
-    float new_angle = orig_angle + current_angle - base_angle;
-    object->set_angle(new_angle);
-  }
-  
-  void on_move_end(GdkEventMotion* event, const Vector2f& offset_)
-  {
-    on_move_update(event, offset_);
-  }
-
-  void draw(SceneContext& sc)
-  {
-    Rectf rect = get_bounding_box();
-    rect += offset;
-    sc.control().draw_control(surface, pos, ctrl_angle);
-  }
+  void draw(SceneContext& sc);
 };
 
 #endif

Added: trunk/windstille/src/editor/decal_scale_control_point.cpp
===================================================================
--- trunk/windstille/src/editor/decal_scale_control_point.cpp	2009-04-09 21:05:12 UTC (rev 2908)
+++ trunk/windstille/src/editor/decal_scale_control_point.cpp	2009-04-09 22:24:00 UTC (rev 2909)
@@ -0,0 +1,79 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#include "display/scene_context.hpp"
+#include "decal_scale_control_point.hpp"
+
+DecalScaleControlPoint::DecalScaleControlPoint(DecalObjectModel* object_, float ctrl_angle_, const Vector2f& pos_, 
+                                               bool x_scale_, bool y_scale_)
+  : ControlPoint(Surface("editor/scale_handle.png"), pos_),
+    object(object_),
+    ctrl_angle(ctrl_angle_),
+    orig_scale(object_->get_scale()),
+    x_scale(x_scale_),
+    y_scale(y_scale_)
+{}
+
+void
+DecalScaleControlPoint::on_move_start(GdkEventButton* event)
+{ 
+}
+
+void
+DecalScaleControlPoint::on_move_update(GdkEventMotion* event, const Vector2f& offset_) 
+{
+  offset = offset_; 
+
+  Vector2f start   = pos - object->get_world_pos();
+  Vector2f current = (pos + offset) - object->get_world_pos();
+
+  start    = start.rotate(-object->get_angle());
+  current = current.rotate(-object->get_angle());
+    
+  Vector2f new_scale = orig_scale;
+
+  if (x_scale)
+    {
+      new_scale.x = current.x / start.x;
+      new_scale.x *= orig_scale.x;
+    }
+
+  if (y_scale)
+    {
+      new_scale.y = current.y / start.y;
+      new_scale.y *= orig_scale.y;
+    }
+
+  object->set_scale(new_scale);
+}
+  
+void
+DecalScaleControlPoint::on_move_end(GdkEventButton* event, const Vector2f& offset_)
+{
+  on_move_update(0/*event*/, offset_);
+}
+
+void
+DecalScaleControlPoint::draw(SceneContext& sc)
+{
+  Rectf rect = get_bounding_box();
+  rect += offset;
+  sc.control().draw_control(surface, pos, ctrl_angle);
+}
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/decal_scale_control_point.cpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Modified: trunk/windstille/src/editor/decal_scale_control_point.hpp
===================================================================
--- trunk/windstille/src/editor/decal_scale_control_point.hpp	2009-04-09 21:05:12 UTC (rev 2908)
+++ trunk/windstille/src/editor/decal_scale_control_point.hpp	2009-04-09 22:24:00 UTC (rev 2909)
@@ -31,59 +31,16 @@
   Vector2f orig_scale;
   bool x_scale;
   bool y_scale;
-
+  
 public:
-  DecalScaleControlPoint(DecalObjectModel* object_, float ctrl_angle_, const Vector2f& pos_, bool x_scale_ = true, bool y_scale_ = true)
-    : ControlPoint(Surface("editor/scale_handle.png"), pos_),
-      object(object_),
-      ctrl_angle(ctrl_angle_),
-      orig_scale(object_->get_scale()),
-      x_scale(x_scale_),
-      y_scale(y_scale_)
-  {}
+  DecalScaleControlPoint(DecalObjectModel* object_, float ctrl_angle_, const Vector2f& pos_, bool 
+                         x_scale_ = true, bool y_scale_ = true);
 
-  void on_move_start(GdkEventButton* event) 
-  {
-  }
+  void on_move_start(GdkEventButton* event);
+  void on_move_update(GdkEventMotion* event, const Vector2f& offset_);
+  void on_move_end(GdkEventButton* event, const Vector2f& offset_);
 
-  void on_move_update(GdkEventMotion* event, const Vector2f& offset_) 
-  {
-    offset = offset_; 
-
-    Vector2f start   = pos - object->get_world_pos();
-    Vector2f current = (pos + offset) - object->get_world_pos();
-
-    start    = start.rotate(-object->get_angle());
-    current = current.rotate(-object->get_angle());
-    
-    Vector2f new_scale = orig_scale;
-
-    if (x_scale)
-      {
-        new_scale.x = current.x / start.x;
-        new_scale.x *= orig_scale.x;
-      }
-
-    if (y_scale)
-      {
-        new_scale.y = current.y / start.y;
-        new_scale.y *= orig_scale.y;
-      }
-
-    object->set_scale(new_scale);
-  }
-  
-  void on_move_end(GdkEventButton* event, const Vector2f& offset_)
-  {
-    on_move_update(0/*event*/, offset_);
-  }
-
-  void draw(SceneContext& sc)
-  {
-    Rectf rect = get_bounding_box();
-    rect += offset;
-    sc.control().draw_control(surface, pos, ctrl_angle);
-  }
+  void draw(SceneContext& sc);
 };
 
 #endif



From grumbel at mail.berlios.de  Fri Apr 10 03:19:49 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Fri, 10 Apr 2009 03:19:49 +0200
Subject: [Windstille-commit] r2910 - trunk/windstille
Message-ID: <200904100119.n3A1Jnn2023658@sheep.berlios.de>

Author: grumbel
Date: 2009-04-10 03:19:49 +0200 (Fri, 10 Apr 2009)
New Revision: 2910

Modified:
   trunk/windstille/COPYING
Log:
Replaced GPLv3 with a more human readable explanation, providing links to the GPL and CC-by-sa

Modified: trunk/windstille/COPYING
===================================================================
--- trunk/windstille/COPYING	2009-04-09 22:24:00 UTC (rev 2909)
+++ trunk/windstille/COPYING	2009-04-10 01:19:49 UTC (rev 2910)
@@ -1,674 +1,76 @@
-                    GNU GENERAL PUBLIC LICENSE
-                       Version 3, 29 June 2007
+Source Code
+===========
 
- Copyright (C) 2007 Free Software Foundation, Inc. <http://fsf.org/>
- Everyone is permitted to copy and distribute verbatim copies
- of this license document, but changing it is not allowed.
+The main source code of Windstille (src/) is covered under the GPLv3
+or later, as indicated at the top of the files. You can find the full
+license text at:
 
-                            Preamble
+ * http://www.gnu.org/copyleft/gpl.html
 
-  The GNU General Public License is a free, copyleft license for
-software and other kinds of works.
+Short Summary:
 
-  The licenses for most software and other practical works are designed
-to take away your freedom to share and change the works.  By contrast,
-the GNU General Public License is intended to guarantee your freedom to
-share and change all versions of a program--to make sure it remains free
-software for all its users.  We, the Free Software Foundation, use the
-GNU General Public License for most of our software; it applies also to
-any other work released this way by its authors.  You can apply it to
-your programs, too.
+ * You are allowed to modify Windstille.
 
-  When we speak of free software, we are referring to freedom, not
-price.  Our General Public Licenses are designed to make sure that you
-have the freedom to distribute copies of free software (and charge for
-them if you wish), that you receive source code or can get it if you
-want it, that you can change the software or use pieces of it in new
-free programs, and that you know you can do these things.
+ * You are allowed to redistribute Windstille.
 
-  To protect your rights, we need to prevent others from denying you
-these rights or asking you to surrender the rights.  Therefore, you have
-certain responsibilities if you distribute copies of the software, or if
-you modify it: responsibilities to respect the freedom of others.
+ * Your modifications must themselves be covered under the GPLv3 and
+   source code must be provided.
 
-  For example, if you distribute copies of such a program, whether
-gratis or for a fee, you must pass on to the recipients the same
-freedoms that you received.  You must make sure that they, too, receive
-or can get the source code.  And you must show them these terms so they
-know their rights.
+Extra Notes:
 
-  Developers that use the GNU GPL protect your rights with two steps:
-(1) assert copyright on the software, and (2) offer you this License
-giving you legal permission to copy, distribute and/or modify it.
+ * The GPL does not apply to external libraries, found in the
+   external/ directory, those libraries come under their own licenses,
+   see the respective directories for details.
 
-  For the developers' and authors' protection, the GPL clearly explains
-that there is no warranty for this free software.  For both users' and
-authors' sake, the GPL requires that modified versions be marked as
-changed, so that their problems will not be attributed erroneously to
-authors of previous versions.
 
-  Some devices are designed to deny users access to install or run
-modified versions of the software inside them, although the manufacturer
-can do so.  This is fundamentally incompatible with the aim of
-protecting users' freedom to change the software.  The systematic
-pattern of such abuse occurs in the area of products for individuals to
-use, which is precisely where it is most unacceptable.  Therefore, we
-have designed this version of the GPL to prohibit the practice for those
-products.  If such problems arise substantially in other domains, we
-stand ready to extend this provision to those domains in future versions
-of the GPL, as needed to protect the freedom of users.
+Graphics
+========
 
-  Finally, every program is threatened constantly by software patents.
-States should not allow patents to restrict development and use of
-software on general-purpose computers, but in those that do, we wish to
-avoid the special danger that patents applied to a free program could
-make it effectively proprietary.  To prevent this, the GPL assures that
-patents cannot be used to render the program non-free.
+Graphics in Windstille are covered under Creative Commons
+Attribution-ShareAlike 3.0 or later (cc-by-sa). You can find the full license
+text at:
 
-  The precise terms and conditions for copying, distribution and
-modification follow.
+ * http://creativecommons.org/licenses/by-sa/3.0/
 
-                       TERMS AND CONDITIONS
+Short Summary:
 
-  0. Definitions.
+ * You are allowed to modify Windstille Graphics.
 
-  "This License" refers to version 3 of the GNU General Public License.
+ * You are allowed to redistribute Windstille Graphics.
 
-  "Copyright" also means copyright-like laws that apply to other kinds of
-works, such as semiconductor masks.
+ * Your modified works must themselves be covered under the cc-by-sa.
 
-  "The Program" refers to any copyrightable work licensed under this
-License.  Each licensee is addressed as "you".  "Licensees" and
-"recipients" may be individuals or organizations.
+Extra Notes:
 
-  To "modify" a work means to copy from or adapt all or part of the work
-in a fashion requiring copyright permission, other than the making of an
-exact copy.  The resulting work is called a "modified version" of the
-earlier work or a work "based on" the earlier work.
+ * In the context of Windstille the GPLv3 is considered a "compatible
+   license", so feel free to use the graphics in a GPL covered
+   project.
 
-  A "covered work" means either the unmodified Program or a work based
-on the Program.
+ * You are not allowed to reuse Windstille assets in a project that
+   isn't, as a whole, either covered by the GPL or CC-by-sa. Namely
+   using Windstille assets in a "Freeware" or "Shareware" title is
+   strictly forbidden.
 
-  To "propagate" a work means to do anything with it that, without
-permission, would make you directly or secondarily liable for
-infringement under applicable copyright law, except executing it on a
-computer or modifying a private copy.  Propagation includes copying,
-distribution (with or without modification), making available to the
-public, and in some countries other activities as well.
+ * While not strictly required, you should include "source code"
+   (.blend, .xcf, ...) for the graphics whenever possible.
 
-  To "convey" a work means any kind of propagation that enables other
-parties to make or receive copies.  Mere interaction with a user through
-a computer network, with no transfer of a copy, is not conveying.
 
-  An interactive user interface displays "Appropriate Legal Notices"
-to the extent that it includes a convenient and prominently visible
-feature that (1) displays an appropriate copyright notice, and (2)
-tells the user that there is no warranty for the work (except to the
-extent that warranties are provided), that licensees may convey the
-work under this License, and how to view a copy of this License.  If
-the interface presents a list of user commands or options, such as a
-menu, a prominent item in the list meets this criterion.
+Music
+=====
 
-  1. Source Code.
+<insert explanation here>
 
-  The "source code" for a work means the preferred form of the work
-for making modifications to it.  "Object code" means any non-source
-form of a work.
 
-  A "Standard Interface" means an interface that either is an official
-standard defined by a recognized standards body, or, in the case of
-interfaces specified for a particular programming language, one that
-is widely used among developers working in that language.
+Sound Effects
+=============
 
-  The "System Libraries" of an executable work include anything, other
-than the work as a whole, that (a) is included in the normal form of
-packaging a Major Component, but which is not part of that Major
-Component, and (b) serves only to enable use of the work with that
-Major Component, or to implement a Standard Interface for which an
-implementation is available to the public in source code form.  A
-"Major Component", in this context, means a major essential component
-(kernel, window system, and so on) of the specific operating system
-(if any) on which the executable work runs, or a compiler used to
-produce the work, or an object code interpreter used to run it.
+<insert explanation here>
 
-  The "Corresponding Source" for a work in object code form means all
-the source code needed to generate, install, and (for an executable
-work) run the object code and to modify the work, including scripts to
-control those activities.  However, it does not include the work's
-System Libraries, or general-purpose tools or generally available free
-programs which are used unmodified in performing those activities but
-which are not part of the work.  For example, Corresponding Source
-includes interface definition files associated with source files for
-the work, and the source code for shared libraries and dynamically
-linked subprograms that the work is specifically designed to require,
-such as by intimate data communication or control flow between those
-subprograms and other parts of the work.
 
-  The Corresponding Source need not include anything that users
-can regenerate automatically from other parts of the Corresponding
-Source.
+Scripts, Levels and Story
+==========================
 
-  The Corresponding Source for a work in source code form is that
-same work.
+<insert explanation here>
 
-  2. Basic Permissions.
 
-  All rights granted under this License are granted for the term of
-copyright on the Program, and are irrevocable provided the stated
-conditions are met.  This License explicitly affirms your unlimited
-permission to run the unmodified Program.  The output from running a
-covered work is covered by this License only if the output, given its
-content, constitutes a covered work.  This License acknowledges your
-rights of fair use or other equivalent, as provided by copyright law.
-
-  You may make, run and propagate covered works that you do not
-convey, without conditions so long as your license otherwise remains
-in force.  You may convey covered works to others for the sole purpose
-of having them make modifications exclusively for you, or provide you
-with facilities for running those works, provided that you comply with
-the terms of this License in conveying all material for which you do
-not control copyright.  Those thus making or running the covered works
-for you must do so exclusively on your behalf, under your direction
-and control, on terms that prohibit them from making any copies of
-your copyrighted material outside their relationship with you.
-
-  Conveying under any other circumstances is permitted solely under
-the conditions stated below.  Sublicensing is not allowed; section 10
-makes it unnecessary.
-
-  3. Protecting Users' Legal Rights From Anti-Circumvention Law.
-
-  No covered work shall be deemed part of an effective technological
-measure under any applicable law fulfilling obligations under article
-11 of the WIPO copyright treaty adopted on 20 December 1996, or
-similar laws prohibiting or restricting circumvention of such
-measures.
-
-  When you convey a covered work, you waive any legal power to forbid
-circumvention of technological measures to the extent such circumvention
-is effected by exercising rights under this License with respect to
-the covered work, and you disclaim any intention to limit operation or
-modification of the work as a means of enforcing, against the work's
-users, your or third parties' legal rights to forbid circumvention of
-technological measures.
-
-  4. Conveying Verbatim Copies.
-
-  You may convey verbatim copies of the Program's source code as you
-receive it, in any medium, provided that you conspicuously and
-appropriately publish on each copy an appropriate copyright notice;
-keep intact all notices stating that this License and any
-non-permissive terms added in accord with section 7 apply to the code;
-keep intact all notices of the absence of any warranty; and give all
-recipients a copy of this License along with the Program.
-
-  You may charge any price or no price for each copy that you convey,
-and you may offer support or warranty protection for a fee.
-
-  5. Conveying Modified Source Versions.
-
-  You may convey a work based on the Program, or the modifications to
-produce it from the Program, in the form of source code under the
-terms of section 4, provided that you also meet all of these conditions:
-
-    a) The work must carry prominent notices stating that you modified
-    it, and giving a relevant date.
-
-    b) The work must carry prominent notices stating that it is
-    released under this License and any conditions added under section
-    7.  This requirement modifies the requirement in section 4 to
-    "keep intact all notices".
-
-    c) You must license the entire work, as a whole, under this
-    License to anyone who comes into possession of a copy.  This
-    License will therefore apply, along with any applicable section 7
-    additional terms, to the whole of the work, and all its parts,
-    regardless of how they are packaged.  This License gives no
-    permission to license the work in any other way, but it does not
-    invalidate such permission if you have separately received it.
-
-    d) If the work has interactive user interfaces, each must display
-    Appropriate Legal Notices; however, if the Program has interactive
-    interfaces that do not display Appropriate Legal Notices, your
-    work need not make them do so.
-
-  A compilation of a covered work with other separate and independent
-works, which are not by their nature extensions of the covered work,
-and which are not combined with it such as to form a larger program,
-in or on a volume of a storage or distribution medium, is called an
-"aggregate" if the compilation and its resulting copyright are not
-used to limit the access or legal rights of the compilation's users
-beyond what the individual works permit.  Inclusion of a covered work
-in an aggregate does not cause this License to apply to the other
-parts of the aggregate.
-
-  6. Conveying Non-Source Forms.
-
-  You may convey a covered work in object code form under the terms
-of sections 4 and 5, provided that you also convey the
-machine-readable Corresponding Source under the terms of this License,
-in one of these ways:
-
-    a) Convey the object code in, or embodied in, a physical product
-    (including a physical distribution medium), accompanied by the
-    Corresponding Source fixed on a durable physical medium
-    customarily used for software interchange.
-
-    b) Convey the object code in, or embodied in, a physical product
-    (including a physical distribution medium), accompanied by a
-    written offer, valid for at least three years and valid for as
-    long as you offer spare parts or customer support for that product
-    model, to give anyone who possesses the object code either (1) a
-    copy of the Corresponding Source for all the software in the
-    product that is covered by this License, on a durable physical
-    medium customarily used for software interchange, for a price no
-    more than your reasonable cost of physically performing this
-    conveying of source, or (2) access to copy the
-    Corresponding Source from a network server at no charge.
-
-    c) Convey individual copies of the object code with a copy of the
-    written offer to provide the Corresponding Source.  This
-    alternative is allowed only occasionally and noncommercially, and
-    only if you received the object code with such an offer, in accord
-    with subsection 6b.
-
-    d) Convey the object code by offering access from a designated
-    place (gratis or for a charge), and offer equivalent access to the
-    Corresponding Source in the same way through the same place at no
-    further charge.  You need not require recipients to copy the
-    Corresponding Source along with the object code.  If the place to
-    copy the object code is a network server, the Corresponding Source
-    may be on a different server (operated by you or a third party)
-    that supports equivalent copying facilities, provided you maintain
-    clear directions next to the object code saying where to find the
-    Corresponding Source.  Regardless of what server hosts the
-    Corresponding Source, you remain obligated to ensure that it is
-    available for as long as needed to satisfy these requirements.
-
-    e) Convey the object code using peer-to-peer transmission, provided
-    you inform other peers where the object code and Corresponding
-    Source of the work are being offered to the general public at no
-    charge under subsection 6d.
-
-  A separable portion of the object code, whose source code is excluded
-from the Corresponding Source as a System Library, need not be
-included in conveying the object code work.
-
-  A "User Product" is either (1) a "consumer product", which means any
-tangible personal property which is normally used for personal, family,
-or household purposes, or (2) anything designed or sold for incorporation
-into a dwelling.  In determining whether a product is a consumer product,
-doubtful cases shall be resolved in favor of coverage.  For a particular
-product received by a particular user, "normally used" refers to a
-typical or common use of that class of product, regardless of the status
-of the particular user or of the way in which the particular user
-actually uses, or expects or is expected to use, the product.  A product
-is a consumer product regardless of whether the product has substantial
-commercial, industrial or non-consumer uses, unless such uses represent
-the only significant mode of use of the product.
-
-  "Installation Information" for a User Product means any methods,
-procedures, authorization keys, or other information required to install
-and execute modified versions of a covered work in that User Product from
-a modified version of its Corresponding Source.  The information must
-suffice to ensure that the continued functioning of the modified object
-code is in no case prevented or interfered with solely because
-modification has been made.
-
-  If you convey an object code work under this section in, or with, or
-specifically for use in, a User Product, and the conveying occurs as
-part of a transaction in which the right of possession and use of the
-User Product is transferred to the recipient in perpetuity or for a
-fixed term (regardless of how the transaction is characterized), the
-Corresponding Source conveyed under this section must be accompanied
-by the Installation Information.  But this requirement does not apply
-if neither you nor any third party retains the ability to install
-modified object code on the User Product (for example, the work has
-been installed in ROM).
-
-  The requirement to provide Installation Information does not include a
-requirement to continue to provide support service, warranty, or updates
-for a work that has been modified or installed by the recipient, or for
-the User Product in which it has been modified or installed.  Access to a
-network may be denied when the modification itself materially and
-adversely affects the operation of the network or violates the rules and
-protocols for communication across the network.
-
-  Corresponding Source conveyed, and Installation Information provided,
-in accord with this section must be in a format that is publicly
-documented (and with an implementation available to the public in
-source code form), and must require no special password or key for
-unpacking, reading or copying.
-
-  7. Additional Terms.
-
-  "Additional permissions" are terms that supplement the terms of this
-License by making exceptions from one or more of its conditions.
-Additional permissions that are applicable to the entire Program shall
-be treated as though they were included in this License, to the extent
-that they are valid under applicable law.  If additional permissions
-apply only to part of the Program, that part may be used separately
-under those permissions, but the entire Program remains governed by
-this License without regard to the additional permissions.
-
-  When you convey a copy of a covered work, you may at your option
-remove any additional permissions from that copy, or from any part of
-it.  (Additional permissions may be written to require their own
-removal in certain cases when you modify the work.)  You may place
-additional permissions on material, added by you to a covered work,
-for which you have or can give appropriate copyright permission.
-
-  Notwithstanding any other provision of this License, for material you
-add to a covered work, you may (if authorized by the copyright holders of
-that material) supplement the terms of this License with terms:
-
-    a) Disclaiming warranty or limiting liability differently from the
-    terms of sections 15 and 16 of this License; or
-
-    b) Requiring preservation of specified reasonable legal notices or
-    author attributions in that material or in the Appropriate Legal
-    Notices displayed by works containing it; or
-
-    c) Prohibiting misrepresentation of the origin of that material, or
-    requiring that modified versions of such material be marked in
-    reasonable ways as different from the original version; or
-
-    d) Limiting the use for publicity purposes of names of licensors or
-    authors of the material; or
-
-    e) Declining to grant rights under trademark law for use of some
-    trade names, trademarks, or service marks; or
-
-    f) Requiring indemnification of licensors and authors of that
-    material by anyone who conveys the material (or modified versions of
-    it) with contractual assumptions of liability to the recipient, for
-    any liability that these contractual assumptions directly impose on
-    those licensors and authors.
-
-  All other non-permissive additional terms are considered "further
-restrictions" within the meaning of section 10.  If the Program as you
-received it, or any part of it, contains a notice stating that it is
-governed by this License along with a term that is a further
-restriction, you may remove that term.  If a license document contains
-a further restriction but permits relicensing or conveying under this
-License, you may add to a covered work material governed by the terms
-of that license document, provided that the further restriction does
-not survive such relicensing or conveying.
-
-  If you add terms to a covered work in accord with this section, you
-must place, in the relevant source files, a statement of the
-additional terms that apply to those files, or a notice indicating
-where to find the applicable terms.
-
-  Additional terms, permissive or non-permissive, may be stated in the
-form of a separately written license, or stated as exceptions;
-the above requirements apply either way.
-
-  8. Termination.
-
-  You may not propagate or modify a covered work except as expressly
-provided under this License.  Any attempt otherwise to propagate or
-modify it is void, and will automatically terminate your rights under
-this License (including any patent licenses granted under the third
-paragraph of section 11).
-
-  However, if you cease all violation of this License, then your
-license from a particular copyright holder is reinstated (a)
-provisionally, unless and until the copyright holder explicitly and
-finally terminates your license, and (b) permanently, if the copyright
-holder fails to notify you of the violation by some reasonable means
-prior to 60 days after the cessation.
-
-  Moreover, your license from a particular copyright holder is
-reinstated permanently if the copyright holder notifies you of the
-violation by some reasonable means, this is the first time you have
-received notice of violation of this License (for any work) from that
-copyright holder, and you cure the violation prior to 30 days after
-your receipt of the notice.
-
-  Termination of your rights under this section does not terminate the
-licenses of parties who have received copies or rights from you under
-this License.  If your rights have been terminated and not permanently
-reinstated, you do not qualify to receive new licenses for the same
-material under section 10.
-
-  9. Acceptance Not Required for Having Copies.
-
-  You are not required to accept this License in order to receive or
-run a copy of the Program.  Ancillary propagation of a covered work
-occurring solely as a consequence of using peer-to-peer transmission
-to receive a copy likewise does not require acceptance.  However,
-nothing other than this License grants you permission to propagate or
-modify any covered work.  These actions infringe copyright if you do
-not accept this License.  Therefore, by modifying or propagating a
-covered work, you indicate your acceptance of this License to do so.
-
-  10. Automatic Licensing of Downstream Recipients.
-
-  Each time you convey a covered work, the recipient automatically
-receives a license from the original licensors, to run, modify and
-propagate that work, subject to this License.  You are not responsible
-for enforcing compliance by third parties with this License.
-
-  An "entity transaction" is a transaction transferring control of an
-organization, or substantially all assets of one, or subdividing an
-organization, or merging organizations.  If propagation of a covered
-work results from an entity transaction, each party to that
-transaction who receives a copy of the work also receives whatever
-licenses to the work the party's predecessor in interest had or could
-give under the previous paragraph, plus a right to possession of the
-Corresponding Source of the work from the predecessor in interest, if
-the predecessor has it or can get it with reasonable efforts.
-
-  You may not impose any further restrictions on the exercise of the
-rights granted or affirmed under this License.  For example, you may
-not impose a license fee, royalty, or other charge for exercise of
-rights granted under this License, and you may not initiate litigation
-(including a cross-claim or counterclaim in a lawsuit) alleging that
-any patent claim is infringed by making, using, selling, offering for
-sale, or importing the Program or any portion of it.
-
-  11. Patents.
-
-  A "contributor" is a copyright holder who authorizes use under this
-License of the Program or a work on which the Program is based.  The
-work thus licensed is called the contributor's "contributor version".
-
-  A contributor's "essential patent claims" are all patent claims
-owned or controlled by the contributor, whether already acquired or
-hereafter acquired, that would be infringed by some manner, permitted
-by this License, of making, using, or selling its contributor version,
-but do not include claims that would be infringed only as a
-consequence of further modification of the contributor version.  For
-purposes of this definition, "control" includes the right to grant
-patent sublicenses in a manner consistent with the requirements of
-this License.
-
-  Each contributor grants you a non-exclusive, worldwide, royalty-free
-patent license under the contributor's essential patent claims, to
-make, use, sell, offer for sale, import and otherwise run, modify and
-propagate the contents of its contributor version.
-
-  In the following three paragraphs, a "patent license" is any express
-agreement or commitment, however denominated, not to enforce a patent
-(such as an express permission to practice a patent or covenant not to
-sue for patent infringement).  To "grant" such a patent license to a
-party means to make such an agreement or commitment not to enforce a
-patent against the party.
-
-  If you convey a covered work, knowingly relying on a patent license,
-and the Corresponding Source of the work is not available for anyone
-to copy, free of charge and under the terms of this License, through a
-publicly available network server or other readily accessible means,
-then you must either (1) cause the Corresponding Source to be so
-available, or (2) arrange to deprive yourself of the benefit of the
-patent license for this particular work, or (3) arrange, in a manner
-consistent with the requirements of this License, to extend the patent
-license to downstream recipients.  "Knowingly relying" means you have
-actual knowledge that, but for the patent license, your conveying the
-covered work in a country, or your recipient's use of the covered work
-in a country, would infringe one or more identifiable patents in that
-country that you have reason to believe are valid.
-
-  If, pursuant to or in connection with a single transaction or
-arrangement, you convey, or propagate by procuring conveyance of, a
-covered work, and grant a patent license to some of the parties
-receiving the covered work authorizing them to use, propagate, modify
-or convey a specific copy of the covered work, then the patent license
-you grant is automatically extended to all recipients of the covered
-work and works based on it.
-
-  A patent license is "discriminatory" if it does not include within
-the scope of its coverage, prohibits the exercise of, or is
-conditioned on the non-exercise of one or more of the rights that are
-specifically granted under this License.  You may not convey a covered
-work if you are a party to an arrangement with a third party that is
-in the business of distributing software, under which you make payment
-to the third party based on the extent of your activity of conveying
-the work, and under which the third party grants, to any of the
-parties who would receive the covered work from you, a discriminatory
-patent license (a) in connection with copies of the covered work
-conveyed by you (or copies made from those copies), or (b) primarily
-for and in connection with specific products or compilations that
-contain the covered work, unless you entered into that arrangement,
-or that patent license was granted, prior to 28 March 2007.
-
-  Nothing in this License shall be construed as excluding or limiting
-any implied license or other defenses to infringement that may
-otherwise be available to you under applicable patent law.
-
-  12. No Surrender of Others' Freedom.
-
-  If conditions are imposed on you (whether by court order, agreement or
-otherwise) that contradict the conditions of this License, they do not
-excuse you from the conditions of this License.  If you cannot convey a
-covered work so as to satisfy simultaneously your obligations under this
-License and any other pertinent obligations, then as a consequence you may
-not convey it at all.  For example, if you agree to terms that obligate you
-to collect a royalty for further conveying from those to whom you convey
-the Program, the only way you could satisfy both those terms and this
-License would be to refrain entirely from conveying the Program.
-
-  13. Use with the GNU Affero General Public License.
-
-  Notwithstanding any other provision of this License, you have
-permission to link or combine any covered work with a work licensed
-under version 3 of the GNU Affero General Public License into a single
-combined work, and to convey the resulting work.  The terms of this
-License will continue to apply to the part which is the covered work,
-but the special requirements of the GNU Affero General Public License,
-section 13, concerning interaction through a network will apply to the
-combination as such.
-
-  14. Revised Versions of this License.
-
-  The Free Software Foundation may publish revised and/or new versions of
-the GNU General Public License from time to time.  Such new versions will
-be similar in spirit to the present version, but may differ in detail to
-address new problems or concerns.
-
-  Each version is given a distinguishing version number.  If the
-Program specifies that a certain numbered version of the GNU General
-Public License "or any later version" applies to it, you have the
-option of following the terms and conditions either of that numbered
-version or of any later version published by the Free Software
-Foundation.  If the Program does not specify a version number of the
-GNU General Public License, you may choose any version ever published
-by the Free Software Foundation.
-
-  If the Program specifies that a proxy can decide which future
-versions of the GNU General Public License can be used, that proxy's
-public statement of acceptance of a version permanently authorizes you
-to choose that version for the Program.
-
-  Later license versions may give you additional or different
-permissions.  However, no additional obligations are imposed on any
-author or copyright holder as a result of your choosing to follow a
-later version.
-
-  15. Disclaimer of Warranty.
-
-  THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY
-APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT
-HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY
-OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,
-THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
-PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM
-IS WITH YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF
-ALL NECESSARY SERVICING, REPAIR OR CORRECTION.
-
-  16. Limitation of Liability.
-
-  IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
-WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR CONVEYS
-THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY
-GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE
-USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF
-DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD
-PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS),
-EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF
-SUCH DAMAGES.
-
-  17. Interpretation of Sections 15 and 16.
-
-  If the disclaimer of warranty and limitation of liability provided
-above cannot be given local legal effect according to their terms,
-reviewing courts shall apply local law that most closely approximates
-an absolute waiver of all civil liability in connection with the
-Program, unless a warranty or assumption of liability accompanies a
-copy of the Program in return for a fee.
-
-                     END OF TERMS AND CONDITIONS
-
-            How to Apply These Terms to Your New Programs
-
-  If you develop a new program, and you want it to be of the greatest
-possible use to the public, the best way to achieve this is to make it
-free software which everyone can redistribute and change under these terms.
-
-  To do so, attach the following notices to the program.  It is safest
-to attach them to the start of each source file to most effectively
-state the exclusion of warranty; and each file should have at least
-the "copyright" line and a pointer to where the full notice is found.
-
-    <one line to give the program's name and a brief idea of what it does.>
-    Copyright (C) <year>  <name of author>
-
-    This program is free software: you can redistribute it and/or modify
-    it under the terms of the GNU General Public License as published by
-    the Free Software Foundation, either version 3 of the License, or
-    (at your option) any later version.
-
-    This program is distributed in the hope that it will be useful,
-    but WITHOUT ANY WARRANTY; without even the implied warranty of
-    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-    GNU General Public License for more details.
-
-    You should have received a copy of the GNU General Public License
-    along with this program.  If not, see <http://www.gnu.org/licenses/>.
-
-Also add information on how to contact you by electronic and paper mail.
-
-  If the program does terminal interaction, make it output a short
-notice like this when it starts in an interactive mode:
-
-    <program>  Copyright (C) <year>  <name of author>
-    This program comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
-    This is free software, and you are welcome to redistribute it
-    under certain conditions; type `show c' for details.
-
-The hypothetical commands `show w' and `show c' should show the appropriate
-parts of the General Public License.  Of course, your program's commands
-might be different; for a GUI interface, you would use an "about box".
-
-  You should also get your employer (if you work as a programmer) or school,
-if any, to sign a "copyright disclaimer" for the program, if necessary.
-For more information on this, and how to apply and follow the GNU GPL, see
-<http://www.gnu.org/licenses/>.
-
-  The GNU General Public License does not permit incorporating your program
-into proprietary programs.  If your program is a subroutine library, you
-may consider it more useful to permit linking proprietary applications with
-the library.  If this is what you want to do, use the GNU Lesser General
-Public License instead of this License.  But first, please read
-<http://www.gnu.org/philosophy/why-not-lgpl.html>.
+# EOF #



From grumbel at mail.berlios.de  Fri Apr 10 07:01:17 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Fri, 10 Apr 2009 07:01:17 +0200
Subject: [Windstille-commit] r2911 - trunk/windstille/src/editor
Message-ID: <200904100501.n3A51HIn003149@sheep.berlios.de>

Author: grumbel
Date: 2009-04-10 07:01:04 +0200 (Fri, 10 Apr 2009)
New Revision: 2911

Modified:
   trunk/windstille/src/editor/layer_manager.cpp
   trunk/windstille/src/editor/sector_model.cpp
   trunk/windstille/src/editor/sector_model.hpp
Log:
Replaced layer-tree with simple layer-list

Modified: trunk/windstille/src/editor/layer_manager.cpp
===================================================================
--- trunk/windstille/src/editor/layer_manager.cpp	2009-04-10 01:19:49 UTC (rev 2910)
+++ trunk/windstille/src/editor/layer_manager.cpp	2009-04-10 05:01:04 UTC (rev 2911)
@@ -20,7 +20,7 @@
 #include <gtkmm/stock.h>
 #include <gtkmm/toolbar.h>
 #include <gtkmm/treemodel.h>
-#include <gtkmm/treestore.h>
+#include <gtkmm/liststore.h>
 #include <gtkmm/treeview.h>
 #include <gtkmm/treemodelcolumn.h>
 
@@ -117,7 +117,7 @@
     }
   else
     {
-      treeview.set_model(Glib::RefPtr<Gtk::TreeStore>());
+      treeview.set_model(Glib::RefPtr<Gtk::ListStore>());
     }
 }
 

Modified: trunk/windstille/src/editor/sector_model.cpp
===================================================================
--- trunk/windstille/src/editor/sector_model.cpp	2009-04-10 01:19:49 UTC (rev 2910)
+++ trunk/windstille/src/editor/sector_model.cpp	2009-04-10 05:01:04 UTC (rev 2911)
@@ -38,9 +38,9 @@
 SectorModel::SectorModel()
  : nav_graph(new NavigationGraph())
 {
-  layer_tree = Gtk::TreeStore::create(LayerManagerColumns::instance());
+  layer_tree = Gtk::ListStore::create(LayerManagerColumns::instance());
 
-  Gtk::TreeStore::iterator it = layer_tree->append();
+  Gtk::ListStore::iterator it = layer_tree->append();
 
   LayerHandle layer(new Layer());
 
@@ -64,12 +64,12 @@
 void
 SectorModel::add_layer(const std::string& name, const Gtk::TreeModel::Path& path)
 {
-  Gtk::TreeStore::iterator it;
+  Gtk::ListStore::iterator it;
 
   if (path.empty())
     it = layer_tree->append();
   else
-    it = layer_tree->append(layer_tree->get_iter(path)->children());
+    it = layer_tree->insert(layer_tree->get_iter(path));
 
   (*it)[LayerManagerColumns::instance().type_icon] = Gdk::Pixbuf::create_from_file("data/editor/type.png");
   (*it)[LayerManagerColumns::instance().name]      = name;
@@ -100,7 +100,7 @@
     }
   else
     { 
-      Gtk::TreeStore::iterator it = layer_tree->get_iter(path);
+      Gtk::ListStore::iterator it = layer_tree->get_iter(path);
       ((LayerHandle)(*it)[LayerManagerColumns::instance().layer])->add(object);
     }
 }
@@ -294,7 +294,7 @@
 }
 
 void
-SectorModel::load_layer(const FileReader& reader, const Gtk::TreeModel::Row* parent_row, 
+SectorModel::load_layer(const FileReader& reader, 
                         std::map<std::string, ObjectModelHandle>& id_table,
                         std::map<ObjectModelHandle, std::string>& parent_table)
 {
@@ -309,7 +309,6 @@
   reader.get("visible", visible);
   reader.get("locked", locked);
   reader.get("objects", objects_reader);
-  reader.get("child-layers", layers_reader);
 
   //std::cout << "loading layer: " << reader.get_name() << " " << name << " " << visible << " " << locked << std::endl;
 
@@ -337,7 +336,7 @@
     }
 
   // Append the layer to the tree
-  Gtk::TreeStore::iterator it = parent_row ? layer_tree->append(parent_row->children()) : it = layer_tree->append();
+  Gtk::ListStore::iterator it = layer_tree->append();
 
   (*it)[LayerManagerColumns::instance().type_icon] = Gdk::Pixbuf::create_from_file("data/editor/type.png");
   (*it)[LayerManagerColumns::instance().name]      = name;
@@ -346,12 +345,6 @@
   (*it)[LayerManagerColumns::instance().layer]     = layer;
 
   layer->update(*it);
-  
-  const std::vector<FileReader>& layers_sections = layers_reader.get_sections();
-  for(std::vector<FileReader>::const_iterator j = layers_sections.begin(); j != layers_sections.end(); ++j)
-    {
-      load_layer(*j, &(*it), id_table, parent_table);
-    }
 }
 
 void
@@ -379,13 +372,13 @@
           reader.get("navigation", navigation_section);
           nav_graph->load(navigation_section);
 
-          const std::vector<FileReader>& sections = reader.get_sections();
+          FileReader layers_section;
+          reader.get("layers", layers_section);
+
+          const std::vector<FileReader>& sections = layers_section.get_sections();
           for(std::vector<FileReader>::const_iterator i = sections.begin(); i != sections.end(); ++i)
             {
-              if (i->get_name() == "layer")
-                {
-                  load_layer(*i, 0, id_table, parent_table);
-                }
+              load_layer(*i, id_table, parent_table);
             }
           
           // Set the parents properly
@@ -420,32 +413,26 @@
   nav_graph->write(writer);
   writer.end_section();
 
-  write(writer, *(layer_tree->children().begin()));
+  writer.start_section("layers");
+  for(Gtk::ListStore::Children::iterator i = layer_tree->children().begin(); i != layer_tree->children().end(); ++i)
+    {
+      const Gtk::TreeRow& row = *i;
 
-  writer.end_section();
-  writer.write_raw("\n\n;; EOF ;;\n");
-}
+      writer.start_section("layer");
+      writer.write("name",    (Glib::ustring)(row[LayerManagerColumns::instance().name]));
+      writer.write("visible", (bool)row[LayerManagerColumns::instance().visible]);
+      writer.write("locked",  (bool)row[LayerManagerColumns::instance().locked]);
 
-void
-SectorModel::write(FileWriter& writer, const Gtk::TreeRow& row) const
-{
-  writer.start_section("layer");
-  writer.write("name",    (Glib::ustring)(row[LayerManagerColumns::instance().name]));
-  writer.write("visible", (bool)row[LayerManagerColumns::instance().visible]);
-  writer.write("locked",  (bool)row[LayerManagerColumns::instance().locked]);
+      writer.start_section("objects");
+      ((LayerHandle)row[LayerManagerColumns::instance().layer])->write(writer);
+      writer.end_section();
 
-  writer.start_section("objects");
-  ((LayerHandle)row[LayerManagerColumns::instance().layer])->write(writer);
-  writer.end_section();
-
-  writer.start_section("child-layers");
-  for(Gtk::TreeStore::Children::iterator i = row.children().begin(); i != row.children().end(); ++i)
-    {
-      write(writer, *i);
+      writer.end_section();
     }
   writer.end_section();
 
   writer.end_section();
+  writer.write_raw("\n\n;; EOF ;;\n");
 }
 
 struct PropSetFunctor
@@ -508,6 +495,7 @@
           layer->update(*iter);
         }
     }
+
   queue_draw();
 }
 

Modified: trunk/windstille/src/editor/sector_model.hpp
===================================================================
--- trunk/windstille/src/editor/sector_model.hpp	2009-04-10 01:19:49 UTC (rev 2910)
+++ trunk/windstille/src/editor/sector_model.hpp	2009-04-10 05:01:04 UTC (rev 2911)
@@ -21,7 +21,7 @@
 
 #include <set>
 #include <memory>
-#include <gtkmm/treestore.h>
+#include <gtkmm/liststore.h>
 #include <gdkmm/pixbuf.h>
 #include <vector>
 
@@ -68,7 +68,7 @@
 {
 private:
   std::auto_ptr<NavigationGraph> nav_graph;
-  Glib::RefPtr<Gtk::TreeStore> layer_tree;
+  Glib::RefPtr<Gtk::ListStore> layer_tree;
   Color ambient_color;
   
 public:
@@ -101,7 +101,7 @@
   
   // void select_objects(const Rectf& rect, bool replace_old_selection = true) const;
 
-  Glib::RefPtr<Gtk::TreeStore> get_layer_tree() { return layer_tree; }
+  Glib::RefPtr<Gtk::ListStore> get_layer_tree() { return layer_tree; }
 
   void on_row_changed(const Gtk::TreeModel::Path& path, const Gtk::TreeModel::iterator& iter);
   void on_row_deleted(const Gtk::TreeModel::Path& path);
@@ -120,11 +120,10 @@
   SnapData snap_object(const Rectf& object, const std::set<ObjectModelHandle>& ignore_objects) const;
 
   void load(const std::string& filename);
-  void load_layer(const FileReader& filename, const Gtk::TreeModel::Row* parent, 
+  void load_layer(const FileReader& filename, 
                   std::map<std::string, ObjectModelHandle>& id_table,
                   std::map<ObjectModelHandle, std::string>& parent_table);
   void write(FileWriter& writer) const;
-  void write(FileWriter& writer, const Gtk::TreeRow& row) const;
 
   NavigationGraph* get_nav_graph() const { return nav_graph.get(); }
 



From grumbel at mail.berlios.de  Fri Apr 10 07:03:47 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Fri, 10 Apr 2009 07:03:47 +0200
Subject: [Windstille-commit] r2913 - trunk/windstille
Message-ID: <200904100503.n3A53lQx004802@sheep.berlios.de>

Author: grumbel
Date: 2009-04-10 07:03:45 +0200 (Fri, 10 Apr 2009)
New Revision: 2913

Modified:
   trunk/windstille/COPYING
   trunk/windstille/INSTALL
   trunk/windstille/README
   trunk/windstille/TODO
Log:
TODO and other updates

Modified: trunk/windstille/COPYING
===================================================================
--- trunk/windstille/COPYING	2009-04-10 05:02:11 UTC (rev 2912)
+++ trunk/windstille/COPYING	2009-04-10 05:03:45 UTC (rev 2913)
@@ -1,5 +1,5 @@
 Source Code
-===========
+============
 
 The main source code of Windstille (src/) is covered under the GPLv3
 or later, as indicated at the top of the files. You can find the full
@@ -26,9 +26,9 @@
 Graphics
 ========
 
-Graphics in Windstille are covered under Creative Commons
-Attribution-ShareAlike 3.0 or later (cc-by-sa). You can find the full license
-text at:
+Graphics (.png, .xcf, .blend) in Windstille are covered under Creative
+Commons Attribution-ShareAlike 3.0 or later (cc-by-sa). You can find
+the full license text at:
 
  * http://creativecommons.org/licenses/by-sa/3.0/
 

Modified: trunk/windstille/INSTALL
===================================================================
--- trunk/windstille/INSTALL	2009-04-10 05:02:11 UTC (rev 2912)
+++ trunk/windstille/INSTALL	2009-04-10 05:03:45 UTC (rev 2913)
@@ -12,21 +12,41 @@
  * physfs
  * boost
  * scons
- * bison
+ * bison (bison++ will not work)
  * flex
+ * gtkmm (for the editor only)
+ * gtkglextmm (for the editor only)
 
-In most cases these will come with your distribution.
+In most cases these will come with your distribution. In Ubuntu you
+can install them with:
 
-The game does not support installation right now, just compile with:
+ % sudo apt-get install \
+     bison \
+     flex \
+     libboost-dev \
+     libboost-signals-dev \
+     libboost-thread-dev \
+     libfreetype6-dev \
+     libphysfs-dev \
+     libsdl-image1.2-dev \
+     libsdl1.2-dev \
+     scons \
+     libpng12-dev \
+     libopenal-dev \
+     libgtkmm-2.4-dev \
+     libgtkglextmm-x11-1.2-dev
 
- $ scons
+For compilation type:
 
+ % scons
+
 and run it from inside its source directory with:
 
- $ ./windstille
+ % ./windstille
 
-Compile on FreeBSD:
+Installation
+============
 
-<AnMaster> CPPFLAGS="-I/usr/local/include -D_SQ64" CXXFLAGS="-DICONV_CONST=const" LDFLAGS="-lpng -L/usr/local/lib" ./configure --prefix=$HOME/test --with-ogg=/usr/local --with-libOpenAL=/usr/local --with-libphysfs=/usr/local
+Installation isn't currently supported, run the executables directly from the source tree.
 
 # EOF #

Modified: trunk/windstille/README
===================================================================
--- trunk/windstille/README	2009-04-10 05:02:11 UTC (rev 2912)
+++ trunk/windstille/README	2009-04-10 05:03:45 UTC (rev 2913)
@@ -22,5 +22,4 @@
 copyright headers in place and distribute the source too if you
 distribute binaries, see the file COPYING for details.
 
-
 # EOF #

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-04-10 05:02:11 UTC (rev 2912)
+++ trunk/windstille/TODO	2009-04-10 05:03:45 UTC (rev 2913)
@@ -262,20 +262,6 @@
 
 * extend the concept of parenting to other(all?) objects
 
-* write "objects/decal.cpp" class, i.e. simple Surface class for
-  non-animated objects:
-
-  (decal (pos x y) 
-
-         ;; relative to pos
-         (quad x1 y1 ;; defaults to Rectf(Vector2f(0, 0), imagesize)
-               x2 y2
-               x3 y3
-               x4 y4)
-         (image "images/greychess.png")
-         (layer "color")
-         )
-
 * Display::push/pop_cliprect() doesn't handle different aspect-ratios properly
 
 * lightmap is broken with non-standard aspect-ratio
@@ -529,6 +515,9 @@
 Editor
 ======
 
+* add special blocker objects, i.e. black boxes that have a
+  configurable fadeout
+
 * add support for collision shapes, to mark lights or other objects as
   shootable/interactable
 
@@ -604,10 +593,8 @@
   them as independed meta-data:
  
   (layers
-    (layer (objects 1)
-           (child-layers
-             (layers
-               (layer (objects 2 3))))))
+    (layer (objects 1))
+    (layer (objects 2 3)))
 
   (objects
     (decal (id 1) ...)
@@ -700,16 +687,10 @@
 
 * New Layer System:
 
-  - normal Layers can contain child layers, which seems like a bad
-    idea, better way would be to have special objectless parent layers
-
   - there might be a need for special layers, such as a background
     layer or a color gradient layer, that doesn't contain objects, but
     is meaningful by itself
 
-  - having structured layers (tree) doesn't seem all that useful,
-    maybe flat layer list would be enough and easier to use
-
 * add button and keyboard shortcut to mark/unmark all layers in the layermask
 
 * add a way to move object to a different layer
@@ -838,6 +819,12 @@
   - enemies
   - active objects (doors, switches, etc.)
 
+Build System
+============
+
+* write a script that builds cross compile environment with mingw on Ubuntu
+
+
 Code Cleanup
 ============
 



From grumbel at mail.berlios.de  Fri Apr 10 07:02:47 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Fri, 10 Apr 2009 07:02:47 +0200
Subject: [Windstille-commit] r2912 - in trunk/windstille/data/sectors: .
	trainstation
Message-ID: <200904100502.n3A52lxq004033@sheep.berlios.de>

Author: grumbel
Date: 2009-04-10 07:02:11 +0200 (Fri, 10 Apr 2009)
New Revision: 2912

Modified:
   trunk/windstille/data/sectors/bar.wst
   trunk/windstille/data/sectors/trainstation/bar.wst
   trunk/windstille/data/sectors/trainstation/bathroom.wst
   trunk/windstille/data/sectors/trainstation/boxstack_test.wst
   trunk/windstille/data/sectors/trainstation/city.wst
   trunk/windstille/data/sectors/trainstation/container.wst
   trunk/windstille/data/sectors/trainstation/elevator.wst
   trunk/windstille/data/sectors/trainstation/mine.wst
   trunk/windstille/data/sectors/trainstation/office.wst
   trunk/windstille/data/sectors/trainstation/stairtest.wst
   trunk/windstille/data/sectors/trainstation/steelplatetest.wst
   trunk/windstille/data/sectors/trainstation/toilet.wst
   trunk/windstille/data/sectors/trainstation/train.wst
   trunk/windstille/data/sectors/trainstation/trainstation.wst
   trunk/windstille/data/sectors/trainstation/worker.wst
Log:
Converted sectors to new flat layer list

Modified: trunk/windstille/data/sectors/bar.wst
===================================================================
--- trunk/windstille/data/sectors/bar.wst	2009-04-10 05:01:04 UTC (rev 2911)
+++ trunk/windstille/data/sectors/bar.wst	2009-04-10 05:02:11 UTC (rev 2912)
@@ -1,189 +1,319 @@
 ;; -*- scheme -*-
 
 (windstille-sector
-  (version 1)
+  (version 2)
   (name "")
   (ambient-color 0.6 0.6 0.6 1)
   (init-script "init.nut")
-  (layer
-    (name "Scene")
-    (visible 1)
-    (locked 1)
-    (objects
-      (decal
-        (pos 540.188 405.812)
-        (parent "")
-        (layer 1)
-        (path "images/objects/bar/seat.png")
-        (type 0))
-      (decal
-        (pos 805.375 380.812)
-        (parent "")
-        (layer 1)
-        (path "images/objects/bar/door.png")
-        (type 0))
-      (decal
-        (pos 329.25 444.812)
-        (parent "")
-        (layer 1)
-        (path "images/objects/bar/table.png")
-        (type 0))
-      (decal
-        (pos 1059 323)
-        (parent "")
-        (layer 1)
-        (path "images/objects/bar/doubledoor.png")
-        (type 0))
-      (decal
-        (pos -123.812 465.812)
-        (parent "")
-        (layer 1)
-        (path "images/objects/bar.png")
-        (type 0))
-      (decal
-        (pos 997.375 572.812)
-        (parent "")
-        (layer 1)
-        (path "images/objects/blueground.png")
-        (type 0))
-      (decal
-        (pos 741.375 572.812)
-        (parent "")
-        (layer 1)
-        (path "images/objects/blueground.png")
-        (type 0))
-      (decal
-        (pos 229.375 572.812)
-        (parent "")
-        (layer 1)
-        (path "images/objects/blueground.png")
-        (type 0))
-      (decal
-        (pos 485.375 572.812)
-        (parent "")
-        (layer 1)
-        (path "images/objects/blueground.png")
-        (type 0))
-      (decal
-        (pos -282.625 572.812)
-        (parent "")
-        (layer 1)
-        (path "images/objects/blueground.png")
-        (type 0))
-      (decal
-        (pos -26.6251 572.812)
-        (parent "")
-        (layer 1)
-        (path "images/objects/blueground.png")
-        (type 0)))
-    (child-layers
-      (layer
-        (name "Stuff")
-        (visible 1)
-        (locked 1)
-        (objects
-          (decal
-            (pos -10.8125 433.812)
-            (parent "")
-            (layer 1)
-            (path "images/objects/bar/stool.png")
-            (type 0))
-          (decal
-            (pos 610.188 379.812)
-            (parent "")
-            (layer 1)
-            (path "images/objects/bar/seat_separator.png")
-            (type 0)))
-        (child-layers))
-      (layer
-        (name "Shadow")
-        (visible 1)
-        (locked 1)
-        (objects
-          (decal
-            (pos 414.367 555.053)
-            (parent "")
-            (layer 1)
-            (path "images/decal/dark.png")
-            (type 0)))
-        (child-layers))
-      (layer
-        (name "Wall")
-        (visible 1)
-        (locked 0)
-        (objects
-          (decal
-            (pos 933.375 316.812)
-            (parent "")
-            (layer 1)
-            (path "images/decal/wall3.png")
-            (type 0))
-          (decal
-            (pos 1061.37 316.812)
-            (parent "")
-            (layer 1)
-            (path "images/decal/wall2.png")
-            (type 0))
-          (decal
-            (pos 805.375 316.812)
-            (parent "")
-            (layer 1)
-            (path "images/decal/wall1.png")
-            (type 0))
-          (decal
-            (pos 421.375 316.812)
-            (parent "")
-            (layer 1)
-            (path "images/decal/wall1.png")
-            (type 0))
-          (decal
-            (pos 677.375 316.812)
-            (parent "")
-            (layer 1)
-            (path "images/decal/wall2.png")
-            (type 0))
-          (decal
-            (pos 549.375 316.812)
-            (parent "")
-            (layer 1)
-            (path "images/decal/wall3.png")
-            (type 0))
-          (decal
-            (pos 37.3748 316.812)
-            (parent "")
-            (layer 1)
-            (path "images/decal/wall1.png")
-            (type 0))
-          (decal
-            (pos 293.375 316.812)
-            (parent "")
-            (layer 1)
-            (path "images/decal/wall2.png")
-            (type 0))
-          (decal
-            (pos 165.375 316.812)
-            (parent "")
-            (layer 1)
-            (path "images/decal/wall3.png")
-            (type 0))
-          (decal
-            (pos -346.625 316.812)
-            (parent "")
-            (layer 1)
-            (path "images/decal/wall1.png")
-            (type 0))
-          (decal
-            (pos -90.6252 316.812)
-            (parent "")
-            (layer 1)
-            (path "images/decal/wall2.png")
-            (type 0))
-          (decal
-            (pos -218.625 316.812)
-            (parent "")
-            (layer 1)
-            (path "images/decal/wall3.png")
-            (type 0)))
-        (child-layers)))))
+  (navigation
+    (nodes)
+    (edges))
+  (layers
+    (layer
+      (name "Scene")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x9790e88")
+          (pos 540.188 405.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/seat.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x979a0c8")
+          (pos 805.375 380.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x979a370")
+          (pos 329.25 444.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/table.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9794b10")
+          (pos 1059 323)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/doubledoor.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9794d78")
+          (pos -123.812 465.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9794908")
+          (pos 997.375 572.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9793500")
+          (pos 741.375 572.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982b238")
+          (pos 229.375 572.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97944f8")
+          (pos 485.375 572.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9794610")
+          (pos -282.625 572.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982aeb0")
+          (pos -26.6251 572.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Stuff")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x982aff0")
+          (pos -10.8125 433.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/stool.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982ac60")
+          (pos 610.188 379.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/seat_separator.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Shadow")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x998b598")
+          (pos 414.367 555.053)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Wall")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x9797ea8")
+          (pos 933.375 316.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9798e80")
+          (pos 1061.37 316.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9798d88")
+          (pos 805.375 316.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97987d0")
+          (pos 421.375 316.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9799548")
+          (pos 677.375 316.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97996c0")
+          (pos 549.375 316.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9799838")
+          (pos 37.3748 316.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97988b8")
+          (pos 293.375 316.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9798fd0")
+          (pos 165.375 316.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9799e58")
+          (pos -346.625 316.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9798bb8")
+          (pos -90.6252 316.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9798a80")
+          (pos -218.625 316.812)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/bar.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/bar.wst	2009-04-10 05:01:04 UTC (rev 2911)
+++ trunk/windstille/data/sectors/trainstation/bar.wst	2009-04-10 05:02:11 UTC (rev 2912)
@@ -5,630 +5,627 @@
   (name "")
   (ambient-color 0.5 0.5 0.5 1)
   (init-script "init.nut")
-  (layer
-    (name "Scene")
-    (visible #t)
-    (locked #t)
-    (objects
-      (decal
-        (id "0x94db3a0")
-        (pos -94 321)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 1.30518 2.44005)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x94d6db8")
-        (pos -62 353)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 1.30518 2.44005)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x94d9528")
-        (pos -30 385)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 1.30518 2.44005)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x94d9720")
-        (pos 2212 342)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 1.30518 2.44005)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x94dc620")
-        (pos 2244 374)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 1.30518 2.44005)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x94d76b0")
-        (pos 2276 406)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 1.30518 2.44005)
-        (angle 0)
-        (hflip #f)
-        (vflip #f)))
-    (child-layers
-      (layer
-        (name "Light")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x94d7fe8")
-            (pos 1429 299)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 0.417892 0.444211)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x94d6410")
-            (pos 1039 286)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 0.417892 0.444211)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9134e20")
-            (pos 648 283)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 0.417892 0.444211)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x94d96d8")
-            (pos 1037 390)
-            (parent "")
-            (select-mask 1)
-            (path "images/streetlamp-light.png")
-            (type 1)
-            (scale 1.57731 1.2139)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x94d7110")
-            (pos 1421 397)
-            (parent "")
-            (select-mask 1)
-            (path "images/streetlamp-light.png")
-            (type 1)
-            (scale 1.57731 1.2139)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x94d7f78")
-            (pos 647 375)
-            (parent "")
-            (select-mask 1)
-            (path "images/streetlamp-light.png")
-            (type 1)
-            (scale 1.57731 1.2139)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Ground")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x91ff300")
-            (pos 431 629)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x91fed48")
-            (pos 815 629)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x91fedf0")
-            (pos 1199 629)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9234120")
-            (pos 1583 629)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x92341e8")
-            (pos 431 117)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x92342d0")
-            (pos 815 117)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x92343b8")
-            (pos 1199 117)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x92344a0")
-            (pos 1583 117)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x94d2dc8")
-            (pos 47 629)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x94d62c8")
-            (pos 47 117)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x94d71d0")
-            (pos 1967 629)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x94d7218")
-            (pos 1967 117)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t)))
-        (child-layers))
-      (layer
-        (name "Character")
-        (visible #t)
-        (locked #f)
-        (objects
-          (decal
-            (id "0x94d0368")
-            (pos 1224 586)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.346924 0.591065)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x91fd478")
-            (pos 1233 450)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/humanreference.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Objects")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x91fd418")
-            (pos 1160 462)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bar/seat.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9209758")
-            (pos 902 462)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bar/seat.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0x91fc128")
-            (pos 1229 437)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bar/seat_separator.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x91fcbc0")
-            (pos 833 437)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bar/seat_separator.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x91fcc58")
-            (pos 1031 502)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bar/table.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x93849a8")
-            (pos 1556 462)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bar/seat.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9384a20")
-            (pos 1298 462)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bar/seat.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0x91fcf90")
-            (pos 1625 437)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bar/seat_separator.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x91fd078")
-            (pos 1427 502)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bar/table.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x91fd160")
-            (pos 764 462)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bar/seat.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x92077d0")
-            (pos 506 462)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bar/seat.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0x92078b8")
-            (pos 437 437)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bar/seat_separator.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x92079a8")
-            (pos 635 502)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bar/table.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9207a90")
-            (pos 1038 208)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_lamp.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x913b700")
-            (pos 643 205)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_lamp.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x8b82e28")
-            (pos 1423 226)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_lamp.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Shadow")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x91fb1f0")
-            (pos 1460 564)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1.42725 0.499512)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x91ff378")
-            (pos 1056 562)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1.42725 0.499512)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x92092f0")
-            (pos 582 572)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1.42725 0.499512)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Background")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x92094b8")
-            (pos 383 374)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x92e4bc8")
-            (pos 671 374)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x92e4c58")
-            (pos 959 374)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x92e4d00")
-            (pos 1247 374)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x92e4dc8")
-            (pos 1535 373)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x94d94e0")
-            (pos 1823 373)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x90ee588")
-            (pos 95 374)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x94dc2b8")
-            (pos 2111 373)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bar_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers)))))
+  (navigation
+    (nodes)
+    (edges))
+  (layers
+    (layer
+      (name "Scene")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x91b94c8")
+          (pos -94 321)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.30518 2.44005)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91bbb48")
+          (pos -62 353)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.30518 2.44005)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91bb818")
+          (pos -30 385)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.30518 2.44005)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91bbc28")
+          (pos 2212 342)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.30518 2.44005)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91bc990")
+          (pos 2244 374)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.30518 2.44005)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91bcaa8")
+          (pos 2276 406)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.30518 2.44005)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Light")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x91bc258")
+          (pos 1429 299)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 0.417892 0.444211)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91bc6e0")
+          (pos 1039 286)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 0.417892 0.444211)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91bc580")
+          (pos 648 283)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 0.417892 0.444211)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91bc638")
+          (pos 1037 390)
+          (parent "")
+          (select-mask 1)
+          (path "images/streetlamp-light.png")
+          (type 1)
+          (scale 1.57731 1.2139)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91b9728")
+          (pos 1421 397)
+          (parent "")
+          (select-mask 1)
+          (path "images/streetlamp-light.png")
+          (type 1)
+          (scale 1.57731 1.2139)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91b9900")
+          (pos 647 375)
+          (parent "")
+          (select-mask 1)
+          (path "images/streetlamp-light.png")
+          (type 1)
+          (scale 1.57731 1.2139)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Ground")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x91ccac8")
+          (pos 431 629)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91ccb80")
+          (pos 815 629)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91ba310")
+          (pos 1199 629)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91ba958")
+          (pos 1583 629)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91ba3e8")
+          (pos 431 117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0x91ba4f0")
+          (pos 815 117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0x91ba628")
+          (pos 1199 117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0x91bb030")
+          (pos 1583 117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0x92bf928")
+          (pos 47 629)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x92bf7d0")
+          (pos 47 117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0x92bfb60")
+          (pos 1967 629)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91bb0f8")
+          (pos 1967 117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))))
+    (layer
+      (name "Character")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x91cc998")
+          (pos 1224 586)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.346924 0.591065)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x91bbf68")
+          (pos 1233 450)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/humanreference.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Objects")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x91ba0c0")
+          (pos 1160 462)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/seat.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9469dd0")
+          (pos 902 462)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/seat.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0x947eb08")
+          (pos 1229 437)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/seat_separator.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9454ff8")
+          (pos 833 437)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/seat_separator.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x949c970")
+          (pos 1031 502)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/table.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x94a5b60")
+          (pos 1556 462)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/seat.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x94aed80")
+          (pos 1298 462)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/seat.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0x94c2a28")
+          (pos 1625 437)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/seat_separator.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x94af0c8")
+          (pos 1427 502)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/table.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x94aef18")
+          (pos 764 462)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/seat.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9509208")
+          (pos 506 462)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/seat.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0x9508d40")
+          (pos 437 437)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/seat_separator.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9508dd0")
+          (pos 635 502)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bar/table.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9531620")
+          (pos 1038 208)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_lamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9508ea8")
+          (pos 643 205)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_lamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x934ff20")
+          (pos 1423 226)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_lamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Shadow")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x91bb310")
+          (pos 1460 564)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.42725 0.499512)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x93500f0")
+          (pos 1056 562)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.42725 0.499512)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9350330")
+          (pos 582 572)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.42725 0.499512)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Background")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x954f668")
+          (pos 383 374)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x959c358")
+          (pos 671 374)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x959ca38")
+          (pos 959 374)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x959c8b8")
+          (pos 1247 374)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x95ede18")
+          (pos 1535 373)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x95edc78")
+          (pos 1823 373)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x96901b0")
+          (pos 95 374)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9732220")
+          (pos 2111 373)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bar_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/bathroom.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/bathroom.wst	2009-04-10 05:01:04 UTC (rev 2911)
+++ trunk/windstille/data/sectors/trainstation/bathroom.wst	2009-04-10 05:02:11 UTC (rev 2912)
@@ -36,906 +36,898 @@
         (node1 4)
         (node2 1)
         (properties 0))))
-  (layer
-    (name "Scene")
-    (visible #t)
-    (locked #t)
-    (objects
-      (decal
-        (id "0x9d1bdd8")
-        (pos 958 491)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/humanreference.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f)))
-    (child-layers
-      (layer
-        (name "LightLight")
-        (visible #t)
-        (locked #f)
-        (objects
-          (decal
-            (id "0xa167988")
-            (pos 548 546)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light2.png")
-            (type 1)
-            (scale 3.57812 2.56836)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d18430")
-            (pos 559 291)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light2.png")
-            (type 1)
-            (scale 3.23438 1.83594)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d2f100")
-            (pos 870 563)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light2.png")
-            (type 1)
-            (scale 3.57812 2.56836)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa168798")
-            (pos 881 308)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light2.png")
-            (type 1)
-            (scale 3.23438 1.83594)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d26380")
-            (pos 1218 284)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light2.png")
-            (type 1)
-            (scale 3.23438 1.83594)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa16c198")
-            (pos 1187 554)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light2.png")
-            (type 1)
-            (scale 3.57812 2.56836)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Light")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9d34330")
-            (pos 575 244)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 0.595588 0.549077)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d1f0e8")
-            (pos 878 246)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 0.595588 0.549077)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d1fa78")
-            (pos 1167 242)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 0.595588 0.549077)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Black")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9d1fbb8")
-            (pos 1409 210)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d1fd80")
-            (pos 1437 666)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d1fe98")
-            (pos 318 663)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d494c0")
-            (pos 294 191)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d49658")
-            (pos 852 159)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/shadow.png")
-            (type 0)
-            (scale 10.2773 1.21973)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d490e8")
-            (pos 857 156)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/shadow.png")
-            (type 0)
-            (scale 10.2773 1.21973)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d492c8")
-            (pos 864 684)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/shadow.png")
-            (type 0)
-            (scale 10.2773 1.21973)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x9d48f08")
-            (pos 867 687)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/shadow.png")
-            (type 0)
-            (scale 10.2773 1.21973)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x9d79c68")
-            (pos 301 432)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/shadow.png")
-            (type 0)
-            (scale 3.31934 1.58594)
-            (angle 1.58324)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x9d89e18")
-            (pos 280 438)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/shadow.png")
-            (type 0)
-            (scale 3.31934 1.58594)
-            (angle 1.58324)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x9d89f00")
-            (pos 1471 416)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/shadow.png")
-            (type 0)
-            (scale 3.31934 1.58594)
-            (angle 1.58324)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9daa0b0")
-            (pos 1471 408)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/shadow.png")
-            (type 0)
-            (scale 3.31934 1.58594)
-            (angle 1.58324)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Ground")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9dca4a8")
-            (pos 422 672)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9ddae78")
-            (pos 550 672)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9dfb130")
-            (pos 678 672)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9e1b3a0")
-            (pos 806 672)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9e1b4b8")
-            (pos 934 672)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9e2b558")
-            (pos 1062 672)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9e3b868")
-            (pos 1190 672)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9e4b978")
-            (pos 1318 672)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9e4ba38")
-            (pos 422 160)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9e7be00")
-            (pos 550 160)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9e8bfd8")
-            (pos 678 160)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9e7bf60")
-            (pos 806 160)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9eac518")
-            (pos 934 160)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9ebc660")
-            (pos 1062 160)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9e9c2e8")
-            (pos 1190 160)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9ecc870")
-            (pos 1318 160)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9edca28")
-            (pos 1443 543)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 1.56813)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9eecdd0")
-            (pos 1442 415)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 1.56813)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9f0cfe0")
-            (pos 1441 289)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 1.56813)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9f1d0a0")
-            (pos 297 291)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 1.56813)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x9f2d298")
-            (pos 298 418)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 1.56813)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x9f3d5a0")
-            (pos 297 544)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/apartment_ground1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 1.56813)
-            (hflip #f)
-            (vflip #t)))
-        (child-layers))
-      (layer
-        (name "Objects")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9f4d7f0")
-            (pos 1141 415)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_housewall.png")
-            (type 0)
-            (scale 0.156915 0.249564)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d1f700")
-            (pos 1289 519)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d1e058")
-            (pos 569 227)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/streetlamp.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9ddac08")
-            (pos 1163 229)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/streetlamp.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9f5d930")
-            (pos 877 229)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/streetlamp.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d32830")
-            (pos 1140 496)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/sink.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Shadow2")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9d1e230")
-            (pos 1142 549)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.383545 0.456787)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d1e160")
-            (pos 1275 590)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.383545 0.456787)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Shadow")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9d330f8")
-            (pos 870 247)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/shadow.png")
-            (type 0)
-            (scale 8 0.453125)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d33210")
-            (pos 868 590)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/shadow.png")
-            (type 0)
-            (scale 8 1.51562)
-            (angle 0)
-            (hflip #t)
-            (vflip #t))
-          (decal
-            (id "0x9d33e28")
-            (pos 1341 418)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/shadow.png")
-            (type 0)
-            (scale 3.37656 0.970145)
-            (angle 1.56816)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d33a00")
-            (pos 399 421)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/shadow.png")
-            (type 0)
-            (scale 3.37656 0.970145)
-            (angle 1.56816)
-            (hflip #t)
-            (vflip #t)))
-        (child-layers))
-      (layer
-        (name "Background")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9d32330")
-            (pos 422 544)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fe4e00")
-            (pos 550 544)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9d324f8")
-            (pos 422 416)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9ff4f48")
-            (pos 550 416)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa005250")
-            (pos 422 288)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0253c0")
-            (pos 550 288)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0356d0")
-            (pos 678 544)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0458a8")
-            (pos 678 416)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa005158")
-            (pos 678 288)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0559d8")
-            (pos 806 288)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa065d80")
-            (pos 1062 544)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa085fc0")
-            (pos 1062 416)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa096090")
-            (pos 934 288)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0a63a0")
-            (pos 1062 288)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0b6578")
-            (pos 1190 544)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa085ec8")
-            (pos 1318 544)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0c66a8")
-            (pos 1190 416)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0d68a8")
-            (pos 1318 416)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0f6b80")
-            (pos 1190 288)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa106e88")
-            (pos 1318 288)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bath_tile.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa117070")
-            (pos 875 467)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/showerdoors.png")
-            (type 0)
-            (scale 2.09222 2.069)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers)))))
+  (layers
+    (layer
+      (name "Scene")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x99201f8")
+          (pos 958 491)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/humanreference.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "LightLight")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x99229c8")
+          (pos 548 546)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 3.57812 2.56836)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9922ab8")
+          (pos 559 291)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 3.23438 1.83594)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9922c78")
+          (pos 870 563)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 3.57812 2.56836)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9923ae8")
+          (pos 881 308)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 3.23438 1.83594)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x99241c0")
+          (pos 1218 284)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 3.23438 1.83594)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9923cc8")
+          (pos 1187 554)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 3.57812 2.56836)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Light")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x9923638")
+          (pos 575 244)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 0.595588 0.549077)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9923770")
+          (pos 878 246)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 0.595588 0.549077)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9a64168")
+          (pos 1167 242)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 0.595588 0.549077)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Black")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x9923200")
+          (pos 1409 210)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9923358")
+          (pos 1437 666)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9922450")
+          (pos 318 663)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9938a60")
+          (pos 294 191)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x99225a0")
+          (pos 852 159)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 10.2773 1.21973)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x99395f0")
+          (pos 857 156)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 10.2773 1.21973)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9939118")
+          (pos 864 684)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 10.2773 1.21973)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0x9939210")
+          (pos 867 687)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 10.2773 1.21973)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0x9939358")
+          (pos 301 432)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 3.31934 1.58594)
+          (angle 1.58324)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0x9938e78")
+          (pos 280 438)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 3.31934 1.58594)
+          (angle 1.58324)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0x9939868")
+          (pos 1471 416)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 3.31934 1.58594)
+          (angle 1.58324)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9938b60")
+          (pos 1471 408)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 3.31934 1.58594)
+          (angle 1.58324)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Ground")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x9937b30")
+          (pos 422 672)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9938828")
+          (pos 550 672)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9b271e0")
+          (pos 678 672)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9b57488")
+          (pos 806 672)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9b675b8")
+          (pos 934 672)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9b877f0")
+          (pos 1062 672)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9b979e0")
+          (pos 1190 672)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9ba7cb8")
+          (pos 1318 672)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9bb7ea0")
+          (pos 422 160)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9bc8040")
+          (pos 550 160)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9bd81e0")
+          (pos 678 160)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9bd82c8")
+          (pos 806 160)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9bf84d8")
+          (pos 934 160)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9c08670")
+          (pos 1062 160)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9c189a0")
+          (pos 1190 160)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9c28ae8")
+          (pos 1318 160)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9c38d10")
+          (pos 1443 543)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 1.56813)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9c48eb0")
+          (pos 1442 415)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 1.56813)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9c48f98")
+          (pos 1441 289)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 1.56813)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9c691a8")
+          (pos 297 291)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 1.56813)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0x9c79340")
+          (pos 298 418)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 1.56813)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0x9c89670")
+          (pos 297 544)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/apartment_ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 1.56813)
+          (hflip #f)
+          (vflip #t))))
+    (layer
+      (name "Objects")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x9c99898")
+          (pos 1141 415)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_housewall.png")
+          (type 0)
+          (scale 0.156915 0.249564)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9923ef8")
+          (pos 1289 519)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9ca9970")
+          (pos 569 227)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/streetlamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9cd1fa8")
+          (pos 1163 229)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/streetlamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9cd8eb0")
+          (pos 877 229)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/streetlamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9cd8fd0")
+          (pos 1140 496)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/sink.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Shadow2")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x9cd20a0")
+          (pos 1142 549)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.383545 0.456787)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9cd2198")
+          (pos 1275 590)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.383545 0.456787)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Shadow")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x9938340")
+          (pos 870 247)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 8 0.453125)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9938440")
+          (pos 868 590)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 8 1.51562)
+          (angle 0)
+          (hflip #t)
+          (vflip #t))
+        (decal
+          (id "0x9920c38")
+          (pos 1341 418)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 3.37656 0.970145)
+          (angle 1.56816)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x99209d0")
+          (pos 399 421)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 3.37656 0.970145)
+          (angle 1.56816)
+          (hflip #t)
+          (vflip #t))))
+    (layer
+      (name "Background")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x9920e48")
+          (pos 422 544)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9921958")
+          (pos 550 544)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9921b10")
+          (pos 422 416)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9921bf8")
+          (pos 550 416)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9920320")
+          (pos 422 288)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9921588")
+          (pos 550 288)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9921668")
+          (pos 678 544)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9921d98")
+          (pos 678 416)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9921e60")
+          (pos 678 288)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9921f28")
+          (pos 806 288)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9a95408")
+          (pos 1062 544)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9a95600")
+          (pos 1062 416)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9922030")
+          (pos 934 288)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9a94b90")
+          (pos 1062 288)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9a95230")
+          (pos 1190 544)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9a94d58")
+          (pos 1318 544)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9a94e60")
+          (pos 1190 416)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9a95030")
+          (pos 1318 416)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9a96210")
+          (pos 1190 288)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9a96010")
+          (pos 1318 288)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bath_tile.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9a962d8")
+          (pos 875 467)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/showerdoors.png")
+          (type 0)
+          (scale 2.09222 2.069)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/boxstack_test.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/boxstack_test.wst	2009-04-10 05:01:04 UTC (rev 2911)
+++ trunk/windstille/data/sectors/trainstation/boxstack_test.wst	2009-04-10 05:02:11 UTC (rev 2912)
@@ -216,363 +216,363 @@
         (node1 28)
         (node2 26)
         (properties 0))))
-  (layer
-    (name "Scene")
-    (visible #t)
-    (locked #f)
-    (objects
-      (decal
-        (id "0x970bdd8")
-        (pos -1533 -512)
-        (parent "0x970da88")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970ef50")
-        (pos -1533 -256)
-        (parent "0x970da88")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970cab0")
-        (pos -1536 0)
-        (parent "0x970da88")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970cc28")
-        (pos -1021 -512)
-        (parent "0x970da88")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x971e540")
-        (pos -1021 -256)
-        (parent "0x970da88")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970ce28")
-        (pos -1024 0)
-        (parent "0x970da88")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970d038")
-        (pos -512 0)
-        (parent "0x970da88")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970d248")
-        (pos -509 -256)
-        (parent "0x970da88")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970d458")
-        (pos -509 -512)
-        (parent "0x970da88")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970d668")
-        (pos 3 -512)
-        (parent "0x970da88")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970d878")
-        (pos 3 -256)
-        (parent "0x970da88")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970da88")
-        (pos 1486 864)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970dc58")
-        (pos 837 672)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelbox.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x971e788")
-        (pos 826 725)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 0.394531 0.363281)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x971e1a0")
-        (pos 899 800)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelbox.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x971e360")
-        (pos 771 800)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelbox.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x971d438")
-        (pos 265 929)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelbox.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x971d570")
-        (pos 393 929)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelbox.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x971d688")
-        (pos 521 929)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelbox.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x971dc38")
-        (pos 450 801)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelbox.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x971def0")
-        (pos 322 801)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelbox.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970e2e0")
-        (pos 385 673)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelbox.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970e140")
-        (pos 768 864)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 0.480469 0.363281)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970dd78")
-        (pos 714 928)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelbox.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970dec8")
-        (pos 894 859)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 0.480469 0.363281)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x971da10")
-        (pos 842 928)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelbox.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x971db30")
-        (pos 970 928)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelbox.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970e9c8")
-        (pos 710 972)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 0.480469 0.363281)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970eb88")
-        (pos 836 967)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 0.480469 0.363281)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x970ec68")
-        (pos 961 974)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 0.480469 0.363281)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x97f1bd8")
-        (pos 223 1248)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/city_housewall.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x97f1de8")
-        (pos 1247 1248)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/city_housewall.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f)))
-    (child-layers)))
+  (layers
+    (layer
+      (name "Scene")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x9f4d418")
+          (pos -1533 -512)
+          (parent "0x9f5e0f8")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f4f728")
+          (pos -1533 -256)
+          (parent "0x9f5e0f8")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f4f650")
+          (pos -1536 0)
+          (parent "0x9f5e0f8")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f4feb8")
+          (pos -1021 -512)
+          (parent "0x9f5e0f8")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f50048")
+          (pos -1021 -256)
+          (parent "0x9f5e0f8")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f4fb88")
+          (pos -1024 0)
+          (parent "0x9f5e0f8")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f4fd58")
+          (pos -512 0)
+          (parent "0x9f5e0f8")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f501b8")
+          (pos -509 -256)
+          (parent "0x9f5e0f8")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f50320")
+          (pos -509 -512)
+          (parent "0x9f5e0f8")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f5ed40")
+          (pos 3 -512)
+          (parent "0x9f5e0f8")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f5ef50")
+          (pos 3 -256)
+          (parent "0x9f5e0f8")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f5e0f8")
+          (pos 1486 864)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f5e2f8")
+          (pos 837 672)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f5f1d0")
+          (pos 826 725)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.394531 0.363281)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f5f320")
+          (pos 899 800)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f5f4e0")
+          (pos 771 800)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f5f618")
+          (pos 265 929)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f5e920")
+          (pos 393 929)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f5e7a0")
+          (pos 521 929)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9fafa40")
+          (pos 450 801)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9fbfbf0")
+          (pos 322 801)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9fcfe48")
+          (pos 385 673)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9fe0070")
+          (pos 768 864)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.480469 0.363281)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9ff0268")
+          (pos 714 928)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa000408")
+          (pos 894 859)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.480469 0.363281)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa000520")
+          (pos 842 928)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f5ea28")
+          (pos 970 928)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa010658")
+          (pos 710 972)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.480469 0.363281)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa020af0")
+          (pos 836 967)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.480469 0.363281)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa010920")
+          (pos 961 974)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.480469 0.363281)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0107c0")
+          (pos 223 1248)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_housewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f5e4b8")
+          (pos 1247 1248)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_housewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/city.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/city.wst	2009-04-10 05:01:04 UTC (rev 2911)
+++ trunk/windstille/data/sectors/trainstation/city.wst	2009-04-10 05:02:11 UTC (rev 2912)
@@ -5,1655 +5,1648 @@
   (name "")
   (ambient-color 0.1 0.1 0.2 1)
   (init-script "init.nut")
-  (layer
-    (name "Scene")
-    (visible #t)
-    (locked #t)
-    (objects)
-    (child-layers
-      (layer
-        (name "Light")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9581190")
-            (pos 689 326)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 3.63751 2.04308)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9580630")
-            (pos -2229 315)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 3.7027 1.9346)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95806d0")
-            (pos 2213 674)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1.76741 2.13994)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9580790")
-            (pos 909 162)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1.90027 1.81253)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95816b8")
-            (pos -1070 626)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1.5143 1.10403)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9581770")
-            (pos -1064 624)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 1.34704 1.09163)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Highlight")
-        (visible #t)
-        (locked #f)
-        (objects
-          (decal
-            (id "0x9580de8")
-            (pos 2998 558)
-            (parent "")
-            (select-mask 1)
-            (path "images/streetlamp-light.png")
-            (type 1)
-            (scale 2.4498 1.68449)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x957ea78")
-            (pos 836 212)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp.png")
-            (type 0)
-            (scale 1.05279 1.05689)
-            (angle -1.56597)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x957fd00")
-            (pos 985 221)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 3.65012 5.58788)
-            (angle 1.47871)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x957fd78")
-            (pos 949 214)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 0.961703 0.344589)
-            (angle 1.58209)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x957fe20")
-            (pos -1207 634)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a99c8")
-            (pos -910 639)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a9a68")
-            (pos -912 619)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1_highlight.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a9b70")
-            (pos -1208 615)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1_highlight.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95aa478")
-            (pos 2992 368)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/streetlamp.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95aa618")
-            (pos 2999 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 0.698039 0.489933)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95aaf48")
-            (pos 3542 559)
-            (parent "")
-            (select-mask 1)
-            (path "images/streetlamp-light.png")
-            (type 1)
-            (scale 2.4498 1.68449)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9657e38")
-            (pos 3536 369)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/streetlamp.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9657f20")
-            (pos 3543 381)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 0.698039 0.489933)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9658008")
-            (pos 4050 558)
-            (parent "")
-            (select-mask 1)
-            (path "images/streetlamp-light.png")
-            (type 1)
-            (scale 2.4498 1.68449)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x96580f0")
-            (pos 4044 368)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/streetlamp.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x96581d8")
-            (pos 4051 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 0.698039 0.489933)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x96582c0")
-            (pos 3549 485)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 1)
-            (scale 4.8895 5.48547)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x96583a8")
-            (pos -3945 517)
-            (parent "")
-            (select-mask 1)
-            (path "images/streetlamp-light.png")
-            (type 1)
-            (scale 2.4498 1.68449)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9658490")
-            (pos -3951 327)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/streetlamp.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9658578")
-            (pos -3944 339)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 0.698039 0.489933)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Character")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x957e828")
-            (pos 525 612)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/humanreference.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Ground")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9659c40")
-            (pos 1271 855)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9659d60")
-            (pos 759 855)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x965a210")
-            (pos 247 855)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x965a2b8")
-            (pos 2807 855)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a6d38")
-            (pos 2295 855)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a6e20")
-            (pos 1783 855)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a6f08")
-            (pos -777 855)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a6ff0")
-            (pos -1289 855)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a70d8")
-            (pos -1801 855)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a71c0")
-            (pos -265 855)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a72a8")
-            (pos -2313 855)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a7390")
-            (pos -2825 855)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a7478")
-            (pos -3337 855)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a7560")
-            (pos -3849 854)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a7648")
-            (pos -4361 854)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a7730")
-            (pos -4873 854)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a7818")
-            (pos -5385 854)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a7900")
-            (pos -5897 854)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a79e8")
-            (pos -6409 854)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a7ad0")
-            (pos -6921 854)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a7bb8")
-            (pos -7433 854)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a7ca0")
-            (pos -7945 854)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a7d88")
-            (pos -2215 -873)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9741e28")
-            (pos -1959 -873)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9742038")
-            (pos -1703 -873)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a85d8")
-            (pos -1447 -873)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x95a86c0")
-            (pos 601 -873)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0x95a87a8")
-            (pos 345 -873)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0x95a8890")
-            (pos 89 -873)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0x95a8978")
-            (pos -167 -873)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0x973fbb0")
-            (pos -679 -873)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0x973fc98")
-            (pos -423 -873)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0x973fd80")
-            (pos -935 -873)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x973fe68")
-            (pos -1191 -873)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x973ff50")
-            (pos 3831 853)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9740038")
-            (pos 3319 853)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9740120")
-            (pos 5367 853)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9740208")
-            (pos 4855 853)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97402f0")
-            (pos 4343 853)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97403d8")
-            (pos 6903 852)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97404c0")
-            (pos 6391 852)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97405a8")
-            (pos 5879 852)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/cityground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "House2")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9659a38")
-            (pos 1470 471)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_subway.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Fuel")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9659b30")
-            (pos -2749 423)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/fuel_container.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9659420")
-            (pos -3388 422)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/fuel_container.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "House")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x976c368")
-            (pos 217 471)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_housewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x976cde8")
-            (pos 217 -41)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_housewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x976dce0")
-            (pos 217 -553)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_housewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x976dd88")
-            (pos 643 -38)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_houseairvent.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x976e138")
-            (pos 645 -550)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_houseairvent.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d3c10")
-            (pos -131 -559)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x987c6a0")
-            (pos 48 -558)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cf028")
-            (pos 236 -556)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cf0d0")
-            (pos -126 -45)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cf198")
-            (pos 53 -44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cf280")
-            (pos 241 -42)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cf368")
-            (pos 438 817)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 2.96695 1.58413)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d3370")
-            (pos -807 471)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_housewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d1a38")
-            (pos -807 -41)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_housewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d1af8")
-            (pos -807 -553)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_housewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d1bc0")
-            (pos -1831 471)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_housewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d1ca8")
-            (pos -1831 -41)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_housewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d1d90")
-            (pos -1831 -553)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_housewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d1e78")
-            (pos 49 457)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/explosion_decal.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d15d0")
-            (pos -1495 498)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_crack.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cf408")
-            (pos -1003 -564)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cf4b0")
-            (pos -824 -563)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cf558")
-            (pos -636 -561)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cf640")
-            (pos -998 -50)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cf728")
-            (pos -819 -49)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cf810")
-            (pos -631 -47)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cf8f8")
-            (pos -1527 -34)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cf9e0")
-            (pos -1715 -39)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cfac8")
-            (pos -1894 -40)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cfbb0")
-            (pos -1532 -563)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cfc98")
-            (pos -1720 -565)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cfd80")
-            (pos -1899 -566)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cfe68")
-            (pos -2237 -561)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_houseairvent.png")
-            (type 0)
-            (scale -1.23139 1.08248)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97cff58")
-            (pos -2239 -41)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_houseairvent.png")
-            (type 0)
-            (scale -1.23139 1.08248)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d0048")
-            (pos -1061 582)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/door.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d0238")
-            (pos -810 477)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d0b98")
-            (pos -628 478)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_window.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d0c40")
-            (pos -437 671)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelplate_crack.png")
-            (type 0)
-            (scale 1.09301 1.15319)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Shadow")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9a0bf88")
-            (pos 858 689)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1.55695 0.984741)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9a0bfd0")
-            (pos 704 418)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.786377 2.50299)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x999f5b0")
-            (pos 1974 744)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1.22888 0.977112)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x976ca70")
-            (pos 1397 489)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 3.22015 1.55695)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x976cb20")
-            (pos -2291 573)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1.49889 2.34289)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x976cbd0")
-            (pos -2855 737)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 2.52588 1.11444)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d0fa8")
-            (pos 2870 735)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 6.60283 0.940395)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d1058")
-            (pos 4870 739)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 6.60283 0.940395)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Wall")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9a0bf40")
-            (pos 613 398)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x97d12a0")
-            (pos 1145 398)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9921288")
-            (pos 1677 397)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9921330")
-            (pos 2209 397)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x99213f8")
-            (pos 2741 397)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x99214e0")
-            (pos -2609 407)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x99215c8")
-            (pos -2077 407)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x99216b0")
-            (pos -3141 407)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9921798")
-            (pos -4205 407)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9921880")
-            (pos -3673 407)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9921968")
-            (pos -4737 407)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9921a50")
-            (pos -5801 407)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9921b38")
-            (pos -5269 407)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9921c20")
-            (pos -6333 407)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9921d08")
-            (pos 3273 396)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9921df0")
-            (pos 3805 397)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x999d190")
-            (pos 4337 396)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x999d278")
-            (pos 4869 396)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x999d360")
-            (pos 5401 396)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x999d448")
-            (pos 5933 396)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x999d530")
-            (pos 6465 396)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/citywall.png")
-            (type 0)
-            (scale 1.03906 1.2832)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x999d618")
-            (pos 4631 455)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.284744 0.58992)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x999d6f8")
-            (pos 4558 464)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.322891 0.914169)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x999d7d8")
-            (pos 4599 378)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_gate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Background")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x999d950")
-            (pos 1328 80)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/fuel_container.png")
-            (type 0)
-            (scale 1.93044 2.12433)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9741a80")
-            (pos 2513 80)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/fuel_container.png")
-            (type 0)
-            (scale 1.93044 2.12433)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers)))))
+  (navigation
+    (nodes)
+    (edges))
+  (layers
+    (layer
+      (name "Scene")
+      (visible #t)
+      (locked #t)
+      (objects))
+    (layer
+      (name "Light")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xa0de990")
+          (pos 689 326)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 3.63751 2.04308)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0dde08")
+          (pos -2229 315)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 3.7027 1.9346)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0dded8")
+          (pos 2213 674)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1.76741 2.13994)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0def78")
+          (pos 909 162)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1.90027 1.81253)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0df160")
+          (pos -1070 626)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1.5143 1.10403)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0df368")
+          (pos -1064 624)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 1.34704 1.09163)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Highlight")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xa0df8c8")
+          (pos 2998 558)
+          (parent "")
+          (select-mask 1)
+          (path "images/streetlamp-light.png")
+          (type 1)
+          (scale 2.4498 1.68449)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0dbbf0")
+          (pos 836 212)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp.png")
+          (type 0)
+          (scale 1.05279 1.05689)
+          (angle -1.56597)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0dcf00")
+          (pos 985 221)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 3.65012 5.58788)
+          (angle 1.47871)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0dd890")
+          (pos 949 214)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 0.961703 0.344589)
+          (angle 1.58209)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0dc058")
+          (pos -1207 634)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0dc408")
+          (pos -910 639)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0dcd88")
+          (pos -912 619)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0dc220")
+          (pos -1208 615)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0dca08")
+          (pos 2992 368)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/streetlamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0dc940")
+          (pos 2999 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 0.698039 0.489933)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0dd750")
+          (pos 3542 559)
+          (parent "")
+          (select-mask 1)
+          (path "images/streetlamp-light.png")
+          (type 1)
+          (scale 2.4498 1.68449)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0dd198")
+          (pos 3536 369)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/streetlamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0dd280")
+          (pos 3543 381)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 0.698039 0.489933)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa0dd440")
+          (pos 4050 558)
+          (parent "")
+          (select-mask 1)
+          (path "images/streetlamp-light.png")
+          (type 1)
+          (scale 2.4498 1.68449)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa213be8")
+          (pos 4044 368)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/streetlamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa213ea0")
+          (pos 4051 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 0.698039 0.489933)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa213d50")
+          (pos 3549 485)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 1)
+          (scale 4.8895 5.48547)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa2176c0")
+          (pos -3945 517)
+          (parent "")
+          (select-mask 1)
+          (path "images/streetlamp-light.png")
+          (type 1)
+          (scale 2.4498 1.68449)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa217818")
+          (pos -3951 327)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/streetlamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa21af30")
+          (pos -3944 339)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 0.698039 0.489933)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Character")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xa21b5c8")
+          (pos 525 612)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/humanreference.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Ground")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xa1e0b20")
+          (pos 1271 855)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa103ba8")
+          (pos 759 855)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa107280")
+          (pos 247 855)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa105f40")
+          (pos 2807 855)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa107f48")
+          (pos 2295 855)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa105de8")
+          (pos 1783 855)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa107710")
+          (pos -777 855)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa107938")
+          (pos -1289 855)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa107378")
+          (pos -1801 855)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa107498")
+          (pos -265 855)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa107a70")
+          (pos -2313 855)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa107b30")
+          (pos -2825 855)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa106c40")
+          (pos -3337 855)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa107c20")
+          (pos -3849 854)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa106d20")
+          (pos -4361 854)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa106de8")
+          (pos -4873 854)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22c898")
+          (pos -5385 854)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22cd60")
+          (pos -5897 854)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa1068f0")
+          (pos -6409 854)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa106aa8")
+          (pos -6921 854)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa1061c0")
+          (pos -7433 854)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22c918")
+          (pos -7945 854)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22cad8")
+          (pos -2215 -873)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa106838")
+          (pos -1959 -873)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22d520")
+          (pos -1703 -873)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22d630")
+          (pos -1447 -873)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa106420")
+          (pos 601 -873)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xa106558")
+          (pos 345 -873)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xa26d7f0")
+          (pos 89 -873)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xa26d930")
+          (pos -167 -873)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xa26db00")
+          (pos -679 -873)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xa30e1c8")
+          (pos -423 -873)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xa30e308")
+          (pos -935 -873)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa2cdc60")
+          (pos -1191 -873)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa2cdd90")
+          (pos 3831 853)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa34e4a8")
+          (pos 3319 853)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa3aea80")
+          (pos 5367 853)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa3aec48")
+          (pos 4855 853)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa34e528")
+          (pos 4343 853)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa34e648")
+          (pos 6903 852)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22d070")
+          (pos 6391 852)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22d230")
+          (pos 5879 852)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/cityground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "House2")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xa21b018")
+          (pos 1470 471)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_subway.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Fuel")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xa3cf248")
+          (pos -2749 423)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/fuel_container.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa21b0d0")
+          (pos -3388 422)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/fuel_container.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "House")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xa3cfb70")
+          (pos 217 471)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_housewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa103ec0")
+          (pos 217 -41)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_housewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa1048e0")
+          (pos 217 -553)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_housewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa104ae8")
+          (pos 643 -38)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_houseairvent.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa104cf8")
+          (pos 645 -550)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_houseairvent.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa1056c8")
+          (pos -131 -559)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa1058d0")
+          (pos 48 -558)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa104ff0")
+          (pos 236 -556)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa105988")
+          (pos -126 -45)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa104de0")
+          (pos 53 -44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa4b5d18")
+          (pos 241 -42)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa4fca70")
+          (pos 438 817)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 2.96695 1.58413)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa105228")
+          (pos -807 471)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_housewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa520150")
+          (pos -807 -41)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_housewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa5202c8")
+          (pos -807 -553)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_housewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa104550")
+          (pos -1831 471)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_housewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa1046b0")
+          (pos -1831 -41)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_housewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22b5c8")
+          (pos -1831 -553)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_housewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22b280")
+          (pos 49 457)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/explosion_decal.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22b710")
+          (pos -1495 498)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_crack.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22bf50")
+          (pos -1003 -564)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22c010")
+          (pos -824 -563)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22a278")
+          (pos -636 -561)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22a670")
+          (pos -998 -50)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22a770")
+          (pos -819 -49)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22a428")
+          (pos -631 -47)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22a8c8")
+          (pos -1527 -34)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22acc8")
+          (pos -1715 -39)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22adc8")
+          (pos -1894 -40)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22ab28")
+          (pos -1532 -563)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa7dffe8")
+          (pos -1720 -565)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa803720")
+          (pos -1899 -566)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa826e58")
+          (pos -2237 -561)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_houseairvent.png")
+          (type 0)
+          (scale -1.23139 1.08248)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22bb20")
+          (pos -2239 -41)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_houseairvent.png")
+          (type 0)
+          (scale -1.23139 1.08248)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22b8f0")
+          (pos -1061 582)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22afd0")
+          (pos -810 477)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa84a508")
+          (pos -628 478)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_window.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa84a620")
+          (pos -437 671)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate_crack.png")
+          (type 0)
+          (scale 1.09301 1.15319)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Shadow")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xa84a9d8")
+          (pos 858 689)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.55695 0.984741)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa103c28")
+          (pos 704 418)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.786377 2.50299)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22c650")
+          (pos 1974 744)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.22888 0.977112)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa22c6f8")
+          (pos 1397 489)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 3.22015 1.55695)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa3cfc68")
+          (pos -2291 573)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.49889 2.34289)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa104350")
+          (pos -2855 737)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 2.52588 1.11444)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa89bcb0")
+          (pos 2870 735)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 6.60283 0.940395)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa89be58")
+          (pos 4870 739)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 6.60283 0.940395)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Wall")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xa977138")
+          (pos 613 398)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa977750")
+          (pos 1145 398)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa9779e8")
+          (pos 1677 397)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa977b90")
+          (pos 2209 397)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa977d08")
+          (pos 2741 397)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa977ee8")
+          (pos -2609 407)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa9780b0")
+          (pos -2077 407)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa978e60")
+          (pos -3141 407)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa978f68")
+          (pos -4205 407)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa978200")
+          (pos -3673 407)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa978350")
+          (pos -4737 407)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa978540")
+          (pos -5801 407)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa978748")
+          (pos -5269 407)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa978810")
+          (pos -6333 407)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa9788d0")
+          (pos 3273 396)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa543a98")
+          (pos 3805 397)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa3d2068")
+          (pos 4337 396)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa3d1ee8")
+          (pos 4869 396)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa3d21b8")
+          (pos 5401 396)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa3d1340")
+          (pos 5933 396)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa3d1a00")
+          (pos 6465 396)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/citywall.png")
+          (type 0)
+          (scale 1.03906 1.2832)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa3d1bc0")
+          (pos 4631 455)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.284744 0.58992)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa3d1850")
+          (pos 4558 464)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.322891 0.914169)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa3d0f78")
+          (pos 4599 378)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_gate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Background")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xa976f40")
+          (pos 1328 80)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/fuel_container.png")
+          (type 0)
+          (scale 1.93044 2.12433)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa103ce8")
+          (pos 2513 80)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/fuel_container.png")
+          (type 0)
+          (scale 1.93044 2.12433)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/container.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/container.wst	2009-04-10 05:01:04 UTC (rev 2911)
+++ trunk/windstille/data/sectors/trainstation/container.wst	2009-04-10 05:02:11 UTC (rev 2912)
@@ -5,674 +5,808 @@
   (name "")
   (ambient-color 0 0 0 1)
   (init-script "init.nut")
-  (layer
-    (name "Scene")
-    (visible 1)
-    (locked 0)
-    (objects)
-    (child-layers
-      (layer
-        (name "Character")
-        (visible 1)
-        (locked 1)
-        (objects
-          (decal
-            (id "0xa437ba0")
-            (pos 521 777)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/humanreference.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa437de8")
-            (pos 539 200)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1.49438 1.43945)
-            (angle 0))
-          (decal
-            (id "0xa437ea0")
-            (pos 451 331)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/explosion_decal.png")
-            (type 0)
-            (scale 1.40212 1.74096)
-            (angle 0))
-          (decal
-            (id "0xa437f90")
-            (pos 789 826)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelbox.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa436fd8")
-            (pos 917 826)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelbox.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa438610")
-            (pos 789 698)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelbox.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa4386b8")
-            (pos 917 698)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelbox.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa4387a0")
-            (pos 805 601)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelbox_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa438c90")
-            (pos 693 858)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelbox_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "Lights")
-        (visible 1)
-        (locked 1)
-        (objects
-          (decal
-            (id "0xa437ca8")
-            (pos 1087 797)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa438e08")
-            (pos -147 797)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa59ccb0")
-            (pos 1082 782)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1_highlight.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa59cda0")
-            (pos -148 782)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1_highlight.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa59ce90")
-            (pos -109 755)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 2.23024 0.952316)
-            (angle 0))
-          (decal
-            (id "0xa59cf70")
-            (pos 1091 786)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 2.23024 0.952316)
-            (angle 0))
-          (decal
-            (id "0xa435270")
-            (pos 981 182)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 2.35601 1.92387)
-            (angle 0))
-          (decal
-            (id "0xa435350")
-            (pos 1101 779)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 2)
-            (scale 0.950408 0.128342)
-            (angle 0))
-          (decal
-            (id "0xa435430")
-            (pos -128 779)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 2)
-            (scale 0.959945 0.142647)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "Ground")
-        (visible 1)
-        (locked 1)
-        (objects
-          (decal
-            (id "0xa438d18")
-            (pos 663 -121)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_roof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa435d98")
-            (pos 1047 -121)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_roof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa4366b0")
-            (pos -105 -121)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_roof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa436758")
-            (pos 1484 135)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa436818")
-            (pos 1484 263)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa436cc0")
-            (pos 1484 391)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa436d68")
-            (pos 1480 519)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa436e50")
-            (pos 1480 647)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa5942e8")
-            (pos 1367 -57)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_corner.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa59c5c0")
-            (pos -540 127)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale -1.02656 0.904633)
-            (angle 0))
-          (decal
-            (id "0xa59c7d8")
-            (pos 1373 903)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_corner.png")
-            (type 0)
-            (scale 1.49591 1.01907)
-            (angle 1.54812))
-          (decal
-            (id "0xa594ac0")
-            (pos -540 475)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale -1.02656 0.904633)
-            (angle 0))
-          (decal
-            (id "0xa594ba8")
-            (pos -540 591)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale -1.02656 0.904633)
-            (angle 0))
-          (decal
-            (id "0xa594c90")
-            (pos -540 707)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale -1.02656 0.904633)
-            (angle 0))
-          (decal
-            (id "0xa594d78")
-            (pos -425 -57)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_corner.png")
-            (type 0)
-            (scale 1 1)
-            (angle -1.60494))
-          (decal
-            (id "0xa594e68")
-            (pos -419 905)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_corner.png")
-            (type 0)
-            (scale 0.984741 1.09155)
-            (angle 3.11112))
-          (decal
-            (id "0xa594f58")
-            (pos -104 954)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_roof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 3.14387))
-          (decal
-            (id "0xa595040")
-            (pos 280 954)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_roof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 3.14387))
-          (decal
-            (id "0xa595128")
-            (pos 661 954)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_roof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 3.14387))
-          (decal
-            (id "0xa595210")
-            (pos 1045 954)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_roof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 3.14387))
-          (decal
-            (id "0xa5952f8")
-            (pos -544 401)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_side.png")
-            (type 0)
-            (scale -1.04999 0.326508)
-            (angle 0))
-          (decal
-            (id "0xa5953e0")
-            (pos 279 -97)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_roof2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "Stairs")
-        (visible 1)
-        (locked 1)
-        (objects
-          (decal
-            (id "0xa436be8")
-            (pos -389 447)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa437ac8")
-            (pos -261 409)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa59a9e0")
-            (pos -261 575)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa59aa80")
-            (pos -133 537)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa59bba0")
-            (pos -133 703)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa59bc78")
-            (pos -5 665)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa59bd58")
-            (pos -5 831)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa59be38")
-            (pos 123 793)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "Shadow")
-        (visible 1)
-        (locked 1)
-        (objects
-          (decal
-            (id "0xa5955a0")
-            (pos 429 -18)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 4.3617 0.916553)
-            (angle 0))
-          (decal
-            (id "0xa59c088")
-            (pos -264 91)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1.60797 1.59605)
-            (angle 0))
-          (decal
-            (id "0xa59c168")
-            (pos 1200 36)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1.60797 1.59605)
-            (angle 0))
-          (decal
-            (id "0xa59c248")
-            (pos 481 562)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.517823 1.49438)
-            (angle 0))
-          (decal
-            (id "0xa59c328")
-            (pos 804 479)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.121094 0.865723)
-            (angle 0))
-          (decal
-            (id "0xa676570")
-            (pos 821 347)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.456787 0.414063)
-            (angle 0))
-          (decal
-            (id "0xa676a30")
-            (pos 854 439)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.125254 0.663415)
-            (angle 0))
-          (decal
-            (id "0xa676b10")
-            (pos 713 859)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.560547 0.511719)
-            (angle 0))
-          (decal
-            (id "0xa676bf0")
-            (pos 976 842)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.54834 0.737549)
-            (angle 0))
-          (decal
-            (id "0xa676cd0")
-            (pos 818 723)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "Door")
-        (visible 1)
-        (locked 1)
-        (objects
-          (decal
-            (id "0xa59bf48")
-            (pos 338 745)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/door.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "Background")
-        (visible 1)
-        (locked 1)
-        (objects
-          (decal
-            (id "0xa679440")
-            (pos -15 424)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa6750e0")
-            (pos 973 427)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa675190")
-            (pos 549 839)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelplate_crack.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa675240")
-            (pos -181 185)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_crack.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa6752f0")
-            (pos 1267 845)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_crack.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa6753e0")
-            (pos 1209 472)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.640625 0.746094)
-            (angle 0))
-          (decal
-            (id "0xa6754c0")
-            (pos 1192 578)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.142578 0.601562)
-            (angle 0))
-          (decal
-            (id "0xa6755a0")
-            (pos 1206 450)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.535156 0.523438)
-            (angle 0))
-          (decal
-            (id "0xa675680")
-            (pos 1241 553)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.078125 0.478516)
-            (angle 0))
-          (decal
-            (id "0xa675760")
-            (pos 1206 435)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/container_gate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers)))))
+  (navigation
+    (nodes)
+    (edges))
+  (layers
+    (layer
+      (name "Scene")
+      (visible #t)
+      (locked #f)
+      (objects))
+    (layer
+      (name "Character")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xaa4ec78")
+          (pos 521 777)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/humanreference.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4e140")
+          (pos 539 200)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.49438 1.43945)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4e228")
+          (pos 451 331)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/explosion_decal.png")
+          (type 0)
+          (scale 1.40212 1.74096)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4df88")
+          (pos 789 826)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4f628")
+          (pos 917 826)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4f470")
+          (pos 789 698)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4f778")
+          (pos 917 698)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4f898")
+          (pos 805 601)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4f190")
+          (pos 693 858)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelbox_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Lights")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xaa5f168")
+          (pos 1087 797)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4fef0")
+          (pos -147 797)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4ffd0")
+          (pos 1082 782)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4c0a0")
+          (pos -148 782)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4c8f8")
+          (pos -109 755)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 2.23024 0.952316)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4be50")
+          (pos 1091 786)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 2.23024 0.952316)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4c220")
+          (pos 981 182)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 2.35601 1.92387)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4c3a0")
+          (pos 1101 779)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 2)
+          (scale 0.950408 0.128342)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4c740")
+          (pos -128 779)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 2)
+          (scale 0.959945 0.142647)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Ground")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xaa4d738")
+          (pos 663 -121)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_roof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4de08")
+          (pos 1047 -121)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_roof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4d868")
+          (pos -105 -121)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_roof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4d4f8")
+          (pos 1484 135)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4da60")
+          (pos 1484 263)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4d9a8")
+          (pos 1484 391)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaba6c58")
+          (pos 1480 519)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaba67a0")
+          (pos 1480 647)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaba68e0")
+          (pos 1367 -57)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_corner.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xac06e98")
+          (pos -540 127)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale -1.02656 0.904633)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xac07068")
+          (pos 1373 903)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_corner.png")
+          (type 0)
+          (scale 1.49591 1.01907)
+          (angle 1.54812)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xac07148")
+          (pos -540 475)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale -1.02656 0.904633)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4d300")
+          (pos -540 591)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale -1.02656 0.904633)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xad477f8")
+          (pos -540 707)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale -1.02656 0.904633)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xad47900")
+          (pos -425 -57)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_corner.png")
+          (type 0)
+          (scale 1 1)
+          (angle -1.60494)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xad47988")
+          (pos -419 905)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_corner.png")
+          (type 0)
+          (scale 0.984741 1.09155)
+          (angle 3.11112)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xae07d48")
+          (pos -104 954)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_roof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 3.14387)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xae480e8")
+          (pos 280 954)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_roof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 3.14387)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xae07e20")
+          (pos 661 954)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_roof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 3.14387)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xae48280")
+          (pos 1045 954)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_roof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 3.14387)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4d0b8")
+          (pos -544 401)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_side.png")
+          (type 0)
+          (scale -1.04999 0.326508)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4d1a8")
+          (pos 279 -97)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_roof2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Stairs")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xaa4ef18")
+          (pos -389 447)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa4ea70")
+          (pos -261 409)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaec8cd0")
+          (pos -261 575)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xacc74a8")
+          (pos -133 537)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaec8ae8")
+          (pos -133 703)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaec8820")
+          (pos -5 665)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb0aa048")
+          (pos -5 831)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb0a9f60")
+          (pos 123 793)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Shadow")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xb0d3bc8")
+          (pos 429 -18)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 4.3617 0.916553)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb0e3da8")
+          (pos -264 91)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.60797 1.59605)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaec8f88")
+          (pos 1200 36)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.60797 1.59605)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaec8e88")
+          (pos 481 562)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.517823 1.49438)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xafa90d8")
+          (pos 804 479)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.121094 0.865723)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xab31f10")
+          (pos 821 347)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.456787 0.414063)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xab320e8")
+          (pos 854 439)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.125254 0.663415)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa5cd58")
+          (pos 713 859)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.560547 0.511719)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa5e2c8")
+          (pos 976 842)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.54834 0.737549)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa5df48")
+          (pos 818 723)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Door")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xb0d3af8")
+          (pos 338 745)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Background")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xaa5e608")
+          (pos -15 424)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa5e7f8")
+          (pos 973 427)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa5d330")
+          (pos 549 839)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate_crack.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa5d550")
+          (pos -181 185)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_crack.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa5d720")
+          (pos 1267 845)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_crack.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb149dd0")
+          (pos 1209 472)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.640625 0.746094)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb17d7d8")
+          (pos 1192 578)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.142578 0.601562)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb17d998")
+          (pos 1206 450)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.535156 0.523438)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa5dcd8")
+          (pos 1241 553)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.078125 0.478516)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xaa5d8e0")
+          (pos 1206 435)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/container_gate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/elevator.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/elevator.wst	2009-04-10 05:01:04 UTC (rev 2911)
+++ trunk/windstille/data/sectors/trainstation/elevator.wst	2009-04-10 05:02:11 UTC (rev 2912)
@@ -8,766 +8,763 @@
   (navigation
     (nodes)
     (edges))
-  (layer
-    (name "Scene")
-    (visible #t)
-    (locked #t)
-    (objects)
-    (child-layers
-      (layer
-        (name "Highlights")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa95f860")
-            (pos 0 -3)
-            (parent "0xa95f800")
-            (select-mask 1)
-            (path "images/decal/light2.png")
-            (type 2)
-            (scale 0.617188 0.625)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa95f800")
-            (pos 349 576)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light2.png")
-            (type 2)
-            (scale 0.117188 0.125)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0e42c8")
-            (pos 0 -3)
-            (parent "0xa0e4258")
-            (select-mask 1)
-            (path "images/decal/light2.png")
-            (type 2)
-            (scale 0.617188 0.625)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0e4258")
-            (pos 578 572)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light2.png")
-            (type 2)
-            (scale 0.117188 0.125)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0e0f78")
-            (pos 455 572)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light2.png")
-            (type 2)
-            (scale 3.76565 0.294281)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Lights")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa6e5800")
-            (pos 454 774)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light2.png")
-            (type 1)
-            (scale 20.453 15.3696)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa07bfb0")
-            (pos 454 623)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light2.png")
-            (type 1)
-            (scale 4.00336 3.39467)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Elevator")
-        (visible #t)
-        (locked #f)
-        (objects
-          (decal
-            (id "0xa0ebe30")
-            (pos 1022 826)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/plant4.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0ebda0")
-            (pos 370 225)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1.99062 0.165029)
-            (angle -1.56985)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0xa0ebd10")
-            (pos 423 216)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1.99062 0.165029)
-            (angle -1.56985)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0xa91ad70")
-            (pos 545 217)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1.99062 0.165029)
-            (angle -1.56985)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0xa91ace0")
-            (pos -371 814)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/plant5.png")
-            (type 0)
-            (scale 1.48186 1.90226)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa91ac50")
-            (pos 488 227)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1.99062 0.165029)
-            (angle -1.56985)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0xa95b288")
-            (pos 459 708)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/elevator.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa95b1f8")
-            (pos 183 84)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/elevator_wood.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa95b168")
-            (pos 53 340)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/elevator_wood.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa958ee0")
-            (pos -78 596)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/elevator_wood.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa958e50")
-            (pos -208 852)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/elevator_wood.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa958dc0")
-            (pos -211 854)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.472656 0.25)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa983328")
-            (pos 755 84)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/elevator_wood.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0xa983298")
-            (pos 885 340)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/elevator_wood.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0xa983208")
-            (pos 1016 596)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/elevator_wood.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0xa980120")
-            (pos 1146 852)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/elevator_wood.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0xa980090")
-            (pos 599 -236)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/elevator_wheel.png")
-            (type 0)
-            (scale 1 1)
-            (angle -0.676006)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa980000")
-            (pos 317 -235)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/elevator_wheel.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0.102794)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0e4698")
-            (pos 700 -28)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.549866 0.191284)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0e4608")
-            (pos 237 -29)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.549866 0.191284)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa978d00")
-            (pos 461 -137)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/elevator_engine.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa978c70")
-            (pos -234 924)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/elevator_stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0e4578")
-            (pos 1160 856)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.472656 0.25)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa49d260")
-            (pos 1164 914)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/elevator_stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa49d1d0")
-            (pos 1165 979)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1.08984 0.25)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa49d140")
-            (pos 108 864)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/humanreference.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0xa6c2d20")
-            (pos 1272 954)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.510803 0.3797)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa6c2c90")
-            (pos 1288 944)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/plant1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa6c2c00")
-            (pos -171.395 900.148)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/plant3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa745fa0")
-            (pos 483 989)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1.67376 0.258859)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa745f10")
-            (pos 998 1106)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa745e80")
-            (pos 998 1362)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0e30a0")
-            (pos 998 1618)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0e3010")
-            (pos 1510 1106)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0e43b0")
-            (pos -258 968)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1.08984 0.25)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0e8410")
-            (pos -542 1107)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa978d78")
-            (pos -30 1107)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0e4320")
-            (pos -30 1363)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa92d460")
-            (pos -30 1619)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa92d3d0")
-            (pos 963 1680)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/shadow.png")
-            (type 0)
-            (scale 7.86646 1.61989)
-            (angle -1.57154)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0xa9894f8")
-            (pos 1038 1192)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa945f18")
-            (pos 1206 1579)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.940395 1.53644)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa945eb0")
-            (pos 1238 1611)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.940395 1.53644)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0e6118")
-            (pos 1201 1587)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.940395 1.53644)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa989d50")
-            (pos 1113 1594)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.940395 1.53644)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa6f7188")
-            (pos 1188 1354)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.940395 1.53644)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa962d08")
-            (pos 1202 1448)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.940395 1.53644)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa91cef0")
-            (pos -308 1481)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.940395 1.53644)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0xa984c80")
-            (pos -340 1513)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.940395 1.53644)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0xa96a200")
-            (pos -303 1489)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.940395 1.53644)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0xa0a0138")
-            (pos -12 1570)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.940395 1.53644)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0xa9471c8")
-            (pos -236 1454)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.940395 1.53644)
-            (angle 0)
-            (hflip #t)
-            (vflip #f))
-          (decal
-            (id "0xa0ebc90")
-            (pos -265 1778)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa039830")
-            (pos -1054 1107)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa6df2b8")
-            (pos -1566 1107)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa95b800")
-            (pos 3047 1106)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa6d0fa0")
-            (pos 2534 1106)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa989800")
-            (pos 2022 1106)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa989850")
-            (pos -966 1146)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/shadow.png")
-            (type 0)
-            (scale 14.1607 1.61989)
-            (angle 0)
-            (hflip #t)
-            (vflip #t))
-          (decal
-            (id "0xa0e2f80")
-            (pos 1810 1137)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/shadow.png")
-            (type 0)
-            (scale 11.2615 1.61989)
-            (angle 0)
-            (hflip #f)
-            (vflip #t)))
-        (child-layers)))))
+  (layers
+    (layer
+      (name "Scene")
+      (visible #t)
+      (locked #t)
+      (objects))
+    (layer
+      (name "Highlights")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xb27cf80")
+          (pos 0 -3)
+          (parent "0xb27c858")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 2)
+          (scale 0.617188 0.625)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb27c858")
+          (pos 349 576)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 2)
+          (scale 0.117188 0.125)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb27d750")
+          (pos 0 -3)
+          (parent "0xb27d4d8")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 2)
+          (scale 0.617188 0.625)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb27d4d8")
+          (pos 578 572)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 2)
+          (scale 0.117188 0.125)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb27d5e0")
+          (pos 455 572)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 2)
+          (scale 3.76565 0.294281)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Lights")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xb27d870")
+          (pos 454 774)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 20.453 15.3696)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb27c488")
+          (pos 454 623)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 4.00336 3.39467)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Elevator")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xb27a598")
+          (pos 1022 826)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/plant4.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb27ad98")
+          (pos 370 225)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1.99062 0.165029)
+          (angle -1.56985)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xb28f200")
+          (pos 423 216)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1.99062 0.165029)
+          (angle -1.56985)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xb28f318")
+          (pos 545 217)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1.99062 0.165029)
+          (angle -1.56985)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xb27a7b8")
+          (pos -371 814)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/plant5.png")
+          (type 0)
+          (scale 1.48186 1.90226)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb27b9e8")
+          (pos 488 227)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1.99062 0.165029)
+          (angle -1.56985)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xb27bb20")
+          (pos 459 708)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/elevator.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb27bd38")
+          (pos 183 84)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/elevator_wood.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb27bef8")
+          (pos 53 340)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/elevator_wood.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb27bfa0")
+          (pos -78 596)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/elevator_wood.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb27c0b8")
+          (pos -208 852)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/elevator_wood.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb582f10")
+          (pos -211 854)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.472656 0.25)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb583028")
+          (pos 755 84)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/elevator_wood.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xb583158")
+          (pos 885 340)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/elevator_wood.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xb27b468")
+          (pos 1016 596)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/elevator_wood.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xb27b580")
+          (pos 1146 852)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/elevator_wood.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xb5c53e0")
+          (pos 599 -236)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/elevator_wheel.png")
+          (type 0)
+          (scale 1 1)
+          (angle -0.676006)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb775ff0")
+          (pos 317 -235)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/elevator_wheel.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0.102794)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb7760e0")
+          (pos 700 -28)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.549866 0.191284)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb649720")
+          (pos 237 -29)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.549866 0.191284)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb649870")
+          (pos 461 -137)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/elevator_engine.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb27b118")
+          (pos -234 924)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/elevator_stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb27b348")
+          (pos 1160 856)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.472656 0.25)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb7bebe8")
+          (pos 1164 914)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/elevator_stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb7e71a0")
+          (pos 1165 979)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.08984 0.25)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb68bd48")
+          (pos 108 864)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/humanreference.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xb80f258")
+          (pos 1272 954)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.510803 0.3797)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb80f478")
+          (pos 1288 944)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/plant1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb80f6c8")
+          (pos -171.395 900.148)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/plant3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb7e6f10")
+          (pos 483 989)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1.67376 0.258859)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb7be7a8")
+          (pos 998 1106)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb88ef58")
+          (pos 998 1362)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb7be988")
+          (pos 998 1618)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb7be398")
+          (pos 1510 1106)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb7be580")
+          (pos -258 968)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.08984 0.25)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb8a84c0")
+          (pos -542 1107)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb8a8a30")
+          (pos -30 1107)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb8a8c00")
+          (pos -30 1363)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb8a8630")
+          (pos -30 1619)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb8a8800")
+          (pos 963 1680)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 7.86646 1.61989)
+          (angle -1.57154)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xb8a8d08")
+          (pos 1038 1192)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb88e700")
+          (pos 1206 1579)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.940395 1.53644)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb88e818")
+          (pos 1238 1611)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.940395 1.53644)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb88ea58")
+          (pos 1201 1587)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.940395 1.53644)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb88eb70")
+          (pos 1113 1594)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.940395 1.53644)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb88eca8")
+          (pos 1188 1354)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.940395 1.53644)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb8b8ee8")
+          (pos 1202 1448)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.940395 1.53644)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb8b9db0")
+          (pos -308 1481)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.940395 1.53644)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xb8b9ec8")
+          (pos -340 1513)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.940395 1.53644)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xb8b9010")
+          (pos -303 1489)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.940395 1.53644)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xb8b9250")
+          (pos -12 1570)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.940395 1.53644)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xb8b9400")
+          (pos -236 1454)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.940395 1.53644)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xb8b9998")
+          (pos -265 1778)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb8b9b80")
+          (pos -1054 1107)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb8b9520")
+          (pos -1566 1107)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb8bab80")
+          (pos 3047 1106)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb8ba090")
+          (pos 2534 1106)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb8bac60")
+          (pos 2022 1106)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb8baf10")
+          (pos -966 1146)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 14.1607 1.61989)
+          (angle 0)
+          (hflip #t)
+          (vflip #t))
+        (decal
+          (id "0xb8ba780")
+          (pos 1810 1137)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 11.2615 1.61989)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/mine.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/mine.wst	2009-04-10 05:01:04 UTC (rev 2911)
+++ trunk/windstille/data/sectors/trainstation/mine.wst	2009-04-10 05:02:11 UTC (rev 2912)
@@ -5,862 +5,857 @@
   (name "")
   (ambient-color 0 0 0 1)
   (init-script "init.nut")
-  (layer
-    (name "Mine")
-    (visible #t)
-    (locked #t)
-    (objects)
-    (child-layers
-      (layer
-        (name "Ground")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9f2c0b8")
-            (pos 549 593)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9f2c9b0")
-            (pos 1347 593)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9f2cfa0")
-            (pos -249 593)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9f2b1f8")
-            (pos -2297 593)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9f2b3b8")
-            (pos -700.997 593)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9f2b4a0")
-            (pos -1499 593)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Light")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9f2cd38")
-            (pos 72.8123 428.586)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9f2cba8")
-            (pos 957.187 478)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa18e670")
-            (pos -2024.01 398.313)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa18e870")
-            (pos -1088.37 457.98)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa18e9c0")
-            (pos -1595.5 531.125)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa18eb10")
-            (pos -626.089 548.147)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa18ed40")
-            (pos 452.5 531.125)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa18efa0")
-            (pos -1090.81 479.953)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers
-          (layer
-            (name "Lamps")
-            (visible #t)
-            (locked #t)
-            (objects
-              (decal
-                (id "0xa129cc8")
-                (pos 523 227.062)
-                (parent "")
-                (select-mask 1)
-                (path "images/objects/apartmentlamp_light.png")
-                (type 1)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0x9f2ae40")
-                (pos -1525 227.062)
-                (parent "")
-                (select-mask 1)
-                (path "images/objects/apartmentlamp_light.png")
-                (type 1)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0x9f2b010")
-                (pos -1490.94 161.75)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/rooflamp_bloom.png")
-                (type 2)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa127848")
-                (pos 552.57 42.1211)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/rooflamp.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa128468")
-                (pos 561.945 159.309)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/rooflamp_bloom.png")
-                (type 2)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa1293d0")
-                (pos -1495.43 42.1211)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/rooflamp.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f)))
-            (child-layers))))
-      (layer
-        (name "Wood")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa129510")
-            (pos -2170.5 332.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_tree1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa129660")
-            (pos -954.877 340.5)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_tree2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa128930")
-            (pos -122.5 332.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_tree1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa59c2f0")
-            (pos 1093.12 340.5)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_tree2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e8e70")
-            (pos -122.5 -180.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_tree1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e8760")
-            (pos 1093.12 -171.5)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_tree2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e9030")
-            (pos -954.877 -171.5)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_tree2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e91e8")
-            (pos -2170.5 -180.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_tree1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Items")
-        (visible #t)
-        (locked #f)
-        (objects
-          (decal
-            (id "0xa3e9390")
-            (pos 750.812 468)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/trashcan.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e8c50")
-            (pos 425.812 460.188)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/trashcan.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e9668")
-            (pos -445.623 466.047)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/trashcan.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa59a610")
-            (pos -1903.44 466.047)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/trashcan.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9f2d5b0")
-            (pos 178 511)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/plant1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9f2f650")
-            (pos 1257 457)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/plant5.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9b243b0")
-            (pos 935 459)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/plant3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9b287c0")
-            (pos -1195 398)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/plant4.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Player")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa59a6f8")
-            (pos 638.516 439.91)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/humanreference.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Shadows")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa3e7d28")
-            (pos -103.75 531.125)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa59b4d0")
-            (pos 1075.94 526.438)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa59c000")
-            (pos 613.437 582.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa59c168")
-            (pos 211.875 567.062)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e6fe8")
-            (pos -450.186 557.297)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e79a8")
-            (pos -1840.03 590.5)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa7ed150")
-            (pos -2149.79 531.125)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa7ed338")
-            (pos -2179.87 298.703)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e66f8")
-            (pos 1073.56 306.875)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e67d8")
-            (pos -131.875 296.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa7ed050")
-            (pos -974.437 306.875)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e6908")
-            (pos -972.057 526.438)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Wall")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa3e6ca8")
-            (pos 803.06 203.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e6150")
-            (pos 803.063 459.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e6258")
-            (pos 1315.06 203.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e6418")
-            (pos 1315.06 459.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e6588")
-            (pos 803.06 -52.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e76e8")
-            (pos 1315.06 -52.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa869bd8")
-            (pos -732.937 -52.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa86aab8")
-            (pos -732.937 459.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa86a5a0")
-            (pos -732.937 203.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa86b020")
-            (pos -1244.94 -52.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa86ae88")
-            (pos -1244.93 459.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa86ad80")
-            (pos -1244.94 203.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa86a700")
-            (pos -220.937 459.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa86a100")
-            (pos -220.937 203.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa869f40")
-            (pos 291.063 459.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa869e28")
-            (pos 291.063 203.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa867a98")
-            (pos 291.063 -52.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa867db8")
-            (pos -220.937 -52.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa869098")
-            (pos -1756.93 -52.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa869b70")
-            (pos -1756.93 203.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa867ca0")
-            (pos -1756.93 459.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa8692d8")
-            (pos -2268.93 -52.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa869490")
-            (pos -2268.93 203.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa869a28")
-            (pos -2268.93 459.25)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/mine_background.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers)))))
+  (navigation
+    (nodes)
+    (edges))
+  (layers
+    (layer
+      (name "Mine")
+      (visible #t)
+      (locked #t)
+      (objects))
+    (layer
+      (name "Ground")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xb986450")
+          (pos 549 593)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb985718")
+          (pos 1347 593)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb985c58")
+          (pos -249 593)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb987298")
+          (pos -2297 593)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb9873b0")
+          (pos -700.997 593)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb9858c8")
+          (pos -1499 593)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Light")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xbac68d8")
+          (pos 72.8123 428.586)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbac6a40")
+          (pos 957.187 478)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbac6310")
+          (pos -2024.01 398.313)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbac5e98")
+          (pos -1088.37 457.98)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbac6058")
+          (pos -1595.5 531.125)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb986580")
+          (pos -626.089 548.147)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb9866d0")
+          (pos 452.5 531.125)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb9868b8")
+          (pos -1090.81 479.953)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Lamps")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xb986d40")
+          (pos 523 227.062)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb999a20")
+          (pos -1525 227.062)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb999bc8")
+          (pos -1490.94 161.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb999cb8")
+          (pos 552.57 42.1211)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb9836a8")
+          (pos 561.945 159.309)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb9852c8")
+          (pos -1495.43 42.1211)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Wood")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xb984028")
+          (pos -2170.5 332.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_tree1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb984180")
+          (pos -954.877 340.5)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_tree2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb986c50")
+          (pos -122.5 332.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_tree1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb984360")
+          (pos 1093.12 340.5)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_tree2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb9845b0")
+          (pos -122.5 -180.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_tree1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb984778")
+          (pos 1093.12 -171.5)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_tree2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb984938")
+          (pos -954.877 -171.5)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_tree2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb984cb8")
+          (pos -2170.5 -180.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_tree1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Items")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xb984aa8")
+          (pos 750.812 468)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/trashcan.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb9854b8")
+          (pos 425.812 460.188)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/trashcan.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbe58a20")
+          (pos -445.623 466.047)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/trashcan.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbe7bc68")
+          (pos -1903.44 466.047)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/trashcan.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbe8d6a0")
+          (pos 178 511)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/plant1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbe9f128")
+          (pos 1257 457)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/plant5.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb984ff8")
+          (pos 935 459)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/plant3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbebc0c0")
+          (pos -1195 398)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/plant4.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Player")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xbebbee8")
+          (pos 638.516 439.91)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/humanreference.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Shadows")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xbef3430")
+          (pos -103.75 531.125)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf27520")
+          (pos 1075.94 526.438)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf273f0")
+          (pos 613.437 582.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb983818")
+          (pos 211.875 567.062)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb983a08")
+          (pos -450.186 557.297)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf32610")
+          (pos -1840.03 590.5)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf327e0")
+          (pos -2149.79 531.125)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf32480")
+          (pos -2179.87 298.703)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf328d0")
+          (pos 1073.56 306.875)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf32eb8")
+          (pos -131.875 296.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf33078")
+          (pos -974.437 306.875)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf329a8")
+          (pos -972.057 526.438)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Wall")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xbf33300")
+          (pos 803.06 203.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf335d8")
+          (pos 803.063 459.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf33468")
+          (pos 1315.06 203.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf33c10")
+          (pos 1315.06 459.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf33db8")
+          (pos 803.06 -52.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf33f30")
+          (pos 1315.06 -52.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf34e98")
+          (pos -732.937 -52.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf35068")
+          (pos -732.937 459.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf34488")
+          (pos -732.937 203.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf35210")
+          (pos -1244.94 -52.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf34030")
+          (pos -1244.93 459.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf34150")
+          (pos -1244.94 203.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf34a70")
+          (pos -220.937 459.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf34c58")
+          (pos -220.937 203.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf345e8")
+          (pos 291.063 459.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbf34840")
+          (pos 291.063 203.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb9978c8")
+          (pos 291.063 -52.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbc57dc8")
+          (pos -220.937 -52.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbc57fa8")
+          (pos -1756.93 -52.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb998e28")
+          (pos -1756.93 203.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb998af0")
+          (pos -1756.93 459.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb998bd0")
+          (pos -2268.93 -52.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb998fb8")
+          (pos -2268.93 203.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb9991b8")
+          (pos -2268.93 459.25)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/office.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/office.wst	2009-04-10 05:01:04 UTC (rev 2911)
+++ trunk/windstille/data/sectors/trainstation/office.wst	2009-04-10 05:02:11 UTC (rev 2912)
@@ -5,806 +5,967 @@
   (name "")
   (ambient-color 0 0 0 1)
   (init-script "init.nut")
-  (layer
-    (name "Scene")
-    (visible 1)
-    (locked 0)
-    (objects)
-    (child-layers
-      (layer
-        (name "Character")
-        (visible 1)
-        (locked 0)
-        (objects
-          (decal
-            (id "0xa2ab680")
-            (pos 24 457)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/humanreference.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "Light")
-        (visible 1)
-        (locked 0)
-        (objects
-          (decal
-            (id "0xa2aae28")
-            (pos -176.66 473.947)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2aad68")
-            (pos 359.466 456.262)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2aae90")
-            (pos -739.878 477.707)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2aaf70")
-            (pos -1203.21 476.314)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2ab780")
-            (pos 838.744 503.93)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2ab860")
-            (pos 241.479 454.773)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "Ground")
-        (visible 1)
-        (locked 0)
-        (objects
-          (decal
-            (id "0xa2aac58")
-            (pos 130 636)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a6750")
-            (pos 386 636)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a90b0")
-            (pos 642 636)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a9128")
-            (pos 130 124)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b8ae8")
-            (pos 386 124)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a9250")
-            (pos 642 124)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a92f8")
-            (pos -638 636)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a93a0")
-            (pos -382 636)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a9488")
-            (pos -126 636)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a9570")
-            (pos -638 124)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a9658")
-            (pos -382 124)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a9740")
-            (pos -126 124)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a9828")
-            (pos -1406 636)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a9910")
-            (pos -1150 636)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a99f8")
-            (pos -894 636)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a9ae0")
-            (pos -1406 124)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a9bc8")
-            (pos -1150 124)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a9cb0")
-            (pos -894 124)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a9d98")
-            (pos 898 636)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a9e80")
-            (pos 898 124)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2a9f68")
-            (pos 1410 636)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2aa050")
-            (pos 1154 636)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2aa138")
-            (pos 1154 124)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2aa220")
-            (pos 1410 124)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2aa308")
-            (pos 1666 124)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2aa3f0")
-            (pos 1666 636)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "Lights")
-        (visible 1)
-        (locked 0)
-        (objects
-          (decal
-            (id "0xa2ac9d0")
-            (pos -185.687 478)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2ac348")
-            (pos -186.087 454.328)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1_highlight.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2aa8e0")
-            (pos -697.391 478)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b74c0")
-            (pos -697.791 454.328)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1_highlight.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b7570")
-            (pos -1218 458.328)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1_highlight.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b7640")
-            (pos -1218.6 478)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b7720")
-            (pos 143.113 478)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b7800")
-            (pos 142.713 454.328)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1_highlight.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b78f0")
-            (pos 370.625 454.328)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1_highlight.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b79e0")
-            (pos 371.025 478)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b7ac0")
-            (pos 721.247 478)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b7ba0")
-            (pos 720.847 454.328)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/lamp1_highlight.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "Character")
-        (visible 1)
-        (locked 0)
-        (objects)
-        (child-layers))
-      (layer
-        (name "Stuff")
-        (visible 1)
-        (locked 0)
-        (objects
-          (decal
-            (id "0xa2ac890")
-            (pos 546.349 496)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bench.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b7cf0")
-            (pos -21.9375 496)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bench.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b7dd0")
-            (pos -435.526 496)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bench.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b7eb0")
-            (pos -965.526 496)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bench.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b7f90")
-            (pos 956.427 496)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bench.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "Shadow")
-        (visible 1)
-        (locked 0)
-        (objects
-          (decal
-            (id "0xa450648")
-            (pos 253.75 47.375)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa450700")
-            (pos 238.125 713)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa4507e0")
-            (pos 563.125 702.062)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b8570")
-            (pos 255.313 430)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/train_door.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b8658")
-            (pos -175 635)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b8738")
-            (pos -702.376 610.672)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2b8818")
-            (pos -1181.38 644.672)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "BackgroundWall")
-        (visible 1)
-        (locked 0)
-        (objects
-          (decal
-            (id "0xa2ac830")
-            (pos 578 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa2aa830")
-            (pos 962 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa39ffc0")
-            (pos 450 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa39fa48")
-            (pos 66 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa39fae8")
-            (pos 322 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa312758")
-            (pos 194 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa312838")
-            (pos -190 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa312918")
-            (pos -62 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa3129f8")
-            (pos -318 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa312ad8")
-            (pos -702 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa312bb8")
-            (pos -446 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa312c98")
-            (pos -574 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa312d78")
-            (pos -958 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa312e58")
-            (pos -830 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa312f38")
-            (pos -1086 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa313018")
-            (pos -1470 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa3130f8")
-            (pos -1214 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa3131d8")
-            (pos -1342 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa3132b8")
-            (pos 834 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa313398")
-            (pos 1090 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa313478")
-            (pos 706 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa313558")
-            (pos 1474 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa313638")
-            (pos 1346 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa313718")
-            (pos 1602 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa3137f8")
-            (pos 1218 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa5b3248")
-            (pos 1730 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/wall3.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers)))))
+  (navigation
+    (nodes)
+    (edges))
+  (layers
+    (layer
+      (name "Scene")
+      (visible #t)
+      (locked #f)
+      (objects))
+    (layer
+      (name "Character")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xbfdfea0")
+          (pos 24 457)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/humanreference.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Light")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xbfdf770")
+          (pos -176.66 473.947)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfdf478")
+          (pos 359.466 456.262)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfe00c0")
+          (pos -739.878 477.707)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfe0688")
+          (pos -1203.21 476.314)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfe07d8")
+          (pos 838.744 503.93)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfe0928")
+          (pos 241.479 454.773)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Ground")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xbfe10b0")
+          (pos 130 636)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfff6b8")
+          (pos 386 636)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfdd9f0")
+          (pos 642 636)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfdd6e8")
+          (pos 130 124)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfff498")
+          (pos 386 124)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfde388")
+          (pos 642 124)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfff3b8")
+          (pos -638 636)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfde0c8")
+          (pos -382 636)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfde208")
+          (pos -126 636)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfddd68")
+          (pos -638 124)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfddf50")
+          (pos -382 124)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfdde88")
+          (pos -126 124)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfdef28")
+          (pos -1406 636)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfdefa8")
+          (pos -1150 636)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfdf180")
+          (pos -894 636)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfde458")
+          (pos -1406 124)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc1b7868")
+          (pos -1150 124)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfdea98")
+          (pos -894 124)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc1b7970")
+          (pos 898 636)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc1cfb48")
+          (pos 898 124)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc1cfdb0")
+          (pos 1410 636)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc1cfc30")
+          (pos 1154 636)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc1cfd08")
+          (pos 1154 124)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfde640")
+          (pos 1410 124)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc2804b0")
+          (pos 1666 124)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc1f0048")
+          (pos 1666 636)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Lights")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xbfdd558")
+          (pos -185.687 478)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfe0b88")
+          (pos -186.087 454.328)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfdf608")
+          (pos -697.391 478)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc31b8a0")
+          (pos -697.791 454.328)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbfdd2c8")
+          (pos -1218 458.328)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc2803f8")
+          (pos -1218.6 478)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc298de8")
+          (pos 143.113 478)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc3562b0")
+          (pos 142.713 454.328)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc31bae0")
+          (pos 370.625 454.328)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc31bc88")
+          (pos 371.025 478)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc31ba10")
+          (pos 721.247 478)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc31bdc0")
+          (pos 720.847 454.328)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Character")
+      (visible #t)
+      (locked #f)
+      (objects))
+    (layer
+      (name "Stuff")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xc3ca9a8")
+          (pos 546.349 496)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bench.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc3cae70")
+          (pos -21.9375 496)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bench.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc43f8d0")
+          (pos -435.526 496)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bench.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc3cac70")
+          (pos -965.526 496)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bench.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc2986d0")
+          (pos 956.427 496)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bench.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Shadow")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xc46f780")
+          (pos 253.75 47.375)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc46fe88")
+          (pos 238.125 713)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc51ba00")
+          (pos 563.125 702.062)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc51bd30")
+          (pos 255.313 430)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/train_door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc4d6dc8")
+          (pos -175 635)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc56b0d0")
+          (pos -702.376 610.672)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc56af90")
+          (pos -1181.38 644.672)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "BackgroundWall")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xc53e408")
+          (pos 578 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbffd228")
+          (pos 962 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbff2b08")
+          (pos 450 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbffd510")
+          (pos 66 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbff28e8")
+          (pos 322 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbffd898")
+          (pos 194 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbffd9d8")
+          (pos -190 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbffdaf0")
+          (pos -62 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbffe020")
+          (pos -318 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbffe798")
+          (pos -702 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbffe950")
+          (pos -446 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbffeb08")
+          (pos -574 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbffdca8")
+          (pos -958 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbffde90")
+          (pos -830 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbffe630")
+          (pos -1086 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbffe258")
+          (pos -1470 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xbffe370")
+          (pos -1214 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc92a5e8")
+          (pos -1342 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc8fa368")
+          (pos 834 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc8fa428")
+          (pos 1090 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc98a858")
+          (pos 706 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc9bab40")
+          (pos 1474 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xc9eac58")
+          (pos 1346 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xca1aeb8")
+          (pos 1602 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xca4b038")
+          (pos 1218 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xca4b120")
+          (pos 1730 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wall3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/stairtest.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/stairtest.wst	2009-04-10 05:01:04 UTC (rev 2911)
+++ trunk/windstille/data/sectors/trainstation/stairtest.wst	2009-04-10 05:02:11 UTC (rev 2912)
@@ -5,1172 +5,1433 @@
   (name "")
   (ambient-color 0 0 0 1)
   (init-script "init.nut")
-  (layer
-    (name "New Layer")
-    (visible 1)
-    (locked 0)
-    (objects
-      (decal
-        (id "0x9f4d0b8")
-        (pos -784.328 285.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4d1a0")
-        (pos -1154.33 285.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4d288")
-        (pos -1239.52 541.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4d370")
-        (pos -869.515 541.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4d458")
-        (pos -868.033 29.2408)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4e758")
-        (pos -1238.03 29.2408)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4e840")
-        (pos -1152.85 -226.759)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4e928")
-        (pos -782.845 -226.759)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4ea10")
-        (pos -42.8453 -226.759)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4eaf8")
-        (pos -412.845 -226.759)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4ebe0")
-        (pos -498.033 29.2408)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4ecc8")
-        (pos -128.033 29.2408)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4edb0")
-        (pos -129.515 541.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4ee98")
-        (pos -499.515 541.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4ef80")
-        (pos -414.328 285.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4f068")
-        (pos -44.3278 285.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4f150")
-        (pos -50.4747 1309.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4f238")
-        (pos -420.475 1309.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4f320")
-        (pos -505.662 1565.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4f408")
-        (pos -135.662 1565.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4f4f0")
-        (pos -134.18 1053.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4f5d8")
-        (pos -504.18 1053.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4f6c0")
-        (pos -418.992 797.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4f7a8")
-        (pos -48.9923 797.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4f890")
-        (pos -788.992 797.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4f978")
-        (pos -1158.99 797.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4fa60")
-        (pos -1244.18 1053.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4fb48")
-        (pos -874.18 1053.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4fc30")
-        (pos -875.662 1565.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4fd18")
-        (pos -1245.66 1565.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4fe00")
-        (pos -1160.47 1309.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4fee8")
-        (pos -790.475 1309.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4ffd0")
-        (pos 689.526 1309.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f500b8")
-        (pos 319.525 1309.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f501a0")
-        (pos 234.338 1566.8)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f50288")
-        (pos 604.338 1565.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f50370")
-        (pos 605.821 1053.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f50458")
-        (pos 235.82 1053.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f50540")
-        (pos 321.008 797.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f50628")
-        (pos 691.008 797.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f50710")
-        (pos 1431.01 797.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5e6f0")
-        (pos 1061.01 797.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5e7a8")
-        (pos 975.82 1053.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5e890")
-        (pos 1345.82 1053.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5e978")
-        (pos 1344.34 1565.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5ea60")
-        (pos 974.338 1565.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5eb48")
-        (pos 1059.53 1309.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5ec30")
-        (pos 1429.53 1309.24)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5ed18")
-        (pos 1065.67 285.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5ee00")
-        (pos 980.485 541.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5eee8")
-        (pos 1350.49 541.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5efd0")
-        (pos 1351.97 29.2407)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5f0b8")
-        (pos 367.905 -108.259)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5f1a0")
-        (pos 1067.15 -226.759)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5f288")
-        (pos 1437.15 -226.759)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5f370")
-        (pos 697.155 -226.759)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5f458")
-        (pos 327.155 -226.759)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5f540")
-        (pos 241.967 29.2407)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5f628")
-        (pos 611.968 29.2407)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5f710")
-        (pos 610.485 541.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5f7f8")
-        (pos -188.118 395.202)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5f8d8")
-        (pos 240.485 541.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5f9c0")
-        (pos 325.672 285.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5faa8")
-        (pos 6.44479 160.077)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5fb88")
-        (pos 13.4448 209.264)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5fc68")
-        (pos 695.673 285.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f5fd50")
-        (pos 588 224)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/stair2.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f48f60")
-        (pos 588 384)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/stair1.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f63c28")
-        (pos 716 512)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/stair1.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f63cc8")
-        (pos 336.132 378.827)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f63d68")
-        (pos 716 352)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/stair2.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f63e48")
-        (pos 972 608)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/stair2.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f63f28")
-        (pos 972 766.438)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/stair1.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f64008")
-        (pos 844 640)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/stair1.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f640e8")
-        (pos 844 480)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/stair2.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f641c8")
-        (pos -295.118 263.202)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f642a8")
-        (pos 396 320.563)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/wallplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f64360")
-        (pos 98.6324 375.702)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f64440")
-        (pos -377.93 358.514)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f64520")
-        (pos 140 320.563)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/wallplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f64608")
-        (pos -372 320.563)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/wallplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f646f0")
-        (pos -116 320.563)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/wallplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f647d8")
-        (pos 379 487.563)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/rooflamp.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f648c0")
-        (pos -99 487.563)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/rooflamp.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f649a8")
-        (pos 376.312 684.625)
-        (parent "")
-        (select-mask 1)
-        (path "images/objects/apartmentlamp_light.png")
-        (type 1)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f64a98")
-        (pos -66.6875 696.312)
-        (parent "")
-        (select-mask 1)
-        (path "images/objects/apartmentlamp_light.png")
-        (type 1)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f64b88")
-        (pos 385.688 606.5)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/rooflamp_bloom.png")
-        (type 2)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbcd28")
-        (pos -79.9375 597.125)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/rooflamp_bloom.png")
-        (type 2)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbce10")
-        (pos -150.336 803.741)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/light.png")
-        (type 1)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbcef0")
-        (pos 368.377 942.761)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/light.png")
-        (type 1)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbcfd0")
-        (pos 274.615 124.982)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/light.png")
-        (type 1)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbd0b0")
-        (pos 323.559 150.22)
-        (parent "")
-        (select-mask 1)
-        (path "images/streetlamp.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f60778")
-        (pos 322.07 217.889)
-        (parent "")
-        (select-mask 1)
-        (path "images/streetlamp-light.png")
-        (type 1)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbde78")
-        (pos 323.632 105.389)
-        (parent "")
-        (select-mask 1)
-        (path "images/streetlamp-highlight.png")
-        (type 2)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbe9f8")
-        (pos 9.67236 108.563)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/terminal.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbd648")
-        (pos -296.68 180.563)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/bench.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbe320")
-        (pos 981.968 29.2407)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbe3e8")
-        (pos 1435.67 285.241)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steelplate.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbe4d0")
-        (pos -238.868 211.639)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/light.png")
-        (type 1)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbe5b0")
-        (pos 0.194588 208.514)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/light.png")
-        (type 1)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbe690")
-        (pos -475.787 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbe778")
-        (pos -440.787 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbe860")
-        (pos -370.787 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9fbe948")
-        (pos -405.787 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f609b8")
-        (pos -300.816 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f60aa0")
-        (pos -335.816 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f60b88")
-        (pos -125.845 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f60c70")
-        (pos -90.8452 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f60d58")
-        (pos -195.816 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f60e40")
-        (pos -160.816 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f60f28")
-        (pos -230.816 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f61010")
-        (pos -265.816 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f610f8")
-        (pos 154.126 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f611e0")
-        (pos 189.126 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f612c8")
-        (pos 259.126 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f613b0")
-        (pos 224.126 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f61498")
-        (pos 329.097 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f61580")
-        (pos 294.097 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f61668")
-        (pos 84.1258 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f61750")
-        (pos 119.126 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f61838")
-        (pos 14.1548 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f61920")
-        (pos 49.1548 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f61a08")
-        (pos -20.8452 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f61af0")
-        (pos -55.8452 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f61bd8")
-        (pos 498.53 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f61cc0")
-        (pos 428.559 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f61da8")
-        (pos 463.559 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f61e90")
-        (pos 393.559 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f61f78")
-        (pos 358.559 265.367)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/handrail.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)))
-    (child-layers)))
+  (navigation
+    (nodes)
+    (edges))
+  (layers
+    (layer
+      (name "New Layer")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xcbb4490")
+          (pos -784.328 285.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb5a90")
+          (pos -1154.33 285.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcc30288")
+          (pos -1239.52 541.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcc303c0")
+          (pos -869.515 541.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcc304d8")
+          (pos -868.033 29.2408)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbd13b0")
+          (pos -1238.03 29.2408)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbd1500")
+          (pos -1152.85 -226.759)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbd1608")
+          (pos -782.845 -226.759)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb5c40")
+          (pos -42.8453 -226.759)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbd0d80")
+          (pos -412.845 -226.759)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbd0e80")
+          (pos -498.033 29.2408)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbd0f88")
+          (pos -128.033 29.2408)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbd1090")
+          (pos -129.515 541.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb5d48")
+          (pos -499.515 541.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb6a38")
+          (pos -414.328 285.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb5e28")
+          (pos -44.3278 285.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb7958")
+          (pos -50.4747 1309.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb7a38")
+          (pos -420.475 1309.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb5ed0")
+          (pos -505.662 1565.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb6020")
+          (pos -135.662 1565.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb6328")
+          (pos -134.18 1053.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb63a8")
+          (pos -504.18 1053.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb6c98")
+          (pos -418.992 797.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd3c6f68")
+          (pos -48.9923 797.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb66a8")
+          (pos -788.992 797.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd3c7040")
+          (pos -1158.99 797.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd423cd0")
+          (pos -1244.18 1053.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd423ea0")
+          (pos -874.18 1053.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd3c70e8")
+          (pos -875.662 1565.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd423f78")
+          (pos -1245.66 1565.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd424058")
+          (pos -1160.47 1309.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd4241a8")
+          (pos -790.475 1309.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb7488")
+          (pos 689.526 1309.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd539df0")
+          (pos 319.525 1309.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb76e8")
+          (pos 234.338 1566.8)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd539af8")
+          (pos 604.338 1565.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd539b78")
+          (pos 605.821 1053.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd765b98")
+          (pos 235.82 1053.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd765670")
+          (pos 321.008 797.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd7657a0")
+          (pos 691.008 797.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd64fba0")
+          (pos 1431.01 797.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd64fca8")
+          (pos 1061.01 797.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd64f8d0")
+          (pos 975.82 1053.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd64f9d0")
+          (pos 1345.82 1053.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd990c70")
+          (pos 1344.34 1565.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd990d78")
+          (pos 974.338 1565.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xd990eb0")
+          (pos 1059.53 1309.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xdaa6aa0")
+          (pos 1429.53 1309.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xdaa6b68")
+          (pos 1065.67 285.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xdaa6c48")
+          (pos 980.485 541.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xdaa6d98")
+          (pos 1350.49 541.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xdd2efb8")
+          (pos 1351.97 29.2407)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xdc193d0")
+          (pos 367.905 -108.259)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xdc190f0")
+          (pos 1067.15 -226.759)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xdc191d8")
+          (pos 1437.15 -226.759)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xde44cd8")
+          (pos 697.155 -226.759)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xdd2f150")
+          (pos 327.155 -226.759)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xde44db0")
+          (pos 241.967 29.2407)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xdf5aa50")
+          (pos 611.968 29.2407)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xdf5ac20")
+          (pos 610.485 541.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xde44e58")
+          (pos -188.118 395.202)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xde44fe0")
+          (pos 240.485 541.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xdf5ad50")
+          (pos 325.672 285.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xdf5aef0")
+          (pos 6.44479 160.077)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe0cd210")
+          (pos 13.4448 209.264)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe0cd468")
+          (pos 695.673 285.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe1e2e10")
+          (pos 588 224)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe29c940")
+          (pos 588 384)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe1e32c0")
+          (pos 716 512)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb70a0")
+          (pos 336.132 378.827)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe29c708")
+          (pos 716 352)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe29c450")
+          (pos 972 608)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb7180")
+          (pos 972 766.438)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe34c310")
+          (pos 844 640)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe365cd0")
+          (pos 844 480)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xcbb7230")
+          (pos -295.118 263.202)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe375e40")
+          (pos 396 320.563)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe1e2ee8")
+          (pos 98.6324 375.702)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe1e3038")
+          (pos -377.93 358.514)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe3b7f28")
+          (pos 140 320.563)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe3b8058")
+          (pos -372 320.563)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe3b80d8")
+          (pos -116 320.563)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe39fc78")
+          (pos 379 487.563)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe39f990")
+          (pos -99 487.563)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe39fac8")
+          (pos 376.312 684.625)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe400960")
+          (pos -66.6875 696.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe400ac8")
+          (pos 385.688 606.5)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe418c58")
+          (pos -79.9375 597.125)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe445d20")
+          (pos -150.336 803.741)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe445e18")
+          (pos 368.377 942.761)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe445f40")
+          (pos 274.615 124.982)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe3d02d8")
+          (pos 323.559 150.22)
+          (parent "")
+          (select-mask 1)
+          (path "images/streetlamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe4731b8")
+          (pos 322.07 217.889)
+          (parent "")
+          (select-mask 1)
+          (path "images/streetlamp-light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe473290")
+          (pos 323.632 105.389)
+          (parent "")
+          (select-mask 1)
+          (path "images/streetlamp-highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe4735b0")
+          (pos 9.67236 108.563)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/terminal.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe473878")
+          (pos -296.68 180.563)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bench.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe473a10")
+          (pos 981.968 29.2407)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe473bc0")
+          (pos 1435.67 285.241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe3d03c0")
+          (pos -238.868 211.639)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe570570")
+          (pos 0.194588 208.514)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe3d04d8")
+          (pos -475.787 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe5cd400")
+          (pos -440.787 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe473cd0")
+          (pos -370.787 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe5cd1a8")
+          (pos -405.787 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe570180")
+          (pos -300.816 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe474200")
+          (pos -335.816 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe4743c8")
+          (pos -125.845 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe570260")
+          (pos -90.8452 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe659ea8")
+          (pos -195.816 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe570338")
+          (pos -160.816 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe667b78")
+          (pos -230.816 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe66eb48")
+          (pos -265.816 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe675b28")
+          (pos 154.126 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe67cc40")
+          (pos 189.126 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe683aa8")
+          (pos 259.126 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe68aa20")
+          (pos 224.126 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe6919e0")
+          (pos 329.097 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe698970")
+          (pos 294.097 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe69f980")
+          (pos 84.1258 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe6ad960")
+          (pos 119.126 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe6a6918")
+          (pos 14.1548 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe6bb918")
+          (pos 49.1548 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe6c2890")
+          (pos -20.8452 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe6c9848")
+          (pos -55.8452 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe6d0800")
+          (pos 498.53 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe6d77b8")
+          (pos 428.559 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe6de770")
+          (pos 463.559 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe6e5728")
+          (pos 393.559 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe6ec6e0")
+          (pos 358.559 265.367)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/steelplatetest.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/steelplatetest.wst	2009-04-10 05:01:04 UTC (rev 2911)
+++ trunk/windstille/data/sectors/trainstation/steelplatetest.wst	2009-04-10 05:02:11 UTC (rev 2912)
@@ -5,385 +5,388 @@
   (name "")
   (ambient-color 0 0 0 1)
   (init-script "init.nut")
-  (layer
-    (name "Scene")
-    (visible #t)
-    (locked #f)
-    (objects
-      (decal
-        (id "0xa1a6c58")
-        (pos 1494 414)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0xa407900")
-        (pos 982 672)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0xa425d20")
-        (pos 982 416)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x9be2b60")
-        (pos 2006 672)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0xa425da0")
-        (pos 2006 416)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0xa408cb8")
-        (pos 1884 717)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 1.72268 1.06486)
-        (angle -1.56411)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x9bdb760")
-        (pos 2006 160)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x9f41580")
-        (pos 1494 160)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x9bdb7b0")
-        (pos 982 160)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0xa44ca00")
-        (pos 470 160)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0xa1c48b0")
-        (pos 470 416)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0xa1af6d0")
-        (pos 470 672)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/mine_background.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0xa43d690")
-        (pos 1268 698)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 1.72268 1.06486)
-        (angle -1.56411)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x9ed87f8")
-        (pos 1304 480)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steeltile2.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0xa1c4468")
-        (pos 1302 608)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steeltile3.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x9b40448")
-        (pos 1302 736)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steeltile6.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0xa420620")
-        (pos 1814 734)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steeltile3.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #t)
-        (vflip #f))
-      (decal
-        (id "0xa44cad8")
-        (pos 1558 672)
-        (parent "")
-        (select-mask 1)
-        (path "images/objects/door.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0xa4261d8")
-        (pos 1814 606)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steeltile5.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #t)
-        (vflip #f))
-      (decal
-        (id "0x9be3030")
-        (pos 1555 549)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 0.139274 0.594062)
-        (angle -1.56411)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0xa1c27f0")
-        (pos 1560 480)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steeltile6.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #t)
-        (vflip #f))
-      (decal
-        (id "0x9ed3e70")
-        (pos 1489 673)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 0.131086 0.898949)
-        (angle -0.00282016)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0xa1aacb0")
-        (pos 1432 480)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steeltile4.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #t)
-        (vflip #f))
-      (decal
-        (id "0xa41fe08")
-        (pos 1430 608)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steeltile1.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #t)
-        (vflip #f))
-      (decal
-        (id "0xa41fe88")
-        (pos 1814 478)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steeltile3.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #t)
-        (vflip #f))
-      (decal
-        (id "0xa43f050")
-        (pos 1688 480)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steeltile2.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x9b3f478")
-        (pos 1634 682)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/dark.png")
-        (type 0)
-        (scale 0.131086 0.898949)
-        (angle -0.00282016)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x9bdcd68")
-        (pos 1686 735)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steeltile6.png")
-        (type 0)
-        (scale 1 0.984375)
-        (angle 0)
-        (hflip #t)
-        (vflip #f))
-      (decal
-        (id "0xa4405b0")
-        (pos 1430 736)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steeltile4.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #t)
-        (vflip #f))
-      (decal
-        (id "0xa440630")
-        (pos 1686 608)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/steeltile1.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #t)
-        (vflip #f))
-      (decal
-        (id "0xa41ef40")
-        (pos 1238 864)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/stone2.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0xa41ef90")
-        (pos 1750 864)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/stone2.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0x9eca2b0")
-        (pos 726 864)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/stone2.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f))
-      (decal
-        (id "0xa4404c8")
-        (pos 2262 864)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/stone2.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)
-        (hflip #f)
-        (vflip #f)))
-    (child-layers)))
+  (navigation
+    (nodes)
+    (edges))
+  (layers
+    (layer
+      (name "Scene")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xe798bd8")
+          (pos 1494 414)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79b5c0")
+          (pos 982 672)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79b660")
+          (pos 982 416)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79b2d8")
+          (pos 2006 672)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79b498")
+          (pos 2006 416)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79cb78")
+          (pos 1884 717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.72268 1.06486)
+          (angle -1.56411)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79c3c0")
+          (pos 2006 160)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79c930")
+          (pos 1494 160)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79c4c0")
+          (pos 982 160)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79c5f8")
+          (pos 470 160)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79c718")
+          (pos 470 416)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79bc08")
+          (pos 470 672)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79bdd8")
+          (pos 1268 698)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.72268 1.06486)
+          (angle -1.56411)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79b868")
+          (pos 1304 480)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steeltile2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79baf0")
+          (pos 1302 608)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steeltile3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe7b5f80")
+          (pos 1302 736)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steeltile6.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe7b6048")
+          (pos 1814 734)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steeltile3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xe799170")
+          (pos 1558 672)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe7992a8")
+          (pos 1814 606)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steeltile5.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xe799748")
+          (pos 1555 549)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.139274 0.594062)
+          (angle -1.56411)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe7998d0")
+          (pos 1560 480)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steeltile6.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xe7994c8")
+          (pos 1489 673)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.131086 0.898949)
+          (angle -0.00282016)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe799eb8")
+          (pos 1432 480)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steeltile4.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xe79a508")
+          (pos 1430 608)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steeltile1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xe79a050")
+          (pos 1814 478)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steeltile3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xe799b20")
+          (pos 1688 480)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steeltile2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe799c40")
+          (pos 1634 682)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.131086 0.898949)
+          (angle -0.00282016)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79a5d0")
+          (pos 1686 735)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steeltile6.png")
+          (type 0)
+          (scale 1 0.984375)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xe79aa88")
+          (pos 1430 736)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steeltile4.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xe79b118")
+          (pos 1686 608)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steeltile1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0xe79a700")
+          (pos 1238 864)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79af40")
+          (pos 1750 864)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79abe8")
+          (pos 726 864)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe79ada8")
+          (pos 2262 864)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/toilet.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/toilet.wst	2009-04-10 05:01:04 UTC (rev 2911)
+++ trunk/windstille/data/sectors/trainstation/toilet.wst	2009-04-10 05:02:11 UTC (rev 2912)
@@ -5,1109 +5,1105 @@
   (name "")
   (ambient-color 0.5 0.5 0.5 1)
   (init-script "init.nut")
-  (layer
-    (name "Scene")
-    (visible #t)
-    (locked #t)
-    (objects)
-    (child-layers
-      (layer
-        (name "Light")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9fbe068")
-            (pos 1292 294)
-            (parent "")
-            (select-mask 1)
-            (path "images/streetlamp-light.png")
-            (type 1)
-            (scale 0.843122 2.78601)
-            (angle 4.53577)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbd698")
-            (pos 949 238)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/apartmentlamp_light.png")
-            (type 1)
-            (scale 1.36387 1.52344)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbd378")
-            (pos 958 5)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/apartmentlamp_highlight.png")
-            (type 2)
-            (scale 1.74257 1.58333)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Character")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9fbeb00")
-            (pos 1581 269)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/humanreference.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Ground")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0x9fbb330")
-            (pos 1683 -53)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 0.792 0.76)
-            (angle -2.32532)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbb5a0")
-            (pos 1716 400)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 0.792 0.76)
-            (angle -0.809692)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbba48")
-            (pos 335 405)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 0.792 0.76)
-            (angle -2.32532)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x9fbbc08")
-            (pos 366 -49)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 0.792 0.76)
-            (angle -0.809692)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x9fbbdc8")
-            (pos 1472 448)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbbf88")
-            (pos 1344 448)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbc148")
-            (pos 1216 448)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbc308")
-            (pos 1088 448)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbc4c8")
-            (pos 960 448)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbc688")
-            (pos 832 448)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbc848")
-            (pos 704 448)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbca08")
-            (pos 576 448)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbcbc8")
-            (pos 448 448)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbcd88")
-            (pos 1472 -64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x9fbcf48")
-            (pos 1344 -64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x9fd94b8")
-            (pos 1216 -64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0x9fd9560")
-            (pos 1088 -64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0xa10da28")
-            (pos 960 -64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0xa119bf0")
-            (pos 832 -64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0xa125d98")
-            (pos 704 -64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0xa131f20")
-            (pos 576 -64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0xa13e120")
-            (pos 448 -64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0xa14a2c0")
-            (pos 1600 -64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0xa1564c0")
-            (pos 1600 448)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa162660")
-            (pos 1728 320)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle -1.57174)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa16e860")
-            (pos 1728 192)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle -1.57174)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa17aa00")
-            (pos 1728 64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle -1.57174)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa186c00")
-            (pos 320 64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle -1.57174)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0xa192da0")
-            (pos 320 192)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle -1.57174)
-            (hflip #f)
-            (vflip #t))
-          (decal
-            (id "0xa19efa0")
-            (pos 320 320)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle -1.57174)
-            (hflip #f)
-            (vflip #t)))
-        (child-layers))
-      (layer
-        (name "Objects")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa1b72e8")
-            (pos 784 293)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbe288")
-            (pos 992 258)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa1b77e0")
-            (pos 1109 258)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbd0f8")
-            (pos 639 297)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa1b7d40")
-            (pos 646 257)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_door.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa1b8100")
-            (pos 494 297)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa1b83a0")
-            (pos 502 257)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_door.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa1b7b28")
-            (pos 862 256)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_door2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbb6d8")
-            (pos 718 256)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_door2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbb770")
-            (pos 574 256)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_door2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa1bed98")
-            (pos 430 256)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_door2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa1bef38")
-            (pos 1297 174)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/city_housewall.png")
-            (type 0)
-            (scale 0.157431 0.18585)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa030f78")
-            (pos 1293 251)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/sink.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa02f2f8")
-            (pos 840 257)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/toilet_door_open2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Shadow")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa02f1a8")
-            (pos 995 293)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.340821 0.423828)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa02ee28")
-            (pos 1112 298)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.340821 0.423828)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa030788")
-            (pos 1302 280)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.35547 0.301758)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa030878")
-            (pos 806 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.824219 0.682617)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa030a60")
-            (pos 588 385)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.824219 0.682617)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa2cf7d0")
-            (pos 387 348)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.570312 1.12109)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa030540")
-            (pos 361 -38)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1.09277 0.549805)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa030678")
-            (pos 1679 -45)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1.09277 0.549805)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa2cfdc0")
-            (pos 1770 420)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1.09277 0.549805)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa2cfc60")
-            (pos 1667 162)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.25293 0.97461)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa2cf8b0")
-            (pos 1150 396)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 2.00098 0.256836)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa2cf9c0")
-            (pos 1329 325)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.296876 0.604492)
-            (angle -0.443416)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa0300c8")
-            (pos 1134 413)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.423829 0.848633)
-            (angle -0.184662)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa030288")
-            (pos 1001 414)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.340821 0.863281)
-            (angle 0.0135104)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa02fc10")
-            (pos 836 235)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.501953 0.609375)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Background")
-        (visible #t)
-        (locked #f)
-        (objects
-          (decal
-            (id "0xa2d0190")
-            (pos 448 320)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa2d08e0")
-            (pos 448 64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa301a40")
-            (pos 448 192)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa2d0f80")
-            (pos 576 320)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa301b68")
-            (pos 576 64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa311cc0")
-            (pos 576 192)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa321ed0")
-            (pos 704 192)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa342110")
-            (pos 704 64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3524b8")
-            (pos 704 320)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3523c0")
-            (pos 832 320)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3625e8")
-            (pos 832 64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3727d8")
-            (pos 832 192)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3829a0")
-            (pos 960 320)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3a2bd8")
-            (pos 960 64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3b2de8")
-            (pos 960 192)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3b2ee8")
-            (pos 1088 192)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3c3098")
-            (pos 1088 64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3d3218")
-            (pos 1088 320)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa3e35c0")
-            (pos 1472 64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa4037e8")
-            (pos 1345 192)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa4138a8")
-            (pos 1344 64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa423bf8")
-            (pos 1344 320)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa433db8")
-            (pos 1216 192)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa413998")
-            (pos 1216 64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa443ee8")
-            (pos 1216 320)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa454290")
-            (pos 1600 192)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa4744b8")
-            (pos 1600 64)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa484578")
-            (pos 1600 320)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/walltiles.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "New Layer")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa02fe58")
-            (pos 1472 256)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/door.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa02ff00")
-            (pos 1398 267)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.243164 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0x9fbb240")
-            (pos 1589 266)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.370117 1.00977)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa4846d8")
-            (pos 1448 124)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 0.213867 0.560547)
-            (angle 1.45326)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa2d0cb0")
-            (pos 962 6)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 0.862746 0.219799)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers)))))
+  (navigation
+    (nodes)
+    (edges))
+  (layers
+    (layer
+      (name "Scene")
+      (visible #t)
+      (locked #t)
+      (objects))
+    (layer
+      (name "Light")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xeb0a730")
+          (pos 1292 294)
+          (parent "")
+          (select-mask 1)
+          (path "images/streetlamp-light.png")
+          (type 1)
+          (scale 0.843122 2.78601)
+          (angle 4.53577)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb09b78")
+          (pos 949 238)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_light.png")
+          (type 1)
+          (scale 1.36387 1.52344)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb0bbc8")
+          (pos 958 5)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_highlight.png")
+          (type 2)
+          (scale 1.74257 1.58333)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Character")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xeb09f00")
+          (pos 1581 269)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/humanreference.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Ground")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xeb0b868")
+          (pos 1683 -53)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 0.792 0.76)
+          (angle -2.32532)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb07be8")
+          (pos 1716 400)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 0.792 0.76)
+          (angle -0.809692)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb07d00")
+          (pos 335 405)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 0.792 0.76)
+          (angle -2.32532)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xeb23400")
+          (pos 366 -49)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 0.792 0.76)
+          (angle -0.809692)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xeb083d8")
+          (pos 1472 448)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb08598")
+          (pos 1344 448)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb08758")
+          (pos 1216 448)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb08918")
+          (pos 1088 448)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb08ad8")
+          (pos 960 448)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb08c98")
+          (pos 832 448)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb08e58")
+          (pos 704 448)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb09018")
+          (pos 576 448)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb091d8")
+          (pos 448 448)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb09398")
+          (pos 1472 -64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xeb09558")
+          (pos 1344 -64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xeb09718")
+          (pos 1216 -64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xeb09a30")
+          (pos 1088 -64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xeb23238")
+          (pos 960 -64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xec2b810")
+          (pos 832 -64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xec379e0")
+          (pos 704 -64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xec43b88")
+          (pos 576 -64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xec4fd58")
+          (pos 448 -64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xec5bef8")
+          (pos 1600 -64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xec680f8")
+          (pos 1600 448)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xec74298")
+          (pos 1728 320)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle -1.57174)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xec80498")
+          (pos 1728 192)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle -1.57174)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xec8c638")
+          (pos 1728 64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle -1.57174)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xec98838")
+          (pos 320 64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle -1.57174)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xeca49d8")
+          (pos 320 192)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle -1.57174)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xecb0bd8")
+          (pos 320 320)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle -1.57174)
+          (hflip #f)
+          (vflip #t))))
+    (layer
+      (name "Objects")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xecc8f20")
+          (pos 784 293)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb0b9b0")
+          (pos 992 258)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb0adb8")
+          (pos 1109 258)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xecc93e0")
+          (pos 639 297)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb098e0")
+          (pos 646 257)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xecc9d90")
+          (pos 494 297)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xecc9b58")
+          (pos 502 257)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xecca138")
+          (pos 862 256)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_door2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xecc9e90")
+          (pos 718 256)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_door2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xecc9948")
+          (pos 574 256)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_door2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xecce238")
+          (pos 430 256)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_door2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xecce418")
+          (pos 1297 174)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/city_housewall.png")
+          (type 0)
+          (scale 0.157431 0.18585)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xecd0730")
+          (pos 1293 251)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/sink.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xecd0988")
+          (pos 840 257)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/toilet_door_open2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Shadow")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xeb08078")
+          (pos 995 293)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.340821 0.423828)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xecbcdb8")
+          (pos 1112 298)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.340821 0.423828)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb08208")
+          (pos 1302 280)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.35547 0.301758)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xecd1028")
+          (pos 806 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.824219 0.682617)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb225f0")
+          (pos 588 385)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.824219 0.682617)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xecd11a0")
+          (pos 387 348)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.570312 1.12109)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb23050")
+          (pos 361 -38)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.09277 0.549805)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb226d0")
+          (pos 1679 -45)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.09277 0.549805)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb22930")
+          (pos 1770 420)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.09277 0.549805)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb22a58")
+          (pos 1667 162)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.25293 0.97461)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb22cd0")
+          (pos 1150 396)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 2.00098 0.256836)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb22e30")
+          (pos 1329 325)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.296876 0.604492)
+          (angle -0.443416)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xecd0a80")
+          (pos 1134 413)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.423829 0.848633)
+          (angle -0.184662)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xecd0bb8")
+          (pos 1001 414)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.340821 0.863281)
+          (angle 0.0135104)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb21f50")
+          (pos 836 235)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.501953 0.609375)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Background")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xeb220b0")
+          (pos 448 320)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb22238")
+          (pos 448 64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xed98c00")
+          (pos 448 192)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeda8f10")
+          (pos 576 320)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xed888d0")
+          (pos 576 64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xedb9120")
+          (pos 576 192)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xedd91c8")
+          (pos 704 192)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xede9510")
+          (pos 704 64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xedf96f8")
+          (pos 704 320)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xee098d0")
+          (pos 832 320)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xede9430")
+          (pos 832 64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xee19a00")
+          (pos 832 192)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xee29c00")
+          (pos 960 320)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xee49ed8")
+          (pos 960 64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xee5a1e0")
+          (pos 960 192)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xee6a448")
+          (pos 1088 192)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xee7a5a0")
+          (pos 1088 64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xee5a090")
+          (pos 1088 320)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xee8a7b8")
+          (pos 1472 64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeeaab50")
+          (pos 1345 192)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xee9aa38")
+          (pos 1344 64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeecad88")
+          (pos 1344 320)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeedafa8")
+          (pos 1216 192)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xee9a8d0")
+          (pos 1216 64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeeeb248")
+          (pos 1216 320)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeefb480")
+          (pos 1600 192)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xef1b7b0")
+          (pos 1600 64)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xef1b868")
+          (pos 1600 320)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/walltiles.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "New Layer")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xed88658")
+          (pos 1472 256)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb0ad30")
+          (pos 1398 267)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.243164 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb0aef0")
+          (pos 1589 266)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.370117 1.00977)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb0b6d0")
+          (pos 1448 124)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.213867 0.560547)
+          (angle 1.45326)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xed88700")
+          (pos 962 6)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 0.862746 0.219799)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/train.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/train.wst	2009-04-10 05:01:04 UTC (rev 2911)
+++ trunk/windstille/data/sectors/trainstation/train.wst	2009-04-10 05:02:11 UTC (rev 2912)
@@ -5,92 +5,113 @@
   (name "")
   (ambient-color 0 0 0 1)
   (init-script "init.nut")
-  (layer
-    (name "New Layer")
-    (visible 1)
-    (locked 0)
-    (objects
-      (decal
-        (id "0x9143ee8")
-        (pos -752 0)
-        (parent "0x9f4d030")
-        (select-mask 1)
-        (path "images/decal/train_front.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9128f30")
-        (pos 696 0)
-        (parent "0x9f4d030")
-        (select-mask 1)
-        (path "images/decal/train_back.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9f4d030")
-        (pos 974.233 -296.814)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/train_middle.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x90627b0")
-        (pos -153.68 -216)
-        (parent "0x9f4d030")
-        (select-mask 1)
-        (path "images/decal/train_generator.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x91299b8")
-        (pos -593.074 240.832)
-        (parent "0x9f4d030")
-        (select-mask 1)
-        (path "images/decal/train_engine_front.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x97e9ea0")
-        (pos 586.93 241.832)
-        (parent "0x9f4d030")
-        (select-mask 1)
-        (path "images/decal/train_engine_back.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x96e3850")
-        (pos -213.07 240.832)
-        (parent "0x9f4d030")
-        (select-mask 1)
-        (path "images/decal/train_engine_middle.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9158d78")
-        (pos 242.93 240.832)
-        (parent "0x9f4d030")
-        (select-mask 1)
-        (path "images/decal/train_engine_middle.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0))
-      (decal
-        (id "0x9b9dfe0")
-        (pos 1.44153 -15.168)
-        (parent "0x9f4d030")
-        (select-mask 1)
-        (path "images/decal/train_door.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)))
-    (child-layers)))
+  (navigation
+    (nodes)
+    (edges))
+  (layers
+    (layer
+      (name "New Layer")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xeb14c70")
+          (pos -752 0)
+          (parent "0x105b4db0")
+          (select-mask 1)
+          (path "images/decal/train_front.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb15250")
+          (pos 696 0)
+          (parent "0x105b4db0")
+          (select-mask 1)
+          (path "images/decal/train_back.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x105b4db0")
+          (pos 974.233 -296.814)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/train_middle.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1062d128")
+          (pos -153.68 -216)
+          (parent "0x105b4db0")
+          (select-mask 1)
+          (path "images/decal/train_generator.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf05f760")
+          (pos -593.074 240.832)
+          (parent "0x105b4db0")
+          (select-mask 1)
+          (path "images/decal/train_engine_front.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xe9d7370")
+          (pos 586.93 241.832)
+          (parent "0x105b4db0")
+          (select-mask 1)
+          (path "images/decal/train_engine_back.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb21e08")
+          (pos -213.07 240.832)
+          (parent "0x105b4db0")
+          (select-mask 1)
+          (path "images/decal/train_engine_middle.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xeb0a580")
+          (pos 242.93 240.832)
+          (parent "0x105b4db0")
+          (select-mask 1)
+          (path "images/decal/train_engine_middle.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf01b1a8")
+          (pos 1.44153 -15.168)
+          (parent "0x105b4db0")
+          (select-mask 1)
+          (path "images/decal/train_door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/trainstation.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/trainstation.wst	2009-04-10 05:01:04 UTC (rev 2911)
+++ trunk/windstille/data/sectors/trainstation/trainstation.wst	2009-04-10 05:02:11 UTC (rev 2912)
@@ -74,3337 +74,3318 @@
         (node1 10)
         (node2 4)
         (properties 0))))
-  (layer
-    (name "Trainstation")
-    (visible #t)
-    (locked #t)
-    (objects)
-    (child-layers
-      (layer
-        (name "Daylight")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa6bb478")
-            (pos -855.442 319.354)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa6baa38")
-            (pos -1297.52 365.776)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa6bbd00")
-            (pos -1402.7 340.058)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa6bc510")
-            (pos -1099.97 336.543)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa6bc6d8")
-            (pos -1569.48 329.078)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Lights")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa6bc128")
-            (pos 1630.08 1070.32)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa6bc270")
-            (pos 983.756 904.953)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa707f78")
-            (pos 315.072 868.593)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa708380")
-            (pos -1636 909.933)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa708538")
-            (pos -810.844 849.183)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa708080")
-            (pos 1559.83 804.374)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa708190")
-            (pos -259.112 903.761)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa708ac0")
-            (pos -477.046 760.753)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa708ca8")
-            (pos -1553.29 729.292)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa708698")
-            (pos -1169.49 799.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers
-          (layer
-            (name "ExtraLight")
-            (visible #t)
-            (locked #t)
-            (objects
-              (decal
-                (id "0xa6ba168")
-                (pos -402.054 1017.24)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/light.png")
-                (type 1)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa6ba230")
-                (pos 161.91 1097.81)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/light.png")
-                (type 1)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa6ba370")
-                (pos 860.719 704.086)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/light.png")
-                (type 1)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa6b9d90")
-                (pos 208.559 708.054)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/light.png")
-                (type 1)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa6b9e88")
-                (pos -845.605 1035.11)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/light.png")
-                (type 1)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa6b97c8")
-                (pos -332.91 1098.59)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/light.png")
-                (type 1)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa6b99d0")
-                (pos -1151.04 1059.27)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/light.png")
-                (type 1)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa6b9c28")
-                (pos -1663.74 995.791)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/light.png")
-                (type 1)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa6b89a8")
-                (pos 943.16 1149.08)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/light.png")
-                (type 1)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f)))
-            (child-layers))))
-      (layer
-        (name "Train2")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa707e68")
-            (pos -752 0)
-            (parent "0xa6b8b10")
-            (select-mask 1)
-            (path "images/decal/train_front.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa708778")
-            (pos 696 0)
-            (parent "0xa6b8b10")
-            (select-mask 1)
-            (path "images/decal/train_back.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa6b8b10")
-            (pos -2098.65 942.97)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/train_middle.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa6b8d40")
-            (pos -586.991 241.125)
-            (parent "0xa6b8b10")
-            (select-mask 1)
-            (path "images/decal/train_engine_front.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa6b9178")
-            (pos 593.009 242.125)
-            (parent "0xa6b8b10")
-            (select-mask 1)
-            (path "images/decal/train_engine_back.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa706718")
-            (pos -206.991 241.125)
-            (parent "0xa6b8b10")
-            (select-mask 1)
-            (path "images/decal/train_engine_middle.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa705f50")
-            (pos 249.009 241.125)
-            (parent "0xa6b8b10")
-            (select-mask 1)
-            (path "images/decal/train_engine_middle.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa705af8")
-            (pos 0.719482 -14.875)
-            (parent "0xa6b8b10")
-            (select-mask 1)
-            (path "images/decal/train_door.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Shadow")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa706018")
-            (pos -2249.87 1060.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa706f08")
-            (pos -2244.5 972.452)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa7070a0")
-            (pos -2151.95 1070.86)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa7071c8")
-            (pos -2223.31 378.014)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa707440")
-            (pos -2222.56 441.264)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa707820")
-            (pos -2231.18 652.952)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa707668")
-            (pos -2231.93 589.702)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa7069a0")
-            (pos -2223.79 825.967)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa706910")
-            (pos -2016.48 1029.67)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa988648")
-            (pos -2047.33 560.924)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa989218")
-            (pos -2080.6 782.737)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Roof")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa988318")
-            (pos -132.297 329.766)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/roof2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa988f40")
-            (pos 378.703 329.766)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/roof2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70b0e8")
-            (pos 1400.7 331.719)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/roof2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70b250")
-            (pos 889.703 331.719)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/roof2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70cc18")
-            (pos 2422.7 331.719)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/roof2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70c950")
-            (pos 1911.7 331.719)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/roof2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70af88")
-            (pos -1652.53 298.683)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/roof2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70cd10")
-            (pos -771.438 410.719)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/roof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70c6a0")
-            (pos -1141.53 298.683)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/roof2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70cdf0")
-            (pos -2163.53 298.683)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/roof2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70d290")
-            (pos -2674.53 298.683)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/roof2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Lamps")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa70cee8")
-            (pos 266.7 554.465)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/apartmentlamp_light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70c1b8")
-            (pos 999.122 579.855)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/apartmentlamp_light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70a490")
-            (pos 1651.47 577.902)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/apartmentlamp_light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70c240")
-            (pos 1660.56 541.188)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70a188")
-            (pos 998.057 533.375)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70a338")
-            (pos 237.12 549)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp_bloom.png")
-            (type 2)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70a918")
-            (pos 1642.66 434.301)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa709f58")
-            (pos 982.958 428.895)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa70acf0")
-            (pos 231.267 426.715)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rooflamp.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Decor Items")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xa70a7c0")
-            (pos 240.218 886.438)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/board.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xaa41800")
-            (pos 934.407 913.438)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/terminal.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa709040")
-            (pos -163.625 985.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bench.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xab69b88")
-            (pos 578.562 985.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bench.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xab69a28")
-            (pos 1244.19 985.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bench.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xaa415c8")
-            (pos 1689.49 985.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bench.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xaa41538")
-            (pos 2006.69 985.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/bench.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa709660")
-            (pos 424.131 1013.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/plant.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xaaafb40")
-            (pos -1002.18 1013.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/plant.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa709730")
-            (pos -914.086 1013.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/plant.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa7098a8")
-            (pos -832.618 1013.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/plant.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xaaafc50")
-            (pos 1064.43 1014.67)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/plant.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa709d30")
-            (pos 676.954 1029.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/box.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xaca7748")
-            (pos 612.954 1029.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/box.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa709a38")
-            (pos 648.954 965.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/box.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xac60ff8")
-            (pos 740.954 1029.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/box.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xacb0a88")
-            (pos 584.954 965.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/box.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xacb0b70")
-            (pos 548.954 1029.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/box.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xacb6f38")
-            (pos 706.554 965.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/box.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xacb3c60")
-            (pos 28.218 973.438)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/trashcan.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xacc0368")
-            (pos 1448.12 973.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/trashcan.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Railground")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xace3ac8")
-            (pos -249.032 1380.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98d9f0")
-            (pos -761.032 1380.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xacf7980")
-            (pos -2297.03 1380.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98db38")
-            (pos -1785.03 1380.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98d720")
-            (pos -1273.03 1380.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xacf7ab0")
-            (pos 262.968 1380.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xacf7bf8")
-            (pos 774.968 1380.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xae37df0")
-            (pos 1798.97 1380.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xae384a0")
-            (pos 1286.97 1380.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xae37f38")
-            (pos 1670.97 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xae380d8")
-            (pos 1926.97 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xae381d0")
-            (pos 1414.97 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98caf8")
-            (pos 1158.97 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98c158")
-            (pos 2214.14 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98c658")
-            (pos 1702.14 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98c7a8")
-            (pos 1958.14 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98c960")
-            (pos 1446.14 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98d5d0")
-            (pos -121.032 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98be50")
-            (pos -377.032 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98bfd8")
-            (pos 646.968 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb04e998")
-            (pos 902.968 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb038f78")
-            (pos 390.968 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb04e658")
-            (pos 134.968 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb04e738")
-            (pos 1190.13 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb079a08")
-            (pos 934.13 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb079ac8")
-            (pos 422.13 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb079c48")
-            (pos 166.13 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb0ba660")
-            (pos 678.13 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb0ba7e0")
-            (pos -89.87 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98d2b8")
-            (pos -889.032 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98d470")
-            (pos -633.032 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb0e5688")
-            (pos -345.87 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb0e5808")
-            (pos -601.87 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb1102c8")
-            (pos -1369.87 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb1103a8")
-            (pos -1881.87 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb165a80")
-            (pos -1625.87 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb165b50")
-            (pos -1113.87 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb165cd8")
-            (pos -857.872 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb1a5f10")
-            (pos -1145.03 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb1a60a0")
-            (pos -1657.03 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb1d0b58")
-            (pos -1401.03 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb1d0c38")
-            (pos -1913.03 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb1fb708")
-            (pos -2169.03 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb1fb7c8")
-            (pos -3193.03 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb1fb948")
-            (pos -2937.03 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb23bf98")
-            (pos -2681.03 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb23c118")
-            (pos -2649.87 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb2673e8")
-            (pos -2905.87 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb2674c8")
-            (pos -2809.03 1380.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb292790")
-            (pos -3321.03 1380.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb292840")
-            (pos -2393.87 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb2929e8")
-            (pos -2137.87 1187.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/rail.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98d1c8")
-            (pos -2425.03 1273.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stone.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Endwall")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xb2d3240")
-            (pos -1539 508)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/elevatordoor_left.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb2d3290")
-            (pos -1539 380)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/elevatordoor_left.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa707dd8")
-            (pos -1539 1020)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/elevatordoor_left.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa708e08")
-            (pos -1539 892)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/elevatordoor_left.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98cf78")
-            (pos -1539 636)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/elevatordoor_left.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xa98cdd0")
-            (pos -1539 764)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/elevatordoor_left.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb2e8f30")
-            (pos -1539 1148)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/elevatordoor_left.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb2e9078")
-            (pos -1741 1084)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb2e97f0")
-            (pos -2111 1084)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb2e8978")
-            (pos -2111 824)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb2e93d8")
-            (pos -1741 824)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb2e95c8")
-            (pos -2111 568)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb534840")
-            (pos -1741 568)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb5348d8")
-            (pos -2109 312)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb534560")
-            (pos -1739 312)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/steelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb3c2360")
-            (pos -1763.88 1198.81)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb534688")
-            (pos -2080.29 1241.78)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb3c2070")
-            (pos -2400.6 1212.48)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb3c2150")
-            (pos -2239 276)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb64a738")
-            (pos -1976 368)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb64a348")
-            (pos -1717 263)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Ground")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xac3e6c8")
-            (pos 1836.13 1103.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb64a568")
-            (pos 2144.13 1103.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb3c18d0")
-            (pos -1551.87 1103.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb3c19c0")
-            (pos -1243.87 1103.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb3c1ad0")
-            (pos -935.87 1103.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb7503e8")
-            (pos -627.87 1103.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb703d08")
-            (pos -319.87 1103.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb750510")
-            (pos -11.87 1103.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb7506d8")
-            (pos 296.13 1103.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb7043f0")
-            (pos 604.13 1103.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb7045a8")
-            (pos 912.13 1103.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb79c5c0")
-            (pos 1220.13 1103.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xb79c708")
-            (pos 1528.13 1103.44)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/ground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Stairs")
-        (visible #t)
-        (locked #t)
-        (objects)
-        (child-layers
-          (layer
-            (name "Shadow")
-            (visible #t)
-            (locked #t)
-            (objects
-              (decal
-                (id "0xb704248")
-                (pos -1672.24 1055.45)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/dark.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb7b5ed8")
-                (pos -1529 861)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/dark.png")
-                (type 0)
-                (scale 0.833984 1.60059)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb834968")
-                (pos -1557 564)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/dark.png")
-                (type 0)
-                (scale 0.750977 1.16602)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb834ce8")
-                (pos -1484.44 1141.69)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/dark.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb7b5fe0")
-                (pos -937.569 1133.87)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/dark.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f)))
-            (child-layers))
-          (layer
-            (name "StairHandle")
-            (visible #t)
-            (locked #f)
-            (objects
-              (decal
-                (id "0xa989728")
-                (pos -964 844)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/handrail.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa98a078")
-                (pos -1058 746)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/handrail.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa989e48")
-                (pos -1155 652)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/handrail.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa989f88")
-                (pos -1250 547)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/handrail.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa98a678")
-                (pos -1347 456)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/handrail.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa98a418")
-                (pos -1440 363)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/handrail.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa98a520")
-                (pos -863 930)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/handrail.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa98a840")
-                (pos -1537 273)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/handrail.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa98aa00")
-                (pos -841 864)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_handle.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa98b878")
-                (pos -969 736)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_handle.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa98ade0")
-                (pos -1097 608)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_handle.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa98b908")
-                (pos -1225 480)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_handle.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa98ba38")
-                (pos -1353 352)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_handle.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f)))
-            (child-layers))
-          (layer
-            (name "Stairs")
-            (visible #t)
-            (locked #t)
-            (objects
-              (decal
-                (id "0xa98b4f8")
-                (pos -1040 739)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/shadow.png")
-                (type 0)
-                (scale 9.94316 1.38132)
-                (angle -2.42953)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb91a388")
-                (pos -1358 869)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_base.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb92a900")
-                (pos -849 997)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_stairs.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb94ad80")
-                (pos -974 997)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_base.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb95b060")
-                (pos -974 869)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_stairs.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb97b108")
-                (pos -1102 997)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_base.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb98b450")
-                (pos -1102 869)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_base.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb91a7b0")
-                (pos -1102 741)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_stairs.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb99b600")
-                (pos -1230 613)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_stairs.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb9ab758")
-                (pos -1358 613)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_base.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb9cbae0")
-                (pos -1358 485)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_stairs.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb9dbc38")
-                (pos -1486 613)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_base.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb98b370")
-                (pos -1486 485)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_base.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb9ebd68")
-                (pos -1486 357)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_stairs.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb9fbfd8")
-                (pos -1358 741)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_base.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb9fc0a0")
-                (pos -1486 741)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_base.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xba2c3f8")
-                (pos -1230 741)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_base.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xba3c710")
-                (pos -1486 869)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_base.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xba1c270")
-                (pos -1230 869)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_base.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xba4c890")
-                (pos -1358 997)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_base.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xba4c970")
-                (pos -1486 997)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_base.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xba7ce28")
-                (pos -1230 997)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/stair_base.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xba8d0a0")
-                (pos -1347 917)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/door.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f)))
-            (child-layers))
-          (layer
-            (name "StairWall")
-            (visible #t)
-            (locked #t)
-            (objects
-              (decal
-                (id "0xb906ea8")
-                (pos -658.251 306.508)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbaad898")
-                (pos -658.251 434.508)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xb91a690")
-                (pos -656.688 690.508)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbb1fc38")
-                (pos -656.688 562.508)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa98b0a0")
-                (pos -1425 307)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbb68208")
-                (pos -656.462 935.117)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/tunnelplate_bottom.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xa98b1a8")
-                (pos -656.688 818.508)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbb4fdf0")
-                (pos -657 946)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbb4ff40")
-                (pos -657 1074)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbb1f928")
-                (pos -1424.46 563.117)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbb98408")
-                (pos -1424.46 691.117)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbbb0e28")
-                (pos -1424.46 435.117)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbb984d0")
-                (pos -1424.46 819.117)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbbb0750")
-                (pos -1168.46 819.117)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbcf5300")
-                (pos -1168.46 435.117)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbbb0cf8")
-                (pos -1168.46 691.117)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbcf53f8")
-                (pos -1168.46 563.117)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbd0d738")
-                (pos -1169 307)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbd3d908")
-                (pos -912.462 307.117)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbd3da58")
-                (pos -912.462 563.117)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbd6dc60")
-                (pos -912.462 691.117)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbd6dd80")
-                (pos -912.462 435.117)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbd9e178")
-                (pos -912.462 819.117)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbd9df60")
-                (pos -1169 947)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbdce488")
-                (pos -913 946)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f))
-              (decal
-                (id "0xbdce310")
-                (pos -913 1074)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/wallplate.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0)
-                (hflip #f)
-                (vflip #f)))
-            (child-layers))))
-      (layer
-        (name "WallShadow")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xbdfe930")
-            (pos -498.687 804.29)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xbaad390")
-            (pos -418.187 492.016)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Train")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xb906de8")
-            (pos -752 0)
-            (parent "0xbe2eb08")
-            (select-mask 1)
-            (path "images/decal/train_front.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xbdfe690")
-            (pos 696 0)
-            (parent "0xbe2eb08")
-            (select-mask 1)
-            (path "images/decal/train_back.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xbe2eb08")
-            (pos 1705.54 939.785)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/train_middle.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xbe2eb88")
-            (pos -586.991 241.125)
-            (parent "0xbe2eb08")
-            (select-mask 1)
-            (path "images/decal/train_engine_front.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xbbb0a18")
-            (pos 593.009 242.125)
-            (parent "0xbe2eb08")
-            (select-mask 1)
-            (path "images/decal/train_engine_back.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xbcacfd8")
-            (pos -206.991 241.125)
-            (parent "0xbe2eb08")
-            (select-mask 1)
-            (path "images/decal/train_engine_middle.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xbcad060")
-            (pos 249.009 241.125)
-            (parent "0xbe2eb08")
-            (select-mask 1)
-            (path "images/decal/train_engine_middle.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xbe47ba0")
-            (pos 0.719482 -14.875)
-            (parent "0xbe2eb08")
-            (select-mask 1)
-            (path "images/decal/train_door.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers))
-      (layer
-        (name "Tunnel Wall")
-        (visible #t)
-        (locked #t)
-        (objects
-          (decal
-            (id "0xbec0590")
-            (pos 1790.43 900.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_bottom.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xbec0b90")
-            (pos 2046.43 900.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_bottom.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc013b08")
-            (pos 1278.43 900.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_bottom.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc013d08")
-            (pos 1534.43 900.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_bottom.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xbec06c0")
-            (pos 1022.43 900.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_bottom.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xbec07e0")
-            (pos 2165.35 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xbfb9250")
-            (pos 2101.35 464.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc121ef8")
-            (pos 2037.34 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc19c628")
-            (pos 1781.34 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc1dcac8")
-            (pos 1845.35 464.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc19c350")
-            (pos 1909.34 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc19c488")
-            (pos 1397.34 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xbfb9838")
-            (pos 1333.35 464.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xbfb9550")
-            (pos 1269.34 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc23ce00")
-            (pos 1525.34 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xbfb9620")
-            (pos 1589.35 464.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc2ed450")
-            (pos 1653.34 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc23ccf8")
-            (pos 629.352 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc2fd5d8")
-            (pos 565.354 464.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc2fd858")
-            (pos 501.352 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc2fd7d8")
-            (pos 245.352 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc3ade48")
-            (pos 309.354 464.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc3adef0")
-            (pos 373.352 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc35dcf0")
-            (pos 885.352 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc3be020")
-            (pos 821.354 464.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc3be0f0")
-            (pos 757.352 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc40e4a0")
-            (pos 1013.35 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc41e668")
-            (pos 1077.35 464.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc46eab8")
-            (pos 1141.34 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc46eba8")
-            (pos -394.638 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc41e810")
-            (pos -138.648 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc47ecc8")
-            (pos -202.646 464.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc47ee40")
-            (pos -266.648 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc4df108")
-            (pos -10.6475 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc4ef2a0")
-            (pos 53.3544 464.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc4ef370")
-            (pos 117.352 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc53f720")
-            (pos 766.427 900.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_bottom.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc54f8e8")
-            (pos 510.427 900.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_bottom.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc54fba0")
-            (pos 254.427 900.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_bottom.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc59fd50")
-            (pos -458.636 464.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc54faf8")
-            (pos -522.638 656.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_small.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc6544a8")
-            (pos -1.57263 900.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_bottom.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc6540f8")
-            (pos -257.573 900.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_bottom.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f))
-          (decal
-            (id "0xc654320")
-            (pos -513.573 900.717)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/tunnelplate_bottom.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)
-            (hflip #f)
-            (vflip #f)))
-        (child-layers)))))
+  (layers
+    (layer
+      (name "Trainstation")
+      (visible #t)
+      (locked #t)
+      (objects))
+    (layer
+      (name "Daylight")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xf021d40")
+          (pos -855.442 319.354)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf022a18")
+          (pos -1297.52 365.776)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf022b00")
+          (pos -1402.7 340.058)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf021450")
+          (pos -1099.97 336.543)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf021070")
+          (pos -1569.48 329.078)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Lights")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xf021f00")
+          (pos 1630.08 1070.32)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf022010")
+          (pos 983.756 904.953)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06c390")
+          (pos 315.072 868.593)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf0222e8")
+          (pos -1636 909.933)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06be70")
+          (pos -810.844 849.183)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06bf90")
+          (pos 1559.83 804.374)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06c178")
+          (pos -259.112 903.761)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06b5c8")
+          (pos -477.046 760.753)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06b798")
+          (pos -1553.29 729.292)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06b990")
+          (pos -1169.49 799.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "ExtraLight")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xf06bbe0")
+          (pos -402.054 1017.24)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf069d78")
+          (pos 161.91 1097.81)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf069e40")
+          (pos 860.719 704.086)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06a5d0")
+          (pos 208.559 708.054)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06a7b8")
+          (pos -845.605 1035.11)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06a9c0")
+          (pos -332.91 1098.59)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06ab98")
+          (pos -1151.04 1059.27)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06acb0")
+          (pos -1663.74 995.791)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06ae18")
+          (pos 943.16 1149.08)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Train2")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xf06bb40")
+          (pos -752 0)
+          (parent "0xf06dbf8")
+          (select-mask 1)
+          (path "images/decal/train_front.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06a4e8")
+          (pos 696 0)
+          (parent "0xf06dbf8")
+          (select-mask 1)
+          (path "images/decal/train_back.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06dbf8")
+          (pos -2098.65 942.97)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/train_middle.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06d148")
+          (pos -586.991 241.125)
+          (parent "0xf06dbf8")
+          (select-mask 1)
+          (path "images/decal/train_engine_front.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06cd30")
+          (pos 593.009 242.125)
+          (parent "0xf06dbf8")
+          (select-mask 1)
+          (path "images/decal/train_engine_back.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06d7b8")
+          (pos -206.991 241.125)
+          (parent "0xf06dbf8")
+          (select-mask 1)
+          (path "images/decal/train_engine_middle.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06dca0")
+          (pos 249.009 241.125)
+          (parent "0xf06dbf8")
+          (select-mask 1)
+          (path "images/decal/train_engine_middle.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06de28")
+          (pos 0.719482 -14.875)
+          (parent "0xf06dbf8")
+          (select-mask 1)
+          (path "images/decal/train_door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Shadow")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xf06d3d8")
+          (pos -2249.87 1060.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf161908")
+          (pos -2244.5 972.452)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf161ac8")
+          (pos -2151.95 1070.86)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf161550")
+          (pos -2223.31 378.014)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf161738")
+          (pos -2222.56 441.264)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06e530")
+          (pos -2231.18 652.952)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06ea70")
+          (pos -2231.93 589.702)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06ec30")
+          (pos -2223.79 825.967)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06e690")
+          (pos -2016.48 1029.67)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06e878")
+          (pos -2047.33 560.924)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf2c0d88")
+          (pos -2080.6 782.737)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Roof")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xf2c0fb8")
+          (pos -132.297 329.766)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/roof2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf2c01f0")
+          (pos 378.703 329.766)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/roof2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf2c0328")
+          (pos 1400.7 331.719)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/roof2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf2c0928")
+          (pos 889.703 331.719)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/roof2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf2c0b00")
+          (pos 2422.7 331.719)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/roof2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf2c12a8")
+          (pos 1911.7 331.719)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/roof2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf2c2038")
+          (pos -1652.53 298.683)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/roof2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf2c2158")
+          (pos -771.438 410.719)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/roof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf2c1670")
+          (pos -1141.53 298.683)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/roof2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf01ee00")
+          (pos -2163.53 298.683)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/roof2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf0713c8")
+          (pos -2674.53 298.683)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/roof2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Lamps")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xf01f810")
+          (pos 266.7 554.465)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf2c0f38")
+          (pos 999.122 579.855)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf01f330")
+          (pos 1651.47 577.902)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf01ef58")
+          (pos 1660.56 541.188)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf01f030")
+          (pos 998.057 533.375)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf0209d0")
+          (pos 237.12 549)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf020ac0")
+          (pos 1642.66 434.301)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf020bc8")
+          (pos 982.958 428.895)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf020c90")
+          (pos 231.267 426.715)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Decor Items")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xf01fe08")
+          (pos 240.218 886.438)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/board.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34d408")
+          (pos 934.407 913.438)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/terminal.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34d5d8")
+          (pos -163.625 985.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bench.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06fc68")
+          (pos 578.562 985.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bench.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06f170")
+          (pos 1244.19 985.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bench.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06fa78")
+          (pos 1689.49 985.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bench.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06fb98")
+          (pos 2006.69 985.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/bench.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06f718")
+          (pos 424.131 1013.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/plant.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06fe10")
+          (pos -1002.18 1013.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/plant.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf06fec8")
+          (pos -914.086 1013.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/plant.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf0700f0")
+          (pos -832.618 1013.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/plant.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf070530")
+          (pos 1064.43 1014.67)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/plant.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf0701a0")
+          (pos 676.954 1029.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/box.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf0706e0")
+          (pos 612.954 1029.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/box.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf070a58")
+          (pos 648.954 965.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/box.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf070e68")
+          (pos 740.954 1029.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/box.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf070cc8")
+          (pos 584.954 965.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/box.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf553970")
+          (pos 548.954 1029.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/box.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf5569e8")
+          (pos 706.554 965.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/box.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf559af8")
+          (pos 28.218 973.438)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/trashcan.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf559c18")
+          (pos 1448.12 973.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/trashcan.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Railground")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xf34b300")
+          (pos -249.032 1380.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf2c45d0")
+          (pos -761.032 1380.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf2c4470")
+          (pos -2297.03 1380.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf2c4740")
+          (pos -1785.03 1380.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34ca60")
+          (pos -1273.03 1380.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34d118")
+          (pos 262.968 1380.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34d248")
+          (pos 774.968 1380.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34cfc0")
+          (pos 1798.97 1380.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34cc00")
+          (pos 1286.97 1380.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34cd48")
+          (pos 1670.97 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34c5f8")
+          (pos 1926.97 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34c728")
+          (pos 1414.97 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34b7e8")
+          (pos 1158.97 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34c388")
+          (pos 2214.14 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34c220")
+          (pos 1702.14 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34c078")
+          (pos 1958.14 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf82e670")
+          (pos 1446.14 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf82e728")
+          (pos -121.032 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf82e808")
+          (pos -377.032 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf859198")
+          (pos 646.968 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf899160")
+          (pos 902.968 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34b450")
+          (pos 390.968 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34b530")
+          (pos 134.968 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34b680")
+          (pos 1190.13 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf8c4778")
+          (pos 934.13 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf899200")
+          (pos 422.13 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf899478")
+          (pos 166.13 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf899350")
+          (pos 678.13 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf8efb00")
+          (pos -89.87 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf930198")
+          (pos -889.032 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf95ade8")
+          (pos -633.032 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf95af00")
+          (pos -345.87 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf9859c8")
+          (pos -601.87 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf985bc0")
+          (pos -1369.87 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf985ca0")
+          (pos -1881.87 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf9c62f0")
+          (pos -1625.87 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf9f0e00")
+          (pos -1113.87 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf930258")
+          (pos -857.872 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf9303a0")
+          (pos -1145.03 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfa1ba18")
+          (pos -1657.03 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfa1bb78")
+          (pos -1401.03 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfa1bcc8")
+          (pos -1913.03 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfa5baa8")
+          (pos -2169.03 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfa5bc18")
+          (pos -3193.03 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf9f0ee0")
+          (pos -2937.03 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfa86e50")
+          (pos -2681.03 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfab23e0")
+          (pos -2649.87 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfab24a0")
+          (pos -2905.87 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfab25b8")
+          (pos -2809.03 1380.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfadd8f0")
+          (pos -3321.03 1380.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfb1dff8")
+          (pos -2393.87 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfb1ded8")
+          (pos -2137.87 1187.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfb1e148")
+          (pos -2425.03 1273.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Endwall")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xf34bb38")
+          (pos -1539 508)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/elevatordoor_left.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf0228a8")
+          (pos -1539 380)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/elevatordoor_left.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfb339b0")
+          (pos -1539 1020)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/elevatordoor_left.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf55ce50")
+          (pos -1539 892)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/elevatordoor_left.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf55cd58")
+          (pos -1539 636)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/elevatordoor_left.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34be88")
+          (pos -1539 764)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/elevatordoor_left.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfb34010")
+          (pos -1539 1148)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/elevatordoor_left.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf34bdb8")
+          (pos -1741 1084)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfb34270")
+          (pos -2111 1084)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf56e8e8")
+          (pos -2111 824)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfb343b8")
+          (pos -1741 824)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfb34500")
+          (pos -2111 568)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfa86fa0")
+          (pos -1741 568)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfa870d8")
+          (pos -2109 312)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfd7f3d8")
+          (pos -1739 312)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/steelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfd7f4a0")
+          (pos -1763.88 1198.81)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfd7f5d0")
+          (pos -2080.29 1241.78)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfd7f6c8")
+          (pos -2400.6 1212.48)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfe95510")
+          (pos -2239 276)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfe95300")
+          (pos -1976 368)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfe95270")
+          (pos -1717 263)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Ground")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xfc0cb30")
+          (pos 1836.13 1103.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xf01fd30")
+          (pos 2144.13 1103.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfc0c938")
+          (pos -1551.87 1103.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfc0c888")
+          (pos -1243.87 1103.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfc0d1e8")
+          (pos -935.87 1103.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfef2370")
+          (pos -627.87 1103.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfef24a8")
+          (pos -319.87 1103.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfef2b38")
+          (pos -11.87 1103.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xff71928")
+          (pos 296.13 1103.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xff71b98")
+          (pos 604.13 1103.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xff719e0")
+          (pos 912.13 1103.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xff57f48")
+          (pos 1220.13 1103.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xff58128")
+          (pos 1528.13 1103.44)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Stairs")
+      (visible #t)
+      (locked #t)
+      (objects))
+    (layer
+      (name "Shadow")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xfef29d8")
+          (pos -1672.24 1055.45)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xff58258")
+          (pos -1529 861)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.833984 1.60059)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xffd6ed0")
+          (pos -1557 564)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.750977 1.16602)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xffd7040")
+          (pos -1484.44 1141.69)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1003c8d8")
+          (pos -937.569 1133.87)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "StairHandle")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x1003d1c0")
+          (pos -964 844)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1003d7d8")
+          (pos -1058 746)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1003d8b0")
+          (pos -1155 652)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1004b968")
+          (pos -1250 547)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10052800")
+          (pos -1347 456)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x100597a8")
+          (pos -1440 363)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10060750")
+          (pos -863 930)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10067708")
+          (pos -1537 273)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/handrail.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1006e6c0")
+          (pos -841 864)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_handle.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10088b18")
+          (pos -969 736)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_handle.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10088bc0")
+          (pos -1097 608)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_handle.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10088ca8")
+          (pos -1225 480)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_handle.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1009bdf0")
+          (pos -1353 352)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_handle.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Stairs")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x100c21f0")
+          (pos -1040 739)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/shadow.png")
+          (type 0)
+          (scale 9.94316 1.38132)
+          (angle -2.42953)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x100af010")
+          (pos -1358 869)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_base.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x100e8c38")
+          (pos -849 997)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_stairs.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x100f8d80")
+          (pos -974 997)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_base.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x101292a0")
+          (pos -974 869)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_stairs.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10108fb8")
+          (pos -1102 997)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_base.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10139458")
+          (pos -1102 869)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_base.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10139538")
+          (pos -1102 741)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_stairs.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10169898")
+          (pos -1230 613)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_stairs.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10179a90")
+          (pos -1358 613)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_base.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10189cd8")
+          (pos -1358 485)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_stairs.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x101699b0")
+          (pos -1486 613)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_base.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10199ec0")
+          (pos -1486 485)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_base.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x101aa268")
+          (pos -1486 357)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_stairs.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x101ca4a8")
+          (pos -1358 741)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_base.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x101da578")
+          (pos -1486 741)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_base.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x101ea888")
+          (pos -1230 741)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_base.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x101faa60")
+          (pos -1486 869)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_base.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x101ca3b0")
+          (pos -1230 869)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_base.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1020ab90")
+          (pos -1358 997)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_base.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1021af38")
+          (pos -1486 997)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_base.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1023b178")
+          (pos -1230 997)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair_base.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1024b248")
+          (pos -1347 917)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "StairWall")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x1023b058")
+          (pos -658.251 306.508)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x100e8950")
+          (pos -658.251 434.508)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x100e89f0")
+          (pos -656.688 690.508)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1026bad0")
+          (pos -656.688 562.508)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1003d340")
+          (pos -1425 307)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x102d5230")
+          (pos -656.462 935.117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_bottom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x102d52f8")
+          (pos -656.688 818.508)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x102a4fb0")
+          (pos -657 946)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x102d5440")
+          (pos -657 1074)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x102a4c58")
+          (pos -1424.46 563.117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x103e9c98")
+          (pos -1424.46 691.117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x103e9d60")
+          (pos -1424.46 435.117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1041a1d8")
+          (pos -1424.46 819.117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10419ff8")
+          (pos -1168.46 819.117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1044a5a0")
+          (pos -1168.46 435.117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10462650")
+          (pos -1168.46 691.117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1044a3b8")
+          (pos -1168.46 563.117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10462720")
+          (pos -1169 307)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10492a70")
+          (pos -912.462 307.117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x104c2ea8")
+          (pos -912.462 563.117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x104c2cf8")
+          (pos -912.462 691.117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10305570")
+          (pos -912.462 435.117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x104daf38")
+          (pos -912.462 819.117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x104db038")
+          (pos -1169 947)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1050b2a8")
+          (pos -913 946)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1056b8e0")
+          (pos -913 1074)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/wallplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "WallShadow")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x10075678")
+          (pos -498.687 804.29)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xfc0cf50")
+          (pos -418.187 492.016)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Train")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x10075718")
+          (pos -752 0)
+          (parent "0x10583bf8")
+          (select-mask 1)
+          (path "images/decal/train_front.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1056ba18")
+          (pos 696 0)
+          (parent "0x10583bf8")
+          (select-mask 1)
+          (path "images/decal/train_back.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10583bf8")
+          (pos 1705.54 939.785)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/train_middle.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1031d870")
+          (pos -586.991 241.125)
+          (parent "0x10583bf8")
+          (select-mask 1)
+          (path "images/decal/train_engine_front.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1031da10")
+          (pos 593.009 242.125)
+          (parent "0x10583bf8")
+          (select-mask 1)
+          (path "images/decal/train_engine_back.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x105b4720")
+          (pos -206.991 241.125)
+          (parent "0x10583bf8")
+          (select-mask 1)
+          (path "images/decal/train_engine_middle.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1053b658")
+          (pos 249.009 241.125)
+          (parent "0x10583bf8")
+          (select-mask 1)
+          (path "images/decal/train_engine_middle.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x105b4cc0")
+          (pos 0.719482 -14.875)
+          (parent "0x10583bf8")
+          (select-mask 1)
+          (path "images/decal/train_door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Tunnel Wall")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x105b4b68")
+          (pos 1790.43 900.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_bottom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1062ddf8")
+          (pos 2046.43 900.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_bottom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10780d38")
+          (pos 1278.43 900.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_bottom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10780f38")
+          (pos 1534.43 900.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_bottom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1062d8d0")
+          (pos 1022.43 900.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_bottom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x107264d8")
+          (pos 2165.35 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x107265b0")
+          (pos 2101.35 464.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1062dad8")
+          (pos 2037.34 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1088f138")
+          (pos 1781.34 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x109899f0")
+          (pos 1845.35 464.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1088f298")
+          (pos 1909.34 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1088f378")
+          (pos 1397.34 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x109a9c10")
+          (pos 1333.35 464.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x109a9d88")
+          (pos 1269.34 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10a0a528")
+          (pos 1525.34 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x109fa048")
+          (pos 1589.35 464.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10a0a2b8")
+          (pos 1653.34 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10a5a648")
+          (pos 629.352 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10a6a820")
+          (pos 565.354 464.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10abac90")
+          (pos 501.352 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10abada8")
+          (pos 245.352 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10a6a980")
+          (pos 309.354 464.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10acae60")
+          (pos 373.352 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10acafe8")
+          (pos 885.352 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10b2b268")
+          (pos 821.354 464.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10b2b528")
+          (pos 757.352 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10b7b680")
+          (pos 1013.35 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10b8b8b0")
+          (pos 1077.35 464.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10bdbd00")
+          (pos 1141.34 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10bdbdf0")
+          (pos -394.638 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10b8ba58")
+          (pos -138.648 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10bebf10")
+          (pos -202.646 464.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10bec088")
+          (pos -266.648 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10c4c350")
+          (pos -10.6475 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10c5c4e8")
+          (pos 53.3544 464.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10c5c5b8")
+          (pos 117.352 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10cac968")
+          (pos 766.427 900.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_bottom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10cbcb30")
+          (pos 510.427 900.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_bottom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10cbcde8")
+          (pos 254.427 900.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_bottom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10d0cf98")
+          (pos -458.636 464.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10cbcd40")
+          (pos -522.638 656.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_small.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10dc16f0")
+          (pos -1.57263 900.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_bottom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10dc1340")
+          (pos -257.573 900.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_bottom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x10dc1568")
+          (pos -513.573 900.717)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tunnelplate_bottom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/worker.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/worker.wst	2009-04-10 05:01:04 UTC (rev 2911)
+++ trunk/windstille/data/sectors/trainstation/worker.wst	2009-04-10 05:02:11 UTC (rev 2912)
@@ -5,1295 +5,1567 @@
   (name "")
   (ambient-color 0 0 0 1)
   (init-script "init.nut")
-  (layer
-    (name "Scene")
-    (visible 1)
-    (locked 0)
-    (objects
-      (decal
-        (id "0xa752988")
-        (pos 1204.55 268.312)
-        (parent "")
-        (select-mask 1)
-        (path "images/decal/humanreference.png")
-        (type 0)
-        (scale 1 1)
-        (angle 0)))
-    (child-layers
-      (layer
-        (name "Light")
-        (visible 1)
-        (locked 0)
-        (objects
-          (decal
-            (id "0xa755958")
-            (pos 58.9653 321.293)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa755a10")
-            (pos 1347.85 311.818)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa755af0")
-            (pos -518.274 304.576)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa755bd0")
-            (pos 667.297 305.114)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa755cb0")
-            (pos 45.189 -395.95)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa755d90")
-            (pos 653.521 -410.567)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa755e70")
-            (pos -535.175 -411.104)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa755f50")
-            (pos 1334.07 -403.863)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/light.png")
-            (type 1)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers
-          (layer
-            (name "Highlight")
-            (visible 1)
-            (locked 0)
-            (objects
-              (decal
-                (id "0xa756230")
-                (pos -520.276 3.38026)
-                (parent "")
-                (select-mask 1)
-                (path "images/objects/apartmentlamp_highlight.png")
-                (type 2)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa756a98")
-                (pos 657.849 1.81776)
-                (parent "")
-                (select-mask 1)
-                (path "images/objects/apartmentlamp_highlight.png")
-                (type 2)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa750700")
-                (pos 1321.1 -0.557228)
-                (parent "")
-                (select-mask 1)
-                (path "images/objects/apartmentlamp_highlight.png")
-                (type 2)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa752ef8")
-                (pos 36.7242 -0.55722)
-                (parent "")
-                (select-mask 1)
-                (path "images/objects/apartmentlamp_highlight.png")
-                (type 2)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa752f90")
-                (pos -499.515 23.7381)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/rooflamp_bloom.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa753048")
-                (pos 46.7499 29.8416)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/rooflamp_bloom.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa753130")
-                (pos 656.491 10.0661)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/rooflamp_bloom.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa753218")
-                (pos 1331.54 20.6863)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/rooflamp_bloom.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa753300")
-                (pos 1394.11 -619.545)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/rooflamp_bloom.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa7533e8")
-                (pos 728.826 -616.493)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/rooflamp_bloom.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa7534d0")
-                (pos 109.319 -610.39)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/rooflamp_bloom.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa7535b8")
-                (pos -436.945 -616.493)
-                (parent "")
-                (select-mask 1)
-                (path "images/decal/rooflamp_bloom.png")
-                (type 0)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa7536a0")
-                (pos 99.2935 -640.789)
-                (parent "")
-                (select-mask 1)
-                (path "images/objects/apartmentlamp_highlight.png")
-                (type 2)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa753798")
-                (pos 1383.67 -640.789)
-                (parent "")
-                (select-mask 1)
-                (path "images/objects/apartmentlamp_highlight.png")
-                (type 2)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa753890")
-                (pos 720.418 -638.414)
-                (parent "")
-                (select-mask 1)
-                (path "images/objects/apartmentlamp_highlight.png")
-                (type 2)
-                (scale 1 1)
-                (angle 0))
-              (decal
-                (id "0xa753988")
-                (pos -457.706 -636.851)
-                (parent "")
-                (select-mask 1)
-                (path "images/objects/apartmentlamp_highlight.png")
-                (type 2)
-                (scale 1 1)
-                (angle 0)))
-            (child-layers))))
-      (layer
-        (name "Ground")
-        (visible 1)
-        (locked 0)
-        (objects
-          (decal
-            (id "0xa753dc8")
-            (pos 1641.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa753eb0")
-            (pos 873.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa753f98")
-            (pos 1130.5 448.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa754080")
-            (pos 361.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa754168")
-            (pos 105.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa754250")
-            (pos -150.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa754338")
-            (pos 617.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa754420")
-            (pos 1385.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa754508")
-            (pos -101.75 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7545f0")
-            (pos 154.25 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7546d8")
-            (pos 410.25 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7547c0")
-            (pos 1178.25 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7548a8")
-            (pos 922.25 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa754990")
-            (pos 666.25 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa754a78")
-            (pos 1690.25 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa768da8")
-            (pos 1434.25 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa768e90")
-            (pos -918.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa768f78")
-            (pos -662.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa769060")
-            (pos -1430.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa769148")
-            (pos -1686.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa769230")
-            (pos -1942.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa769318")
-            (pos -1174.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa769400")
-            (pos -406.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7694e8")
-            (pos -1893.75 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7695d0")
-            (pos -1637.75 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7696b8")
-            (pos -1381.75 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7697a0")
-            (pos -613.75 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa769888")
-            (pos -869.75 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa769970")
-            (pos -1125.75 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa769a58")
-            (pos -357.75 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa769b40")
-            (pos 1897.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa769c28")
-            (pos 2153.5 447.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa769d10")
-            (pos 1946.25 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa769df8")
-            (pos 2202.25 -64.6875)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa769ee0")
-            (pos 1915.34 -192.687)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa769fc8")
-            (pos -388.656 -192.687)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76a0b0")
-            (pos -644.656 -192.687)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76a198")
-            (pos -900.656 -192.687)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76a280")
-            (pos 1403.34 -192.687)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76a368")
-            (pos 635.344 -192.687)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76a450")
-            (pos -132.656 -192.687)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76a538")
-            (pos 123.344 -192.687)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76a620")
-            (pos 379.344 -192.687)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76a708")
-            (pos 1147.34 -192.687)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76a7f0")
-            (pos 891.344 -192.687)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76a8d8")
-            (pos 1659.34 -192.687)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueground.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76a9c0")
-            (pos 2225.09 -704.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76aaa8")
-            (pos 1969.09 -704.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76ab90")
-            (pos -334.905 -704.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76ac78")
-            (pos -1102.91 -704.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76ad60")
-            (pos -846.905 -704.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76ae48")
-            (pos -590.905 -704.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76af30")
-            (pos 1457.09 -704.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76b018")
-            (pos 1713.09 -704.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bd760")
-            (pos 689.095 -704.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bd848")
-            (pos 945.095 -704.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bd930")
-            (pos 1201.09 -704.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bda18")
-            (pos 433.095 -704.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bdb00")
-            (pos 177.095 -704.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bdbe8")
-            (pos -78.9053 -704.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/blueroof.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "Stairs")
-        (visible 1)
-        (locked 0)
-        (objects
-          (decal
-            (id "0xa76b718")
-            (pos 1346.67 98.8136)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76b7e8")
-            (pos 1346.67 258.814)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa76b898")
-            (pos 1474.67 386.814)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bdd80")
-            (pos 1474.67 226.814)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bde30")
-            (pos 1218.67 -29.1864)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bdee0")
-            (pos 1090.67 2.81363)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bdf90")
-            (pos 1090.67 -157.186)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7be040")
-            (pos 1218.67 130.814)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7be0f0")
-            (pos 958.609 -125.186)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair1.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7be1a0")
-            (pos 958.609 -285.186)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/stair2.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "Locker")
-        (visible 1)
-        (locked 0)
-        (objects
-          (decal
-            (id "0xa76b908")
-            (pos 337.491 253.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/locker.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7557a0")
-            (pos 465.491 253.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/locker.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa756338")
-            (pos 593.491 253.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/locker.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7563e0")
-            (pos 721.491 253.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/locker.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7c1258")
-            (pos 849.491 253.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/locker.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7c1340")
-            (pos -707.071 240.313)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/elevatordoor.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7c0520")
-            (pos -708.083 255.313)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/door.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7c26c0")
-            (pos -326.468 339.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bed.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7c1b90")
-            (pos 72.6572 339.312)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bed.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bead0")
-            (pos -177.277 -384.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/door.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7beb88")
-            (pos -175.578 -399.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/elevatordoor.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bec20")
-            (pos 411.525 -399.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/elevatordoor.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bed08")
-            (pos 409.826 -384.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/door.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bede8")
-            (pos -726.788 -399.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/elevatordoor.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7beed0")
-            (pos -728.486 -384.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/door.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "Shadow")
-        (visible 1)
-        (locked 0)
-        (objects
-          (decal
-            (id "0xa76b760")
-            (pos 1432.09 426.524)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bf0d8")
-            (pos 325.796 355.072)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bf188")
-            (pos 870.812 337.75)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bf238")
-            (pos 586.047 254.156)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bf2e8")
-            (pos -224.968 432.364)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bf398")
-            (pos 67.5322 426.114)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bf850")
-            (pos 1152.54 -13.9169)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bf930")
-            (pos 929.427 -188.448)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bfa10")
-            (pos 1198.26 393.161)
-            (parent "")
-            (select-mask 1)
-            (path "images/decal/dark.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers))
-      (layer
-        (name "Background")
-        (visible 1)
-        (locked 0)
-        (objects
-          (decal
-            (id "0xa7bf010")
-            (pos 346.25 191.313)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa7bfe70")
-            (pos 730.25 191.313)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa966b30")
-            (pos 1498.25 191.313)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa966bd8")
-            (pos 1114.25 191.313)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa966cc0")
-            (pos -37.75 191.313)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa966da8")
-            (pos -1573.75 191.313)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa966e90")
-            (pos -421.75 191.313)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa8ccb28")
-            (pos -805.75 191.313)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa8ccbf0")
-            (pos -1189.75 191.313)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa8cccd8")
-            (pos 1882.25 191.313)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa8ccdc0")
-            (pos 1975.29 -448.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa8ccea8")
-            (pos -1096.71 -448.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa8ccf90")
-            (pos -712.715 -448.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa8cd078")
-            (pos -328.715 -448.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa8cd160")
-            (pos 55.2852 -448.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa8cd248")
-            (pos 1207.29 -448.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa8cd330")
-            (pos 1591.29 -448.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa8cd418")
-            (pos 823.285 -448.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0))
-          (decal
-            (id "0xa8cd500")
-            (pos 439.285 -448.688)
-            (parent "")
-            (select-mask 1)
-            (path "images/objects/bluewall.png")
-            (type 0)
-            (scale 1 1)
-            (angle 0)))
-        (child-layers)))))
+  (navigation
+    (nodes)
+    (edges))
+  (layers
+    (layer
+      (name "Scene")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x11234560")
+          (pos 1204.55 268.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/humanreference.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Light")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x11236dc8")
+          (pos 58.9653 321.293)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11236f90")
+          (pos 1347.85 311.818)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11252b48")
+          (pos -518.274 304.576)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11237590")
+          (pos 667.297 305.114)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11237a10")
+          (pos 45.189 -395.95)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11237b38")
+          (pos 653.521 -410.567)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112376f8")
+          (pos -535.175 -411.104)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11237830")
+          (pos 1334.07 -403.863)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light.png")
+          (type 1)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Highlight")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x11238730")
+          (pos -520.276 3.38026)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11238108")
+          (pos 657.849 1.81776)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11238338")
+          (pos 1321.1 -0.557228)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11238260")
+          (pos 36.7242 -0.55722)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1125d598")
+          (pos -499.515 23.7381)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1125db70")
+          (pos 46.7499 29.8416)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11293ca8")
+          (pos 656.491 10.0661)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1125d650")
+          (pos 1331.54 20.6863)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11293bd8")
+          (pos 1394.11 -619.545)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1125d920")
+          (pos 728.826 -616.493)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1125d7c0")
+          (pos 109.319 -610.39)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112a5dd0")
+          (pos -436.945 -616.493)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/rooflamp_bloom.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112a5c58")
+          (pos 99.2935 -640.789)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112a6858")
+          (pos 1383.67 -640.789)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1126fe28")
+          (pos 720.418 -638.414)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112b8a70")
+          (pos -457.706 -636.851)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/apartmentlamp_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Ground")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x112a69a0")
+          (pos 1641.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112a6a88")
+          (pos 873.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11251148")
+          (pos 1130.5 448.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11250e68")
+          (pos 361.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11250fa8")
+          (pos 105.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11236aa8")
+          (pos -150.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112368d8")
+          (pos 617.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112519f0")
+          (pos 1385.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11251718")
+          (pos -101.75 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11251fa8")
+          (pos 154.25 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11251868")
+          (pos 410.25 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11251398")
+          (pos 1178.25 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11251580")
+          (pos 922.25 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11252a18")
+          (pos 666.25 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11251c40")
+          (pos 1690.25 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11251e28")
+          (pos 1434.25 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112526d8")
+          (pos -918.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112527e0")
+          (pos -662.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11251d30")
+          (pos -1430.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x114c9338")
+          (pos -1686.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x114c9258")
+          (pos -1942.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x114f9668")
+          (pos -1174.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x114f9540")
+          (pos -406.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112524c0")
+          (pos -1893.75 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11541918")
+          (pos -1637.75 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11252308")
+          (pos -1381.75 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x115419e0")
+          (pos -613.75 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11491040")
+          (pos -869.75 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1155a0f0")
+          (pos -1125.75 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1155a1f0")
+          (pos -357.75 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11490ea0")
+          (pos 1897.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x115da4f8")
+          (pos 2153.5 447.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x115da6e0")
+          (pos 1946.25 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1161a950")
+          (pos 2202.25 -64.6875)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1161a7c0")
+          (pos 1915.34 -192.687)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x115da590")
+          (pos -388.656 -192.687)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11250ad0")
+          (pos -644.656 -192.687)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11250b78")
+          (pos -900.656 -192.687)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11250bf8")
+          (pos 1403.34 -192.687)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11559cf8")
+          (pos 635.344 -192.687)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x116db348")
+          (pos -132.656 -192.687)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x117236a8")
+          (pos 123.344 -192.687)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x117238b8")
+          (pos 379.344 -192.687)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1173bb00")
+          (pos 1147.34 -192.687)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1173b9d8")
+          (pos 891.344 -192.687)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x117236f8")
+          (pos 1659.34 -192.687)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueground.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1176be18")
+          (pos 2225.09 -704.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1179c020")
+          (pos 1969.09 -704.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1179c1a0")
+          (pos -334.905 -704.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x116c3190")
+          (pos -1102.91 -704.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1166ac08")
+          (pos -846.905 -704.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1166aed0")
+          (pos -590.905 -704.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x117cc5e8")
+          (pos 1457.09 -704.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1186ce98")
+          (pos 1713.09 -704.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1186d1e0")
+          (pos 689.095 -704.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x117ccc90")
+          (pos 945.095 -704.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1186d040")
+          (pos 1201.09 -704.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1188d358")
+          (pos 433.095 -704.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1188d648")
+          (pos 177.095 -704.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x118cd6d8")
+          (pos -78.9053 -704.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/blueroof.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Stairs")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x1194de40")
+          (pos 1346.67 98.8136)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1194de90")
+          (pos 1346.67 258.814)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112a6400")
+          (pos 1474.67 386.814)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11237d38")
+          (pos 1474.67 226.814)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112384b0")
+          (pos 1218.67 -29.1864)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11252df8")
+          (pos 1090.67 2.81363)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11238638")
+          (pos 1090.67 -157.186)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x117b4470")
+          (pos 1218.67 130.814)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1198df30")
+          (pos 958.609 -125.186)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11a24268")
+          (pos 958.609 -285.186)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stair2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Locker")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x1198dff8")
+          (pos 337.491 253.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/locker.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112dc840")
+          (pos 465.491 253.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/locker.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11a44708")
+          (pos 593.491 253.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/locker.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11a5e550")
+          (pos 721.491 253.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/locker.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11abec18")
+          (pos 849.491 253.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/locker.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11aded70")
+          (pos -707.071 240.313)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/elevatordoor.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11aff028")
+          (pos -708.083 255.313)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11a7e9a8")
+          (pos -326.468 339.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bed.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11b1f108")
+          (pos 72.6572 339.312)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bed.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11bcebc0")
+          (pos -177.277 -384.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11b1f2f0")
+          (pos -175.578 -399.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/elevatordoor.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11bcec80")
+          (pos 411.525 -399.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/elevatordoor.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11bcea58")
+          (pos 409.826 -384.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11b1f4e0")
+          (pos -726.788 -399.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/elevatordoor.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11b1f668")
+          (pos -728.486 -384.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/door.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Shadow")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x11ce4a28")
+          (pos 1432.09 426.524)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11ce4b00")
+          (pos 325.796 355.072)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11ce47c0")
+          (pos 870.812 337.75)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11c7cca8")
+          (pos 586.047 254.156)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11c7ce60")
+          (pos -224.968 432.364)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1194dca0")
+          (pos 67.5322 426.114)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x1194dc00")
+          (pos 1152.54 -13.9169)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112f0a70")
+          (pos 929.427 -188.448)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112f0b50")
+          (pos 1198.26 393.161)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Background")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x11235dc0")
+          (pos 346.25 191.313)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11235fc0")
+          (pos 730.25 191.313)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11235560")
+          (pos 1498.25 191.313)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11235628")
+          (pos 1114.25 191.313)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11235708")
+          (pos -37.75 191.313)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11235838")
+          (pos -1573.75 191.313)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11235170")
+          (pos -421.75 191.313)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x112352a8")
+          (pos -805.75 191.313)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11fd6cb0")
+          (pos -1189.75 191.313)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11fd6a00")
+          (pos 1882.25 191.313)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11fd6b38")
+          (pos 1975.29 -448.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x120430c0")
+          (pos -1096.71 -448.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x11234eb0")
+          (pos -712.715 -448.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x12042de8")
+          (pos -328.715 -448.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x12042ee8")
+          (pos 55.2852 -448.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x12043008")
+          (pos 1207.29 -448.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x122cba38")
+          (pos 1591.29 -448.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x121f3348")
+          (pos 823.285 -448.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x122cb6b8")
+          (pos 439.285 -448.688)
+          (parent "")
+          (select-mask 1)
+          (path "images/objects/bluewall.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))))
 
 ;; EOF ;;



From grumbel at mail.berlios.de  Sun Apr 12 04:34:31 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sun, 12 Apr 2009 04:34:31 +0200
Subject: [Windstille-commit] r2914 - trunk/media/wiki
Message-ID: <200904120234.n3C2YVQr001791@sheep.berlios.de>

Author: grumbel
Date: 2009-04-12 04:34:30 +0200 (Sun, 12 Apr 2009)
New Revision: 2914

Modified:
   trunk/media/wiki/Editor.wiki
Log:
Added a few notes about the Editor

Modified: trunk/media/wiki/Editor.wiki
===================================================================
--- trunk/media/wiki/Editor.wiki	2009-04-10 05:03:45 UTC (rev 2913)
+++ trunk/media/wiki/Editor.wiki	2009-04-12 02:34:30 UTC (rev 2914)
@@ -1,3 +1,7 @@
+<<note>>
+Full sandbox seemed to troublesome to actually implement, so it was skipped for the moment. The editor however shares all drawing code with the game and some data structures such as the navigation graph are reused as well.
+<</note>>
+
 The Windstille Editor will follow a sandbox model. The engine shall be flexible enough that it can run inside the editor and be manipulated. For this to work the engine must first be cleaned up enough so that it can be wrapped up into a GtkWidget. The goal of going sandbox is to reduce code duplication and allow direct jumps into and out of the game.
 
 == Interface
@@ -6,6 +10,31 @@
 
 The basic interface will be similar to that of other game editor such as SuperTux or Pingus. One notable exception is how the objects are organized, instead of a flat list, each object will have a parent object. Which allows both the grouping of objects as well as easier reuse of previous build objects (e.g. a train could be used in multiple sectors).
 
+== Object Grouping / TreeView
+
+<<note>>
+A Blender-like tree based Outliner proved to hard to use, due to the high object count, so the editor did fell back to a simple layered model, which seems good enough. Object parenting is provided as well.
+<</note>>
+
+<<thumbnail src="editor2.png">>
+
+The way objects connect to each other is represented in a simple tree, comparable to [[http://www.blender.org/development/release-logs/blender-235a/outliner/ | Blenders Outliner]]. At the root of the tree is the sector itself, while normal objects attach to it. Objects whose position shall be relative to another object, attach to the respective object (e.g. a door might attach to a train).
+
+In addition to just the structure, the TreeView will also provide ways to manipulate the object sorting, parenting as well as simply properties, like visibilty.
+
+=== Example
+
+Type | Name |  Visible 
+* (sector) | Sector | [X]
+** (sprite) | Train [X]
+*** (psys) | Smoke [X]
+*** (sprite) | LeftDoor [X]
+*** (sprite) | RightDoor [X]
+** (empty) | Track
+*** (sprite) | Rail [ ]
+*** (rail) | Column [ ]
+*** (gradient) | Background [ ]
+
 == Property Editor
 
 The property editor will allow the manipulation of all of the objects properties:
@@ -25,4 +54,8 @@
 
 == Flexlay
 
-Flexlay is the old Windstille editor and so far still somewhat functional.
+[[http://flexlay.berlios.de/|Flexlay]] is the old Windstille editor and so far still somewhat functional for the current tile based maps. 
+
+== Animation
+
+For animation there needs to be a widget that can edit the abstract curves, as well as handling of animation paths directly in the Sector itself.



From grumbel at mail.berlios.de  Sun Apr 12 04:34:59 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sun, 12 Apr 2009 04:34:59 +0200
Subject: [Windstille-commit] r2915 - trunk/media/wiki
Message-ID: <200904120234.n3C2Yx4k002607@sheep.berlios.de>

Author: grumbel
Date: 2009-04-12 04:34:59 +0200 (Sun, 12 Apr 2009)
New Revision: 2915

Modified:
   trunk/media/wiki/wiki2html.py
Log:
Moved doxygen docu to different host, since we are running into web-quota on berlios.de

Modified: trunk/media/wiki/wiki2html.py
===================================================================
--- trunk/media/wiki/wiki2html.py	2009-04-12 02:34:30 UTC (rev 2914)
+++ trunk/media/wiki/wiki2html.py	2009-04-12 02:34:59 UTC (rev 2915)
@@ -100,7 +100,7 @@
 
         elif name == "class":
             if body:
-                return bldr.tag.a(body, class_='class', href="../docs/class" + body + ".html")
+                return bldr.tag.a(body, class_='class', href="http://pingus.seul.org/~grumbel/windstille/docs/class" + body + ".html")
             else:
                 return None
 



From grumbel at mail.berlios.de  Tue Apr 14 04:23:51 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 14 Apr 2009 04:23:51 +0200
Subject: [Windstille-commit] r2916 - trunk/windstille/src/screen
Message-ID: <200904140223.n3E2Nptd028612@sheep.berlios.de>

Author: grumbel
Date: 2009-04-14 04:23:49 +0200 (Tue, 14 Apr 2009)
New Revision: 2916

Modified:
   trunk/windstille/src/screen/game_session.cpp
   trunk/windstille/src/screen/game_session.hpp
   trunk/windstille/src/screen/sprite2dview.cpp
   trunk/windstille/src/screen/sprite2dview.hpp
   trunk/windstille/src/screen/sprite3dview.cpp
   trunk/windstille/src/screen/sprite3dview.hpp
   trunk/windstille/src/screen/view.cpp
   trunk/windstille/src/screen/view.hpp
Log:
Micro cleanup

Modified: trunk/windstille/src/screen/game_session.cpp
===================================================================
--- trunk/windstille/src/screen/game_session.cpp	2009-04-12 02:34:59 UTC (rev 2915)
+++ trunk/windstille/src/screen/game_session.cpp	2009-04-14 02:23:49 UTC (rev 2916)
@@ -24,40 +24,40 @@
 #include <sqstdio.h> 
 #include <sqstdaux.h> 
 
+#include "app/console.hpp"
 #include "app/menu_manager.hpp"
+#include "app/windstille_main.hpp"
+#include "collision/collision_engine.hpp"
+#include "display/display.hpp"
+#include "display/scene_context.hpp"
+#include "display/surface.hpp"
+#include "display/surface_manager.hpp"
+#include "engine/game_object.hpp"
+#include "engine/script_manager.hpp"
+#include "engine/sector.hpp"
 #include "font/fonts.hpp"
-#include "engine/sector.hpp"
-#include "app/console.hpp"
-#include "engine/game_object.hpp"
-#include "objects/player.hpp"
-#include "tile/tile_map.hpp"
-#include "screen_manager.hpp"
-#include "view.hpp"
+#include "hud/conversation.hpp"
 #include "hud/dialog_manager.hpp"
+#include "hud/inventory.hpp"
+#include "hud/pda.hpp"
 #include "hud/speech_manager.hpp"
-#include "app/windstille_main.hpp"
-#include "display/scene_context.hpp"
-#include "scripting/util.hpp"
-#include "scripting/wrapper.hpp"
 #include "input/input_manager.hpp"
+#include "objects/player.hpp"
+#include "objects/test_object.hpp"
 #include "particles/particle_system.hpp"
 #include "particles/spark_drawer.hpp"
 #include "particles/surface_drawer.hpp"
-#include "engine/script_manager.hpp"
+#include "screen_manager.hpp"
+#include "scripting/util.hpp"
+#include "scripting/wrapper.hpp"
 #include "sound/sound_manager.hpp"
-#include "hud/conversation.hpp"
-#include "collision/collision_engine.hpp"
-#include "objects/test_object.hpp"
-#include "hud/inventory.hpp"
-#include "display/surface_manager.hpp"
-#include "display/surface.hpp"
-#include "display/display.hpp"
-#include "hud/pda.hpp"
+#include "tile/tile_map.hpp"
+#include "view.hpp"
 
 #include "game_session.hpp"
 
 GameSession* GameSession::current_ = 0; 
-
+
 class GameSessionImpl
 {
 public:
@@ -122,7 +122,7 @@
   
   void handle_event(const SDL_Event& event);
 };
-
+
 GameSession::GameSession(const std::string& arg_filename)
   : impl(new GameSessionImpl())
 {
@@ -528,5 +528,5 @@
 {
   return &(impl->sc);
 }
-
+
 /* EOF */

Modified: trunk/windstille/src/screen/game_session.hpp
===================================================================
--- trunk/windstille/src/screen/game_session.hpp	2009-04-12 02:34:59 UTC (rev 2915)
+++ trunk/windstille/src/screen/game_session.hpp	2009-04-14 02:23:49 UTC (rev 2916)
@@ -21,13 +21,14 @@
 
 #include <string>
 #include <squirrel.h>
+
+#include "app/console.hpp"
+#include "app/globals.hpp"
 #include "display/scene_context.hpp"
-#include "app/console.hpp"
+#include "hud/controller_help_window.hpp"
 #include "screen.hpp"
-#include "hud/controller_help_window.hpp"
 #include "sprite2d/sprite.hpp"
-#include "app/globals.hpp"
-
+
 class PDA;
 class EnergyBar;
 class View;
@@ -38,7 +39,7 @@
 class Inventory;
 
 class GameSessionImpl;
-
+
 class GameSession : public Screen
 {
 public:
@@ -47,7 +48,7 @@
   static GameSession* current_; 
 
 public:
-  static GameSession* current() { return current_; } 
+  static GameSession* current() { return current_; }
 
   GameSession(const std::string& arg_filename);
   virtual ~GameSession();
@@ -88,7 +89,7 @@
 private:
   boost::shared_ptr<GameSessionImpl> impl;
 };
-
+
 #endif
 
 /* EOF */

Modified: trunk/windstille/src/screen/sprite2dview.cpp
===================================================================
--- trunk/windstille/src/screen/sprite2dview.cpp	2009-04-12 02:34:59 UTC (rev 2915)
+++ trunk/windstille/src/screen/sprite2dview.cpp	2009-04-14 02:23:49 UTC (rev 2916)
@@ -32,7 +32,7 @@
 
 #define DISPLAY_W 800
 #define DISPLAY_H 600
-
+
 Sprite2DView::Sprite2DView()
 {
   auto_scroll = false;
@@ -394,5 +394,5 @@
   sprite = Sprite(filename);
   ignore_delta = true;
 }
-
+
 /* EOF */

Modified: trunk/windstille/src/screen/sprite2dview.hpp
===================================================================
--- trunk/windstille/src/screen/sprite2dview.hpp	2009-04-12 02:34:59 UTC (rev 2915)
+++ trunk/windstille/src/screen/sprite2dview.hpp	2009-04-14 02:23:49 UTC (rev 2916)
@@ -22,7 +22,7 @@
 #include "display/scene_context.hpp"
 #include "sprite2d/sprite.hpp"
 #include "screen.hpp"
-
+
 /**
  * A simple class to view 3d sprites and their different actions,
  * mostly usefull for debugging 
@@ -84,7 +84,7 @@
   Sprite2DView (const Sprite2DView&);
   Sprite2DView& operator= (const Sprite2DView&);
 };
-
+
 #endif
 
 /* EOF */

Modified: trunk/windstille/src/screen/sprite3dview.cpp
===================================================================
--- trunk/windstille/src/screen/sprite3dview.cpp	2009-04-12 02:34:59 UTC (rev 2915)
+++ trunk/windstille/src/screen/sprite3dview.cpp	2009-04-14 02:23:49 UTC (rev 2916)
@@ -17,15 +17,16 @@
 */
 
 #include <iostream>
-#include "input/controller.hpp"
+
+#include "app/console.hpp"
+#include "app/menu_manager.hpp"
 #include "display/display.hpp"
-#include "app/console.hpp"
+#include "font/fonts.hpp"
 #include "font/ttf_font.hpp"
-#include "font/fonts.hpp"
-#include "app/menu_manager.hpp"
+#include "input/controller.hpp"
 #include "screen_manager.hpp"
 #include "sprite3dview.hpp"
-
+
 Sprite3DView::Sprite3DView()
 {
   current_action = 0;
@@ -161,5 +162,5 @@
 {
   
 }
-
+
 /* EOF */

Modified: trunk/windstille/src/screen/sprite3dview.hpp
===================================================================
--- trunk/windstille/src/screen/sprite3dview.hpp	2009-04-12 02:34:59 UTC (rev 2915)
+++ trunk/windstille/src/screen/sprite3dview.hpp	2009-04-14 02:23:49 UTC (rev 2916)
@@ -22,7 +22,7 @@
 #include "display/scene_context.hpp"
 #include "sprite3d/sprite3d.hpp"
 #include "screen.hpp"
-
+
 /**
  * A simple class to view 3d sprites and their different actions,
  * mostly usefull for debugging 
@@ -53,7 +53,7 @@
   Sprite3DView (const Sprite3DView&);
   Sprite3DView& operator= (const Sprite3DView&);
 };
-
+
 #endif
 
 /* EOF */

Modified: trunk/windstille/src/screen/view.cpp
===================================================================
--- trunk/windstille/src/screen/view.cpp	2009-04-12 02:34:59 UTC (rev 2915)
+++ trunk/windstille/src/screen/view.cpp	2009-04-14 02:23:49 UTC (rev 2916)
@@ -25,7 +25,7 @@
 #include "view.hpp"
 
 View* View::current_ = 0;
-
+
 View::View()
   : state(Display::get_width(), Display::get_height()),
     zoom(1.0), 
@@ -102,5 +102,5 @@
 {
   return state.screen_to_world(point);
 }
-
+
 /* EOF */

Modified: trunk/windstille/src/screen/view.hpp
===================================================================
--- trunk/windstille/src/screen/view.hpp	2009-04-12 02:34:59 UTC (rev 2915)
+++ trunk/windstille/src/screen/view.hpp	2009-04-14 02:23:49 UTC (rev 2916)
@@ -22,10 +22,10 @@
 #include "display/graphic_context_state.hpp"
 #include "engine/camera.hpp"
 #include "math/vector2f.hpp"
-
+
 class Controller;
 class SceneContext;
-
+
 /** This class is the gui component which renders the world to the
     screen */
 class View
@@ -56,7 +56,7 @@
 protected:
   static View* current_;
 };
-
+
 #endif
 
 /* EOF */



From grumbel at mail.berlios.de  Tue Apr 14 04:26:30 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 14 Apr 2009 04:26:30 +0200
Subject: [Windstille-commit] r2917 - trunk/windstille/src/editor
Message-ID: <200904140226.n3E2QUBR028782@sheep.berlios.de>

Author: grumbel
Date: 2009-04-14 04:26:29 +0200 (Tue, 14 Apr 2009)
New Revision: 2917

Modified:
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/editor_window.hpp
   trunk/windstille/src/editor/object_selector.cpp
   trunk/windstille/src/editor/object_selector.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
Log:
Moved object loading code into ObjectSelector and added drag&drop of URIs, so D&D from WindstilleEditor to Gimp is possible

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-14 02:23:49 UTC (rev 2916)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-14 02:26:29 UTC (rev 2917)
@@ -384,12 +384,7 @@
   // Window
   add(vbox);
 
-  fill_object_selector("data/images/decal/");
-  fill_object_selector("data/images/objects/bar/");
-  //fill_object_selector("data/images/inventory/");
-  //fill_object_selector("data/images/portraits/");
-  fill_object_selector("data/images/objects/");
-  fill_object_selector("data/images/");
+  object_selector.populate();
 }
 
 EditorWindow::~EditorWindow()
@@ -688,84 +683,6 @@
     }
 }
 
-static bool has_suffix(const std::string& str, const std::string& suffix)
-{
-  if (str.length() >= suffix.length())
-    return str.compare(str.length() - suffix.length(), suffix.length(), suffix) == 0;
-  else
-    return false;
-}
-
-void
-EditorWindow::fill_object_selector(const std::string& directory)
-{
-  std::vector<Glib::ustring> images;
-
-  Glib::Dir dir(directory);
-  for(Glib::Dir::iterator i = dir.begin(); i != dir.end(); ++i)
-    {
-      if (has_suffix(*i, ".png"))
-        {
-          Glib::ustring path = directory;
-          path += *i;
-          images.push_back(path);
-        }
-    }
-
-  std::sort(images.begin(), images.end());
-
-  for(std::vector<Glib::ustring>::iterator i = images.begin(); i != images.end(); ++i)    
-    {
-      Glib::RefPtr<Gdk::Pixbuf> pixbuf = Gdk::Pixbuf::create_from_file(*i);
-      Glib::RefPtr<Gdk::Pixbuf> icon;
-
-      { // Create an icon, by scaling it down, keeping aspect
-        // intact and adding a background (important to make drag&drop easier)
-        int size     = 48; // size of the icon
-        int min_size = 16; // minimum width/height of the icon after scaling
-
-        if (1)
-          {
-            icon = Gdk::Pixbuf::create_from_file("data/editor/icon_bg.png");
-            size = std::max(icon->get_width(), icon->get_height());
-          }
-        else
-          {
-            icon = Gdk::Pixbuf::create(Gdk::COLORSPACE_RGB, true, 8, size, size);
-            icon->fill(0x444444ff);
-          }
-
-        // Scale pixbuf to icon size while keeping aspect ratio intact
-        double x_scale = (double)size / pixbuf->get_width();
-        double y_scale = (double)size / pixbuf->get_height();
-
-        if (x_scale * pixbuf->get_width() < min_size)
-          x_scale = min_size / pixbuf->get_width();
-
-        if (y_scale * pixbuf->get_height() < min_size)
-          y_scale = min_size / pixbuf->get_height();
-
-        if (pixbuf->get_width() > pixbuf->get_height())              
-          y_scale = x_scale;
-        else
-          x_scale = y_scale;
-
-        int r_w = int(pixbuf->get_width() * x_scale);
-        int r_h = int(pixbuf->get_height() * y_scale);
-
-        pixbuf->composite(icon, 
-                          (size - r_w)/2, (size - r_h)/2,
-                          r_w, r_h,
-                          (size - r_w)/2, (size - r_h)/2,
-                          x_scale, y_scale,
-                          Gdk::INTERP_TILES, 
-                          255);
-      }
-
-      object_selector.add_object(*i, icon);
-    }
-}
-
 bool
 EditorWindow::get_draw_navgraph() const
 {

Modified: trunk/windstille/src/editor/editor_window.hpp
===================================================================
--- trunk/windstille/src/editor/editor_window.hpp	2009-04-14 02:23:49 UTC (rev 2916)
+++ trunk/windstille/src/editor/editor_window.hpp	2009-04-14 02:26:29 UTC (rev 2917)
@@ -99,8 +99,7 @@
   virtual ~EditorWindow();
 
   void show_minimap(bool v);
-  void fill_object_selector(const std::string& directory);
-
+  
 public:
   void on_new();
   void on_open();

Modified: trunk/windstille/src/editor/object_selector.cpp
===================================================================
--- trunk/windstille/src/editor/object_selector.cpp	2009-04-14 02:23:49 UTC (rev 2916)
+++ trunk/windstille/src/editor/object_selector.cpp	2009-04-14 02:26:29 UTC (rev 2917)
@@ -30,6 +30,7 @@
 class ObjectIconColumns : public Gtk::TreeModel::ColumnRecord
 {
 public:
+  Gtk::TreeModelColumn<std::string> url;
   Gtk::TreeModelColumn<std::string> pathname;
   Gtk::TreeModelColumn<Glib::RefPtr<Gdk::Pixbuf> >  icon;
   
@@ -45,6 +46,7 @@
 
   ObjectIconColumns() {
     add(pathname); 
+    add(url);
     add(icon);
   }
 };
@@ -76,6 +78,8 @@
   // Change background color
   // iconview.modify_base(Gtk::STATE_NORMAL, Gdk::Color("#444444"));
   
+  set_border_width(1);
+
   iconview.set_model(list_store);
 
   // Trying to get spacing to minimum, without much effect
@@ -89,7 +93,11 @@
   iconview.set_model(list_store);
 
   std::vector<Gtk::TargetEntry> targets;
-  targets.push_back(Gtk::TargetEntry("WindstilleObject"));
+  //targets.push_back(Gtk::TargetEntry("image/png"));
+  targets.push_back(Gtk::TargetEntry("text/uri-list"));
+  targets.push_back(Gtk::TargetEntry("STRING"));
+  targets.push_back(Gtk::TargetEntry("text/plain"));
+  targets.push_back(Gtk::TargetEntry("application/x-windstille-decal"));
   iconview.drag_source_set(targets, Gdk::BUTTON1_MASK, Gdk::ACTION_COPY);
 
   iconview.signal_drag_begin().connect(sigc::mem_fun(*this, &ObjectSelector::on_drag_begin));
@@ -111,18 +119,112 @@
 }
 
 void
-ObjectSelector::add_object(const std::string& pathname,
-                           const Glib::RefPtr<Gdk::Pixbuf>& icon)
+ObjectSelector::add_decal(const Glib::RefPtr<Gdk::Pixbuf>& icon,
+                          const std::string& pathname,
+                          const std::string& url)
 {
-  Gtk::ListStore::iterator it  = list_store->append();
+  Gtk::ListStore::iterator it = list_store->append();
+
   (*it)[ObjectIconColumns::instance().pathname] = pathname;
+  (*it)[ObjectIconColumns::instance().url]      = url;
   (*it)[ObjectIconColumns::instance().icon]     = icon;
 }
 
+static bool has_suffix(const std::string& str, const std::string& suffix)
+{
+  if (str.length() >= suffix.length())
+    return str.compare(str.length() - suffix.length(), suffix.length(), suffix) == 0;
+  else
+    return false;
+}
+
 void
+ObjectSelector::add_decals_from_directory(const std::string& pathname)
+{
+  std::vector<Glib::ustring> images;
+
+  Glib::Dir dir(pathname);
+  for(Glib::Dir::iterator i = dir.begin(); i != dir.end(); ++i)
+    {
+      if (has_suffix(*i, ".png"))
+        {
+          Glib::ustring path = pathname;
+          path += *i;
+          images.push_back(path);
+        }
+    }
+
+  std::sort(images.begin(), images.end());
+
+  for(std::vector<Glib::ustring>::iterator i = images.begin(); i != images.end(); ++i)    
+    {
+      Glib::RefPtr<Gdk::Pixbuf> pixbuf = Gdk::Pixbuf::create_from_file(*i);
+      Glib::RefPtr<Gdk::Pixbuf> icon;
+
+      { // Create an icon, by scaling it down, keeping aspect
+        // intact and adding a background (important to make drag&drop easier)
+        int size     = 48; // size of the icon
+        int min_size = 16; // minimum width/height of the icon after scaling
+
+        if (1)
+          {
+            icon = Gdk::Pixbuf::create_from_file("data/editor/icon_bg.png");
+            size = std::max(icon->get_width(), icon->get_height());
+          }
+        else
+          {
+            icon = Gdk::Pixbuf::create(Gdk::COLORSPACE_RGB, true, 8, size, size);
+            icon->fill(0x444444ff);
+          }
+
+        // Scale pixbuf to icon size while keeping aspect ratio intact
+        double x_scale = (double)size / pixbuf->get_width();
+        double y_scale = (double)size / pixbuf->get_height();
+
+        if (x_scale * pixbuf->get_width() < min_size)
+          x_scale = min_size / pixbuf->get_width();
+
+        if (y_scale * pixbuf->get_height() < min_size)
+          y_scale = min_size / pixbuf->get_height();
+
+        if (pixbuf->get_width() > pixbuf->get_height())              
+          y_scale = x_scale;
+        else
+          x_scale = y_scale;
+
+        int r_w = int(pixbuf->get_width() * x_scale);
+        int r_h = int(pixbuf->get_height() * y_scale);
+
+        pixbuf->composite(icon, 
+                          (size - r_w)/2, (size - r_h)/2,
+                          r_w, r_h,
+                          (size - r_w)/2, (size - r_h)/2,
+                          x_scale, y_scale,
+                          Gdk::INTERP_TILES, 
+                          255);
+      }
+
+      add_decal(icon, *i, 
+                "file:///home/ingo/projects/windstille/trunk/windstille/" + *i);
+    }
+}
+
+void
+ObjectSelector::populate()
+{
+  add_decals_from_directory("data/images/decal/");
+  add_decals_from_directory("data/images/objects/bar/");
+  add_decals_from_directory("data/images/objects/");
+  add_decals_from_directory("data/images/");
+  //("data/images/inventory/");
+  //("data/images/portraits/");
+}
+void
 ObjectSelector::refresh()
 {
-  std::cout << "Refresh" << std::endl;
+  std::cout << "ObjectSelector::refresh()" << std::endl;
+  list_store->clear();
+  populate();
 }
                     
 void
@@ -164,10 +266,18 @@
     {
       Gtk::ListStore::iterator it = list_store->get_iter(*i);
 
-      //if (it)
-      //std::cout << "on_drag_begin: " << (*it)[ObjectIconColumns::instance().pathname] << std::endl;
+      std::cout << "TARGET: " << selection_data.get_target() << std::endl;
 
-      selection_data.set("data", (*it)[ObjectIconColumns::instance().pathname]);
+      if (selection_data.get_target() == "application/x-windstille-decal")
+        {
+          const std::string& str = (*it)[ObjectIconColumns::instance().pathname];
+          selection_data.set(8, reinterpret_cast<const guint8*>(str.c_str()), str.length());
+        }
+      else
+        {
+          const std::string& str = (*it)[ObjectIconColumns::instance().url];
+          selection_data.set(8, reinterpret_cast<const guint8*>(str.c_str()), str.length());
+        }
     }
 }
 

Modified: trunk/windstille/src/editor/object_selector.hpp
===================================================================
--- trunk/windstille/src/editor/object_selector.hpp	2009-04-14 02:23:49 UTC (rev 2916)
+++ trunk/windstille/src/editor/object_selector.hpp	2009-04-14 02:26:29 UTC (rev 2917)
@@ -42,9 +42,13 @@
   ObjectSelector(EditorWindow& editor);
   virtual ~ObjectSelector();
 
-  void add_object(const std::string& pathname,
-                  const Glib::RefPtr<Gdk::Pixbuf>& icon);
+  void add_decal(const Glib::RefPtr<Gdk::Pixbuf>& icon,
+                 const std::string& pathname,
+                 const std::string& url);
 
+  void add_decals_from_directory(const std::string& pathname);
+
+  void populate();
   void refresh();
 
 protected:

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-14 02:23:49 UTC (rev 2916)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-14 02:26:29 UTC (rev 2917)
@@ -98,7 +98,7 @@
 
   // Glib::signal_timeout().connect(sigc::mem_fun(this, &WindstilleWidget::on_timeout), 33);
   std::vector<Gtk::TargetEntry> targets;
-  targets.push_back(Gtk::TargetEntry("WindstilleObject"));
+  targets.push_back(Gtk::TargetEntry("application/x-windstille-decal"));
   drag_dest_set(targets, Gtk::DEST_DEFAULT_ALL, Gdk::ACTION_COPY);
 
   set_selection(Selection::create());



From grumbel at mail.berlios.de  Tue Apr 14 04:28:13 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 14 Apr 2009 04:28:13 +0200
Subject: [Windstille-commit] r2918 - trunk/windstille
Message-ID: <200904140228.n3E2SD4i028899@sheep.berlios.de>

Author: grumbel
Date: 2009-04-14 04:28:12 +0200 (Tue, 14 Apr 2009)
New Revision: 2918

Modified:
   trunk/windstille/TODO
Log:
TODO updates

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-04-14 02:26:29 UTC (rev 2917)
+++ trunk/windstille/TODO	2009-04-14 02:28:12 UTC (rev 2918)
@@ -187,6 +187,8 @@
 Miscellaneous
 =============
 
+* View class could be done away, as it doesn't have any clear purpose
+
 * sorting DrawingRequest can be speed up by a bucket sort, as most
   requests don't make use of z-pos
 
@@ -515,6 +517,20 @@
 Editor
 ======
 
+* new boost1.37 seems to be missing boost_signals, instead it has
+  boost_signals-mt, do we want to get funcky with configure checks or
+  ignore and stay boost1.35 or so?
+
+* add (maybe) a LispWriter::start_section(name, bool compact) to create:
+
+  (object (name "aeu") (...))
+
+  instead of
+
+  (object
+    (name "aeu")
+    (...))
+
 * add special blocker objects, i.e. black boxes that have a
   configurable fadeout
 
@@ -537,9 +553,6 @@
 * add a way to delete navgraph nodes (need to move Selection out of
   tool, generalize it or just use right button)
 
-* tools are not drawn/updated when no button is pressed (active_tool
-  variable is at fault)
-
 * NavgraphTool (see Construo):
  
   - in Construo insertion and selection are two different tool
@@ -711,12 +724,10 @@
 
 * highlight content of rect selection while the rect gets dragged
 
-* add way to refresh content of ObjectSelector (i.e. load new images
-  from disk)
-
-* highlight map is problematic, since objects don't cover highlights,
-  maybe rendering a stencil mask might help, other alternative would
-  be occulsion querys, but they only work for Geforce3 and Up. Have to
+* highlight map is problematic, since objects don't cover highlights
+  (i.e. train infront of a highlight in the background), maybe
+  rendering a stencil mask might help, other alternative would be
+  occulsion querys, but they only work for Geforce3 and Up. Have to
   wait and see how much of a problem that is in practice, ray-casting
   would be doable as well, but won't work well with 3d sprites or
   scaling
@@ -751,8 +762,7 @@
 * lightmap objects are hard to see (not that big an issue with the new
   layer system)
 
-* decal needs to be scalable and have vertices moveable, also color
-  needs to be adjustable
+* decal color needs to be adjustable
 
 * make duplicated objects insert near those from which they where
   cloned (maybe have "Paste" and "Paste On Top")
@@ -763,27 +773,18 @@
 
    - seperate Surface stuff, turn it into a scaleable/rotatable decal quad
    - simple path
-   - full NavigationGraph
    - Sprite
    - Sprite3d / Character
 
 * ObjectSelector/IconView allows drag&drop even when nothing is
   selected, leading to a Grumbel dummy image drag&drop without effect
 
-* add a way to draw objects to DrawingContext that only does
-  translation, but not rotation and scaling, for use in UIElements,
-  overlay text, etc.
-
 * implement dialog to change level properties:
 
   - name
   - ambient color (Gtk::ColorSelection)
   - level size (?)
 
-* SceneModel seems easier to implement then Sandbox'ing, maybe go with
-  that first. TreeModel could be used directly to presenet the Scene,
-  instead of trying to keep to things synced.
-
 * Sandbox Pro&Contra:
 
   + very fast getting in and out of the game
@@ -804,9 +805,6 @@
   settings, more exactly it should be embeddable into a GtkWidget (or
   shall the editor be completly seperate?)
 
-* should objects in the editor be based on real Windstille objects or
-  on mookup objects?
-
 * Editor Toolbar:
 
   - Visualize parent/child relationship (little arrows)



From grumbel at mail.berlios.de  Tue Apr 14 16:27:35 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 14 Apr 2009 16:27:35 +0200
Subject: [Windstille-commit] r2919 - trunk/windstille/src/editor
Message-ID: <200904141427.n3EERZKA028720@sheep.berlios.de>

Author: grumbel
Date: 2009-04-14 16:27:34 +0200 (Tue, 14 Apr 2009)
New Revision: 2919

Modified:
   trunk/windstille/src/editor/object_selector.cpp
   trunk/windstille/src/editor/object_selector.hpp
Log:
Renamed ObjectIconColumn to just Column

Modified: trunk/windstille/src/editor/object_selector.cpp
===================================================================
--- trunk/windstille/src/editor/object_selector.cpp	2009-04-14 02:28:12 UTC (rev 2918)
+++ trunk/windstille/src/editor/object_selector.cpp	2009-04-14 14:27:34 UTC (rev 2919)
@@ -27,31 +27,31 @@
 #include "editor_window.hpp"
 #include "object_selector.hpp"
 
-class ObjectIconColumns : public Gtk::TreeModel::ColumnRecord
+class ObjectSelector::Columns : public Gtk::TreeModel::ColumnRecord
 {
 public:
   Gtk::TreeModelColumn<std::string> url;
   Gtk::TreeModelColumn<std::string> pathname;
   Gtk::TreeModelColumn<Glib::RefPtr<Gdk::Pixbuf> >  icon;
   
-  static ObjectIconColumns& instance() {
+  static ObjectSelector::Columns& instance() {
     if (instance_)
       return *instance_;
     else
-      return *(instance_ = new ObjectIconColumns());
+      return *(instance_ = new ObjectSelector::Columns());
   }
 
 private:
-  static ObjectIconColumns* instance_;
+  static ObjectSelector::Columns* instance_;
 
-  ObjectIconColumns() {
+  Columns() {
     add(pathname); 
     add(url);
     add(icon);
   }
 };
 
-ObjectIconColumns* ObjectIconColumns::instance_ = 0;
+ObjectSelector::Columns* ObjectSelector::Columns::instance_ = 0;
 
 ObjectSelector::ObjectSelector(EditorWindow& editor_)
   : editor(editor_),
@@ -73,7 +73,7 @@
 
   Gtk::Toolbar& toolbar = dynamic_cast<Gtk::Toolbar&>(*ui_manager->get_widget("/ObjectSelectorToolBar"));
   
-  list_store = Gtk::ListStore::create(ObjectIconColumns::instance());
+  list_store = Gtk::ListStore::create(Columns::instance());
 
   // Change background color
   // iconview.modify_base(Gtk::STATE_NORMAL, Gdk::Color("#444444"));
@@ -87,8 +87,8 @@
   iconview.set_column_spacing(0);
   iconview.set_row_spacing(0);
 
-  iconview.set_pixbuf_column(ObjectIconColumns::instance().icon);
-  //iconview.set_text_column(ObjectIconColumns::instance().pathname);
+  iconview.set_pixbuf_column(Columns::instance().icon);
+  //iconview.set_text_column(Columns::instance().pathname);
 
   iconview.set_model(list_store);
 
@@ -125,9 +125,9 @@
 {
   Gtk::ListStore::iterator it = list_store->append();
 
-  (*it)[ObjectIconColumns::instance().pathname] = pathname;
-  (*it)[ObjectIconColumns::instance().url]      = url;
-  (*it)[ObjectIconColumns::instance().icon]     = icon;
+  (*it)[Columns::instance().pathname] = pathname;
+  (*it)[Columns::instance().url]      = url;
+  (*it)[Columns::instance().icon]     = icon;
 }
 
 static bool has_suffix(const std::string& str, const std::string& suffix)
@@ -238,7 +238,7 @@
       ++i)
     {
       Gtk::ListStore::iterator it = list_store->get_iter(*i);
-      iconpath = (*it)[ObjectIconColumns::instance().pathname];
+      iconpath = (*it)[Columns::instance().pathname];
     }
 
   Glib::RefPtr<Gdk::Pixbuf> pixbuf = Gdk::Pixbuf::create_from_file(iconpath);
@@ -270,12 +270,12 @@
 
       if (selection_data.get_target() == "application/x-windstille-decal")
         {
-          const std::string& str = (*it)[ObjectIconColumns::instance().pathname];
+          const std::string& str = (*it)[Columns::instance().pathname];
           selection_data.set(8, reinterpret_cast<const guint8*>(str.c_str()), str.length());
         }
       else
         {
-          const std::string& str = (*it)[ObjectIconColumns::instance().url];
+          const std::string& str = (*it)[Columns::instance().url];
           selection_data.set(8, reinterpret_cast<const guint8*>(str.c_str()), str.length());
         }
     }

Modified: trunk/windstille/src/editor/object_selector.hpp
===================================================================
--- trunk/windstille/src/editor/object_selector.hpp	2009-04-14 02:28:12 UTC (rev 2918)
+++ trunk/windstille/src/editor/object_selector.hpp	2009-04-14 14:27:34 UTC (rev 2919)
@@ -38,6 +38,8 @@
   Gtk::IconView iconview;
   Glib::RefPtr<Gtk::ListStore> list_store;
   
+  class Columns;
+
 public:
   ObjectSelector(EditorWindow& editor);
   virtual ~ObjectSelector();



From grumbel at mail.berlios.de  Tue Apr 14 17:16:34 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 14 Apr 2009 17:16:34 +0200
Subject: [Windstille-commit] r2920 - trunk/windstille/src/editor
Message-ID: <200904141516.n3EFGYkm000037@sheep.berlios.de>

Author: grumbel
Date: 2009-04-14 17:16:33 +0200 (Tue, 14 Apr 2009)
New Revision: 2920

Modified:
   trunk/windstille/src/editor/object_selector.cpp
Log:
Added a ComboBox to the ObjectSelector

Modified: trunk/windstille/src/editor/object_selector.cpp
===================================================================
--- trunk/windstille/src/editor/object_selector.cpp	2009-04-14 14:27:34 UTC (rev 2919)
+++ trunk/windstille/src/editor/object_selector.cpp	2009-04-14 15:16:33 UTC (rev 2920)
@@ -19,7 +19,10 @@
 #include <iostream>
 #include <boost/function.hpp>
 #include <gtkmm/treeselection.h>
+#include <gtkmm/comboboxtext.h>
+#include <gtkmm/separatortoolitem.h>
 #include <gtkmm/stock.h>
+#include <gtkmm/image.h>
 #include <gtkmm/toolbar.h>
 #include <gtkmm/treemodelcolumn.h>
 
@@ -57,6 +60,7 @@
   : editor(editor_),
     label("Object Selector", Gtk::ALIGN_LEFT)
 {
+#if 0
   Glib::RefPtr<Gtk::UIManager>   ui_manager   = editor.get_ui_manager();
   Glib::RefPtr<Gtk::ActionGroup> action_group = Gtk::ActionGroup::create();
 
@@ -72,7 +76,21 @@
                                  "</ui>");
 
   Gtk::Toolbar& toolbar = dynamic_cast<Gtk::Toolbar&>(*ui_manager->get_widget("/ObjectSelectorToolBar"));
-  
+#endif
+
+  Gtk::Button& refresh_button = *Gtk::manage(new Gtk::Button());
+  refresh_button.add(*Gtk::manage(new Gtk::Image(Gtk::Stock::REFRESH, Gtk::ICON_SIZE_MENU)));
+  refresh_button.set_relief(Gtk::RELIEF_NONE);
+  refresh_button.signal_clicked().connect(sigc::mem_fun(*this, &ObjectSelector::refresh));
+
+
+  Gtk::ComboBoxText& combo_box = *Gtk::manage(new Gtk::ComboBoxText());
+  combo_box.append_text("All");
+  combo_box.append_text("Walls & Ground");
+  combo_box.append_text("Decor");
+  combo_box.append_text("Lights");
+  combo_box.append_text("Highlights");
+
   list_store = Gtk::ListStore::create(Columns::instance());
 
   // Change background color
@@ -108,7 +126,12 @@
   scrolled.add(iconview);
   pack_start(label, Gtk::PACK_SHRINK);
 
-  pack_start(toolbar, Gtk::PACK_SHRINK);
+  Gtk::HBox& hbox = *Gtk::manage(new Gtk::HBox());
+  //hbox.pack_start(toolbar,   Gtk::PACK_SHRINK);
+  hbox.pack_start(refresh_button,   Gtk::PACK_SHRINK);
+  hbox.pack_start(combo_box, Gtk::PACK_SHRINK);
+  pack_start(hbox, Gtk::PACK_SHRINK);
+  
   add(scrolled);
   //show_all();
 }



From grumbel at mail.berlios.de  Tue Apr 14 18:03:32 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 14 Apr 2009 18:03:32 +0200
Subject: [Windstille-commit] r2921 - trunk/windstille/src/editor
Message-ID: <200904141603.n3EG3WYb007756@sheep.berlios.de>

Author: grumbel
Date: 2009-04-14 18:03:31 +0200 (Tue, 14 Apr 2009)
New Revision: 2921

Modified:
   trunk/windstille/src/editor/object_selector.cpp
   trunk/windstille/src/editor/object_selector.hpp
Log:
Hooked up ObjectSelector filter (objects don't get have properties to filter on, so it doesn't do much)

Modified: trunk/windstille/src/editor/object_selector.cpp
===================================================================
--- trunk/windstille/src/editor/object_selector.cpp	2009-04-14 15:16:33 UTC (rev 2920)
+++ trunk/windstille/src/editor/object_selector.cpp	2009-04-14 16:03:31 UTC (rev 2921)
@@ -19,7 +19,6 @@
 #include <iostream>
 #include <boost/function.hpp>
 #include <gtkmm/treeselection.h>
-#include <gtkmm/comboboxtext.h>
 #include <gtkmm/separatortoolitem.h>
 #include <gtkmm/stock.h>
 #include <gtkmm/image.h>
@@ -83,22 +82,24 @@
   refresh_button.set_relief(Gtk::RELIEF_NONE);
   refresh_button.signal_clicked().connect(sigc::mem_fun(*this, &ObjectSelector::refresh));
 
+  filter_box.append_text("All");
+  filter_box.append_text("Walls & Ground");
+  filter_box.append_text("Decor");
+  filter_box.append_text("Lights");
+  filter_box.append_text("Highlights");
+  filter_box.set_active(0);
+  filter_box.signal_changed().connect(sigc::mem_fun(*this, &ObjectSelector::on_filter_changed));
 
-  Gtk::ComboBoxText& combo_box = *Gtk::manage(new Gtk::ComboBoxText());
-  combo_box.append_text("All");
-  combo_box.append_text("Walls & Ground");
-  combo_box.append_text("Decor");
-  combo_box.append_text("Lights");
-  combo_box.append_text("Highlights");
-
   list_store = Gtk::ListStore::create(Columns::instance());
-
+  list_filter = Gtk::TreeModelFilter::create(list_store);
+  list_filter->set_visible_func(sigc::mem_fun(*this, &ObjectSelector::filter));
+  
   // Change background color
   // iconview.modify_base(Gtk::STATE_NORMAL, Gdk::Color("#444444"));
   
   set_border_width(1);
 
-  iconview.set_model(list_store);
+  iconview.set_model(list_filter);
 
   // Trying to get spacing to minimum, without much effect
   iconview.set_spacing(0);
@@ -129,7 +130,7 @@
   Gtk::HBox& hbox = *Gtk::manage(new Gtk::HBox());
   //hbox.pack_start(toolbar,   Gtk::PACK_SHRINK);
   hbox.pack_start(refresh_button,   Gtk::PACK_SHRINK);
-  hbox.pack_start(combo_box, Gtk::PACK_SHRINK);
+  hbox.pack_start(filter_box, Gtk::PACK_SHRINK);
   pack_start(hbox, Gtk::PACK_SHRINK);
   
   add(scrolled);
@@ -161,6 +162,12 @@
     return false;
 }
 
+bool
+ObjectSelector::filter(const Gtk::TreeModel::const_iterator& it)
+{
+  return true;
+}
+
 void
 ObjectSelector::add_decals_from_directory(const std::string& pathname)
 {
@@ -249,6 +256,13 @@
   list_store->clear();
   populate();
 }
+
+void
+ObjectSelector::on_filter_changed()
+{
+  std::cout << "on_filter_changed(): " << filter_box.get_active_row_number() << std::endl;
+  list_filter->refilter();
+}
                     
 void
 ObjectSelector::on_drag_begin(const Glib::RefPtr<Gdk::DragContext>& context)

Modified: trunk/windstille/src/editor/object_selector.hpp
===================================================================
--- trunk/windstille/src/editor/object_selector.hpp	2009-04-14 15:16:33 UTC (rev 2920)
+++ trunk/windstille/src/editor/object_selector.hpp	2009-04-14 16:03:31 UTC (rev 2921)
@@ -23,7 +23,9 @@
 #include <gtkmm/scrolledwindow.h>
 #include <gtkmm/label.h>
 #include <gtkmm/liststore.h>
+#include <gtkmm/comboboxtext.h>
 #include <gdkmm/dragcontext.h>
+#include <gtkmm/treemodelfilter.h>
 #include <gtkmm/iconview.h>
 
 class EditorWindow;
@@ -37,7 +39,9 @@
   Gtk::ScrolledWindow scrolled;
   Gtk::IconView iconview;
   Glib::RefPtr<Gtk::ListStore> list_store;
-  
+  Gtk::ComboBoxText filter_box;
+  Glib::RefPtr<Gtk::TreeModelFilter> list_filter;
+
   class Columns;
 
 public:
@@ -52,6 +56,7 @@
 
   void populate();
   void refresh();
+  bool filter(const Gtk::TreeModel::const_iterator& it);
 
 protected:
   void on_drag_begin(const Glib::RefPtr<Gdk::DragContext>& context);
@@ -59,6 +64,8 @@
                         Gtk::SelectionData& selection_data, 
                         guint info, guint time);
   
+  void on_filter_changed();
+
 private:
   ObjectSelector(const ObjectSelector&);
   ObjectSelector& operator=(const ObjectSelector&);



From grumbel at mail.berlios.de  Tue Apr 14 18:56:05 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 14 Apr 2009 18:56:05 +0200
Subject: [Windstille-commit] r2922 - trunk/windstille/src/editor
Message-ID: <200904141656.n3EGu5vN001172@sheep.berlios.de>

Author: grumbel
Date: 2009-04-14 18:55:57 +0200 (Tue, 14 Apr 2009)
New Revision: 2922

Modified:
   trunk/windstille/src/editor/object_selector.cpp
   trunk/windstille/src/editor/object_selector.hpp
Log:
Hooked up Object filter, basically working now (categories are a bit messy)

Modified: trunk/windstille/src/editor/object_selector.cpp
===================================================================
--- trunk/windstille/src/editor/object_selector.cpp	2009-04-14 16:03:31 UTC (rev 2921)
+++ trunk/windstille/src/editor/object_selector.cpp	2009-04-14 16:55:57 UTC (rev 2922)
@@ -34,7 +34,8 @@
 public:
   Gtk::TreeModelColumn<std::string> url;
   Gtk::TreeModelColumn<std::string> pathname;
-  Gtk::TreeModelColumn<Glib::RefPtr<Gdk::Pixbuf> >  icon;
+  Gtk::TreeModelColumn<Glib::RefPtr<Gdk::Pixbuf> > icon;
+  Gtk::TreeModelColumn<uint32_t>    filter_mask;
   
   static ObjectSelector::Columns& instance() {
     if (instance_)
@@ -50,6 +51,7 @@
     add(pathname); 
     add(url);
     add(icon);
+    add(filter_mask);
   }
 };
 
@@ -57,7 +59,8 @@
 
 ObjectSelector::ObjectSelector(EditorWindow& editor_)
   : editor(editor_),
-    label("Object Selector", Gtk::ALIGN_LEFT)
+    label("Object Selector", Gtk::ALIGN_LEFT),
+    filter_mask(OBJECT_GROUP_ALL)
 {
 #if 0
   Glib::RefPtr<Gtk::UIManager>   ui_manager   = editor.get_ui_manager();
@@ -82,11 +85,17 @@
   refresh_button.set_relief(Gtk::RELIEF_NONE);
   refresh_button.signal_clicked().connect(sigc::mem_fun(*this, &ObjectSelector::refresh));
 
-  filter_box.append_text("All");
-  filter_box.append_text("Walls & Ground");
-  filter_box.append_text("Decor");
-  filter_box.append_text("Lights");
-  filter_box.append_text("Highlights");
+  filter_entries.push_back(ComboBoxEntry("All", OBJECT_GROUP_ALL));
+  filter_entries.push_back(ComboBoxEntry("Walls & Ground", OBJECT_GROUP_DECAL | OBJECT_GROUP_WALL | OBJECT_GROUP_GROUND));
+  filter_entries.push_back(ComboBoxEntry("Decor", OBJECT_GROUP_DECAL | OBJECT_GROUP_DECOR));
+  filter_entries.push_back(ComboBoxEntry("Lights", OBJECT_GROUP_LIGHT));
+  filter_entries.push_back(ComboBoxEntry("Highlights", OBJECT_GROUP_HIGHLIGHT));
+
+  for(std::vector<ComboBoxEntry>::const_iterator i = filter_entries.begin(); i != filter_entries.end(); ++i)
+    {
+      filter_box.append_text(i->name);
+    }
+
   filter_box.set_active(0);
   filter_box.signal_changed().connect(sigc::mem_fun(*this, &ObjectSelector::on_filter_changed));
 
@@ -109,8 +118,6 @@
   iconview.set_pixbuf_column(Columns::instance().icon);
   //iconview.set_text_column(Columns::instance().pathname);
 
-  iconview.set_model(list_store);
-
   std::vector<Gtk::TargetEntry> targets;
   //targets.push_back(Gtk::TargetEntry("image/png"));
   targets.push_back(Gtk::TargetEntry("text/uri-list"));
@@ -145,13 +152,15 @@
 void
 ObjectSelector::add_decal(const Glib::RefPtr<Gdk::Pixbuf>& icon,
                           const std::string& pathname,
-                          const std::string& url)
+                          const std::string& url,
+                          uint32_t filter)
 {
   Gtk::ListStore::iterator it = list_store->append();
 
-  (*it)[Columns::instance().pathname] = pathname;
-  (*it)[Columns::instance().url]      = url;
-  (*it)[Columns::instance().icon]     = icon;
+  (*it)[Columns::instance().pathname]    = pathname;
+  (*it)[Columns::instance().url]         = url;
+  (*it)[Columns::instance().icon]        = icon;
+  (*it)[Columns::instance().filter_mask] = filter;
 }
 
 static bool has_suffix(const std::string& str, const std::string& suffix)
@@ -165,11 +174,11 @@
 bool
 ObjectSelector::filter(const Gtk::TreeModel::const_iterator& it)
 {
-  return true;
+  return (*it)[Columns::instance().filter_mask] & filter_mask;
 }
 
 void
-ObjectSelector::add_decals_from_directory(const std::string& pathname)
+ObjectSelector::add_decals_from_directory(const std::string& pathname, uint32_t filter)
 {
   std::vector<Glib::ustring> images;
 
@@ -235,17 +244,18 @@
       }
 
       add_decal(icon, *i, 
-                "file:///home/ingo/projects/windstille/trunk/windstille/" + *i);
+                "file:///home/ingo/projects/windstille/trunk/windstille/" + *i, 
+                filter);
     }
 }
 
 void
 ObjectSelector::populate()
 {
-  add_decals_from_directory("data/images/decal/");
-  add_decals_from_directory("data/images/objects/bar/");
-  add_decals_from_directory("data/images/objects/");
-  add_decals_from_directory("data/images/");
+  add_decals_from_directory("data/images/decal/", OBJECT_GROUP_DECAL);
+  add_decals_from_directory("data/images/objects/bar/", OBJECT_GROUP_DECAL | OBJECT_GROUP_OBJECT | OBJECT_GROUP_DECOR);
+  add_decals_from_directory("data/images/objects/", OBJECT_GROUP_DECAL | OBJECT_GROUP_OBJECT | OBJECT_GROUP_DECOR);
+  add_decals_from_directory("data/images/", OBJECT_GROUP_LIGHT);
   //("data/images/inventory/");
   //("data/images/portraits/");
 }
@@ -261,6 +271,7 @@
 ObjectSelector::on_filter_changed()
 {
   std::cout << "on_filter_changed(): " << filter_box.get_active_row_number() << std::endl;
+  filter_mask = filter_entries[filter_box.get_active_row_number()].filter_mask;
   list_filter->refilter();
 }
                     

Modified: trunk/windstille/src/editor/object_selector.hpp
===================================================================
--- trunk/windstille/src/editor/object_selector.hpp	2009-04-14 16:03:31 UTC (rev 2921)
+++ trunk/windstille/src/editor/object_selector.hpp	2009-04-14 16:55:57 UTC (rev 2922)
@@ -42,17 +42,54 @@
   Gtk::ComboBoxText filter_box;
   Glib::RefPtr<Gtk::TreeModelFilter> list_filter;
 
+  struct ComboBoxEntry {
+    std::string name;
+    uint32_t filter_mask;
+
+    ComboBoxEntry(const std::string& name_, 
+                  uint32_t filter_mask_)
+      : name(name_),
+        filter_mask(filter_mask_)
+    {}
+  };
+
+  std::vector<ComboBoxEntry> filter_entries;
+
   class Columns;
 
+  enum {
+    OBJECT_GROUP_LIGHT      = (1<<0),
+    OBJECT_GROUP_HIGHLIGHT  = (1<<1),
+    OBJECT_GROUP_DECAL      = (1<<2),
+
+    OBJECT_GROUP_GROUND     = (1<<3),
+    OBJECT_GROUP_BACKGROUND = (1<<4),
+    OBJECT_GROUP_WALL       = (1<<5),
+    OBJECT_GROUP_OBJECT     = (1<<6),
+    OBJECT_GROUP_DECOR      = (1<<7),
+    OBJECT_GROUP_DOOR       = (1<<8),
+    OBJECT_GROUP_LAMP       = (1<<9),
+
+    OBJECT_GROUP_CHARACTER  = (1<<10),
+    OBJECT_GROUP_CREATURE   = (1<<11),
+
+    OBJECT_GROUP_PARTICLESYSTEM = (1<<12),
+
+    OBJECT_GROUP_ALL        = ~0
+  };
+
+  uint32_t filter_mask;
+
 public:
   ObjectSelector(EditorWindow& editor);
   virtual ~ObjectSelector();
 
   void add_decal(const Glib::RefPtr<Gdk::Pixbuf>& icon,
                  const std::string& pathname,
-                 const std::string& url);
+                 const std::string& url,
+                 uint32_t filter);
 
-  void add_decals_from_directory(const std::string& pathname);
+  void add_decals_from_directory(const std::string& pathname, uint32_t filter);
 
   void populate();
   void refresh();



From grumbel at mail.berlios.de  Tue Apr 14 22:03:18 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 14 Apr 2009 22:03:18 +0200
Subject: [Windstille-commit] r2923 - trunk/windstille/src/editor
Message-ID: <200904142003.n3EK3I28009581@sheep.berlios.de>

Author: grumbel
Date: 2009-04-14 22:03:17 +0200 (Tue, 14 Apr 2009)
New Revision: 2923

Modified:
   trunk/windstille/src/editor/object_selector.cpp
   trunk/windstille/src/editor/selection.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
Log:
Fixed missing selection_change call causing invalid ControlPoints, cleaned up stdout

Modified: trunk/windstille/src/editor/object_selector.cpp
===================================================================
--- trunk/windstille/src/editor/object_selector.cpp	2009-04-14 16:55:57 UTC (rev 2922)
+++ trunk/windstille/src/editor/object_selector.cpp	2009-04-14 20:03:17 UTC (rev 2923)
@@ -314,7 +314,7 @@
     {
       Gtk::ListStore::iterator it = list_store->get_iter(*i);
 
-      std::cout << "TARGET: " << selection_data.get_target() << std::endl;
+      //std::cout << "TARGET: " << selection_data.get_target() << std::endl;
 
       if (selection_data.get_target() == "application/x-windstille-decal")
         {

Modified: trunk/windstille/src/editor/selection.hpp
===================================================================
--- trunk/windstille/src/editor/selection.hpp	2009-04-14 16:55:57 UTC (rev 2922)
+++ trunk/windstille/src/editor/selection.hpp	2009-04-14 20:03:17 UTC (rev 2923)
@@ -57,6 +57,7 @@
       {
         add(*i);
       }
+    signal_changed();
   }
 
   void add(const ObjectModelHandle& object);
@@ -68,7 +69,7 @@
   Selection::iterator end()   { return objects.end(); }
 
   Selection::reverse_iterator rbegin() { return objects.rbegin(); }
-  Selection::reverse_iterator rend() { return objects.rend(); }
+  Selection::reverse_iterator rend()   { return objects.rend(); }
 
   bool empty() const;
   void clear();

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-14 16:55:57 UTC (rev 2922)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-14 20:03:17 UTC (rev 2923)
@@ -431,10 +431,8 @@
         }
     }
 
-  selection = new_selection;
-
   // Second pass to set the parents to the cloned objects
-  for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
+  for(Selection::iterator i = new_selection->begin(); i != new_selection->end(); ++i)
     {
       if ((*i)->get_parent())
         {
@@ -452,9 +450,7 @@
         }
     }
 
-  on_selection_change();
-
-  queue_draw();
+  set_selection(new_selection);
 }
 
 void
@@ -487,8 +483,9 @@
 WindstilleWidget::mouse_down(GdkEventButton* event)
 {
   grab_focus();
-  std::cout << "Button Press: " << event->x << ", " << event->y << " - " << event->button << std::endl;
-  //ewer->on_mouse_button_down(Vector2i(event->x, event->y), event->button);
+
+  //std::cout << "Button Press: " << event->x << ", " << event->y << " - " << event->button << std::endl;
+
   if (event->button == 1)
     { // Tool
       EditorWindow::current()->get_current_tool()->mouse_down(event, *this);
@@ -543,7 +540,7 @@
 bool
 WindstilleWidget::key_press(GdkEventKey* event)
 {
-  std::cout << event->keyval << " keypress " << state.get_pos() << std::endl;
+  //std::cout << event->keyval << " keypress " << state.get_pos() << std::endl;
 
   switch(event->keyval)
     {
@@ -734,8 +731,6 @@
     }
   
   queue_draw();
-
-  std::cout << "WindstilleWidget::on_selection_change(): " << selection->size() << " " << control_points.size() << std::endl;
 }
 
 ControlPointHandle



From grumbel at mail.berlios.de  Tue Apr 14 22:24:49 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 14 Apr 2009 22:24:49 +0200
Subject: [Windstille-commit] r2924 - trunk/windstille/src/editor
Message-ID: <200904142024.n3EKOnQo012224@sheep.berlios.de>

Author: grumbel
Date: 2009-04-14 22:24:49 +0200 (Tue, 14 Apr 2009)
New Revision: 2924

Modified:
   trunk/windstille/src/editor/select_tool.cpp
   trunk/windstille/src/editor/select_tool.hpp
Log:
Added threshold before objects are moved to make it easier to select them without accidently moving them

Modified: trunk/windstille/src/editor/select_tool.cpp
===================================================================
--- trunk/windstille/src/editor/select_tool.cpp	2009-04-14 20:03:17 UTC (rev 2923)
+++ trunk/windstille/src/editor/select_tool.cpp	2009-04-14 20:24:49 UTC (rev 2924)
@@ -24,6 +24,9 @@
 #include "editor_window.hpp"
 #include "select_tool.hpp"
 
+static const uint32_t MOVE_TIMEOUT = 100;
+static const int MOVE_THRESHOLD = 16.0f;
+
 SelectTool::SelectTool()
   : mode(NO_MODE)
     
@@ -33,6 +36,7 @@
 void
 SelectTool::mouse_down(GdkEventButton* event, WindstilleWidget& wst)
 {
+  start_time = event->time;
   click_pos = wst.get_state().screen_to_world(Vector2f(event->x, event->y));
 
   ctrl_point = wst.get_control_point(click_pos);
@@ -130,14 +134,20 @@
     }
   else if (mode == OBJECT_DRAG_MODE)
     {
-      selection->on_move_update(pos - click_pos);
+      Vector2f offset = pos - click_pos;
+          
+      if ((event->time - start_time) > MOVE_TIMEOUT ||
+          offset.length() > MOVE_THRESHOLD)
+        {
+          selection->on_move_update(offset);
       
-      if (event->state & GDK_CONTROL_MASK)
-        {
-          selection->on_move_update(pos - click_pos + process_snap(wst));
+          if (event->state & GDK_CONTROL_MASK)
+            {
+              selection->on_move_update(pos - click_pos + process_snap(wst));
+            }
+
+          wst.queue_draw();
         }
-
-      wst.queue_draw();
     }
   else if (mode == SELECT_MODE)
     {
@@ -164,17 +174,26 @@
     }
   else if (mode == OBJECT_DRAG_MODE)
     {
-      selection->on_move_update(pos - click_pos);
+      if ((event->time - start_time) > MOVE_TIMEOUT)
+        {
+          Vector2f offset = pos - click_pos;
+
+          if (event->time - start_time > MOVE_TIMEOUT ||
+              offset.length() > MOVE_THRESHOLD)
+            {
+              selection->on_move_update(pos - click_pos);
       
-      if (event->state & GDK_CONTROL_MASK)
-        {
-          selection->on_move_end(pos - click_pos + process_snap(wst));
+              if (event->state & GDK_CONTROL_MASK)
+                {
+                  selection->on_move_end(pos - click_pos + process_snap(wst));
+                }
+              else
+                {
+                  selection->on_move_end(pos - click_pos);
+                }
+              wst.queue_draw();
+            }
         }
-      else
-        {
-          selection->on_move_end(pos - click_pos);
-        }
-      wst.queue_draw();
     }
   else if (mode == SELECT_MODE)
     {

Modified: trunk/windstille/src/editor/select_tool.hpp
===================================================================
--- trunk/windstille/src/editor/select_tool.hpp	2009-04-14 20:03:17 UTC (rev 2923)
+++ trunk/windstille/src/editor/select_tool.hpp	2009-04-14 20:24:49 UTC (rev 2924)
@@ -19,6 +19,8 @@
 #ifndef HEADER_WINDSTILLE_EDITOR_SELECT_TOOL_HPP
 #define HEADER_WINDSTILLE_EDITOR_SELECT_TOOL_HPP
 
+#include <stdint.h>
+
 #include "math/rect.hpp"
 #include "object_model.hpp"
 #include "tool.hpp"
@@ -30,7 +32,8 @@
   Rectf    rect;
   SelectionHandle selection;
   ControlPointHandle ctrl_point;
-
+  uint32_t start_time;
+  
   enum { 
     SELECT_MODE,
     OBJECT_DRAG_MODE,



From grumbel at mail.berlios.de  Tue Apr 14 22:25:09 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 14 Apr 2009 22:25:09 +0200
Subject: [Windstille-commit] r2925 - trunk/windstille
Message-ID: <200904142025.n3EKP9ML012266@sheep.berlios.de>

Author: grumbel
Date: 2009-04-14 22:25:08 +0200 (Tue, 14 Apr 2009)
New Revision: 2925

Modified:
   trunk/windstille/TODO
Log:
Added threshold before objects are moved to make it easier to select them without accidently moving them

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-04-14 20:24:49 UTC (rev 2924)
+++ trunk/windstille/TODO	2009-04-14 20:25:08 UTC (rev 2925)
@@ -517,6 +517,8 @@
 Editor
 ======
 
+* figure out a way to rename image files without breaking the levels
+
 * new boost1.37 seems to be missing boost_signals, instead it has
   boost_signals-mt, do we want to get funcky with configure checks or
   ignore and stay boost1.35 or so?
@@ -548,7 +550,8 @@
 * make NavGraph insert tool automatically split edge when new nodes is
   on edge
 
-* add keyboard shortcuts to flatten current NodeSelection
+* add keyboard shortcuts to flatten (set same x or y value for all)
+  current NodeSelection, also add snapping to grid and stuff
 
 * add a way to delete navgraph nodes (need to move Selection out of
   tool, generalize it or just use right button)
@@ -587,9 +590,6 @@
 
 * maybe have different RGB and RGBA Textures in the TexturePacker
 
-* add a tiny timeout before an objects can be moved, so that its
-  easier to mark an object without accidently moving it
-
 * share SoftwareSurface via Manager class, generalize Manager classes
   -> template
 



From grumbel at mail.berlios.de  Tue Apr 14 22:44:36 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 14 Apr 2009 22:44:36 +0200
Subject: [Windstille-commit] r2926 - trunk/windstille/src/editor
Message-ID: <200904142044.n3EKiaPZ013789@sheep.berlios.de>

Author: grumbel
Date: 2009-04-14 22:44:35 +0200 (Tue, 14 Apr 2009)
New Revision: 2926

Modified:
   trunk/windstille/src/editor/control_point.cpp
   trunk/windstille/src/editor/select_tool.cpp
   trunk/windstille/src/editor/windstille_widget.cpp
Log:
Fixed some more issues with election not properly updated

Modified: trunk/windstille/src/editor/control_point.cpp
===================================================================
--- trunk/windstille/src/editor/control_point.cpp	2009-04-14 20:25:08 UTC (rev 2925)
+++ trunk/windstille/src/editor/control_point.cpp	2009-04-14 20:44:35 UTC (rev 2926)
@@ -53,8 +53,6 @@
 ControlPoint::on_move_end(GdkEventButton* event, const Vector2f& offset_)
 {
   offset = offset_;
-  std::cout << "on_move_end: " << offset << std::endl;
-
   offset = Vector2f();
 }
 

Modified: trunk/windstille/src/editor/select_tool.cpp
===================================================================
--- trunk/windstille/src/editor/select_tool.cpp	2009-04-14 20:25:08 UTC (rev 2925)
+++ trunk/windstille/src/editor/select_tool.cpp	2009-04-14 20:44:35 UTC (rev 2926)
@@ -79,7 +79,6 @@
             }
       
           mode = OBJECT_DRAG_MODE;
-          selection->on_move_start();
         }
       else
         {
@@ -139,11 +138,14 @@
       if ((event->time - start_time) > MOVE_TIMEOUT ||
           offset.length() > MOVE_THRESHOLD)
         {
+          if (!selection->is_moving())
+            selection->on_move_start();
+
           selection->on_move_update(offset);
       
           if (event->state & GDK_CONTROL_MASK)
             {
-              selection->on_move_update(pos - click_pos + process_snap(wst));
+              selection->on_move_update(offset + process_snap(wst));
             }
 
           wst.queue_draw();
@@ -174,25 +176,22 @@
     }
   else if (mode == OBJECT_DRAG_MODE)
     {
-      if ((event->time - start_time) > MOVE_TIMEOUT)
-        {
-          Vector2f offset = pos - click_pos;
+      Vector2f offset = pos - click_pos;
 
-          if (event->time - start_time > MOVE_TIMEOUT ||
-              offset.length() > MOVE_THRESHOLD)
-            {
-              selection->on_move_update(pos - click_pos);
+      if (event->time - start_time > MOVE_TIMEOUT ||
+          offset.length() > MOVE_THRESHOLD)
+        {
+          selection->on_move_update(offset);
       
-              if (event->state & GDK_CONTROL_MASK)
-                {
-                  selection->on_move_end(pos - click_pos + process_snap(wst));
-                }
-              else
-                {
-                  selection->on_move_end(pos - click_pos);
-                }
-              wst.queue_draw();
+          if (event->state & GDK_CONTROL_MASK)
+            {
+              selection->on_move_end(offset + process_snap(wst));
             }
+          else
+            {
+              selection->on_move_end(offset);
+            }
+          wst.queue_draw();
         }
     }
   else if (mode == SELECT_MODE)

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-14 20:25:08 UTC (rev 2925)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-14 20:44:35 UTC (rev 2926)
@@ -674,7 +674,7 @@
 WindstilleWidget::set_selection(const SelectionHandle& selection_)
 {
   selection = selection_;
-  selection->signal_changed.connect(sigc::mem_fun(this, &WindstilleWidget::on_selection_change));
+  selection->signal_changed.connect(sigc::mem_fun(*this, &WindstilleWidget::on_selection_change));
   on_selection_change();
 }
 



From grumbel at mail.berlios.de  Tue Apr 14 23:22:22 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 14 Apr 2009 23:22:22 +0200
Subject: [Windstille-commit] r2927 - trunk/windstille/src/editor
Message-ID: <200904142122.n3ELMM3m016388@sheep.berlios.de>

Author: grumbel
Date: 2009-04-14 23:22:22 +0200 (Tue, 14 Apr 2009)
New Revision: 2927

Modified:
   trunk/windstille/src/editor/decal_rotate_control_point.cpp
Log:
Added snapping to multiple of 22.5 degree angles when control is held

Modified: trunk/windstille/src/editor/decal_rotate_control_point.cpp
===================================================================
--- trunk/windstille/src/editor/decal_rotate_control_point.cpp	2009-04-14 20:44:35 UTC (rev 2926)
+++ trunk/windstille/src/editor/decal_rotate_control_point.cpp	2009-04-14 21:22:22 UTC (rev 2927)
@@ -45,6 +45,13 @@
   float current_angle = atan2(current.y, current.x);
 
   float new_angle = orig_angle + current_angle - base_angle;
+
+  if (event->state & GDK_CONTROL_MASK)
+    {
+      float steps = 16.0f;
+      new_angle = roundf((new_angle / (2*M_PI)) * steps) / steps * 2*M_PI;
+    }
+
   object->set_angle(new_angle);
 }
   



From grumbel at mail.berlios.de  Tue Apr 14 23:57:38 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Tue, 14 Apr 2009 23:57:38 +0200
Subject: [Windstille-commit] r2928 - trunk/windstille/src/editor
Message-ID: <200904142157.n3ELvco7020260@sheep.berlios.de>

Author: grumbel
Date: 2009-04-14 23:57:36 +0200 (Tue, 14 Apr 2009)
New Revision: 2928

Modified:
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/windstille_widget.cpp
   trunk/windstille/src/editor/windstille_widget.hpp
Log:
Added ResetRotation and ResetScale to context menu

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-14 21:22:22 UTC (rev 2927)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-14 21:57:36 UTC (rev 2928)
@@ -125,6 +125,7 @@
     "      <menuitem action='ToggleLightLayer'/>"
     "      <menuitem action='ToggleHighlightLayer'/>"
     "      <menuitem action='ToggleControlLayer'/>"
+    "      <separator/>"
     "      <menuitem action='ToggleBackgroundLayer'/>"
     "      <menuitem action='ToggleVisibleLayer'/>"
     "      <menuitem action='ToggleGridLayer'/>"
@@ -187,6 +188,7 @@
     "    <toolitem action='ToggleLightLayer'/>"
     "    <toolitem action='ToggleHighlightLayer'/>"
     "    <toolitem action='ToggleControlLayer'/>"
+    "    <separator/>"
     "    <toolitem action='ToggleBackgroundLayer'/>"
     "    <toolitem action='ToggleVisibleLayer'/>"
     "    <toolitem action='ToggleGridLayer'/>"
@@ -263,6 +265,11 @@
   action_group->add(Gtk::Action::create_with_icon_name("ClearParent", "clear_parent", "Clear Parent", "Clear Parent"),
                     sigc::bind(sigc::mem_fun(*this, &EditorWindow::call_with_windstille_widget), &WindstilleWidget::selection_clear_parent));
 
+  action_group->add(Gtk::Action::create_with_icon_name("ResetRotation", "reload", "Reset Rotation", "Reset Rotation"),
+                    sigc::bind(sigc::mem_fun(*this, &EditorWindow::call_with_windstille_widget), &WindstilleWidget::selection_reset_rotation));
+  action_group->add(Gtk::Action::create_with_icon_name("ResetScale", "reload", "Reset Scale", "Reset Scale"),
+                    sigc::bind(sigc::mem_fun(*this, &EditorWindow::call_with_windstille_widget), &WindstilleWidget::selection_reset_scale));
+
   action_group->add(Gtk::Action::create_with_icon_name("HFlipObject", "object_hflip", "Horizontal Flip", "Horizontal Flip"),
                     sigc::bind(sigc::mem_fun(*this, &EditorWindow::call_with_windstille_widget), &WindstilleWidget::selection_hflip));
   action_group->add(Gtk::Action::create_with_icon_name("VFlipObject", "object_vflip", "Vertical Flip", "Vertical Flip"),

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-14 21:22:22 UTC (rev 2927)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-14 21:57:36 UTC (rev 2928)
@@ -69,6 +69,9 @@
                                    "    <menuitem action='HFlipObject'/>"
                                    "    <menuitem action='VFlipObject'/>"
                                    "    <separator/>"
+                                   "    <menuitem action='ResetRotation'/>"
+                                   "    <menuitem action='ResetScale'/>"
+                                   "    <separator/>"
                                    "    <menuitem action='Delete'/>"
                                    //"    <menuitem action='ObjectReset'/>"
                                    "  </popup>"
@@ -454,6 +457,36 @@
 }
 
 void
+WindstilleWidget::selection_reset_rotation()
+{
+  for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
+    {
+      DecalObjectModel* decal = dynamic_cast<DecalObjectModel*>(i->get());
+      if (decal)
+        {
+          decal->set_angle(0.0f);
+        }
+    }
+  on_selection_change();
+  queue_draw();
+}
+
+void
+WindstilleWidget::selection_reset_scale()
+{
+ for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
+    {
+      DecalObjectModel* decal = dynamic_cast<DecalObjectModel*>(i->get());
+      if (decal)
+        {
+          decal->set_scale(Vector2f(1.0f, 1.0f));
+        }
+    }
+ on_selection_change();
+ queue_draw();
+}
+
+void
 WindstilleWidget::selection_delete()
 {
  for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)

Modified: trunk/windstille/src/editor/windstille_widget.hpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.hpp	2009-04-14 21:22:22 UTC (rev 2927)
+++ trunk/windstille/src/editor/windstille_widget.hpp	2009-04-14 21:57:36 UTC (rev 2928)
@@ -118,6 +118,9 @@
   void selection_duplicate();
   void selection_delete();
 
+  void selection_reset_rotation();
+  void selection_reset_scale();
+
   SectorModel* get_sector_model();
   void set_selection(const SelectionHandle& selection);
   SelectionHandle get_selection() const;



From grumbel at mail.berlios.de  Wed Apr 15 00:06:51 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 15 Apr 2009 00:06:51 +0200
Subject: [Windstille-commit] r2929 - in trunk/windstille: data/editor
	src/editor
Message-ID: <200904142206.n3EM6pov022314@sheep.berlios.de>

Author: grumbel
Date: 2009-04-15 00:06:50 +0200 (Wed, 15 Apr 2009)
New Revision: 2929

Added:
   trunk/windstille/data/editor/properties.png
Modified:
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/windstille_widget.cpp
   trunk/windstille/src/editor/windstille_widget.hpp
Log:
Added ObjectProperties dummy button

Added: trunk/windstille/data/editor/properties.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/editor/properties.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-14 21:57:36 UTC (rev 2928)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-14 22:06:50 UTC (rev 2929)
@@ -85,8 +85,8 @@
     "      <menuitem action='Copy'/>"
     "      <menuitem action='Paste'/>"
     "      <separator/>"
+    "      <menuitem action='Duplicate'/>"
     "      <menuitem action='Delete'/>"
-    "      <menuitem action='Duplicate'/>"
     "      <separator/>"
     "      <menuitem action='SelectAll'/>"
     "    </menu>"
@@ -155,8 +155,8 @@
     "    <toolitem action='Copy'/>"
     "    <toolitem action='Paste'/>"
     "    <separator/>"
+    "    <toolitem action='Duplicate'/>"
     "    <toolitem action='Delete'/>"
-    "    <toolitem action='Duplicate'/>"
     "    <separator/>"
     "    <toolitem action='ZoomIn'/>"
     "    <toolitem action='ZoomOut'/>"
@@ -270,6 +270,9 @@
   action_group->add(Gtk::Action::create_with_icon_name("ResetScale", "reload", "Reset Scale", "Reset Scale"),
                     sigc::bind(sigc::mem_fun(*this, &EditorWindow::call_with_windstille_widget), &WindstilleWidget::selection_reset_scale));
 
+  action_group->add(Gtk::Action::create_with_icon_name("ObjectProperties", "properties", "Object Properties", "Object Properties"),
+                    sigc::bind(sigc::mem_fun(*this, &EditorWindow::call_with_windstille_widget), &WindstilleWidget::selection_object_properties));
+
   action_group->add(Gtk::Action::create_with_icon_name("HFlipObject", "object_hflip", "Horizontal Flip", "Horizontal Flip"),
                     sigc::bind(sigc::mem_fun(*this, &EditorWindow::call_with_windstille_widget), &WindstilleWidget::selection_hflip));
   action_group->add(Gtk::Action::create_with_icon_name("VFlipObject", "object_vflip", "Vertical Flip", "Vertical Flip"),

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-14 21:57:36 UTC (rev 2928)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-14 22:06:50 UTC (rev 2929)
@@ -62,6 +62,7 @@
     ui_manager->add_ui_from_string("<ui>"
                                    "  <popup name='PopupMenu'>"
                                    "    <menuitem action='Duplicate'/>"
+                                   "    <menuitem action='Delete'/>"
                                    "    <separator/>"
                                    "    <menuitem action='ConnectParent'/>"
                                    "    <menuitem action='ClearParent'/>"
@@ -72,7 +73,7 @@
                                    "    <menuitem action='ResetRotation'/>"
                                    "    <menuitem action='ResetScale'/>"
                                    "    <separator/>"
-                                   "    <menuitem action='Delete'/>"
+                                   "    <menuitem action='ObjectProperties'/>"
                                    //"    <menuitem action='ObjectReset'/>"
                                    "  </popup>"
                                    "</ui>");
@@ -472,6 +473,12 @@
 }
 
 void
+WindstilleWidget::selection_object_properties()
+{
+  std::cout << "Display Dialog" << std::endl;
+}
+
+void
 WindstilleWidget::selection_reset_scale()
 {
  for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)

Modified: trunk/windstille/src/editor/windstille_widget.hpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.hpp	2009-04-14 21:57:36 UTC (rev 2928)
+++ trunk/windstille/src/editor/windstille_widget.hpp	2009-04-14 22:06:50 UTC (rev 2929)
@@ -121,6 +121,8 @@
   void selection_reset_rotation();
   void selection_reset_scale();
 
+  void selection_object_properties();
+
   SectorModel* get_sector_model();
   void set_selection(const SelectionHandle& selection);
   SelectionHandle get_selection() const;



From grumbel at mail.berlios.de  Wed Apr 15 01:24:36 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 15 Apr 2009 01:24:36 +0200
Subject: [Windstille-commit] r2930 - trunk/windstille/src/editor
Message-ID: <200904142324.n3ENOagH017365@sheep.berlios.de>

Author: grumbel
Date: 2009-04-15 01:24:35 +0200 (Wed, 15 Apr 2009)
New Revision: 2930

Modified:
   trunk/windstille/src/editor/object_selector.cpp
   trunk/windstille/src/editor/object_selector.hpp
Log:
Properly convert the iterator to look in the list_filter not in the list_store

Modified: trunk/windstille/src/editor/object_selector.cpp
===================================================================
--- trunk/windstille/src/editor/object_selector.cpp	2009-04-14 22:06:50 UTC (rev 2929)
+++ trunk/windstille/src/editor/object_selector.cpp	2009-04-14 23:24:35 UTC (rev 2930)
@@ -99,17 +99,14 @@
   filter_box.set_active(0);
   filter_box.signal_changed().connect(sigc::mem_fun(*this, &ObjectSelector::on_filter_changed));
 
-  list_store = Gtk::ListStore::create(Columns::instance());
+  list_store  = Gtk::ListStore::create(Columns::instance());
   list_filter = Gtk::TreeModelFilter::create(list_store);
   list_filter->set_visible_func(sigc::mem_fun(*this, &ObjectSelector::filter));
+  iconview.set_model(list_filter);
   
   // Change background color
   // iconview.modify_base(Gtk::STATE_NORMAL, Gdk::Color("#444444"));
-  
-  set_border_width(1);
 
-  iconview.set_model(list_filter);
-
   // Trying to get spacing to minimum, without much effect
   iconview.set_spacing(0);
   iconview.set_column_spacing(0);
@@ -119,7 +116,6 @@
   //iconview.set_text_column(Columns::instance().pathname);
 
   std::vector<Gtk::TargetEntry> targets;
-  //targets.push_back(Gtk::TargetEntry("image/png"));
   targets.push_back(Gtk::TargetEntry("text/uri-list"));
   targets.push_back(Gtk::TargetEntry("STRING"));
   targets.push_back(Gtk::TargetEntry("text/plain"));
@@ -262,7 +258,6 @@
 void
 ObjectSelector::refresh()
 {
-  std::cout << "ObjectSelector::refresh()" << std::endl;
   list_store->clear();
   populate();
 }
@@ -270,7 +265,6 @@
 void
 ObjectSelector::on_filter_changed()
 {
-  std::cout << "on_filter_changed(): " << filter_box.get_active_row_number() << std::endl;
   filter_mask = filter_entries[filter_box.get_active_row_number()].filter_mask;
   list_filter->refilter();
 }
@@ -285,7 +279,9 @@
       i != selection.end();
       ++i)
     {
-      Gtk::ListStore::iterator it = list_store->get_iter(*i);
+      Gtk::TreeModel::Path path = list_filter->convert_path_to_child_path(*i);
+      Gtk::ListStore::iterator it = list_store->get_iter(path);
+
       iconpath = (*it)[Columns::instance().pathname];
     }
 
@@ -306,16 +302,15 @@
 {
   //std::cout << "ObjectSelector: on_drag_data_get" << std::endl;
 
-  Gtk::IconView::ArrayHandle_TreePaths selection = iconview.get_selected_items();
+  const Gtk::IconView::ArrayHandle_TreePaths& selection = iconview.get_selected_items();
 
-  for(Gtk::IconView::ArrayHandle_TreePaths::iterator i = selection.begin();
+  for(Gtk::IconView::ArrayHandle_TreePaths::const_iterator i = selection.begin();
       i != selection.end();
       ++i)
     {
-      Gtk::ListStore::iterator it = list_store->get_iter(*i);
+      Gtk::TreeModel::Path path = list_filter->convert_path_to_child_path(*i);
+      Gtk::ListStore::iterator it = list_store->get_iter(path);
 
-      //std::cout << "TARGET: " << selection_data.get_target() << std::endl;
-
       if (selection_data.get_target() == "application/x-windstille-decal")
         {
           const std::string& str = (*it)[Columns::instance().pathname];

Modified: trunk/windstille/src/editor/object_selector.hpp
===================================================================
--- trunk/windstille/src/editor/object_selector.hpp	2009-04-14 22:06:50 UTC (rev 2929)
+++ trunk/windstille/src/editor/object_selector.hpp	2009-04-14 23:24:35 UTC (rev 2930)
@@ -38,10 +38,11 @@
   Gtk::Label label;
   Gtk::ScrolledWindow scrolled;
   Gtk::IconView iconview;
-  Glib::RefPtr<Gtk::ListStore> list_store;
-  Gtk::ComboBoxText filter_box;
+  Glib::RefPtr<Gtk::ListStore>       list_store;
   Glib::RefPtr<Gtk::TreeModelFilter> list_filter;
 
+  Gtk::ComboBoxText filter_box;
+
   struct ComboBoxEntry {
     std::string name;
     uint32_t filter_mask;



From grumbel at mail.berlios.de  Wed Apr 15 02:45:37 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 15 Apr 2009 02:45:37 +0200
Subject: [Windstille-commit] r2931 - trunk/windstille
Message-ID: <200904150045.n3F0jbMT011133@sheep.berlios.de>

Author: grumbel
Date: 2009-04-15 02:45:36 +0200 (Wed, 15 Apr 2009)
New Revision: 2931

Modified:
   trunk/windstille/COPYING
Log:
Updated COPYING some more (src: GPL, data: GPL/CC-by-sa)

Modified: trunk/windstille/COPYING
===================================================================
--- trunk/windstille/COPYING	2009-04-14 23:24:35 UTC (rev 2930)
+++ trunk/windstille/COPYING	2009-04-15 00:45:36 UTC (rev 2931)
@@ -1,76 +1,62 @@
-Source Code
-============
+Windstille License
+===================
 
-The main source code of Windstille (src/) is covered under the GPLv3
-or later, as indicated at the top of the files. You can find the full
-license text at:
+Windstille is Free Software. The main source code of Windstille, along
+with the build files and supporting scripts is covered under the
+"GPLv3 or (at your option) any later version", as indicated at the top
+of the files. You can find the full license text of the GPLv3 at:
 
  * http://www.gnu.org/copyleft/gpl.html
 
+Graphics, story, levels and other data files in Windstille are
+dual-licensed and covered under both the "GPLv3 or (at your option) any
+later version" and under the "Creative Commons Attribution-ShareAlike
+3.0". You can find the full license text of the "Creative Commons
+Attribution-ShareAlike 3.0" at:
+
+ * http://creativecommons.org/licenses/by-sa/3.0/
+
+
 Short Summary:
+--------------
 
  * You are allowed to modify Windstille.
 
  * You are allowed to redistribute Windstille.
 
- * Your modifications must themselves be covered under the GPLv3 and
-   source code must be provided.
+ * Modified versions of Windstille or projects using Windstille assets
+   must fall under the same license as Windstille itself (i.e. GPLv3
+   for source code, GPLv3 or "Creative Commons Attribution-ShareAlike
+   3.0" for graphics and other data)
 
+
 Extra Notes:
+------------
 
  * The GPL does not apply to external libraries, found in the
-   external/ directory, those libraries come under their own licenses,
-   see the respective directories for details.
+   external/ directory, those libraries come under their own GPL
+   compatible licenses, see the respective directories for details.
 
-
-Graphics
-========
-
-Graphics (.png, .xcf, .blend) in Windstille are covered under Creative
-Commons Attribution-ShareAlike 3.0 or later (cc-by-sa). You can find
-the full license text at:
-
- * http://creativecommons.org/licenses/by-sa/3.0/
-
-Short Summary:
-
- * You are allowed to modify Windstille Graphics.
-
- * You are allowed to redistribute Windstille Graphics.
-
- * Your modified works must themselves be covered under the cc-by-sa.
-
-Extra Notes:
-
- * In the context of Windstille the GPLv3 is considered a "compatible
-   license", so feel free to use the graphics in a GPL covered
-   project.
-
  * You are not allowed to reuse Windstille assets in a project that
-   isn't, as a whole, either covered by the GPL or CC-by-sa. Namely
-   using Windstille assets in a "Freeware" or "Shareware" title is
-   strictly forbidden.
+   isn't, as a whole, either covered by the GPL or Creative Commons
+   Attribution-ShareAlike. Namely using Windstille assets in a
+   "Freeware" or "Shareware" title is strictly forbidden.
 
- * While not strictly required, you should include "source code"
-   (.blend, .xcf, ...) for the graphics whenever possible.
+ * While not required under the "Creative Commons Attribution-
+   ShareAlike 3.0", you should include "source code" (.blend, .xcf,
+   ...)  for the graphics and other datafiles whenever possible.
 
+ * The source files (.xcf, .blend) for data are located in the media/
+   subdirectory of the SVN repository, however not every data file has
+   a source file associated with it, in those cases the data file is
+   itself the source.
 
-Music
-=====
 
-<insert explanation here>
+Exceptions:
+-----------
+ 
+  * music files in data/music/ and sounds in data/sounds/ are covered
+    under the GPL only, not "Creative Commons Attribution-ShareAlike"
 
 
-Sound Effects
-=============
-
-<insert explanation here>
-
-
-Scripts, Levels and Story
-==========================
-
-<insert explanation here>
-
-
 # EOF #



From grumbel at mail.berlios.de  Mon Apr 20 06:21:57 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Mon, 20 Apr 2009 06:21:57 +0200
Subject: [Windstille-commit] r2932 - trunk/media/images/gui
Message-ID: <200904200421.n3K4LvCo001912@sheep.berlios.de>

Author: grumbel
Date: 2009-04-20 06:21:55 +0200 (Mon, 20 Apr 2009)
New Revision: 2932

Added:
   trunk/media/images/gui/gamecube.svg
   trunk/media/images/gui/playstation.svg
   trunk/media/images/gui/xbox360.svg
Log:
Some game controller images as SVG

Added: trunk/media/images/gui/gamecube.svg
===================================================================
--- trunk/media/images/gui/gamecube.svg	2009-04-15 00:45:36 UTC (rev 2931)
+++ trunk/media/images/gui/gamecube.svg	2009-04-20 04:21:55 UTC (rev 2932)
@@ -0,0 +1,610 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no"?>
+<!-- Created with Inkscape (http://www.inkscape.org/) -->
+<svg
+   xmlns:dc="http://purl.org/dc/elements/1.1/"
+   xmlns:cc="http://creativecommons.org/ns#"
+   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
+   xmlns:svg="http://www.w3.org/2000/svg"
+   xmlns="http://www.w3.org/2000/svg"
+   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
+   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
+   width="667.92609"
+   height="478.66144"
+   id="svg2"
+   sodipodi:version="0.32"
+   inkscape:version="0.46"
+   sodipodi:docname="gamecube.svg"
+   inkscape:output_extension="org.inkscape.output.svg.inkscape"
+   version="1.0"
+   style="display:inline">
+  <defs
+     id="defs4">
+    <linearGradient
+       id="linearGradient3287">
+      <stop
+         style="stop-color:#4d4d4d;stop-opacity:1;"
+         offset="0"
+         id="stop3289" />
+      <stop
+         style="stop-color:#4d4d4d;stop-opacity:0;"
+         offset="1"
+         id="stop3291" />
+    </linearGradient>
+    <inkscape:perspective
+       sodipodi:type="inkscape:persp3d"
+       inkscape:vp_x="0 : 526.18109 : 1"
+       inkscape:vp_y="0 : 1000 : 0"
+       inkscape:vp_z="744.09448 : 526.18109 : 1"
+       inkscape:persp3d-origin="372.04724 : 350.78739 : 1"
+       id="perspective10" />
+    <inkscape:perspective
+       id="perspective2390"
+       inkscape:persp3d-origin="372.04724 : 350.78739 : 1"
+       inkscape:vp_z="744.09448 : 526.18109 : 1"
+       inkscape:vp_y="0 : 1000 : 0"
+       inkscape:vp_x="0 : 526.18109 : 1"
+       sodipodi:type="inkscape:persp3d" />
+    <clipPath
+       id="clp43">
+      <path
+         id="path17725"
+         d="M 564.1,1054.8 L 660,1054.8 L 660,1081 L 564.1,1081 L 564.1,1054.8 z" />
+    </clipPath>
+    <clipPath
+       id="clp44">
+      <path
+         id="path17731"
+         d="M 570.68,1072.3 L 570.67,1063 L 578.78,1058.3 L 578.78,1061.2 L 573.17,1064.4 L 573.17,1070.8 L 570.68,1072.3" />
+    </clipPath>
+    <clipPath
+       id="clp38">
+      <path
+         id="path17691"
+         d="M 564.1,1054.8 L 660,1054.8 L 660,1081 L 564.1,1081 L 564.1,1054.8 z" />
+    </clipPath>
+    <clipPath
+       id="clp39">
+      <path
+         id="path17697"
+         d="M 578.75,1067.6 L 574.98,1069.8 L 578.75,1072 L 582.29,1069.9 L 586.57,1072.4 L 586.84,1072.3 L 578.75,1067.6" />
+    </clipPath>
+    <clipPath
+       id="clp33">
+      <path
+         id="path17657"
+         d="M 564.1,1054.8 L 660,1054.8 L 660,1081 L 564.1,1081 L 564.1,1054.8 z" />
+    </clipPath>
+    <clipPath
+       id="clp34">
+      <path
+         id="path17663"
+         d="M 578.75,1067.6 L 586.84,1072.3 L 586.84,1063 L 578.78,1058.3 L 578.78,1061.2 L 584.38,1064.4 L 584.38,1067.8 L 582.55,1066.7 L 582.55,1065.4 L 578.75,1063.3 L 578.75,1067.6" />
+    </clipPath>
+    <clipPath
+       id="clp28">
+      <path
+         id="path17623"
+         d="M 564.1,1054.8 L 660,1054.8 L 660,1081 L 564.1,1081 L 564.1,1054.8 z" />
+    </clipPath>
+    <clipPath
+       id="clp29">
+      <path
+         id="path17629"
+         d="M 578.75,1063.3 L 578.75,1067.6 L 574.98,1069.8 L 574.98,1065.4 L 578.75,1063.3" />
+    </clipPath>
+    <clipPath
+       id="clp23">
+      <path
+         id="path17589"
+         d="M 564.1,1054.8 L 660,1054.8 L 660,1081 L 564.1,1081 L 564.1,1054.8 z" />
+    </clipPath>
+    <clipPath
+       id="clp24">
+      <path
+         id="path17595"
+         d="M 584.38,1064.4 L 584.38,1067.8 L 584.1,1067.6 L 584.1,1064.5 L 584.38,1064.4" />
+    </clipPath>
+    <clipPath
+       id="clp18">
+      <path
+         id="path17555"
+         d="M 564.1,1054.8 L 660,1054.8 L 660,1081 L 564.1,1081 L 564.1,1054.8 z" />
+    </clipPath>
+    <clipPath
+       id="clp19">
+      <path
+         id="path17561"
+         d="M 573.17,1064.4 L 578.78,1061.2 L 584.38,1064.4 L 584.1,1064.6 L 578.75,1061.5 L 573.45,1064.6 L 573.17,1064.4" />
+    </clipPath>
+    <clipPath
+       id="clp13">
+      <path
+         id="path17521"
+         d="M 564.1,1054.8 L 660,1054.8 L 660,1081 L 564.1,1081 L 564.1,1054.8 z" />
+    </clipPath>
+    <clipPath
+       id="clp14">
+      <path
+         id="path17527"
+         d="M 584.85,1073.4 L 578.74,1077 L 570.68,1072.3 L 573.17,1070.8 L 578.76,1074.1 L 582.39,1072 L 584.85,1073.4" />
+    </clipPath>
+    <clipPath
+       id="clp8">
+      <path
+         id="path17485"
+         d="M 564.1,1054.8 L 660,1054.8 L 660,1081 L 564.1,1081 L 564.1,1054.8 z" />
+    </clipPath>
+    <clipPath
+       id="clp9">
+      <path
+         id="path17491"
+         d="M 582.39,1071.7 L 578.76,1073.8 L 578.76,1074.1 L 582.39,1072 L 582.39,1071.7" />
+    </clipPath>
+    <inkscape:perspective
+       id="perspective3517"
+       inkscape:persp3d-origin="389.49554 : 70.713852 : 1"
+       inkscape:vp_z="778.99109 : 106.07078 : 1"
+       inkscape:vp_y="0 : 1000 : 0"
+       inkscape:vp_x="0 : 106.07078 : 1"
+       sodipodi:type="inkscape:persp3d" />
+    <clipPath
+       id="clipPath107145">
+      <path
+         d="M 564.1,1054.8 L 660,1054.8 L 660,1081 L 564.1,1081 L 564.1,1054.8 z"
+         id="path107147" />
+    </clipPath>
+    <clipPath
+       id="clipPath107115">
+      <path
+         d="M 564.1,1054.8 L 660,1054.8 L 660,1081 L 564.1,1081 L 564.1,1054.8 z"
+         id="path107117" />
+    </clipPath>
+    <clipPath
+       id="clipPath107100">
+      <path
+         d="M 564.1,1054.8 L 660,1054.8 L 660,1081 L 564.1,1081 L 564.1,1054.8 z"
+         id="path107102" />
+    </clipPath>
+    <clipPath
+       id="clipPath107085">
+      <path
+         d="M 564.1,1054.8 L 660,1054.8 L 660,1081 L 564.1,1081 L 564.1,1054.8 z"
+         id="path107087" />
+    </clipPath>
+    <clipPath
+       id="clipPath107054">
+      <path
+         d="M 564.1,1054.8 L 660,1054.8 L 660,1081 L 564.1,1081 L 564.1,1054.8 z"
+         id="path107056" />
+    </clipPath>
+  </defs>
+  <sodipodi:namedview
+     id="base"
+     pagecolor="#ffffff"
+     bordercolor="#666666"
+     borderopacity="1.0"
+     gridtolerance="10000"
+     guidetolerance="10"
+     objecttolerance="10"
+     inkscape:pageopacity="0.0"
+     inkscape:pageshadow="2"
+     inkscape:zoom="0.72693604"
+     inkscape:cx="306.01667"
+     inkscape:cy="416.13014"
+     inkscape:document-units="px"
+     inkscape:current-layer="layer1"
+     showgrid="false"
+     showguides="true"
+     inkscape:guide-bbox="true"
+     inkscape:window-width="1678"
+     inkscape:window-height="980"
+     inkscape:window-x="0"
+     inkscape:window-y="25" />
+  <metadata
+     id="metadata7">
+    <rdf:RDF>
+      <cc:Work
+         rdf:about="">
+        <dc:format>image/svg+xml</dc:format>
+        <dc:type
+           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
+      </cc:Work>
+    </rdf:RDF>
+  </metadata>
+  <g
+     inkscape:label="Layer 1"
+     inkscape:groupmode="layer"
+     id="layer1"
+     style="display:inline"
+     transform="translate(-45.230797,-252.93081)">
+    <path
+       style="fill:#cccccc;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 110.58824,326.87199 C 122.35294,279.81316 156.86275,267.26414 200.78431,281.38179 C 244.70588,295.49944 112.15686,326.87199 110.58824,326.87199 z"
+       id="path3209" />
+    <path
+       id="path3273"
+       d="M 648.13153,326.87199 C 636.36683,279.81316 601.85702,267.26414 557.93546,281.38179 C 514.01389,295.49944 646.56291,326.87199 648.13153,326.87199 z"
+       style="fill:#cccccc;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
+    <path
+       style="fill:#0000c0;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 539.08253,282.80368 C 541.14396,278.73733 545.29953,278.95895 556.07315,279.35314 C 584.5717,280.39585 629.27962,299.83983 641.12336,309.23773 C 648.96762,315.46208 649.7963,319.63815 646.60006,327.85952 L 539.08253,282.80368 z"
+       id="path3275"
+       sodipodi:nodetypes="csscc" />
+    <path
+       id="path3211"
+       style="fill:#463f6f;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 115.29412,324.51905 L 198.47104,521.3818 C 261.74101,485.87076 338.85344,474.32298 380.00001,474.32298 C 421.14657,474.32298 497.8296,485.62975 561.52897,521.3818 L 644.70588,324.51905 C 551.81933,270.89097 440,253.93081 380,253.93081 C 348.1566,253.93081 301.54102,258.80976 251.01061,271.3516 C 206.33058,282.44135 158.58976,299.5223 115.29412,324.51905 z"
+       sodipodi:nodetypes="ccsccssc" />
+    <path
+       style="fill:#59518e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
+       d="M 283.12001,486.95405 C 348.115,469.51451 406.47627,466.70922 466.18485,486.02753 L 469.3914,484.10623 C 419.99435,460.03888 338.49264,462.33759 282.43501,484.66743 L 283.12001,486.95405 z"
+       id="path3610"
+       sodipodi:nodetypes="ccccc" />
+    <path
+       sodipodi:nodetypes="ccsccssc"
+       d="M 115.29412,325.30337 L 168.66711,308.96735 C 231.93708,273.45631 339.63775,261.90853 380.78432,261.90853 C 421.93088,261.90853 524.49626,273.2153 588.19563,308.96735 L 644.70588,325.30337 C 551.81933,271.67529 440,254.71513 380,254.71513 C 348.1566,254.71513 301.54102,259.59408 251.01061,272.13592 C 206.33058,283.22567 158.58976,300.30662 115.29412,325.30337 z"
+       style="fill:#6b61ab;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3319" />
+    <path
+       sodipodi:nodetypes="csssc"
+       id="path3265"
+       d="M 702.07079,446.78372 C 711.11828,567.41688 708.6083,638.996 689.40431,687.44687 C 661.29682,758.36091 614.94233,730.00407 598.92944,686.84371 C 587.97726,657.32373 585.6598,540.27442 585.05663,531.8301 C 584.45347,523.38578 702.67396,447.38688 702.07079,446.78372 z"
+       style="fill:#3c3760;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
+    <path
+       style="fill:#3c3760;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 51.269093,446.78372 C 42.221606,567.41688 44.731588,638.996 63.935575,687.44687 C 92.043062,758.36091 138.39756,730.00407 154.41045,686.84371 C 165.36263,657.32373 167.68009,540.27442 168.28326,531.8301 C 168.88642,523.38578 50.665928,447.38688 51.269093,446.78372 z"
+       id="path3241"
+       sodipodi:nodetypes="csssc" />
+    <path
+       sodipodi:nodetypes="ccscccssc"
+       d="M 649.02907,537.01198 C 611.41296,557.68834 583.35903,571.70322 573.34352,609.79461 C 563.32801,647.886 530.40572,671.96999 491.37254,671.96999 C 444.39843,671.96999 406.27451,633.84607 406.27451,586.87196 C 406.27451,566.17478 413.67572,547.19573 425.97413,532.43884 C 438.27254,517.68195 469.0196,497.50727 469.0196,430.40139 C 469.0196,363.29551 523.48235,308.83277 590.58823,308.83277 C 657.69411,308.83277 712.15686,363.29551 712.15686,430.40139 C 712.15686,476.32969 686.64519,516.33562 649.02907,537.01198 z"
+       style="fill:#4e477c;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3263" />
+    <path
+       id="path3187"
+       style="fill:#4e477c;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 109.4023,537.01198 C 147.01841,557.68834 175.07234,571.70322 185.08785,609.79461 C 195.10336,647.886 228.02565,671.96999 267.05883,671.96999 C 314.03294,671.96999 352.15686,633.84607 352.15686,586.87196 C 352.15686,566.17478 344.75565,547.19573 332.45724,532.43884 C 320.15883,517.68195 289.41177,497.50727 289.41177,430.40139 C 289.41177,363.29551 234.94902,308.83277 167.84314,308.83277 C 100.73726,308.83277 46.274511,363.29551 46.274511,430.40139 C 46.274511,476.32969 71.786184,516.33562 109.4023,537.01198 z"
+       sodipodi:nodetypes="ccscccssc" />
+    <path
+       transform="matrix(0.6715375,0,0,0.6715375,60.397139,137.15715)"
+       d="M 281.56863,436.6759 A 121.56863,121.56863 0 1 1 38.431374,436.6759 A 121.56863,121.56863 0 1 1 281.56863,436.6759 z"
+       sodipodi:ry="121.56863"
+       sodipodi:rx="121.56863"
+       sodipodi:cy="436.6759"
+       sodipodi:cx="160"
+       id="path3191"
+       style="opacity:1;fill:#5a518f;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:2.97824025;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <path
+       transform="matrix(0.6741443,0,0,0.6741443,82.263964,191.76429)"
+       d="M 359.21568,586.08765 A 85.098038,85.098038 0 1 1 189.01961,586.08765 A 85.098038,85.098038 0 1 1 359.21568,586.08765 z"
+       sodipodi:ry="85.098038"
+       sodipodi:rx="85.098038"
+       sodipodi:cy="586.08765"
+       sodipodi:cx="274.11765"
+       id="path3193"
+       style="opacity:1;fill:#3b365f;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:2.96672392;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#5b5290;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:3.27435923;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3199"
+       sodipodi:cx="160"
+       sodipodi:cy="436.6759"
+       sodipodi:rx="121.56863"
+       sodipodi:ry="121.56863"
+       d="M 281.56863,436.6759 A 121.56863,121.56863 0 1 1 38.431374,436.6759 A 121.56863,121.56863 0 1 1 281.56863,436.6759 z"
+       transform="matrix(-0.6108065,0,0,0.6108065,690.67022,163.6769)" />
+    <path
+       transform="matrix(-0.3231504,0,0,0.3231504,644.64525,289.28941)"
+       d="M 281.56863,436.6759 A 121.56863,121.56863 0 1 1 38.431374,436.6759 A 121.56863,121.56863 0 1 1 281.56863,436.6759 z"
+       sodipodi:ry="121.56863"
+       sodipodi:rx="121.56863"
+       sodipodi:cy="436.6759"
+       sodipodi:cx="160"
+       id="path3203"
+       style="opacity:1;fill:#00ffff;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:6.18906879;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#ff0000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:10.3030014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3205"
+       sodipodi:cx="160"
+       sodipodi:cy="436.6759"
+       sodipodi:rx="121.56863"
+       sodipodi:ry="121.56863"
+       d="M 281.56863,436.6759 A 121.56863,121.56863 0 1 1 38.431374,436.6759 A 121.56863,121.56863 0 1 1 281.56863,436.6759 z"
+       transform="matrix(-0.1941182,0,0,0.1941182,550.2746,385.63468)" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#b3b3b3;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:2.0999999;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3207"
+       sodipodi:cx="367.05884"
+       sodipodi:cy="410.00925"
+       sodipodi:rx="16.470589"
+       sodipodi:ry="16.470589"
+       d="M 383.52943,410.00925 A 16.470589,16.470589 0 1 1 350.58825,410.00925 A 16.470589,16.470589 0 1 1 383.52943,410.00925 z"
+       transform="matrix(0.952381,0,0,0.952381,31.596639,43.053661)" />
+    <path
+       style="fill:#cccccc;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 600.14073,364.06741 C 617.36446,363.51824 615.17698,341.76087 599.90377,336.96331 C 584.63055,332.16575 560.05501,335.91112 548.7322,348.60818 C 537.4094,361.30523 547.68961,380.26046 559.749,374.0519 C 571.80839,367.84335 582.91701,364.61657 600.14073,364.06741 z"
+       id="path3232"
+       sodipodi:nodetypes="czzzz" />
+    <path
+       sodipodi:type="star"
+       style="opacity:1;fill:#5a5a5a;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:3.22303748;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3243"
+       sodipodi:sides="5"
+       sodipodi:cx="163.45793"
+       sodipodi:cy="428.68875"
+       sodipodi:r1="98.985367"
+       sodipodi:r2="99.460846"
+       sodipodi:arg1="0"
+       sodipodi:arg2="0.62831853"
+       inkscape:flatsided="false"
+       inkscape:rounded="0"
+       inkscape:randomized="0"
+       d="M 262.4433,428.68875 L 243.92345,487.15037 L 194.04609,522.82943 L 132.72284,523.28164 L 83.377088,486.87089 L 63.997086,428.68875 L 83.377088,370.50661 L 132.72284,334.09587 L 194.04609,334.54807 L 243.92345,370.22713 L 262.4433,428.68875 z"
+       transform="matrix(0,-0.6207128,0.6203526,0,-98.095042,531.71426)" />
+    <path
+       transform="matrix(0,-0.5800062,0.5794667,0,245.31464,681.54066)"
+       d="M 262.4433,428.68875 L 243.92345,487.15037 L 194.04609,522.82943 L 132.72284,523.28164 L 83.377088,486.87089 L 63.997086,428.68875 L 83.377088,370.50661 L 132.72284,334.09587 L 194.04609,334.54807 L 243.92345,370.22713 L 262.4433,428.68875 z"
+       inkscape:randomized="0"
+       inkscape:rounded="0"
+       inkscape:flatsided="false"
+       sodipodi:arg2="0.62831853"
+       sodipodi:arg1="0"
+       sodipodi:r2="99.460846"
+       sodipodi:r1="98.985367"
+       sodipodi:cy="428.68875"
+       sodipodi:cx="163.45793"
+       sodipodi:sides="5"
+       id="path3245"
+       style="opacity:1;fill:#c2c200;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:3.44984341;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="star" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#ffff00;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:5.41744804;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3247"
+       sodipodi:cx="274.11765"
+       sodipodi:cy="586.08765"
+       sodipodi:rx="85.098038"
+       sodipodi:ry="85.098038"
+       d="M 359.21568,586.08765 A 85.098038,85.098038 0 1 1 189.01961,586.08765 A 85.098038,85.098038 0 1 1 359.21568,586.08765 z"
+       transform="matrix(-0.3691775,0,0,0.3691775,594.92357,370.50156)" />
+    <path
+       transform="matrix(0.4,0,0,0.4,103.84314,255.73103)"
+       d="M 281.56863,436.6759 A 121.56863,121.56863 0 1 1 38.431374,436.6759 A 121.56863,121.56863 0 1 1 281.56863,436.6759 z"
+       sodipodi:ry="121.56863"
+       sodipodi:rx="121.56863"
+       sodipodi:cy="436.6759"
+       sodipodi:cx="160"
+       id="path3258"
+       style="opacity:1;fill:#cccccc;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:5;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:none;fill-opacity:1;fill-rule:evenodd;stroke:#797979;stroke-width:6.23914528;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3295"
+       sodipodi:cx="160"
+       sodipodi:cy="436.6759"
+       sodipodi:rx="121.56863"
+       sodipodi:ry="121.56863"
+       d="M 281.56863,436.6759 A 121.56863,121.56863 0 1 1 38.431374,436.6759 A 121.56863,121.56863 0 1 1 281.56863,436.6759 z"
+       transform="matrix(0.3205567,0,0,0.3205567,116.55407,290.42201)" />
+    <path
+       transform="matrix(0.2255379,0,0,0.2255379,131.75708,331.91444)"
+       d="M 281.56863,436.6759 A 121.56863,121.56863 0 1 1 38.431374,436.6759 A 121.56863,121.56863 0 1 1 281.56863,436.6759 z"
+       sodipodi:ry="121.56863"
+       sodipodi:rx="121.56863"
+       sodipodi:cy="436.6759"
+       sodipodi:cx="160"
+       id="path3297"
+       style="opacity:1;fill:none;fill-opacity:1;fill-rule:evenodd;stroke:#797979;stroke-width:8.86769104;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:none;fill-opacity:1;fill-rule:evenodd;stroke:#797979;stroke-width:17.92542648;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3301"
+       sodipodi:cx="160"
+       sodipodi:cy="436.6759"
+       sodipodi:rx="121.56863"
+       sodipodi:ry="121.56863"
+       d="M 281.56863,436.6759 A 121.56863,121.56863 0 1 1 38.431374,436.6759 A 121.56863,121.56863 0 1 1 281.56863,436.6759 z"
+       transform="matrix(0.1115734,0,0,0.1115734,149.9914,381.67999)" />
+    <text
+       xml:space="preserve"
+       style="font-size:28px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:-200%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:0.64088398;stroke:none;stroke-width:3pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans Mono;-inkscape-font-specification:DejaVu Sans Mono"
+       x="592.93433"
+       y="438.25452"
+       id="text3303"
+       sodipodi:linespacing="-200%"><tspan
+         sodipodi:role="line"
+         id="tspan3305"
+         x="592.93433"
+         y="438.25452">A</tspan></text>
+    <text
+       xml:space="preserve"
+       style="font-size:28px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:-200%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:0.64088398;stroke:none;stroke-width:3pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans Mono;-inkscape-font-specification:DejaVu Sans Mono"
+       x="518.90808"
+       y="480.60748"
+       id="text3307"
+       sodipodi:linespacing="-200%"><tspan
+         sodipodi:role="line"
+         id="tspan3309"
+         x="518.90808"
+         y="480.60748">B</tspan></text>
+    <text
+       xml:space="preserve"
+       style="font-size:28px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:-200%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:0.64088398;stroke:none;stroke-width:3pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans Mono;-inkscape-font-specification:DejaVu Sans Mono"
+       x="577.25494"
+       y="362.16608"
+       id="text3311"
+       sodipodi:linespacing="-200%"><tspan
+         sodipodi:role="line"
+         id="tspan3313"
+         x="577.25494"
+         y="362.16608">Y</tspan></text>
+    <path
+       sodipodi:nodetypes="czzzz"
+       id="path3237"
+       d="M 661.92886,434.59306 C 662.74956,451.80599 684.46973,449.27569 689.02585,433.92872 C 693.58196,418.58175 689.44953,394.06833 676.57551,382.94715 C 663.70148,371.82597 644.91071,382.40381 651.30867,394.3638 C 657.70661,406.32378 661.10817,417.38014 661.92886,434.59306 z"
+       style="fill:#cccccc;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
+    <text
+       xml:space="preserve"
+       style="font-size:28px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:-200%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:0.64088398;stroke:none;stroke-width:3pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans Mono;-inkscape-font-specification:DejaVu Sans Mono"
+       x="674.14984"
+       y="422.16254"
+       id="text3315"
+       sodipodi:linespacing="-200%"><tspan
+         sodipodi:role="line"
+         id="tspan3317"
+         x="674.14984"
+         y="422.16254">X</tspan></text>
+    <path
+       style="fill:#9e9e9e;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 255.09006,540.10631 C 253.08514,540.10631 251.49631,541.57143 251.49631,543.38756 L 251.49631,571.29381 L 223.59006,571.29381 C 221.77395,571.29381 220.30881,572.91386 220.30881,574.91881 L 220.30881,598.82506 C 220.30881,600.82998 221.77396,602.45006 223.59006,602.45006 L 251.49631,602.45006 L 251.49631,630.35631 C 251.49631,632.17242 253.08514,633.63759 255.09006,633.63756 L 279.02756,633.63756 C 281.03248,633.63756 282.65254,632.17241 282.65256,630.35631 L 282.65256,602.45006 L 310.52756,602.45006 C 312.34367,602.45006 313.80881,600.83001 313.80881,598.82506 L 313.80881,574.91881 C 313.80881,572.91389 312.34366,571.29381 310.52756,571.29381 L 282.65256,571.29381 L 282.65256,543.38756 C 282.65256,541.57145 281.03249,540.10631 279.02756,540.10631 L 255.09006,540.10631 z"
+       id="rect3249" />
+    <path
+       sodipodi:type="inkscape:offset"
+       inkscape:radius="-3.6088684"
+       inkscape:original="M 255.09375 540.09375 C 253.08883 540.09374 251.5 541.55887 251.5 543.375 L 251.5 571.28125 L 223.59375 571.28125 C 221.77764 571.28124 220.3125 572.9013 220.3125 574.90625 L 220.3125 598.8125 C 220.3125 600.81741 221.77765 602.4375 223.59375 602.4375 L 251.5 602.4375 L 251.5 630.34375 C 251.5 632.15985 253.08883 633.62503 255.09375 633.625 L 279.03125 633.625 C 281.03617 633.62499 282.65623 632.15985 282.65625 630.34375 L 282.65625 602.4375 L 310.53125 602.4375 C 312.34736 602.43749 313.8125 600.81745 313.8125 598.8125 L 313.8125 574.90625 C 313.8125 572.90132 312.34735 571.28125 310.53125 571.28125 L 282.65625 571.28125 L 282.65625 543.375 C 282.65625 541.55888 281.03618 540.09375 279.03125 540.09375 L 255.09375 540.09375 z "
+       style="fill:#cccccc;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path4071"
+       d="M 279.0625,543.375 C 279.0625,543.70507 279.27803,543.6875 279.03125,543.6875 L 255.09375,543.6875 L 255.09375,571.28125 C 255.08527,573.2625 253.48125,574.86652 251.5,574.875 L 223.59375,574.875 C 223.92384,574.875 223.90625,574.65945 223.90625,574.90625 L 223.90625,598.8125 C 223.90625,599.05922 223.92389,598.84375 223.59375,598.84375 L 251.5,598.84375 C 253.48125,598.85223 255.08527,600.45625 255.09375,602.4375 L 255.09375,630.03125 L 279.03125,630.03125 C 279.27801,630.03125 279.0625,630.01367 279.0625,630.34375 L 279.0625,602.4375 C 279.07098,600.45625 280.675,598.85223 282.65625,598.84375 L 310.53125,598.84375 C 310.2012,598.84375 310.21875,599.0593 310.21875,598.8125 L 310.21875,574.90625 C 310.21875,574.6595 310.20113,574.875 310.53125,574.875 L 282.65625,574.875 C 280.675,574.86652 279.07098,573.2625 279.0625,571.28125 L 279.0625,543.375 z" />
+    <path
+       sodipodi:type="arc"
+       style="fill:#808080;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.79166675;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3254"
+       sodipodi:cx="265.37897"
+       sodipodi:cy="588.15552"
+       sodipodi:rx="15.811819"
+       sodipodi:ry="15.811819"
+       d="M 281.19079,588.15552 A 15.811819,15.811819 0 1 1 249.56715,588.15552 A 15.811819,15.811819 0 1 1 281.19079,588.15552 z"
+       transform="matrix(0.7164179,0,0,0.7164179,76.93657,165.50679)" />
+    <path
+       style="fill:#808080;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+       d="M 266.98793,547.28208 C 266.55235,547.30447 266.15763,547.54557 265.93883,547.92288 L 256.93362,563.52321 C 256.70332,563.92219 256.7034,564.41375 256.93385,564.81264 C 257.1643,565.21155 257.59009,565.45717 258.05077,565.45695 L 276.06685,565.45695 C 276.52754,565.45717 276.95333,565.21155 277.18377,564.81264 C 277.41423,564.41375 277.41431,563.92219 277.184,563.52321 L 268.17312,547.92288 C 267.92998,547.50341 267.47205,547.25583 266.98793,547.28208 z"
+       id="path2449" />
+    <path
+       id="path2452"
+       d="M 266.98793,626.46179 C 266.55235,626.4394 266.15763,626.1983 265.93883,625.82099 L 256.93362,610.22066 C 256.70332,609.82168 256.7034,609.33012 256.93385,608.93123 C 257.1643,608.53232 257.59009,608.2867 258.05077,608.28692 L 276.06685,608.28692 C 276.52754,608.2867 276.95333,608.53232 277.18377,608.93123 C 277.41423,609.33012 277.41431,609.82168 277.184,610.22066 L 268.17312,625.82099 C 267.92998,626.24046 267.47205,626.48804 266.98793,626.46179 z"
+       style="fill:#808080;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1" />
+    <path
+       id="path3230"
+       d="M 306.64866,586.80105 C 306.62627,586.36547 306.38517,585.97075 306.00786,585.75195 L 290.40753,576.74674 C 290.00855,576.51644 289.51699,576.51652 289.1181,576.74697 C 288.71919,576.97742 288.47357,577.40321 288.47379,577.86389 L 288.47379,595.87997 C 288.47357,596.34066 288.71919,596.76645 289.1181,596.99689 C 289.51699,597.22735 290.00855,597.22743 290.40753,596.99712 L 306.00786,587.98624 C 306.42733,587.7431 306.67491,587.28517 306.64866,586.80105 z"
+       style="fill:#808080;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1" />
+    <path
+       style="fill:#808080;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+       d="M 227.46895,586.80105 C 227.49134,586.36547 227.73244,585.97075 228.10975,585.75195 L 243.71008,576.74674 C 244.10906,576.51644 244.60062,576.51652 244.99951,576.74697 C 245.39842,576.97742 245.64404,577.40321 245.64382,577.86389 L 245.64382,595.87997 C 245.64404,596.34066 245.39842,596.76645 244.99951,596.99689 C 244.60062,597.22735 244.10906,597.22743 243.71008,596.99712 L 228.10975,587.98624 C 227.69028,587.7431 227.4427,587.28517 227.46895,586.80105 z"
+       id="path3233" />
+    <g
+       id="g4007"
+       transform="matrix(0.3396564,0,0,0.3396564,265.47442,197.28664)">
+      <path
+         d="M 175.21876,340.64021 L 145.38878,392.65958 L 182.69652,392.65958 L 182.69652,380.46753 L 166.03402,380.46753 L 181.39602,355.27066 L 202.28504,392.65958 L 217.72835,392.65958 L 187.65459,340.64021 L 175.21876,340.64021"
+         style="fill:#ffffff;fill-rule:nonzero;stroke:none;stroke-width:0.11;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17743" />
+      <path
+         d="M 251.45971,392.65958 L 267.39063,365.02431 L 267.39063,392.65958 L 280.23297,392.65958 L 280.23297,340.64021 L 267.47197,340.64021 L 246.33905,377.21632 L 225.20612,340.64021 L 212.44512,340.64021 L 212.44512,392.65958 L 225.20612,392.65958 L 225.20612,365.02431 L 241.21838,392.65958 L 251.45971,392.65958"
+         style="fill:#ffffff;fill-rule:nonzero;stroke:none;stroke-width:0.11;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17745" />
+      <path
+         d="M 147.09575,360.96028 L 114.74615,360.96028 L 114.74615,372.33951 L 133.44059,372.33951 L 133.44059,380.46753 L 100.0344,380.46753 L 100.0344,352.01944 L 146.52676,352.01944 L 146.52676,340.64021 L 99.546667,340.64021 C 89.386587,340.64021 86.135417,343.89142 86.135417,353.64503 L 86.135417,379.65476 C 86.135417,389.40837 89.386587,392.65958 99.546667,392.65958 L 133.60316,392.65958 C 143.84449,392.65958 147.09575,389.40837 147.09575,379.65476 L 147.09575,360.96028"
+         style="fill:#ffffff;fill-rule:nonzero;stroke:none;stroke-width:0.11;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17747" />
+      <path
+         d="M 393.70033,340.64021 L 363.22019,340.64021 C 353.06015,340.64021 349.80897,343.89142 349.80897,353.64503 L 349.80897,379.65476 C 349.80897,389.40837 353.06015,392.65958 363.22019,392.65958 L 393.70033,392.65958 C 403.86041,392.65958 407.19293,389.40837 407.19293,379.65476 L 407.19293,369.90111 L 393.21268,369.90111 L 393.21268,380.46753 L 363.70791,380.46753 L 363.70791,352.01944 L 393.21268,352.01944 L 393.21268,360.96028 L 407.19293,360.96028 L 407.19293,353.64503 C 407.19293,343.89142 403.86041,340.64021 393.70033,340.64021"
+         style="fill:#ffffff;fill-rule:nonzero;stroke:none;stroke-width:0.11;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17749" />
+      <path
+         d="M 456.85521,380.46753 L 426.61892,380.46753 L 426.61892,340.64021 L 412.71994,340.64021 L 412.71994,379.65476 C 412.71994,389.40837 415.97112,392.65958 426.13119,392.65958 L 457.34285,392.65958 C 467.58419,392.65958 470.83545,389.40837 470.83545,379.65476 L 470.83545,340.64021 L 456.85521,340.64021 L 456.85521,380.46753"
+         style="fill:#ffffff;fill-rule:nonzero;stroke:none;stroke-width:0.11;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17751" />
+      <path
+         d="M 527.48781,365.83708 C 530.82032,364.21149 532.68974,360.96028 532.68974,357.70906 L 532.68974,351.20663 C 532.68974,343.89142 528.70705,340.64021 520.3352,340.64021 L 476.93145,340.64021 L 476.93145,392.65958 L 517.32781,392.65958 C 527.81297,392.65958 533.17746,388.59555 533.17746,381.28035 L 533.17746,374.77792 C 533.17746,370.71393 531.14541,367.46271 527.48781,365.83708 z M 490.83039,351.20663 L 515.70214,351.20663 C 519.60365,351.20663 519.76621,352.01944 519.76621,353.64503 L 519.76621,357.70906 C 519.76621,359.33469 519.60365,360.14746 515.70214,360.14746 L 490.83039,360.14746 L 490.83039,351.20663 z M 520.0913,378.02913 C 520.0913,380.46753 519.60365,381.28035 515.78348,381.28035 L 490.83039,381.28035 L 490.83039,370.71393 L 515.78348,370.71393 C 519.60365,370.71393 520.0913,371.5267 520.0913,373.96514 L 520.0913,378.02913"
+         style="fill:#ffffff;fill-rule:nonzero;stroke:none;stroke-width:0.11;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17753" />
+      <path
+         d="M 552.27838,370.71393 L 575.03689,370.71393 L 575.03689,360.14746 L 552.27838,360.14746 L 552.27838,351.20663 L 591.37423,351.20663 L 591.37423,340.64021 L 538.37939,340.64021 L 538.37939,392.65958 L 591.78058,392.65958 L 591.78058,380.46753 L 552.27838,380.46753 L 552.27838,370.71393"
+         style="fill:#ffffff;fill-rule:nonzero;stroke:none;stroke-width:0.11;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17755" />
+      <path
+         d="M 300.30922,370.71393 L 323.06773,370.71393 L 323.06773,360.14746 L 300.30922,360.14746 L 300.30922,351.20663 L 339.32381,351.20663 L 339.32381,340.64021 L 286.41024,340.64021 L 286.41024,392.65958 L 339.81142,392.65958 L 339.81142,380.46753 L 300.30922,380.46753 L 300.30922,370.71393"
+         style="fill:#ffffff;fill-rule:nonzero;stroke:none;stroke-width:0.11;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17757" />
+      <path
+         d="M 447.67051,326.00975 L 447.67051,286.18242 L 440.11144,286.18242 L 440.11144,312.19211 L 427.18787,286.18242 L 417.02784,286.18242 L 417.02784,326.00975 L 424.58687,326.00975 L 424.58687,295.12322 L 440.11144,326.00975 L 447.67051,326.00975"
+         style="fill:#babcc0;fill-rule:nonzero;stroke:none;stroke-width:0.11;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17759" />
+      <path
+         d="M 228.29477,295.12322 L 243.90064,326.00975 L 251.37845,326.00975 L 251.37845,286.18242 L 243.8193,286.18242 L 243.8193,312.19211 L 230.97704,286.18242 L 220.7357,286.18242 L 220.7357,326.00975 L 228.29477,326.00975 L 228.29477,295.12322"
+         style="fill:#bbbdbf;fill-rule:nonzero;stroke:none;stroke-width:0.055;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17763" />
+      <path
+         d="M 104.26099,295.12322 L 119.86682,326.00975 L 127.34459,326.00975 L 127.34459,286.18242 L 119.78552,286.18242 L 119.78552,312.19211 L 106.94317,286.18242 L 96.701837,286.18242 L 96.701837,326.00975 L 104.26099,326.00975 L 104.26099,295.12322"
+         style="fill:#bbbdbf;fill-rule:nonzero;stroke:none;stroke-width:0.055;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17767" />
+      <path
+         d="M 169.77292,286.18242 L 178.30737,286.18242 L 178.30737,326.00975 L 169.77292,326.00975 L 169.77292,286.18242 z"
+         style="fill:#bbbdbf;fill-rule:nonzero;stroke:none;stroke-width:0.055;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17771" />
+      <path
+         d="M 298.1959,326.00975 L 306.32396,326.00975 L 306.32396,292.68482 L 319.08492,292.68482 L 319.08492,286.18242 L 285.35364,286.18242 L 285.35364,292.68482 L 298.1959,292.68482 L 298.1959,326.00975"
+         style="fill:#bbbdbf;fill-rule:nonzero;stroke:none;stroke-width:0.055;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17775" />
+      <path
+         d="M 503.18505,326.00975 C 510.17513,326.00975 515.78348,321.94572 515.78348,316.2561 L 515.78348,296.74885 C 515.78348,291.05923 510.17513,286.18242 503.18505,286.18242 L 484.81569,286.18242 L 484.81569,326.00975 L 503.18505,326.00975 z M 492.29346,292.68482 L 502.94114,292.68482 C 505.62345,292.68482 508.30563,294.31044 508.30563,296.74885 L 508.30563,315.44333 C 508.30563,318.69451 505.54215,320.32013 502.94114,320.32013 L 492.29346,320.32013 L 492.29346,292.68482"
+         style="fill:#bbbdbf;fill-rule:nonzero;stroke:none;stroke-width:0.055;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17779" />
+      <path
+         d="M 582.18949,296.74885 C 582.18949,291.05923 576.49991,286.18242 569.59105,286.18242 L 562.8448,286.18242 C 555.93598,286.18242 550.24632,291.05923 550.24632,296.74885 L 550.24632,316.2561 C 550.24632,321.94572 555.93598,326.82257 562.8448,326.82257 L 569.59105,326.82257 C 576.49991,326.82257 582.18949,321.94572 582.18949,316.2561 L 582.18949,296.74885 z M 574.71172,316.2561 C 574.71172,318.69451 571.94824,320.32013 569.34723,320.32013 L 563.08866,320.32013 C 560.4064,320.32013 557.72413,318.69451 557.72413,316.2561 L 557.72413,296.74885 C 557.72413,294.31044 560.4064,292.68482 563.08866,292.68482 L 569.34723,292.68482 C 571.94824,292.68482 574.71172,294.31044 574.71172,296.74885 L 574.71172,316.2561"
+         style="fill:#bbbdbf;fill-rule:nonzero;stroke:none;stroke-width:0.055;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17783" />
+      <path
+         d="M 350.37792,316.2561 C 350.37792,321.94572 355.66116,326.00975 362.40741,326.00975 L 379.88273,326.00975 L 379.88273,320.32013 L 363.13892,320.32013 C 360.53792,320.32013 357.85573,317.88173 357.85573,315.44333 L 357.85573,308.9409 L 379.88273,308.9409 L 379.88273,302.43847 L 357.85573,302.43847 L 357.85573,296.74885 C 357.85573,294.31044 360.53792,292.68482 363.13892,292.68482 L 379.88273,292.68482 L 379.88273,286.18242 L 362.65124,286.18242 C 355.82368,286.9952 350.37792,291.05923 350.37792,296.74885 L 350.37792,316.2561"
+         style="fill:#bbbdbf;fill-rule:nonzero;stroke:none;stroke-width:0.055;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17787" />
+      <path
+         d="M 604.29775,392.65958 L 601.85939,392.65958 L 601.85939,382.90598 L 598.36431,382.90598 L 598.36431,380.46753 L 607.8741,380.46753 L 607.8741,382.90598 L 604.29775,382.90598 L 604.29775,392.65958"
+         style="fill:#ffffff;fill-rule:nonzero;stroke:none;stroke-width:0.055;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17791" />
+      <path
+         d="M 620.55384,392.65958 L 618.278,392.65958 L 618.278,382.90598 L 618.278,382.90598 L 616.08342,392.65958 L 613.72632,392.65958 L 611.53174,382.90598 L 611.53174,382.90598 L 611.53174,392.65958 L 609.2559,392.65958 L 609.2559,380.46753 L 612.83224,380.46753 L 614.94552,390.22118 L 614.94552,390.22118 L 617.05884,380.46753 L 620.55384,380.46753 L 620.55384,392.65958"
+         style="fill:#ffffff;fill-rule:nonzero;stroke:none;stroke-width:0.055;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none"
+         id="path17793" />
+    </g>
+    <text
+       xml:space="preserve"
+       style="font-size:12.66273212px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:-200%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:3pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans Mono;-inkscape-font-specification:DejaVu Sans Mono"
+       x="381.14865"
+       y="403.84012"
+       id="text4027"
+       sodipodi:linespacing="-200%"><tspan
+         sodipodi:role="line"
+         x="381.14865"
+         y="403.84012"
+         id="tspan4031">START/PAUSE</tspan></text>
+    <text
+       sodipodi:linespacing="-200%"
+       id="text4053"
+       y="597.06433"
+       x="493.86221"
+       style="font-size:28px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:-200%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:0.64088398;stroke:none;stroke-width:3pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans Mono;-inkscape-font-specification:DejaVu Sans Mono"
+       xml:space="preserve"><tspan
+         y="597.06433"
+         x="493.86221"
+         id="tspan4055"
+         sodipodi:role="line">C</tspan></text>
+    <path
+       transform="matrix(0.4684029,0,0,0.4684029,142.75454,311.37819)"
+       d="M 281.19079,588.15552 A 15.811819,15.811819 0 1 1 249.56715,588.15552 A 15.811819,15.811819 0 1 1 281.19079,588.15552 z"
+       sodipodi:ry="15.811819"
+       sodipodi:rx="15.811819"
+       sodipodi:cy="588.15552"
+       sodipodi:cx="265.37897"
+       id="path4073"
+       style="fill:#6a6a6a;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.79166675;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+  </g>
+</svg>

Added: trunk/media/images/gui/playstation.svg
===================================================================
--- trunk/media/images/gui/playstation.svg	2009-04-15 00:45:36 UTC (rev 2931)
+++ trunk/media/images/gui/playstation.svg	2009-04-20 04:21:55 UTC (rev 2932)
@@ -0,0 +1,673 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no"?>
+<!-- Created with Inkscape (http://www.inkscape.org/) -->
+<svg
+   xmlns:dc="http://purl.org/dc/elements/1.1/"
+   xmlns:cc="http://creativecommons.org/ns#"
+   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
+   xmlns:svg="http://www.w3.org/2000/svg"
+   xmlns="http://www.w3.org/2000/svg"
+   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
+   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
+   width="242.35608"
+   height="151.01579"
+   id="svg2"
+   sodipodi:version="0.32"
+   inkscape:version="0.46"
+   sodipodi:docname="playstation.svg"
+   inkscape:output_extension="org.inkscape.output.svg.inkscape"
+   version="1.0">
+  <defs
+     id="defs4">
+    <inkscape:perspective
+       sodipodi:type="inkscape:persp3d"
+       inkscape:vp_x="0 : 526.18109 : 1"
+       inkscape:vp_y="0 : 1000 : 0"
+       inkscape:vp_z="744.09448 : 526.18109 : 1"
+       inkscape:persp3d-origin="372.04724 : 350.78739 : 1"
+       id="perspective10" />
+    <inkscape:perspective
+       id="perspective2390"
+       inkscape:persp3d-origin="372.04724 : 350.78739 : 1"
+       inkscape:vp_z="744.09448 : 526.18109 : 1"
+       inkscape:vp_y="0 : 1000 : 0"
+       inkscape:vp_x="0 : 526.18109 : 1"
+       sodipodi:type="inkscape:persp3d" />
+    <inkscape:perspective
+       id="perspective12"
+       inkscape:persp3d-origin="886.50018 : 100 : 1"
+       inkscape:vp_z="1773.0004 : 150 : 1"
+       inkscape:vp_y="0 : 1000 : 0"
+       inkscape:vp_x="0 : 150 : 1"
+       sodipodi:type="inkscape:persp3d" />
+    <inkscape:perspective
+       id="perspective3355"
+       inkscape:persp3d-origin="67.123741 : 33.999209 : 1"
+       inkscape:vp_z="134.24748 : 50.998814 : 1"
+       inkscape:vp_y="0 : 1000 : 0"
+       inkscape:vp_x="0 : 50.998814 : 1"
+       sodipodi:type="inkscape:persp3d" />
+    <inkscape:perspective
+       id="perspective3443"
+       inkscape:persp3d-origin="177.16534 : 118.11023 : 1"
+       inkscape:vp_z="354.33069 : 177.16534 : 1"
+       inkscape:vp_y="0 : 1000 : 0"
+       inkscape:vp_x="0 : 177.16534 : 1"
+       sodipodi:type="inkscape:persp3d" />
+  </defs>
+  <sodipodi:namedview
+     id="base"
+     pagecolor="#ffffff"
+     bordercolor="#666666"
+     borderopacity="1.0"
+     gridtolerance="10000"
+     guidetolerance="10"
+     objecttolerance="10"
+     inkscape:pageopacity="0.0"
+     inkscape:pageshadow="2"
+     inkscape:zoom="5.0789737"
+     inkscape:cx="121.17804"
+     inkscape:cy="75.310493"
+     inkscape:document-units="px"
+     inkscape:current-layer="layer1"
+     showgrid="false"
+     inkscape:window-width="1678"
+     inkscape:window-height="980"
+     inkscape:window-x="0"
+     inkscape:window-y="25"
+     showguides="true"
+     inkscape:guide-bbox="true" />
+  <metadata
+     id="metadata7">
+    <rdf:RDF>
+      <cc:Work
+         rdf:about="">
+        <dc:format>image/svg+xml</dc:format>
+        <dc:type
+           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
+      </cc:Work>
+    </rdf:RDF>
+  </metadata>
+  <g
+     inkscape:label="Layer 1"
+     inkscape:groupmode="layer"
+     id="layer1"
+     transform="translate(-260.34243,-473.69226)">
+    <path
+       style="opacity:1;fill:#3f3f3f;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 60.28125,24.15625 C 58.745414,24.15625 57.53125,25.401664 57.53125,26.9375 L 57.53125,100.09375 C 57.53125,101.62959 58.745415,102.84375 60.28125,102.84375 L 182.0625,102.84375 C 183.59834,102.84375 184.84375,101.62958 184.84375,100.09375 L 184.84375,26.9375 C 184.84375,25.401664 183.59833,24.156251 182.0625,24.15625 L 129.25411,24.15625 C 128.98181,24.605319 128.47602,24.90625 127.91036,24.90625 L 113.59806,24.90625 C 113.03391,24.90625 112.55831,24.603315 112.28556,24.15625 L 60.28125,24.15625 z"
+       transform="translate(260.34243,473.69226)"
+       id="rect3225"
+       sodipodi:nodetypes="ccccccccccccc" />
+    <rect
+       ry="2.6797087"
+       rx="2.7722669"
+       y="504.13943"
+       x="324.1748"
+       height="68.484192"
+       width="114.69135"
+       id="rect3318"
+       style="opacity:1;fill:#262626;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
+    <path
+       style="fill:#262626;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 272.94118,520.33604 C 267.45098,550.4014 263.87026,582.56236 261.17647,596.67591 C 256.95116,618.81355 293.94694,637.42281 307.97386,611.83931 C 318.62262,592.41719 330.71895,567.6563 330.71895,567.6563 L 272.94118,520.33604 z"
+       id="path3206"
+       sodipodi:nodetypes="csscc" />
+    <path
+       id="path3258"
+       style="fill:#7a7a7a;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 435.51649,483.7374 L 468.66652,483.7374 L 466.06856,479.46596 C 464.36524,476.66544 459.93736,474.58707 452.09151,474.58707 C 444.24565,474.58707 439.81777,476.66544 438.11445,479.46596 L 435.51649,483.7374 z"
+       sodipodi:nodetypes="ccscsc" />
+    <path
+       sodipodi:nodetypes="ccscsc"
+       d="M 293.16355,483.7374 L 326.31358,483.7374 L 323.71562,479.46596 C 322.0123,476.66544 317.58442,474.58707 309.73857,474.58707 C 301.89271,474.58707 297.46483,476.66544 295.76151,479.46596 L 293.16355,483.7374 z"
+       style="fill:#7a7a7a;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3234" />
+    <path
+       id="path3229"
+       style="fill:#262626;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 330.58823,503.60667 C 328.88888,492.62627 328.10457,487.13608 327.32026,483.08379 C 326.53594,479.0315 319.60784,476.94 309.73856,476.94 C 299.86928,476.94 292.94118,479.0315 292.15686,483.08379 C 291.37255,487.13608 290.58824,492.62627 288.88889,503.60667"
+       sodipodi:nodetypes="cscsc" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#333333;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.99310337999999998;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path2416"
+       sodipodi:cx="303.79086"
+       sodipodi:cy="528.9635"
+       sodipodi:rx="37.64706"
+       sodipodi:ry="37.64706"
+       d="M 341.43792,528.9635 A 37.64706,37.64706 0 1 1 266.1438,528.9635 A 37.64706,37.64706 0 1 1 341.43792,528.9635 z"
+       transform="matrix(1.0069445,0,0,1.0069445,3.9034135,-2.8890439)" />
+    <path
+       sodipodi:nodetypes="cscsc"
+       d="M 472.94117,503.60667 C 471.24182,492.62627 470.45751,487.13608 469.6732,483.08379 C 468.88888,479.0315 461.96078,476.94 452.0915,476.94 C 442.22222,476.94 435.29412,479.0315 434.5098,483.08379 C 433.72549,487.13608 432.94118,492.62627 431.24183,503.60667"
+       style="fill:#262626;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3260" />
+    <path
+       transform="matrix(0.638889,0,0,0.638889,152.05519,228.66165)"
+       d="M 341.43792,528.9635 A 37.64706,37.64706 0 1 1 266.1438,528.9635 A 37.64706,37.64706 0 1 1 341.43792,528.9635 z"
+       sodipodi:ry="37.64706"
+       sodipodi:rx="37.64706"
+       sodipodi:cy="528.9635"
+       sodipodi:cx="303.79086"
+       id="path3208"
+       style="opacity:1;fill:#333333;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.56521726000000005;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <path
+       transform="matrix(0.4930557,0,0,0.4930557,196.35802,305.80215)"
+       d="M 341.43792,528.9635 A 37.64706,37.64706 0 1 1 266.1438,528.9635 A 37.64706,37.64706 0 1 1 341.43792,528.9635 z"
+       sodipodi:ry="37.64706"
+       sodipodi:rx="37.64706"
+       sodipodi:cy="528.9635"
+       sodipodi:cx="303.79086"
+       id="path3212"
+       style="opacity:1;fill:#000000;fill-opacity:0.51851849;fill-rule:evenodd;stroke:#000000;stroke-width:2.02816868;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#4d4d4d;fill-opacity:0.51851849;fill-rule:evenodd;stroke:#000000;stroke-width:2.3225801;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3210"
+       sodipodi:cx="303.79086"
+       sodipodi:cy="528.9635"
+       sodipodi:rx="37.64706"
+       sodipodi:ry="37.64706"
+       d="M 341.43792,528.9635 A 37.64706,37.64706 0 1 1 266.1438,528.9635 A 37.64706,37.64706 0 1 1 341.43792,528.9635 z"
+       transform="matrix(0.4305557,0,0,0.4305557,215.34495,338.86237)" />
+    <path
+       sodipodi:nodetypes="csscc"
+       id="path3223"
+       d="M 490.07696,520.33604 C 495.56716,550.4014 499.14788,583.08523 501.84167,596.67591 C 506.2235,618.78311 469.0712,637.42281 455.04428,611.83931 C 444.39552,592.41719 432.29919,567.6563 432.29919,567.6563 L 490.07696,520.33604 z"
+       style="fill:#262626;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
+    <path
+       transform="matrix(-1.0069445,0,0,1.0069445,759.11473,-2.8890439)"
+       d="M 341.43792,528.9635 A 37.64706,37.64706 0 1 1 266.1438,528.9635 A 37.64706,37.64706 0 1 1 341.43792,528.9635 z"
+       sodipodi:ry="37.64706"
+       sodipodi:rx="37.64706"
+       sodipodi:cy="528.9635"
+       sodipodi:cx="303.79086"
+       id="path3221"
+       style="opacity:1;fill:#333333;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.99310337999999998;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <path
+       id="path3219"
+       d="M 445.43294,501.73222 C 443.8971,501.73222 442.65169,502.97762 442.65169,504.51347 L 442.65169,519.16972 L 427.96419,519.16972 C 426.42835,519.16972 425.21418,520.41512 425.21419,521.95097 L 425.21419,537.54472 C 425.21419,539.08056 426.42837,540.32596 427.96419,540.32597 L 442.65169,540.32597 L 442.65169,554.98222 C 442.65169,556.51806 443.89709,557.76345 445.43294,557.76347 L 461.02669,557.76347 C 462.56253,557.76347 463.77668,556.51804 463.77669,554.98222 L 463.77669,540.32597 L 478.46419,540.32597 C 480.00003,540.32597 481.21419,539.08055 481.21419,537.54472 L 481.21419,521.95097 C 481.21419,520.41513 480.00004,519.16972 478.46419,519.16972 L 463.77669,519.16972 L 463.77669,504.51347 C 463.77669,502.97763 462.56252,501.73222 461.02669,501.73222 L 445.43294,501.73222 z"
+       style="opacity:1;fill:#262626;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
+    <rect
+       style="opacity:1;fill:#595959;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="rect3236"
+       width="11.633987"
+       height="6.666667"
+       x="353.46405"
+       y="530.27539"
+       rx="1.5686275"
+       ry="1.5686275" />
+    <path
+       style="fill:#595959;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+       d="M 407.18954,533.60873 L 398.6928,536.94206 C 397.88381,537.25943 397.12418,536.24245 397.12418,535.37343 L 397.12418,531.84402 C 397.12418,530.975 397.88381,529.95802 398.6928,530.27539 L 407.18954,533.60873 z"
+       id="rect3238"
+       sodipodi:nodetypes="csccsc" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#595959;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3242"
+       sodipodi:cx="374.24835"
+       sodipodi:cy="545.82623"
+       sodipodi:rx="5.7516341"
+       sodipodi:ry="5.7516341"
+       d="M 379.99999,545.82623 A 5.7516341,5.7516341 0 1 1 368.49672,545.82623 A 5.7516341,5.7516341 0 1 1 379.99999,545.82623 z"
+       transform="matrix(1.3795502,0,0,1.3795502,-133.81076,-201.67829)" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#5a5a5a;fill-opacity:1;fill-rule:evenodd;stroke:#454545;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3244"
+       sodipodi:cx="453.33334"
+       sodipodi:cy="510.66284"
+       sodipodi:rx="8.2352943"
+       sodipodi:ry="8.2352943"
+       d="M 461.56864,510.66284 A 8.2352943,8.2352943 0 1 1 445.09805,510.66284 A 8.2352943,8.2352943 0 1 1 461.56864,510.66284 z"
+       transform="translate(-0.1191535,1.4379085)" />
+    <path
+       transform="translate(-0.1191535,36.862745)"
+       d="M 461.56864,510.66284 A 8.2352943,8.2352943 0 1 1 445.09805,510.66284 A 8.2352943,8.2352943 0 1 1 461.56864,510.66284 z"
+       sodipodi:ry="8.2352943"
+       sodipodi:rx="8.2352943"
+       sodipodi:cy="510.66284"
+       sodipodi:cx="453.33334"
+       id="path3246"
+       style="opacity:1;fill:#5a5a5a;fill-opacity:1;fill-rule:evenodd;stroke:#454545;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <path
+       transform="matrix(-1,0,0,-1,924.25995,1040.476)"
+       d="M 461.56864,510.66284 A 8.2352943,8.2352943 0 1 1 445.09805,510.66284 A 8.2352943,8.2352943 0 1 1 461.56864,510.66284 z"
+       sodipodi:ry="8.2352943"
+       sodipodi:rx="8.2352943"
+       sodipodi:cy="510.66284"
+       sodipodi:cx="453.33334"
+       id="path3248"
+       style="fill:#5a5a5a;fill-opacity:1;fill-rule:evenodd;stroke:#454545;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <path
+       sodipodi:type="arc"
+       style="fill:#5a5a5a;fill-opacity:1;fill-rule:evenodd;stroke:#454545;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3250"
+       sodipodi:cx="453.33334"
+       sodipodi:cy="510.66284"
+       sodipodi:rx="8.2352943"
+       sodipodi:ry="8.2352943"
+       d="M 461.56864,510.66284 A 8.2352943,8.2352943 0 1 1 445.09805,510.66284 A 8.2352943,8.2352943 0 1 1 461.56864,510.66284 z"
+       transform="matrix(-1,0,0,-1,888.83512,1040.476)" />
+    <path
+       style="opacity:1;fill:#262626;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 301.84375,501.25 C 300.30791,501.25 299.0625,502.4954 299.0625,504.03125 L 299.0625,518.6875 L 284.375,518.6875 C 282.83916,518.6875 281.62499,519.9329 281.625,521.46875 L 281.625,537.0625 C 281.625,538.59834 282.83918,539.84374 284.375,539.84375 L 299.0625,539.84375 L 299.0625,554.5 C 299.0625,556.03584 300.3079,557.28123 301.84375,557.28125 L 317.4375,557.28125 C 318.97334,557.28125 320.18749,556.03582 320.1875,554.5 L 320.1875,539.84375 L 334.875,539.84375 C 336.41084,539.84375 337.625,538.59833 337.625,537.0625 L 337.625,521.46875 C 337.625,519.93291 336.41085,518.6875 334.875,518.6875 L 320.1875,518.6875 L 320.1875,504.03125 C 320.1875,502.49541 318.97333,501.25 317.4375,501.25 L 301.84375,501.25 z"
+       id="rect3214" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#333333;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.56521726000000005;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3289"
+       sodipodi:cx="303.79086"
+       sodipodi:cy="528.9635"
+       sodipodi:rx="37.64706"
+       sodipodi:ry="37.64706"
+       d="M 341.43792,528.9635 A 37.64706,37.64706 0 1 1 266.1438,528.9635 A 37.64706,37.64706 0 1 1 341.43792,528.9635 z"
+       transform="matrix(0.638889,0,0,0.638889,222.12055,228.66165)" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#000000;fill-opacity:0.51851849;fill-rule:evenodd;stroke:#000000;stroke-width:2.02816868;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3291"
+       sodipodi:cx="303.79086"
+       sodipodi:cy="528.9635"
+       sodipodi:rx="37.64706"
+       sodipodi:ry="37.64706"
+       d="M 341.43792,528.9635 A 37.64706,37.64706 0 1 1 266.1438,528.9635 A 37.64706,37.64706 0 1 1 341.43792,528.9635 z"
+       transform="matrix(0.4930557,0,0,0.4930557,266.42338,305.80215)" />
+    <path
+       transform="matrix(0.4305557,0,0,0.4305557,285.41031,338.86237)"
+       d="M 341.43792,528.9635 A 37.64706,37.64706 0 1 1 266.1438,528.9635 A 37.64706,37.64706 0 1 1 341.43792,528.9635 z"
+       sodipodi:ry="37.64706"
+       sodipodi:rx="37.64706"
+       sodipodi:cy="528.9635"
+       sodipodi:cx="303.79086"
+       id="path3293"
+       style="opacity:1;fill:#4d4d4d;fill-opacity:0.51851849;fill-rule:evenodd;stroke:#000000;stroke-width:2.3225801;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <g
+       id="g3289"
+       style="fill:#3f3f3f;fill-opacity:1">
+      <path
+         sodipodi:type="star"
+         style="fill:#3f3f3f;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.60991526000000018;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         id="path3273"
+         sodipodi:sides="3"
+         sodipodi:cx="271.52805"
+         sodipodi:cy="514.41351"
+         sodipodi:r1="8.4435501"
+         sodipodi:r2="4.2217751"
+         sodipodi:arg1="0"
+         sodipodi:arg2="1.0471976"
+         inkscape:flatsided="true"
+         inkscape:rounded="0"
+         inkscape:randomized="0"
+         d="M 279.9716,514.41351 L 267.30627,521.72584 L 267.30627,507.10118 L 279.9716,514.41351 z"
+         transform="matrix(0,-0.2837353,-0.5174088,0,575.78708,583.63867)" />
+      <path
+         transform="matrix(0,0.2837353,-0.5174088,0,575.78708,474.89258)"
+         d="M 279.9716,514.41351 L 267.30627,521.72584 L 267.30627,507.10118 L 279.9716,514.41351 z"
+         inkscape:randomized="0"
+         inkscape:rounded="0"
+         inkscape:flatsided="true"
+         sodipodi:arg2="1.0471976"
+         sodipodi:arg1="0"
+         sodipodi:r2="4.2217751"
+         sodipodi:r1="8.4435501"
+         sodipodi:cy="514.41351"
+         sodipodi:cx="271.52805"
+         sodipodi:sides="3"
+         id="path3295"
+         style="fill:#3f3f3f;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.60991526000000018;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         sodipodi:type="star" />
+      <path
+         transform="matrix(0.2837353,0,0,-0.5174088,255.25195,795.4277)"
+         d="M 279.9716,514.41351 L 267.30627,521.72584 L 267.30627,507.10118 L 279.9716,514.41351 z"
+         inkscape:randomized="0"
+         inkscape:rounded="0"
+         inkscape:flatsided="true"
+         sodipodi:arg2="1.0471976"
+         sodipodi:arg1="0"
+         sodipodi:r2="4.2217751"
+         sodipodi:r1="8.4435501"
+         sodipodi:cy="514.41351"
+         sodipodi:cx="271.52805"
+         sodipodi:sides="3"
+         id="path3303"
+         style="fill:#3f3f3f;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.60991526000000018;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         sodipodi:type="star" />
+      <path
+         sodipodi:type="star"
+         style="fill:#3f3f3f;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.60991526000000018;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         id="path3305"
+         sodipodi:sides="3"
+         sodipodi:cx="271.52805"
+         sodipodi:cy="514.41351"
+         sodipodi:r1="8.4435501"
+         sodipodi:r2="4.2217751"
+         sodipodi:arg1="0"
+         sodipodi:arg2="1.0471976"
+         inkscape:flatsided="true"
+         inkscape:rounded="0"
+         inkscape:randomized="0"
+         d="M 279.9716,514.41351 L 267.30627,521.72584 L 267.30627,507.10118 L 279.9716,514.41351 z"
+         transform="matrix(-0.2837353,0,0,-0.5174088,363.99805,795.4277)" />
+    </g>
+    <rect
+       style="opacity:1;fill:none;fill-opacity:1;fill-rule:evenodd;stroke:#ff01db;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="rect3307"
+       width="9.4280901"
+       height="9.4280901"
+       x="430.78772"
+       y="525.09912"
+       rx="0"
+       ry="0" />
+    <path
+       sodipodi:type="star"
+       style="opacity:1;fill:none;fill-opacity:1;fill-rule:evenodd;stroke:#00ff83;stroke-width:1.14162278;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3309"
+       sodipodi:sides="3"
+       sodipodi:cx="449.3132"
+       sodipodi:cy="514.68372"
+       sodipodi:r1="6.9132905"
+       sodipodi:r2="3.4566453"
+       sodipodi:arg1="0.52359878"
+       sodipodi:arg2="1.5707963"
+       inkscape:flatsided="true"
+       inkscape:rounded="0"
+       inkscape:randomized="0"
+       d="M 455.30029,518.14036 L 443.32612,518.14036 L 449.3132,507.77043 L 455.30029,518.14036 z"
+       transform="matrix(0.8766816,0,0,0.8752112,59.309557,61.954815)" />
+    <path
+       sodipodi:type="arc"
+       style="fill:none;fill-opacity:1;fill-rule:evenodd;stroke:#ff0000;stroke-width:1.45829916;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3311"
+       sodipodi:cx="453.33334"
+       sodipodi:cy="510.66284"
+       sodipodi:rx="8.2352943"
+       sodipodi:ry="8.2352943"
+       d="M 461.56864,510.66284 A 8.2352943,8.2352943 0 1 1 445.09805,510.66284 A 8.2352943,8.2352943 0 1 1 461.56864,510.66284 z"
+       transform="matrix(-0.6857303,0,0,-0.6857303,781.79103,879.99016)" />
+    <path
+       id="path3313"
+       style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#8243fb;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 449.03591,543.43016 L 457.53968,551.93393 M 457.53968,543.43016 L 449.03591,551.93393" />
+    <g
+       id="g5204"
+       style="fill:#5a5a5a;fill-opacity:1;stroke:#454545;stroke-opacity:1">
+      <path
+         transform="translate(0.351025,0.3733521)"
+         d="M 318.59375,523.28125 C 318.25849,523.30993 317.95147,523.4805 317.75,523.75 L 314.25,528.1875 C 313.92408,528.61125 313.92408,529.20125 314.25,529.625 L 317.75,534.09375 C 317.97204,534.38796 318.3189,534.5614 318.6875,534.5625 L 326.8125,534.59375 C 327.12814,534.59605 327.43153,534.47168 327.65473,534.24848 C 327.87793,534.02528 328.0023,533.72189 328,533.40625 L 328,524.625 C 328.00481,523.97932 327.48933,523.44991 326.84375,523.4375 L 318.71875,523.28125 C 318.67711,523.27904 318.63539,523.27904 318.59375,523.28125 z"
+         id="path3322"
+         style="fill:#5a5a5a;fill-opacity:1;fill-rule:evenodd;stroke:#454545;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+         inkscape:original="M 318.6875 524.46875 L 315.1875 528.90625 L 318.6875 533.375 L 326.8125 533.40625 L 326.8125 524.625 L 318.6875 524.46875 z "
+         inkscape:radius="1.1788157"
+         sodipodi:type="inkscape:offset" />
+      <path
+         transform="matrix(-1,0,0,1,618.89898,0.2844974)"
+         sodipodi:type="inkscape:offset"
+         inkscape:radius="1.1788157"
+         inkscape:original="M 318.6875 524.46875 L 315.1875 528.90625 L 318.6875 533.375 L 326.8125 533.40625 L 326.8125 524.625 L 318.6875 524.46875 z "
+         style="fill:#5a5a5a;fill-opacity:1;fill-rule:evenodd;stroke:#454545;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+         id="path3324"
+         d="M 318.59375,523.28125 C 318.25849,523.30993 317.95147,523.4805 317.75,523.75 L 314.25,528.1875 C 313.92408,528.61125 313.92408,529.20125 314.25,529.625 L 317.75,534.09375 C 317.97204,534.38796 318.3189,534.5614 318.6875,534.5625 L 326.8125,534.59375 C 327.12814,534.59605 327.43153,534.47168 327.65473,534.24848 C 327.87793,534.02528 328.0023,533.72189 328,533.40625 L 328,524.625 C 328.00481,523.97932 327.48933,523.44991 326.84375,523.4375 L 318.71875,523.28125 C 318.67711,523.27904 318.63539,523.27904 318.59375,523.28125 z" />
+      <path
+         transform="matrix(0,1,-1,0,838.51727,219.99165)"
+         sodipodi:type="inkscape:offset"
+         inkscape:radius="1.1788157"
+         inkscape:original="M 318.6875 524.46875 L 315.1875 528.90625 L 318.6875 533.375 L 326.8125 533.40625 L 326.8125 524.625 L 318.6875 524.46875 z "
+         style="fill:#5a5a5a;fill-opacity:1;fill-rule:evenodd;stroke:#454545;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+         id="path3332"
+         d="M 318.59375,523.28125 C 318.25849,523.30993 317.95147,523.4805 317.75,523.75 L 314.25,528.1875 C 313.92408,528.61125 313.92408,529.20125 314.25,529.625 L 317.75,534.09375 C 317.97204,534.38796 318.3189,534.5614 318.6875,534.5625 L 326.8125,534.59375 C 327.12814,534.59605 327.43153,534.47168 327.65473,534.24848 C 327.87793,534.02528 328.0023,533.72189 328,533.40625 L 328,524.625 C 328.00481,523.97932 327.48933,523.44991 326.84375,523.4375 L 318.71875,523.28125 C 318.67711,523.27904 318.63539,523.27904 318.59375,523.28125 z" />
+      <path
+         d="M 318.59375,523.28125 C 318.25849,523.30993 317.95147,523.4805 317.75,523.75 L 314.25,528.1875 C 313.92408,528.61125 313.92408,529.20125 314.25,529.625 L 317.75,534.09375 C 317.97204,534.38796 318.3189,534.5614 318.6875,534.5625 L 326.8125,534.59375 C 327.12814,534.59605 327.43153,534.47168 327.65473,534.24848 C 327.87793,534.02528 328.0023,533.72189 328,533.40625 L 328,524.625 C 328.00481,523.97932 327.48933,523.44991 326.84375,523.4375 L 318.71875,523.28125 C 318.67711,523.27904 318.63539,523.27904 318.59375,523.28125 z"
+         id="path3334"
+         style="fill:#5a5a5a;fill-opacity:1;fill-rule:evenodd;stroke:#454545;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+         inkscape:original="M 318.6875 524.46875 L 315.1875 528.90625 L 318.6875 533.375 L 326.8125 533.40625 L 326.8125 524.625 L 318.6875 524.46875 z "
+         inkscape:radius="1.1788157"
+         sodipodi:type="inkscape:offset"
+         transform="matrix(0,-1,-1,0,838.60612,838.5396)" />
+    </g>
+    <text
+       xml:space="preserve"
+       style="font-size:10.52404881px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:-200%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:3pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
+       x="309.36154"
+       y="489.09683"
+       id="text3336"
+       sodipodi:linespacing="-200%"><tspan
+         sodipodi:role="line"
+         id="tspan3338"
+         x="309.36154"
+         y="489.09683">L</tspan></text>
+    <text
+       sodipodi:linespacing="-200%"
+       id="text3340"
+       y="489.09683"
+       x="453.00854"
+       style="font-size:10.52404881px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:-200%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:3pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
+       xml:space="preserve"><tspan
+         y="489.09683"
+         x="453.00854"
+         id="tspan3342"
+         sodipodi:role="line">R</tspan></text>
+    <text
+       xml:space="preserve"
+       style="font-size:4.56555033px;font-style:normal;font-weight:normal;fill:#e6e6e6;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
+       x="351.18387"
+       y="527.77789"
+       id="text2434"><tspan
+         sodipodi:role="line"
+         id="tspan2436"
+         x="351.18387"
+         y="527.77789">SELECT</tspan></text>
+    <text
+       id="text2438"
+       y="527.77789"
+       x="394.06564"
+       style="font-size:4.56555033px;font-style:normal;font-weight:normal;fill:#e6e6e6;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
+       xml:space="preserve"><tspan
+         y="527.77789"
+         x="394.06564"
+         id="tspan2440"
+         sodipodi:role="line">START</tspan></text>
+    <g
+       transform="matrix(2.346448e-2,0,0,2.346448e-2,376.62244,504.99176)"
+       id="g2507"
+       inkscape:label="Livello 1">
+      <g
+         id="g2395">
+        <g
+           id="g2389"
+           transform="translate(0,-98.471145)"
+           style="fill:#cccccc">
+          <path
+             id="path2387"
+             d="M -366.54898,330.09481 L -332.49443,330.09481 L -332.49443,420.18025 L -366.54898,420.18025 C -383.50689,364.33139 -467.89767,355.97477 -520.80132,355.97477 C -567.08457,355.97477 -601.65498,368.14411 -601.65498,391.64448 C -601.65498,418.80791 -536.54847,419.56799 -483.9064,426.69844 C -416.1409,435.87739 -317.27622,434.30533 -317.27622,522.89158 C -317.27622,592.80277 -410.13057,616.51839 -468.28482,616.64661 C -572.36677,616.87609 -604.68395,586.89179 -628.49769,586.89179 C -635.09615,586.89179 -638.50877,593.27732 -638.5087,606.04833 L -672.55103,606.04833 L -672.55103,504.96655 L -638.5087,504.96655 C -625.72496,565.90022 -532.02635,579.1786 -492.5589,579.1786 C -464.56603,579.1786 -392.57272,573.69069 -392.57272,540.41855 C -392.57272,508.88842 -438.76664,510.53444 -494.91362,502.516 C -556.43136,493.73055 -677.75822,491.80652 -677.75822,409.99245 C -677.75822,346.87021 -607.02606,316.64792 -527.65841,316.64792 C -435.46954,316.64792 -389.89428,346.585!
 35 -376.21791,346.58535 C -369.77864,346.58535 -366.54898,340.66132 -366.54898,330.09481 L -366.54898,330.09481 z"
+             style="font-size:400.5378418px;font-style:normal;font-weight:normal;fill:#cccccc;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
+             sodipodi:nodetypes="ccccssssssccccsssssscc" />
+          <path
+             style="font-size:400.5378418px;font-style:normal;font-weight:normal;fill:#cccccc;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
+             d="M 578.50818,600.02404 L 523.62498,600.02404 L 304.53193,412.57751 L 304.53193,551.96145 C 304.53181,561.30835 309.20524,565.98178 318.55222,565.98174 L 358.60848,565.98174 L 358.60848,600.02404 L 194.78985,600.02404 L 194.78985,565.98174 L 234.84607,565.98174 C 244.19287,565.98178 248.8663,561.30835 248.86637,551.96145 L 248.86637,381.33439 C 248.8663,371.98775 244.19287,367.31433 234.84607,367.3141 L 194.78985,367.3141 L 194.78985,333.2718 L 332.16914,333.2718 L 522.83048,496.28366 L 522.83048,381.33439 C 522.83008,371.98775 518.15668,367.31433 508.81018,367.3141 L 468.75388,367.3141 L 468.75388,333.2718 L 632.57248,333.2718 L 632.57248,367.3141 L 592.52848,367.3141 C 583.18128,367.31433 578.50778,371.98775 578.50818,381.33439 L 578.50818,600.02404 z"
+             id="path2405" />
+          <path
+             style="font-size:400.5378418px;font-style:normal;font-weight:normal;fill:#cccccc;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
+             d="M 934.22268,333.2718 L 1095.2421,333.2718 L 1095.2421,367.3141 L 1063.5956,367.3141 C 1050.2472,367.31433 1039.0343,371.98775 1029.9567,381.33439 L 922.20698,496.28366 L 922.20698,551.96145 C 922.20678,561.30835 926.88018,565.98178 936.22728,565.98174 L 976.28358,565.98174 L 976.28358,600.02404 L 782.01628,600.02404 L 782.01628,565.98174 L 822.07258,565.98174 C 831.41928,565.98178 836.09268,561.30835 836.09288,551.96145 L 836.09288,499.88958 L 725.54398,381.33439 C 716.46598,371.98775 705.25308,367.31433 691.90508,367.3141 L 660.25858,367.3141 L 660.25858,333.2718 L 858.11948,333.2718 L 858.11948,367.3141 L 838.50088,367.3141 C 833.69278,367.31433 830.62068,368.98283 829.28438,372.3196 C 827.94778,375.65682 828.48158,378.66175 830.88568,381.33439 L 896.17108,451.02025 L 961.45648,381.33439 C 963.86008,378.66175 964.39588,375.65682 963.06388,372.3196 C 961.73118,368.98283 958.66108,367.31433 953.85348,367.3141 L 934.22268,367.3141 L 934.22268,333.2718 z"
+             id="text2388" />
+          <path
+             sodipodi:nodetypes="czzzzczzzz"
+             style="fill:#cccccc;fill-opacity:1;stroke:none;stroke-width:1.72916806;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+             d="M -47.10521,316.64795 C -171.93933,316.64794 -254.60521,380.90677 -254.60521,466.64795 C -254.60521,552.38913 -171.93933,616.6479 -47.10521,616.6479 C 77.72891,616.6479 160.39479,552.38915 160.39479,466.64795 C 160.39479,380.90675 77.72891,316.64796 -47.10521,316.64795 z M -47.10521,356.64795 C 24.48641,356.64796 71.89479,403.77107 71.89479,466.64795 C 71.89479,529.52482 24.48641,576.64795 -47.10521,576.6479 C -118.69683,576.64785 -166.10521,529.52481 -166.10521,466.64795 C -166.10521,403.77108 -118.69683,356.64794 -47.10521,356.64795 z"
+             id="path2401" />
+        </g>
+      </g>
+    </g>
+    <g
+       transform="matrix(1.6530585e-2,0,0,1.6530585e-2,376.12631,541.48635)"
+       id="g3"
+       style="fill:#f2f2f2">
+	
+	<path
+   style="fill:#f2f2f2;fill-opacity:1;fill-rule:evenodd"
+   id="path7"
+   d="M 395.06807,434.21345 L 394.60021,863.39514 L 279.61012,825.99696 L 279.61012,321.53515 L 426.38841,360.34125 C 520.34231,385.59251 577.83949,434.67697 576.90381,520.70189 C 575.96956,620.75529 529.69221,660.95773 439.47538,634.77658 L 439.47538,437.47977 C 439.47538,413.635 395.06807,412.23866 395.06807,434.21345 L 395.06807,434.21345 z"
+   clip-rule="evenodd" />
+
+	<path
+   style="fill:#f2f2f2;fill-opacity:1;fill-rule:evenodd"
+   id="path9"
+   d="M 226.78568,742.76757 L 172.56056,761.00535 C 137.49733,773.16387 107.58489,744.64627 139.83807,732.95128 L 166.01346,723.60717 L 67.381005,692.27665 C 36.994899,702.56663 8.4787729,724.53999 10.3531,755.3983 C 12.223081,786.7187 83.74009,794.20296 138.90381,803.08643 C 190.32031,811.49773 237.06553,806.82349 279.60869,791.86223 L 279.60869,759.60031 L 226.78568,742.76757 L 226.78568,742.76757 z M 395.53446,863.39514 L 496.03688,828.32754 L 394.60021,796.07291 L 394.60021,861.05298 L 395.53446,863.39514 L 395.53446,863.39514 z"
+   clip-rule="evenodd" />
+
+	<path
+   style="fill:#f2f2f2;fill-opacity:1;fill-rule:evenodd"
+   id="path11"
+   d="M 662.91715,769.42531 L 664.78565,768.95457 C 708.72663,753.53123 727.42501,732.01703 722.75363,711.92089 C 715.27373,678.26121 661.51646,660.02348 578.77524,653.9442 C 519.41092,649.73926 460.98092,662.82627 403.95154,682.46035 L 394.60164,685.73681 L 496.97405,717.52794 L 556.80624,697.42166 C 619.44554,685.73681 644.69244,706.30513 584.38808,725.47573 L 554.46981,735.75553 L 662.91715,769.42531 L 662.91715,769.42531 z M 279.61012,620.75529 L 234.26272,636.17869 L 279.61012,650.2057 L 279.61012,620.75529 L 279.61012,620.75529 z"
+   clip-rule="evenodd" />
+
+	<path
+   style="fill:#f2f2f2;fill-opacity:1;fill-rule:evenodd"
+   id="path13"
+   d="M 496.03688,828.32754 L 662.91715,769.42531 L 554.46695,735.75553 L 394.60021,790.45575 L 394.60021,796.07291 L 496.03688,828.32754 L 496.03688,828.32754 z M 279.61012,725.00349 L 226.78712,742.76906 L 279.61012,759.60031 L 279.61012,725.00349 L 279.61012,725.00349 z M 394.60021,752.5955 L 394.60021,685.73681 L 496.97262,717.52794 L 394.60021,752.5955 L 394.60021,752.5955 z M 166.01492,723.60717 L 279.60869,682.93251 L 279.60869,650.2057 L 234.26272,636.17869 L 69.718853,691.81461 C 69.250983,691.81461 68.316721,692.27665 67.38246,692.27665 L 166.01492,723.60717 L 166.01492,723.60717 z"
+   clip-rule="evenodd" />
+
+	
+</g>
+    <text
+       xml:space="preserve"
+       style="font-size:3.54335523px;font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;fill:#007dff;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans Mono;-inkscape-font-specification:Bitstream Vera Sans Mono Bold"
+       x="-316.71548"
+       y="-669.84381"
+       id="text3363"
+       transform="scale(-1.3399112,-0.7463181)"><tspan
+         sodipodi:role="line"
+         id="tspan3365"
+         x="-316.71548"
+         y="-669.84381">DUALSHOCK 3</tspan></text>
+    <text
+       xml:space="preserve"
+       style="font-size:3.07532024px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Arial;-inkscape-font-specification:Arial"
+       x="-223.68372"
+       y="-815.48474"
+       id="text3367"
+       sodipodi:linespacing="125%"
+       transform="scale(-1.6252192,-0.6153016)"><tspan
+         sodipodi:role="line"
+         id="tspan3369"
+         x="-223.68372"
+         y="-815.48474">1</tspan></text>
+    <text
+       id="text3371"
+       y="-815.48474"
+       x="-220.45108"
+       style="font-size:3.07532024px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Arial;-inkscape-font-specification:Arial"
+       xml:space="preserve"
+       sodipodi:linespacing="125%"
+       transform="scale(-1.6252192,-0.6153016)"><tspan
+         y="-815.48474"
+         x="-220.45108"
+         id="tspan3373"
+         sodipodi:role="line">2</tspan></text>
+    <text
+       xml:space="preserve"
+       style="font-size:3.07532024px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Arial;-inkscape-font-specification:Arial"
+       x="-216.92226"
+       y="-815.5238"
+       id="text3375"
+       sodipodi:linespacing="125%"
+       transform="scale(-1.6252192,-0.6153016)"><tspan
+         sodipodi:role="line"
+         id="tspan3377"
+         x="-216.92226"
+         y="-815.5238">3</tspan></text>
+    <text
+       id="text3379"
+       y="-815.49377"
+       x="-212.86066"
+       style="font-size:3.07532024px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Arial;-inkscape-font-specification:Arial"
+       xml:space="preserve"
+       sodipodi:linespacing="125%"
+       transform="scale(-1.6252192,-0.6153016)"><tspan
+         y="-815.49377"
+         x="-212.86066"
+         id="tspan3381"
+         sodipodi:role="line">4</tspan></text>
+    <rect
+       style="fill:#1a1a1a;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="rect3383"
+       width="2.0832427"
+       height="2.7004998"
+       x="343.44067"
+       y="498.32468"
+       rx="0"
+       ry="1.5686275" />
+    <rect
+       ry="1.5686275"
+       rx="0"
+       y="498.32468"
+       x="349.99902"
+       height="2.7004998"
+       width="2.0832427"
+       id="rect3385"
+       style="fill:#1a1a1a;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
+    <rect
+       style="fill:#1a1a1a;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="rect3387"
+       width="2.0832427"
+       height="2.7004998"
+       x="355.86298"
+       y="498.32468"
+       rx="0"
+       ry="1.5686275" />
+    <rect
+       ry="1.5686275"
+       rx="0"
+       y="498.32468"
+       x="360.95535"
+       height="2.7004998"
+       width="2.0832427"
+       id="rect3389"
+       style="fill:#ff0000;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
+    <g
+       style="display:inline"
+       id="layer2"
+       transform="matrix(0,1.574001e-2,-2.6605446e-2,0,386.11457,498.66384)">
+      <rect
+         width="33.971706"
+         height="34.054432"
+         x="226.23077"
+         y="198.17175"
+         style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:0.98877811;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         id="rect1933" />
+      <path
+         d="M 92.57172,87.795685 C 92.574438,101.1654 81.736903,112.00514 68.367188,112.00514 C 54.997472,112.00514 44.159937,101.1654 44.162655,87.795685 C 44.159937,74.425969 54.997472,63.586232 68.367188,63.586232 C 81.736903,63.586232 92.574438,74.425969 92.57172,87.795685 L 92.57172,87.795685 z"
+         transform="matrix(1.027502,0,0,1.027502,3.164391,82.27125)"
+         style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         id="path2830" />
+      <path
+         d="M 92.57172,87.795685 C 92.574438,101.1654 81.736903,112.00514 68.367188,112.00514 C 54.997472,112.00514 44.159937,101.1654 44.162655,87.795685 C 44.159937,74.425969 54.997472,63.586232 68.367188,63.586232 C 81.736903,63.586232 92.574438,74.425969 92.57172,87.795685 L 92.57172,87.795685 z"
+         transform="matrix(0.683726,0,0,0.683726,157.7966,69.64945)"
+         style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         id="path4602" />
+      <path
+         d="M 280.71527,156.68252 C 280.71527,156.68252 314.45387,172.15662 313.94652,172.53713 C 313.43918,172.91764 280.71527,187.8844 280.71527,187.8844 L 280.71527,156.68252 z"
+         style="fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
+         id="path4608" />
+      <path
+         d="M 105.26052,171.85683 C 134.37556,169.11446 149.06431,129.49109 165.95578,129.49109 C 177.37657,129.49109 182.37292,130.02033 196.90547,130.02033"
+         style="fill:none;fill-rule:evenodd;stroke:#ffffff;stroke-width:9.56692886;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         id="path2766" />
+      <path
+         d="M 139.78853,172.06998 C 169.86819,172.06998 176.95255,200.52662 199.2026,214.63263 C 202.97271,216.78698 236.97535,215.38634 239.14879,215.38634"
+         style="fill:none;fill-rule:evenodd;stroke:#ffffff;stroke-width:9.56692886;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         id="path3653" />
+      <path
+         d="M 74.032648,171.98191 L 289.16391,171.98191"
+         style="fill:none;fill-rule:evenodd;stroke:#ffffff;stroke-width:9.56692886;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;display:inline"
+         id="path5436" />
+    </g>
+  </g>
+</svg>

Added: trunk/media/images/gui/xbox360.svg
===================================================================
--- trunk/media/images/gui/xbox360.svg	2009-04-15 00:45:36 UTC (rev 2931)
+++ trunk/media/images/gui/xbox360.svg	2009-04-20 04:21:55 UTC (rev 2932)
@@ -0,0 +1,676 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no"?>
+<!-- Created with Inkscape (http://www.inkscape.org/) -->
+<svg
+   xmlns:dc="http://purl.org/dc/elements/1.1/"
+   xmlns:cc="http://creativecommons.org/ns#"
+   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
+   xmlns:svg="http://www.w3.org/2000/svg"
+   xmlns="http://www.w3.org/2000/svg"
+   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
+   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
+   width="750.61829"
+   height="536.87714"
+   id="svg2"
+   sodipodi:version="0.32"
+   inkscape:version="0.46"
+   sodipodi:docname="xbox360.svg"
+   inkscape:output_extension="org.inkscape.output.svg.inkscape"
+   version="1.0">
+  <defs
+     id="defs4">
+    <inkscape:perspective
+       sodipodi:type="inkscape:persp3d"
+       inkscape:vp_x="0 : 526.18109 : 1"
+       inkscape:vp_y="6.1230318e-14 : 1000 : 0"
+       inkscape:vp_z="744.09448 : 526.18109 : 1"
+       inkscape:persp3d-origin="372.04724 : 350.78739 : 1"
+       id="perspective10" />
+    <inkscape:perspective
+       id="perspective2390"
+       inkscape:persp3d-origin="372.04724 : 350.78739 : 1"
+       inkscape:vp_z="744.09448 : 526.18109 : 1"
+       inkscape:vp_y="0 : 1000 : 0"
+       inkscape:vp_x="0 : 526.18109 : 1"
+       sodipodi:type="inkscape:persp3d" />
+    <inkscape:perspective
+       id="perspective3475"
+       inkscape:persp3d-origin="372.04724 : 350.78739 : 1"
+       inkscape:vp_z="744.09448 : 526.18109 : 1"
+       inkscape:vp_y="0 : 1000 : 0"
+       inkscape:vp_x="0 : 526.18109 : 1"
+       sodipodi:type="inkscape:persp3d" />
+  </defs>
+  <sodipodi:namedview
+     id="base"
+     pagecolor="#ffffff"
+     bordercolor="#666666"
+     borderopacity="1.0"
+     gridtolerance="10000"
+     guidetolerance="10"
+     objecttolerance="10"
+     inkscape:pageopacity="0.0"
+     inkscape:pageshadow="2"
+     inkscape:zoom="0.71245353"
+     inkscape:cx="375.15625"
+     inkscape:cy="523.57156"
+     inkscape:document-units="px"
+     inkscape:current-layer="layer1"
+     showgrid="false"
+     inkscape:window-width="1678"
+     inkscape:window-height="980"
+     inkscape:window-x="0"
+     inkscape:window-y="25"
+     showguides="true"
+     inkscape:guide-bbox="true" />
+  <metadata
+     id="metadata7">
+    <rdf:RDF>
+      <cc:Work
+         rdf:about="">
+        <dc:format>image/svg+xml</dc:format>
+        <dc:type
+           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
+      </cc:Work>
+    </rdf:RDF>
+  </metadata>
+  <g
+     inkscape:label="Layer 1"
+     inkscape:groupmode="layer"
+     id="layer1"
+     transform="translate(0.15288,-260.35206)">
+    <g
+       id="g4442"
+       transform="matrix(0.5752286,0,0,0.5752286,161.90411,275.5957)"
+       style="stroke:#000000;stroke-width:2;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1">
+      <rect
+         style="fill:#4d4d4d;fill-opacity:1;stroke:#000000;stroke-width:2;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         id="rect4436"
+         width="45.344299"
+         height="27.532085"
+         x="390.84552"
+         y="630.43866"
+         ry="4.973381"
+         rx="4.973381" />
+      <rect
+         rx="4.973381"
+         ry="4.973381"
+         y="630.43866"
+         x="305.26193"
+         height="27.532085"
+         width="45.344299"
+         id="rect4438"
+         style="fill:#4d4d4d;fill-opacity:1;stroke:#000000;stroke-width:2;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
+      <rect
+         style="fill:#4d4d4d;fill-opacity:1;stroke:#000000;stroke-width:2;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         id="rect4440"
+         width="32.910625"
+         height="27.325605"
+         x="354.27057"
+         y="630.23145"
+         ry="4.973381"
+         rx="4.973381" />
+    </g>
+    <path
+       sodipodi:nodetypes="cssscc"
+       id="path3365"
+       d="M 655.50745,318.60794 C 655.28894,317.5154 651.35577,300.47167 650.91876,297.63105 C 650.48174,294.79043 649.82621,293.26086 646.33006,290.85726 C 613.51647,268.29793 575.1238,257.40679 537.07541,263.5436 C 530.30162,264.63614 521.56124,281.67987 521.56124,281.67987 L 655.50745,318.60794 z"
+       style="fill:#d8d8d8;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:3;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
+    <path
+       style="fill:#d8d8d8;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:3;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 97.673659,318.60794 C 97.892168,317.5154 101.82534,300.47167 102.26235,297.63105 C 102.69937,294.79043 103.3549,293.26086 106.85105,290.85726 C 139.66464,268.29793 178.05731,257.40679 216.1057,263.5436 C 222.87949,264.63614 231.61987,281.67987 231.61987,281.67987 L 97.673659,318.60794 z"
+       id="path3352"
+       sodipodi:nodetypes="cssscc" />
+    <path
+       style="fill:#cccccc;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:3;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 692.40625,795.6875 C 729.24632,796.78087 745.21397,776.84954 748.8125,678.25 C 752.58374,574.91798 685.51396,378.56055 665.84375,329.03125 C 646.1735,279.50196 547.13046,253.20593 502.1875,281.53125 C 465.20101,304.842 424.68118,307.90625 375.15625,307.90625 C 325.63133,307.90625 285.14275,304.842 248.15625,281.53125 C 235.51605,273.56475 218.57513,269.89652 200.34375,269.875 C 153.75246,269.82 98.606739,293.43208 84.46875,329.03125 C 64.798509,378.56054 -2.2712417,574.91797 1.5,678.25 C 5.0785642,776.30266 20.906856,796.56763 57.3125,795.70312 C 141.78831,786.65213 150.45828,738.83858 207.40625,694.09375 C 260.20364,652.61006 297.18742,648.83525 374.875,650.34375 C 452.56257,648.83527 489.51511,652.61009 542.3125,694.09375 C 599.26048,738.83855 607.93044,786.63651 692.40625,795.6875 z"
+       id="path3354"
+       sodipodi:nodetypes="cssssscsscscsc" />
+    <path
+       style="fill:#808080;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:3;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       d="M 376.55538,626.9578 C 306.48411,626.95781 270.99132,628.49411 235.21163,648.0828 C 160.64529,688.90646 145.67483,753.41543 66.61787,795.67655 C 143.80716,784.49429 153.68236,737.39373 208.80537,694.0828 C 261.60277,652.59914 298.58655,648.8243 376.27413,650.3328 C 453.9617,648.82429 490.91424,652.59914 543.71163,694.0828 C 599.02621,737.54424 608.78338,784.83136 686.71163,795.80155 C 607.46105,753.54261 592.53505,688.94455 517.89913,648.0828 C 482.11944,628.49411 446.62665,626.9578 376.55538,626.9578 z"
+       id="path3191" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#d4d4d4;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.92916417;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3339"
+       sodipodi:cx="160.65491"
+       sodipodi:cy="389.37787"
+       sodipodi:rx="68.636604"
+       sodipodi:ry="68.636604"
+       d="M 229.29151,389.37787 A 68.636604,68.636604 0 1 1 92.018303,389.37787 A 68.636604,68.636604 0 1 1 229.29151,389.37787 z"
+       transform="matrix(1.3186813,0,0,1.3571428,273.88333,-12.726922)" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#d4d4d4;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.92916417;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3335"
+       sodipodi:cx="160.65491"
+       sodipodi:cy="389.37787"
+       sodipodi:rx="68.636604"
+       sodipodi:ry="68.636604"
+       d="M 229.29151,389.37787 A 68.636604,68.636604 0 1 1 92.018303,389.37787 A 68.636604,68.636604 0 1 1 229.29151,389.37787 z"
+       transform="matrix(1.1153846,0,0,1.0384615,-16.651483,-22.141431)" />
+    <path
+       transform="matrix(1.3186813,0,0,1.3571428,52.888559,-12.726922)"
+       d="M 229.29151,389.37787 A 68.636604,68.636604 0 1 1 92.018303,389.37787 A 68.636604,68.636604 0 1 1 229.29151,389.37787 z"
+       sodipodi:ry="68.636604"
+       sodipodi:rx="68.636604"
+       sodipodi:cy="389.37787"
+       sodipodi:cx="160.65491"
+       id="path3337"
+       style="opacity:1;fill:#d4d4d4;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.92916417;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#333333;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:2.64638782;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3249"
+       sodipodi:cx="211.80083"
+       sodipodi:cy="443.66501"
+       sodipodi:rx="53.410645"
+       sodipodi:ry="53.410645"
+       d="M 265.21147,443.66501 A 53.410645,53.410645 0 1 1 158.39018,443.66501 A 53.410645,53.410645 0 1 1 265.21147,443.66501 z"
+       transform="matrix(1.1336207,0,0,1.1336207,25.800327,-1.4980324)" />
+    <path
+       id="path3253"
+       style="fill:#3a3a3a;fill-opacity:1;fill-rule:evenodd;stroke:#515151;stroke-width:3.00000024;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+       d="M 249.60884,556.05516 C 249.60884,561.4302 282.19542,561.01814 282.19542,556.05516 C 282.19542,536.00091 298.47109,519.72501 318.52506,519.72501 C 323.77385,520.88166 325.80104,484.17294 318.52506,483.17466 C 298.47109,483.17466 282.19542,466.89876 282.19542,446.84451 C 282.19542,441.44945 249.60884,441.0386 249.60884,446.84451 C 249.60884,466.89876 233.33317,483.17466 213.2792,483.17466 C 207.39917,482.94968 206.22358,519.51869 213.2792,519.72501 C 233.33317,519.72501 249.60884,536.00091 249.60884,556.05516 z"
+       sodipodi:nodetypes="ccccssccc" />
+    <g
+       id="g3292">
+      <rect
+         ry="16.450199"
+         rx="16.450203"
+         y="372.24924"
+         x="437.39334"
+         height="29.558952"
+         width="37.428303"
+         id="rect3288"
+         style="opacity:1;fill:#d1d1d1;fill-opacity:1;fill-rule:evenodd;stroke:#6d6d6d;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
+      <path
+         transform="matrix(0,1.1259413,1.1259413,0,20.719223,57.395722)"
+         d="M 300.92577,381.6729 L 292.76215,395.81271 L 284.59852,381.6729 L 300.92577,381.6729 z"
+         inkscape:randomized="0"
+         inkscape:rounded="0"
+         inkscape:flatsided="true"
+         sodipodi:arg2="0.52359878"
+         sodipodi:arg1="-0.52359878"
+         sodipodi:r2="4.7132702"
+         sodipodi:r1="9.4265404"
+         sodipodi:cy="386.38617"
+         sodipodi:cx="292.76215"
+         sodipodi:sides="3"
+         id="path3290"
+         style="opacity:1;fill:#717171;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:3;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         sodipodi:type="star" />
+    </g>
+    <g
+       id="g3296"
+       transform="matrix(-1,0,0,1,757.22326,0)">
+      <rect
+         style="opacity:1;fill:#d1d1d1;fill-opacity:1;fill-rule:evenodd;stroke:#6d6d6d;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         id="rect3298"
+         width="37.428303"
+         height="29.558952"
+         x="437.39334"
+         y="372.24924"
+         rx="16.450203"
+         ry="16.450199" />
+      <path
+         sodipodi:type="star"
+         style="opacity:1;fill:#717171;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:3;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         id="path3300"
+         sodipodi:sides="3"
+         sodipodi:cx="292.76215"
+         sodipodi:cy="386.38617"
+         sodipodi:r1="9.4265404"
+         sodipodi:r2="4.7132702"
+         sodipodi:arg1="-0.52359878"
+         sodipodi:arg2="0.52359878"
+         inkscape:flatsided="true"
+         inkscape:rounded="0"
+         inkscape:randomized="0"
+         d="M 300.92577,381.6729 L 292.76215,395.81271 L 284.59852,381.6729 L 300.92577,381.6729 z"
+         transform="matrix(0,1.1259413,1.1259413,0,20.719223,57.395722)" />
+    </g>
+    <path
+       transform="matrix(1.1370745,0,0,1.1370745,-54.470362,-59.078494)"
+       d="M 418.96601,392.55499 A 37.527016,37.527016 0 1 1 343.91198,392.55499 A 37.527016,37.527016 0 1 1 418.96601,392.55499 z"
+       sodipodi:ry="37.527016"
+       sodipodi:rx="37.527016"
+       sodipodi:cy="392.55499"
+       sodipodi:cx="381.439"
+       id="path3304"
+       style="opacity:1;fill:#00ff00;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.87944984;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#979797;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.03515577;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3302"
+       sodipodi:cx="381.439"
+       sodipodi:cy="392.55499"
+       sodipodi:rx="37.527016"
+       sodipodi:ry="37.527016"
+       d="M 418.96601,392.55499 A 37.527016,37.527016 0 1 1 343.91198,392.55499 A 37.527016,37.527016 0 1 1 418.96601,392.55499 z"
+       transform="matrix(0.9660382,0,0,0.9660382,10.769546,8.0626522)" />
+    <path
+       transform="matrix(0.719677,0,0,0.719677,104.74129,99.730104)"
+       d="M 418.96601,392.55499 A 37.527016,37.527016 0 1 1 343.91198,392.55499 A 37.527016,37.527016 0 1 1 418.96601,392.55499 z"
+       sodipodi:ry="37.527016"
+       sodipodi:rx="37.527016"
+       sodipodi:cy="392.55499"
+       sodipodi:cx="381.439"
+       id="path3310"
+       style="opacity:1;fill:#a7a7a7;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1.48899412;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <path
+       style="fill:#00ff00;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.25pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
+       d="M 344.94011,404.6356 C 356.55517,375.84775 372.81663,358.36941 399.68843,354.25686 L 402.77285,356.8272 C 380.82322,364.71715 359.94283,386.25936 349.05266,410.29035 L 344.94011,404.6356 z"
+       id="path3306"
+       sodipodi:nodetypes="ccccc" />
+    <path
+       sodipodi:nodetypes="ccccc"
+       id="path3308"
+       d="M 411.22775,403.33198 C 400.48541,376.70717 385.44579,360.5421 360.59307,356.73856 L 357.7404,359.11577 C 378.0408,366.41289 397.35229,386.33648 407.42421,408.56185 L 411.22775,403.33198 z"
+       style="fill:#00ff00;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.25pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" />
+    <text
+       xml:space="preserve"
+       style="font-size:10.93347359px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:-200%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:3pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans Mono;-inkscape-font-specification:DejaVu Sans Mono"
+       x="472.78644"
+       y="364.41809"
+       id="text3312"
+       sodipodi:linespacing="-200%"><tspan
+         sodipodi:role="line"
+         id="tspan3314"
+         x="472.78644"
+         y="364.41809">START</tspan></text>
+    <path
+       d="M 542.19462,503.98223 C 542.19462,535.38796 516.70589,560.87669 485.30015,560.87669 C 453.89441,560.87669 428.40568,535.38796 428.40568,503.98223 C 428.40568,472.57648 453.89441,447.08775 485.30015,447.08775 C 516.70589,447.08775 542.19462,472.57648 542.19462,503.98223 z M 533.89089,503.98222 C 533.89089,530.80431 512.12223,552.57296 485.30015,552.57296 C 458.47806,552.57296 436.7094,530.80431 436.7094,503.98222 C 436.7094,477.16013 458.47806,455.39148 485.30015,455.39148 C 512.12223,455.39148 533.89089,477.16013 533.89089,503.98222 z"
+       style="fill:#dfdfdf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.06702876;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+       id="path3348" />
+    <text
+       xml:space="preserve"
+       style="font-size:10.93347359px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;line-height:100%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:3pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans Mono;-inkscape-font-specification:DejaVu Sans Mono"
+       x="284.78766"
+       y="362.92157"
+       id="text3316"
+       sodipodi:linespacing="100%"><tspan
+         sodipodi:role="line"
+         id="tspan3318"
+         x="284.78766"
+         y="362.92157">BACK</tspan></text>
+    <path
+       id="path3350"
+       style="fill:#dfdfdf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.06702876;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+       d="M 218.67656,375.05998 C 218.67656,405.28811 194.14356,429.82111 163.91542,429.82111 C 133.68728,429.82111 109.15428,405.28811 109.15428,375.05998 C 109.15428,344.83183 133.68728,320.29883 163.91542,320.29883 C 194.14356,320.29883 218.67656,344.83183 218.67656,375.05998 z M 210.68419,375.05997 C 210.68419,400.87633 189.73177,421.82874 163.91542,421.82874 C 138.09906,421.82874 117.14664,400.87633 117.14664,375.05997 C 117.14664,349.24361 138.09906,328.2912 163.91542,328.2912 C 189.73177,328.2912 210.68419,349.24361 210.68419,375.05997 z" />
+    <path
+       id="path3320"
+       style="fill:none;fill-opacity:1;fill-rule:evenodd;stroke:#969696;stroke-width:0.81337047;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+       d="M 379.23104,433.61031 C 391.84679,433.61031 403.58355,428.83839 411.56194,420.32531 C 418.67644,412.73401 427.24865,406.41041 434.19669,406.41041 C 441.14473,406.41041 433.66336,406.41041 433.66336,406.41041 C 433.66336,406.41041 461.60758,406.41041 461.60758,406.41041 C 472.06124,406.41041 480.54536,397.92629 480.54536,387.3792 C 480.54536,376.83212 472.06124,368.348 461.60758,368.348 C 461.60758,368.348 433.66336,368.348 433.66336,368.348 C 433.66336,368.348 441.14473,368.348 434.19669,368.348 C 427.24865,368.348 418.67644,362.0244 411.56194,354.4331 C 403.58355,345.92002 391.82365,341.1481 379.23104,341.1481 C 366.63844,341.1481 354.87854,345.92002 346.90015,354.4331 C 339.78565,362.0244 331.21344,368.348 324.2654,368.348 C 317.31736,368.348 324.79873,368.348 324.79873,368.348 C 324.79873,368.348 296.85451,368.348 296.85451,368.348 C 286.40085,368.348 277.91673,376.83212 277.91673,387.3792 C 277.91673,397.92629 286.40085,406.41041 296.85451,406.41041 C 296.8545!
 1,406.41041 324.79873,406.41041 324.79873,406.41041 C 324.79873,406.41041 317.31736,406.41041 324.2654,406.41041 C 331.21344,406.41041 339.78565,412.73401 346.90015,420.32531 C 354.87854,428.83839 366.6153,433.61031 379.23104,433.61031 z"
+       sodipodi:nodetypes="cssccsccsscssccsccssc" />
+    <path
+       id="path3341"
+       style="fill:#dfdfdf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.06702876;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+       d="M 338.14038,501.44979 C 338.14038,541.32529 305.77763,573.68804 265.90212,573.68804 C 226.0266,573.68804 193.66386,541.32529 193.66386,501.44979 C 193.66386,461.57427 226.0266,429.21152 265.90212,429.21152 C 305.77763,429.21152 338.14038,461.57427 338.14038,501.44979 z M 327.59723,501.44978 C 327.59723,535.50548 299.95781,563.14489 265.90212,563.14489 C 231.84642,563.14489 204.207,535.50548 204.207,501.44978 C 204.207,467.39408 231.84642,439.75467 265.90212,439.75467 C 299.95781,439.75467 327.59723,467.39408 327.59723,501.44978 z" />
+    <g
+       transform="translate(-321.84517,-119.25308)"
+       id="g3233">
+      <path
+         sodipodi:type="arc"
+         style="opacity:1;fill:#4d4d4d;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:3;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         id="path3235"
+         sodipodi:cx="491.28583"
+         sodipodi:cy="494.31305"
+         sodipodi:rx="49.266716"
+         sodipodi:ry="49.266716"
+         d="M 540.55254,494.31305 A 49.266716,49.266716 0 1 1 442.01911,494.31305 A 49.266716,49.266716 0 1 1 540.55254,494.31305 z"
+         transform="translate(-5.525239,0)" />
+      <path
+         transform="matrix(0.7102804,0,0,0.7102804,136.8099,143.21219)"
+         d="M 540.55254,494.31305 A 49.266716,49.266716 0 1 1 442.01911,494.31305 A 49.266716,49.266716 0 1 1 540.55254,494.31305 z"
+         sodipodi:ry="49.266716"
+         sodipodi:rx="49.266716"
+         sodipodi:cy="494.31305"
+         sodipodi:cx="491.28583"
+         id="path3237"
+         style="opacity:1;fill:#333333;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:4.22368431;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         sodipodi:type="arc" />
+      <g
+         id="g3239"
+         transform="matrix(1.0746269,0,0,1.0746269,-36.250788,-36.889032)">
+        <path
+           transform="matrix(8.4112218e-2,0,0,8.4112218e-2,471.14277,452.73529)"
+           d="M 540.55254,494.31305 A 49.266716,49.266716 0 1 1 442.01911,494.31305 A 49.266716,49.266716 0 1 1 540.55254,494.31305 z"
+           sodipodi:ry="49.266716"
+           sodipodi:rx="49.266716"
+           sodipodi:cy="494.31305"
+           sodipodi:cx="491.28583"
+           id="path3241"
+           style="fill:#9b9b9b;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:26.74999046;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+           sodipodi:type="arc" />
+        <path
+           sodipodi:type="arc"
+           style="fill:#9b9b9b;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:26.74999046;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+           id="path3243"
+           sodipodi:cx="491.28583"
+           sodipodi:cy="494.31305"
+           sodipodi:rx="49.266716"
+           sodipodi:ry="49.266716"
+           d="M 540.55254,494.31305 A 49.266716,49.266716 0 1 1 442.01911,494.31305 A 49.266716,49.266716 0 1 1 540.55254,494.31305 z"
+           transform="matrix(8.4112218e-2,0,0,8.4112218e-2,417.73213,452.73529)" />
+        <path
+           sodipodi:type="arc"
+           style="fill:#9b9b9b;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:26.74999046;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+           id="path3245"
+           sodipodi:cx="491.28583"
+           sodipodi:cy="494.31305"
+           sodipodi:rx="49.266716"
+           sodipodi:ry="49.266716"
+           d="M 540.55254,494.31305 A 49.266716,49.266716 0 1 1 442.01911,494.31305 A 49.266716,49.266716 0 1 1 540.55254,494.31305 z"
+           transform="matrix(0,8.4112218e-2,-8.4112218e-2,0,527.33836,479.69524)" />
+        <path
+           transform="matrix(0,8.4112218e-2,-8.4112218e-2,0,527.33836,426.2846)"
+           d="M 540.55254,494.31305 A 49.266716,49.266716 0 1 1 442.01911,494.31305 A 49.266716,49.266716 0 1 1 540.55254,494.31305 z"
+           sodipodi:ry="49.266716"
+           sodipodi:rx="49.266716"
+           sodipodi:cy="494.31305"
+           sodipodi:cx="491.28583"
+           id="path3247"
+           style="fill:#9b9b9b;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:26.74999046;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+           sodipodi:type="arc" />
+      </g>
+    </g>
+    <g
+       id="g3224"
+       transform="translate(-0.4604366,9.6691683)">
+      <path
+         transform="translate(-5.525239,0)"
+         d="M 540.55254,494.31305 A 49.266716,49.266716 0 1 1 442.01911,494.31305 A 49.266716,49.266716 0 1 1 540.55254,494.31305 z"
+         sodipodi:ry="49.266716"
+         sodipodi:rx="49.266716"
+         sodipodi:cy="494.31305"
+         sodipodi:cx="491.28583"
+         id="path3196"
+         style="opacity:1;fill:#4d4d4d;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:3;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         sodipodi:type="arc" />
+      <path
+         sodipodi:type="arc"
+         style="opacity:1;fill:#333333;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:4.22368431;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+         id="path3198"
+         sodipodi:cx="491.28583"
+         sodipodi:cy="494.31305"
+         sodipodi:rx="49.266716"
+         sodipodi:ry="49.266716"
+         d="M 540.55254,494.31305 A 49.266716,49.266716 0 1 1 442.01911,494.31305 A 49.266716,49.266716 0 1 1 540.55254,494.31305 z"
+         transform="matrix(0.7102804,0,0,0.7102804,136.8099,143.21219)" />
+      <g
+         transform="matrix(1.0746269,0,0,1.0746269,-36.250788,-36.889032)"
+         id="g3218">
+        <path
+           sodipodi:type="arc"
+           style="fill:#9b9b9b;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:26.74999046;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+           id="path3200"
+           sodipodi:cx="491.28583"
+           sodipodi:cy="494.31305"
+           sodipodi:rx="49.266716"
+           sodipodi:ry="49.266716"
+           d="M 540.55254,494.31305 A 49.266716,49.266716 0 1 1 442.01911,494.31305 A 49.266716,49.266716 0 1 1 540.55254,494.31305 z"
+           transform="matrix(8.4112218e-2,0,0,8.4112218e-2,471.14277,452.73529)" />
+        <path
+           transform="matrix(8.4112218e-2,0,0,8.4112218e-2,417.73213,452.73529)"
+           d="M 540.55254,494.31305 A 49.266716,49.266716 0 1 1 442.01911,494.31305 A 49.266716,49.266716 0 1 1 540.55254,494.31305 z"
+           sodipodi:ry="49.266716"
+           sodipodi:rx="49.266716"
+           sodipodi:cy="494.31305"
+           sodipodi:cx="491.28583"
+           id="path3202"
+           style="fill:#9b9b9b;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:26.74999046;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+           sodipodi:type="arc" />
+        <path
+           transform="matrix(0,8.4112218e-2,-8.4112218e-2,0,527.33836,479.69524)"
+           d="M 540.55254,494.31305 A 49.266716,49.266716 0 1 1 442.01911,494.31305 A 49.266716,49.266716 0 1 1 540.55254,494.31305 z"
+           sodipodi:ry="49.266716"
+           sodipodi:rx="49.266716"
+           sodipodi:cy="494.31305"
+           sodipodi:cx="491.28583"
+           id="path3210"
+           style="fill:#9b9b9b;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:26.74999046;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+           sodipodi:type="arc" />
+        <path
+           sodipodi:type="arc"
+           style="fill:#9b9b9b;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:26.74999046;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+           id="path3212"
+           sodipodi:cx="491.28583"
+           sodipodi:cy="494.31305"
+           sodipodi:rx="49.266716"
+           sodipodi:ry="49.266716"
+           d="M 540.55254,494.31305 A 49.266716,49.266716 0 1 1 442.01911,494.31305 A 49.266716,49.266716 0 1 1 540.55254,494.31305 z"
+           transform="matrix(0,8.4112218e-2,-8.4112218e-2,0,527.33836,426.2846)" />
+      </g>
+    </g>
+    <path
+       transform="matrix(1.2631579,0,0,1.2631579,-32.710591,-100.04633)"
+       d="M 565.68628,384.47525 A 28.661438,28.661438 0 1 1 508.3634,384.47525 A 28.661438,28.661438 0 1 1 565.68628,384.47525 z"
+       sodipodi:ry="28.661438"
+       sodipodi:rx="28.661438"
+       sodipodi:cy="384.47525"
+       sodipodi:cx="537.02484"
+       id="path3405"
+       style="opacity:1;fill:#dadada;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <path
+       sodipodi:nodetypes="cssssscsscscsc"
+       id="path3363"
+       d="M 692.40625,795.6875 C 729.24632,796.78087 745.21397,776.84954 748.8125,678.25 C 752.58374,574.91798 685.51396,378.56055 665.84375,329.03125 C 646.1735,279.50196 547.13046,253.20593 502.1875,281.53125 C 465.20101,304.842 424.68118,307.90625 375.15625,307.90625 C 325.63133,307.90625 285.14275,304.842 248.15625,281.53125 C 235.51605,273.56475 218.57513,269.89652 200.34375,269.875 C 153.75246,269.82 98.606739,293.43208 84.46875,329.03125 C 64.798509,378.56054 -2.2712417,574.91797 1.5,678.25 C 5.0785642,776.30266 20.906856,796.56763 57.3125,795.70312 C 141.78831,786.65213 150.45828,738.83858 207.40625,694.09375 C 260.20364,652.61006 297.18742,648.83525 374.875,650.34375 C 452.56257,648.83527 489.51511,652.61009 542.3125,694.09375 C 599.26048,738.83855 607.93044,786.63651 692.40625,795.6875 z"
+       style="fill:none;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:3;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#dadada;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3403"
+       sodipodi:cx="537.02484"
+       sodipodi:cy="384.47525"
+       sodipodi:rx="28.661438"
+       sodipodi:ry="28.661438"
+       d="M 565.68628,384.47525 A 28.661438,28.661438 0 1 1 508.3634,384.47525 A 28.661438,28.661438 0 1 1 565.68628,384.47525 z"
+       transform="matrix(1.2631579,0,0,1.2631579,-141.69948,-100.04633)" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#0000ff;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3367"
+       sodipodi:cx="536.64771"
+       sodipodi:cy="382.96677"
+       sodipodi:rx="25.267321"
+       sodipodi:ry="25.267321"
+       d="M 561.91503,382.96677 A 25.267321,25.267321 0 1 1 511.38038,382.96677 A 25.267321,25.267321 0 1 1 561.91503,382.96677 z" />
+    <path
+       sodipodi:type="arc"
+       style="opacity:1;fill:#dadada;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3407"
+       sodipodi:cx="537.02484"
+       sodipodi:cy="384.47525"
+       sodipodi:rx="28.661438"
+       sodipodi:ry="28.661438"
+       d="M 565.68628,384.47525 A 28.661438,28.661438 0 1 1 508.3634,384.47525 A 28.661438,28.661438 0 1 1 565.68628,384.47525 z"
+       transform="matrix(1.2631579,0,0,1.2631579,-87.393598,-152.08947)" />
+    <path
+       d="M 561.91503,382.96677 A 25.267321,25.267321 0 1 1 511.38038,382.96677 A 25.267321,25.267321 0 1 1 561.91503,382.96677 z"
+       sodipodi:ry="25.267321"
+       sodipodi:rx="25.267321"
+       sodipodi:cy="382.96677"
+       sodipodi:cx="536.64771"
+       id="path3369"
+       style="opacity:1;fill:#ff0000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc"
+       transform="translate(109.36601,0)" />
+    <path
+       d="M 561.91503,382.96677 A 25.267321,25.267321 0 1 1 511.38038,382.96677 A 25.267321,25.267321 0 1 1 561.91503,382.96677 z"
+       sodipodi:ry="25.267321"
+       sodipodi:rx="25.267321"
+       sodipodi:cy="382.96677"
+       sodipodi:cx="536.64771"
+       id="path3371"
+       style="fill:#ffff00;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc"
+       transform="matrix(-1,0,0,-1,1127.9784,711.25052)" />
+    <path
+       transform="matrix(1.2631579,0,0,1.2631579,-87.393598,-44.609078)"
+       d="M 565.68628,384.47525 A 28.661438,28.661438 0 1 1 508.3634,384.47525 A 28.661438,28.661438 0 1 1 565.68628,384.47525 z"
+       sodipodi:ry="28.661438"
+       sodipodi:rx="28.661438"
+       sodipodi:cy="384.47525"
+       sodipodi:cx="537.02484"
+       id="path3409"
+       style="opacity:1;fill:#dadada;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       sodipodi:type="arc" />
+    <path
+       transform="matrix(-1,0,0,-1,1127.9784,820.61655)"
+       sodipodi:type="arc"
+       style="fill:#00ff00;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
+       id="path3373"
+       sodipodi:cx="536.64771"
+       sodipodi:cy="382.96677"
+       sodipodi:rx="25.267321"
+       sodipodi:ry="25.267321"
+       d="M 561.91503,382.96677 A 25.267321,25.267321 0 1 1 511.38038,382.96677 A 25.267321,25.267321 0 1 1 561.91503,382.96677 z" />
+    <text
+       xml:space="preserve"
+       style="font-size:31.15677643px;font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;text-align:center;line-height:-200%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:3pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans Mono;-inkscape-font-specification:DejaVu Sans Mono Bold"
+       x="491.71799"
+       y="429.30984"
+       id="text3381"
+       sodipodi:linespacing="-200%"
+       transform="scale(1.0913562,0.9162912)"><tspan
+         sodipodi:role="line"
+         id="tspan3383"
+         x="491.71799"
+         y="429.30984">X</tspan></text>
+    <text
+       xml:space="preserve"
+       style="font-size:31.15677452px;font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;text-align:center;line-height:-200%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:3pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans Mono;-inkscape-font-specification:DejaVu Sans Mono Bold"
+       x="541.82349"
+       y="369.6312"
+       id="text3385"
+       sodipodi:linespacing="-200%"
+       transform="scale(1.0913562,0.9162912)"><tspan
+         sodipodi:role="line"
+         id="tspan3387"
+         x="541.82349"
+         y="369.6312">Y</tspan></text>
+    <text
+       xml:space="preserve"
+       style="font-size:31.15677452px;font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;text-align:center;line-height:-200%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:3pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans Mono;-inkscape-font-specification:DejaVu Sans Mono Bold"
+       x="541.82349"
+       y="488.98849"
+       id="text3389"
+       sodipodi:linespacing="-200%"
+       transform="scale(1.0913562,0.9162912)"><tspan
+         sodipodi:role="line"
+         id="tspan3391"
+         x="541.82349"
+         y="488.98849">A</tspan></text>
+    <text
+       xml:space="preserve"
+       style="font-size:31.15677452px;font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;text-align:center;line-height:-200%;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:3pt;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans Mono;-inkscape-font-specification:DejaVu Sans Mono Bold"
+       x="591.54114"
+       y="429.32504"
+       id="text3393"
+       sodipodi:linespacing="-200%"
+       transform="scale(1.0913562,0.9162912)"><tspan
+         sodipodi:role="line"
+         id="tspan3395"
+         x="591.54114"
+         y="429.32504">B</tspan></text>
+    <path
+       style="fill:#ffffff;fill-opacity:0.48677243;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+       d="M 553.83094,369.19255 C 553.83094,375.08056 546.1101,370.82393 536.59692,370.82393 C 527.08374,370.82393 519.3629,375.08056 519.3629,369.19255 C 519.3629,363.30455 527.08374,358.52587 536.59692,358.52587 C 546.1101,358.52587 553.83094,363.30455 553.83094,369.19255 z"
+       id="path3433"
+       sodipodi:nodetypes="csssc" />
+    <path
+       sodipodi:nodetypes="csssc"
+       id="path3436"
+       d="M 609.04671,315.31534 C 609.04671,321.20335 601.32587,316.94672 591.81269,316.94672 C 582.29951,316.94672 574.57867,321.20335 574.57867,315.31534 C 574.57867,309.42734 582.29951,304.64866 591.81269,304.64866 C 601.32587,304.64866 609.04671,309.42734 609.04671,315.31534 z"
+       style="fill:#ffffff;fill-opacity:0.48677243;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1" />
+    <path
+       style="fill:#ffffff;fill-opacity:0.48677243;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+       d="M 609.04671,423.73903 C 609.04671,429.62704 601.32587,425.37041 591.81269,425.37041 C 582.29951,425.37041 574.57867,429.62704 574.57867,423.73903 C 574.57867,417.85103 582.29951,413.07235 591.81269,413.07235 C 601.32587,413.07235 609.04671,417.85103 609.04671,423.73903 z"
+       id="path3438"
+       sodipodi:nodetypes="csssc" />
+    <path
+       sodipodi:nodetypes="csssc"
+       id="path3440"
+       d="M 663.92784,369.52718 C 663.92784,375.41519 656.207,371.15856 646.69382,371.15856 C 637.18064,371.15856 629.4598,375.41519 629.4598,369.52718 C 629.4598,363.63918 637.18064,358.8605 646.69382,358.8605 C 656.207,358.8605 663.92784,363.63918 663.92784,369.52718 z"
+       style="fill:#ffffff;fill-opacity:0.48677243;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1" />
+    <path
+       sodipodi:nodetypes="csssc"
+       id="path3456"
+       d="M 612.51723,341.12116 C 612.51723,334.58641 602.05531,345.61344 591.49718,345.61344 C 580.93905,345.61344 570.47713,334.90191 570.47713,341.43666 C 570.47713,347.97141 580.93905,352.95949 591.49718,352.95949 C 602.05531,352.95949 612.51723,347.65591 612.51723,341.12116 z"
+       style="fill:#000000;fill-opacity:0.26455024;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1" />
+    <path
+       style="fill:#000000;fill-opacity:0.26455024;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+       d="M 612.51723,450.91606 C 612.51723,444.38131 602.05531,455.40834 591.49718,455.40834 C 580.93905,455.40834 570.47713,444.69681 570.47713,451.23156 C 570.47713,457.76631 580.93905,462.75439 591.49718,462.75439 C 602.05531,462.75439 612.51723,457.45081 612.51723,450.91606 z"
+       id="path3460"
+       sodipodi:nodetypes="csssc" />
+    <path
+       sodipodi:nodetypes="csssc"
+       id="path3462"
+       d="M 557.61978,396.01861 C 557.61978,389.48386 547.15786,400.51089 536.59973,400.51089 C 526.0416,400.51089 515.57968,389.79936 515.57968,396.33411 C 515.57968,402.86886 526.0416,407.85694 536.59973,407.85694 C 547.15786,407.85694 557.61978,402.55336 557.61978,396.01861 z"
+       style="fill:#000000;fill-opacity:0.26455024;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1" />
+    <path
+       style="fill:#000000;fill-opacity:0.26455024;fill-rule:evenodd;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1"
+       d="M 667.73018,396.01861 C 667.73018,389.48386 657.26826,400.51089 646.71013,400.51089 C 636.152,400.51089 625.69008,389.79936 625.69008,396.33411 C 625.69008,402.86886 636.152,407.85694 646.71013,407.85694 C 657.26826,407.85694 667.73018,402.55336 667.73018,396.01861 z"
+       id="path3464"
+       sodipodi:nodetypes="csssc" />
+    <text
+       xml:space="preserve"
+       style="font-size:19.07241058px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#808080;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Arial;-inkscape-font-specification:Arial"
+       x="334.25269"
+       y="350.16708"
+       id="text4416"
+       sodipodi:linespacing="125%"><tspan
+         sodipodi:role="line"
+         id="tspan4418"
+         x="334.25269"
+         y="350.16708">1</tspan></text>
+    <text
+       sodipodi:linespacing="125%"
+       id="text4420"
+       y="350.16708"
+       x="412.03046"
+       style="font-size:19.07241058px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#808080;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Arial;-inkscape-font-specification:Arial"
+       xml:space="preserve"><tspan
+         y="350.16708"
+         x="412.03046"
+         id="tspan4422"
+         sodipodi:role="line">2</tspan></text>
+    <text
+       xml:space="preserve"
+       style="font-size:40px;font-style:normal;font-weight:normal;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Bitstream Vera Sans"
+       x="337.12454"
+       y="424.88486"
+       id="text4424"><tspan
+         sodipodi:role="line"
+         id="tspan4426"
+         x="337.12454"
+         y="424.88486" /></text>
+    <text
+       sodipodi:linespacing="125%"
+       id="text4428"
+       y="436.35324"
+       x="334.25269"
+       style="font-size:19.07241058px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#808080;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Arial;-inkscape-font-specification:Arial"
+       xml:space="preserve"><tspan
+         y="436.35324"
+         x="334.25269"
+         id="tspan4430"
+         sodipodi:role="line">3</tspan></text>
+    <text
+       xml:space="preserve"
+       style="font-size:19.07241058px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;writing-mode:lr-tb;text-anchor:start;fill:#808080;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:Arial;-inkscape-font-specification:Arial"
+       x="412.03046"
+       y="436.35324"
+       id="text4432"
+       sodipodi:linespacing="125%"><tspan
+         sodipodi:role="line"
+         id="tspan4434"
+         x="412.03046"
+         y="436.35324">4</tspan></text>
+  </g>
+</svg>



From grumbel at mail.berlios.de  Mon Apr 20 08:22:52 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Mon, 20 Apr 2009 08:22:52 +0200
Subject: [Windstille-commit] r2933 - in trunk/windstille/data: images/decal
	sectors/trainstation
Message-ID: <200904200622.n3K6Mqxm032384@sheep.berlios.de>

Author: grumbel
Date: 2009-04-20 08:21:37 +0200 (Mon, 20 Apr 2009)
New Revision: 2933

Added:
   trunk/windstille/data/images/decal/green1.png
   trunk/windstille/data/images/decal/green2.png
   trunk/windstille/data/images/decal/ground1.png
   trunk/windstille/data/images/decal/stone1.png
   trunk/windstille/data/images/decal/stone3.png
   trunk/windstille/data/images/decal/tree1.png
   trunk/windstille/data/images/decal/tree2.png
   trunk/windstille/data/images/decal/tree3.png
   trunk/windstille/data/images/decal/tree4.png
   trunk/windstille/data/sectors/trainstation/blendtiles.wst
   trunk/windstille/data/sectors/trainstation/greenstuff.wst
Log:
Some more experimental graphics

Added: trunk/windstille/data/images/decal/green1.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/green1.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/green2.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/green2.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/ground1.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/ground1.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/stone1.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/stone1.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/stone3.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/stone3.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/tree1.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/tree1.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/tree2.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/tree2.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/tree3.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/tree3.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/tree4.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/tree4.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/sectors/trainstation/blendtiles.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/blendtiles.wst	2009-04-20 04:21:55 UTC (rev 2932)
+++ trunk/windstille/data/sectors/trainstation/blendtiles.wst	2009-04-20 06:21:37 UTC (rev 2933)
@@ -0,0 +1,439 @@
+;; -*- scheme -*-
+
+(windstille-sector
+  (version 2)
+  (name "")
+  (ambient-color 0 0 0 1)
+  (init-script "init.nut")
+  (navigation
+    (nodes)
+    (edges))
+  (layers
+    (layer
+      (name "Shadow")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xa160800")
+          (pos 788 30)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.95703 0.488281)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Highlight")
+      (visible #t)
+      (locked #t)
+      (objects))
+    (layer
+      (name "Light")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xa2840e8")
+          (pos 1038 501)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 6.77393 5.78516)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa284138")
+          (pos 564 114)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 6.77393 5.78516)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Scene")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0xa15fc18")
+          (pos 1060 440)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_tree2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 1.5708)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9ea0f30")
+          (pos 550 441)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_tree2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 1.5708)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa1bbe70")
+          (pos 322 381)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa186410")
+          (pos 442 578)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa186e80")
+          (pos 540 719)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa186598")
+          (pos 702 770)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle -0.720638)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa1c8710")
+          (pos 335 186)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0.617026)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa1c85e0")
+          (pos 430 54)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 1.57531)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa184c00")
+          (pos 720 -11)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 1.84254)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa186b10")
+          (pos 1011 -26)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 1.26413)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0x9ea1040")
+          (pos 879 -93)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 1.26413)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0x9aac778")
+          (pos 1220 60)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 1.92928)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xa197770")
+          (pos 1272 292)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 2.86236)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xa186860")
+          (pos 1247 495)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 2.86236)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xa1869c0")
+          (pos 974 782)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 4.05735)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0x9ba2390")
+          (pos 1140 682)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 3.01079)
+          (hflip #f)
+          (vflip #t))
+        (decal
+          (id "0xa181418")
+          (pos 905 300)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/humanreference.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Shadow")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xa164158")
+          (pos 1113 603)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.920979 1.04883)
+          (angle 0.615165)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa167048")
+          (pos 319 118)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.920979 1.04883)
+          (angle 0.615165)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa166640")
+          (pos 1180 112)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.920979 1.04883)
+          (angle 0.615165)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa167b28")
+          (pos 970 -56)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.920979 1.04883)
+          (angle 0.615165)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa165b00")
+          (pos 632 -6)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.920979 1.04883)
+          (angle 1.17998)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa283370")
+          (pos 389 421)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.920979 1.04883)
+          (angle 2.29995)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa282d98")
+          (pos 666 694)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.454636 1.03986)
+          (angle 1.99697)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa283c68")
+          (pos 819 470)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.59204 0.328613)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9f2f0c0")
+          (pos 916 314)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.267578 0.804688)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa1663e8")
+          (pos 769 298)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 2.9104 2.48315)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "New Layer")
+      (visible #f)
+      (locked #t)
+      (objects
+        (decal
+          (id "0xa161ce0")
+          (pos 1067 629)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa167cb0")
+          (pos 555 629)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa168a28")
+          (pos 1067 373)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9ea1bb0")
+          (pos 555 373)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa161d30")
+          (pos 1067 117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa164108")
+          (pos 555 117)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))))
+
+;; EOF ;;

Added: trunk/windstille/data/sectors/trainstation/greenstuff.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/greenstuff.wst	2009-04-20 04:21:55 UTC (rev 2932)
+++ trunk/windstille/data/sectors/trainstation/greenstuff.wst	2009-04-20 06:21:37 UTC (rev 2933)
@@ -0,0 +1,973 @@
+;; -*- scheme -*-
+
+(windstille-sector
+  (version 2)
+  (name "")
+  (ambient-color 0 0 0 1)
+  (init-script "init.nut")
+  (navigation
+    (nodes)
+    (edges))
+  (layers
+    (layer
+      (name "Light")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x9822f60")
+          (pos 392 164)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 8.41748 4.08838)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9823c50")
+          (pos -434 115)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 2.9577 4.08838)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x98237f0")
+          (pos 246 185)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 4.67431 4.08838)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9823da8")
+          (pos 886 203)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 4.67431 4.08838)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9824010")
+          (pos 1448 564)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 4.67431 4.08838)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9824378")
+          (pos 1015 -221)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 4.43322 3.09808)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x98241d8")
+          (pos -22 234)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 2)
+          (scale 5.20898 0.736328)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9824608")
+          (pos -55 167)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 4.70117 4.27148)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x98246c0")
+          (pos 789 423)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 4.70117 4.27148)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Scene")
+      (visible #t)
+      (locked #f)
+      (objects
+        (decal
+          (id "0x9824e28")
+          (pos -496.346 237.481)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982c600")
+          (pos -608 4)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982c7c0")
+          (pos -617 215)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982cb38")
+          (pos 996 36)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/fuel_container.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982e708")
+          (pos 1369 541)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982e7d8")
+          (pos 298 252)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/plant5.png")
+          (type 0)
+          (scale 1 1)
+          (angle -0.496272)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982d408")
+          (pos 1076 249)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/plant3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982e4a8")
+          (pos 582 483)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982e2e0")
+          (pos 1094 483)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982d658")
+          (pos 582 739)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97efc58")
+          (pos 1094 739)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97ef4a8")
+          (pos 529 157)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982d008")
+          (pos 420 364)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982dfd0")
+          (pos 647 370)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982dd00")
+          (pos 500 392)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982d8e8")
+          (pos 537 302)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 0.925714 0.848485)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982dad0")
+          (pos 656 335)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 0.925714 0.848485)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0x97ef8b0")
+          (pos 861 398)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 0.925714 0.848485)
+          (angle 6.44098)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97efa80")
+          (pos 530 85)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 0.56 0.708556)
+          (angle 0.629229)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97f09d0")
+          (pos 644 202)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 0.363627 0.55737)
+          (angle 1.72203)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97ef588")
+          (pos 1344 453)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 0.925714 0.848485)
+          (angle 7.30801)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97f0898")
+          (pos 618 446)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 0.925714 0.848485)
+          (angle 7.8319)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97ef750")
+          (pos 697 340)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.679688 0.332031)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97f02e8")
+          (pos 710 266)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/plant3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97f0ac8")
+          (pos 856 459)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 0.925714 0.848485)
+          (angle 7.8319)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97f0c80")
+          (pos 1504 755)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97f0650")
+          (pos 1392 766)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97efe98")
+          (pos 1242 628)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97f00b8")
+          (pos 1232 824)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle -0.280592)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97ef0d8")
+          (pos 1351 879)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.570312 0.546875)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97ef280")
+          (pos 1117 632)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ground1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 1.84302)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0x982a400")
+          (pos 1104 821)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982b458")
+          (pos 598 748)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 1.13281 0.546875)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982b188")
+          (pos 1079 411)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982a4c0")
+          (pos 1127 516)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982c468")
+          (pos 1179 397)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 0.925714 0.848485)
+          (angle 6.34187)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982a6c0")
+          (pos 944 416)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 0.925714 0.848485)
+          (angle 6.34187)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982c120")
+          (pos 70 483)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982c270")
+          (pos 134 478)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 2.66321 0.49646)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982c388")
+          (pos -442 483)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982bf88")
+          (pos -442 739)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/mine_background.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982a9b8")
+          (pos 291 424)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982aa80")
+          (pos -143 423)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green2.png")
+          (type 0)
+          (scale 1.31114 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982b708")
+          (pos 136 402)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 0.7025 0.848485)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982adb0")
+          (pos 712 417)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 0.925042 1.12947)
+          (angle 0.202716)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982bc78")
+          (pos 536 388)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/green1.png")
+          (type 0)
+          (scale 0.925042 1.12947)
+          (angle 0.202716)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x919d6e0")
+          (pos 295 730)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97c01f8")
+          (pos -134 695)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa646508")
+          (pos -65 969)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97d5df0")
+          (pos 361 1004)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9832600")
+          (pos 80 1241)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97c0188")
+          (pos -479 881)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97d6160")
+          (pos -351 1153)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97d5ed0")
+          (pos 503 1261)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97d6228")
+          (pos 761 957)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa646430")
+          (pos 902 1207)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97d60c8")
+          (pos 1125 1004)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0.585598)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "New Layer")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x982bad8")
+          (pos -253 257)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9824d98")
+          (pos -252 243)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9822d10")
+          (pos 256 249)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x982b830")
+          (pos 257 235)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/lamp1_highlight.png")
+          (type 2)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Character")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x982b9b0")
+          (pos 3 232)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/humanreference.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))))
+    (layer
+      (name "Trees")
+      (visible #t)
+      (locked #t)
+      (objects
+        (decal
+          (id "0x981b198")
+          (pos 19.2787 37.4811)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tree1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97c0fe0")
+          (pos 189.591 34.3561)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tree3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97c19d0")
+          (pos 331 9)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tree2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97c11d8")
+          (pos -237 42)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tree4.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97ecf48")
+          (pos -329 20)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tree3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97ed718")
+          (pos -33 46)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tree1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0x97ed5e0")
+          (pos -344 14)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tree3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0x97ee1d0")
+          (pos -450 29)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tree2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0x97ed838")
+          (pos 232 29)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tree4.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0x97eebc0")
+          (pos 468 -6)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tree3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0x97eeb10")
+          (pos -545 20)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tree2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97c16b0")
+          (pos 512 5)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tree1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x97c14b0")
+          (pos 664 0)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tree3.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))
+        (decal
+          (id "0x97ee2b0")
+          (pos 800 7)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/tree1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #t)
+          (vflip #f))))))
+
+;; EOF ;;



From grumbel at mail.berlios.de  Mon Apr 20 18:53:27 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Mon, 20 Apr 2009 18:53:27 +0200
Subject: [Windstille-commit] r2934 - trunk/windstille/src/particles
Message-ID: <200904201653.n3KGrRc1028127@sheep.berlios.de>

Author: grumbel
Date: 2009-04-20 18:53:26 +0200 (Mon, 20 Apr 2009)
New Revision: 2934

Modified:
   trunk/windstille/src/particles/drawer.hpp
   trunk/windstille/src/particles/particle_system.cpp
   trunk/windstille/src/particles/particle_system.hpp
   trunk/windstille/src/particles/spark_drawer.cpp
   trunk/windstille/src/particles/surface_drawer.cpp
Log:
Some incomplete work on adding ParticleSystem to the editor

Modified: trunk/windstille/src/particles/drawer.hpp
===================================================================
--- trunk/windstille/src/particles/drawer.hpp	2009-04-20 06:21:37 UTC (rev 2933)
+++ trunk/windstille/src/particles/drawer.hpp	2009-04-20 16:53:26 UTC (rev 2934)
@@ -21,7 +21,7 @@
 
 class DrawingContext;
 class ParticleSystem;
-
+
 // FIXME: Rename this to ParticleDrawer or move it into a "namespace particles"
 class Drawer
 {
@@ -29,7 +29,7 @@
   virtual ~Drawer() {}
   virtual void draw(DrawingContext& sc, ParticleSystem& psys) =0;
 };
-
+
 #endif
 
 /* EOF */

Modified: trunk/windstille/src/particles/particle_system.cpp
===================================================================
--- trunk/windstille/src/particles/particle_system.cpp	2009-04-20 06:21:37 UTC (rev 2933)
+++ trunk/windstille/src/particles/particle_system.cpp	2009-04-20 16:53:26 UTC (rev 2934)
@@ -65,7 +65,7 @@
   props.get("bunching", p_bunching);
   set_bunching(p_bunching);
 
-  props.get("name", name);
+  //FIXME: commented since it causes trouble for the editor: props.get("name", name);
     
   float p_lifetime;
   if (props.get("lifetime", p_lifetime))
@@ -267,8 +267,11 @@
 {
   randomizer->set_pos(particle);
 
-  particle.x   += (parent ? parent->get_pos().x : 0) + x_pos + spawn_x;
-  particle.y   += (parent ? parent->get_pos().y : 0) + y_pos + spawn_y;
+  particle.x   += x_pos + spawn_x;
+  particle.y   += y_pos + spawn_y;
+  // FIXME: parent handling disabled due to work on the editor
+  // particle.x   += (parent ? parent->get_pos().x : 0) + x_pos + spawn_x;
+  // particle.y   += (parent ? parent->get_pos().y : 0) + y_pos + spawn_y;
 
   float direction = rnd.drand(cone_start, cone_stop);
   float speed     = rnd.drand(speed_start, speed_stop);

Modified: trunk/windstille/src/particles/particle_system.hpp
===================================================================
--- trunk/windstille/src/particles/particle_system.hpp	2009-04-20 06:21:37 UTC (rev 2933)
+++ trunk/windstille/src/particles/particle_system.hpp	2009-04-20 16:53:26 UTC (rev 2934)
@@ -19,12 +19,14 @@
 #ifndef HEADER_WINDSTILLE_PARTICLES_PARTICLE_SYSTEM_HPP
 #define HEADER_WINDSTILLE_PARTICLES_PARTICLE_SYSTEM_HPP
 
+#include <memory>
 #include <vector>
 
+#include "math/rect.hpp"
 #include "display/color.hpp"
 #include "drawer.hpp"
-#include "engine/entity.hpp"
-
+
+class FileReader;
 class SceneContext;
 class Randomizer;
 struct Particle;
@@ -48,7 +50,7 @@
   float t;
 };
 
-class ParticleSystem : public Entity
+class ParticleSystem
 {
 public:
   typedef std::vector<Particle> Particles;

Modified: trunk/windstille/src/particles/spark_drawer.cpp
===================================================================
--- trunk/windstille/src/particles/spark_drawer.cpp	2009-04-20 06:21:37 UTC (rev 2933)
+++ trunk/windstille/src/particles/spark_drawer.cpp	2009-04-20 16:53:26 UTC (rev 2934)
@@ -16,12 +16,14 @@
 **  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
 
+#include "display/drawing_context.hpp"
+#include "util/file_reader.hpp"
 #include "display/drawing_request.hpp"
 #include "display/vertex_array_drawing_request.hpp"
 #include "particle_system.hpp"
 #include "display/color.hpp"
 #include "spark_drawer.hpp"
-
+
 SparkDrawer::SparkDrawer(FileReader& props)
 {
   width = 1.0f;
@@ -74,5 +76,5 @@
 
   dc.draw(buffer);
 }
-
+
 /* EOF */

Modified: trunk/windstille/src/particles/surface_drawer.cpp
===================================================================
--- trunk/windstille/src/particles/surface_drawer.cpp	2009-04-20 06:21:37 UTC (rev 2933)
+++ trunk/windstille/src/particles/surface_drawer.cpp	2009-04-20 16:53:26 UTC (rev 2934)
@@ -16,12 +16,13 @@
 **  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
 
+#include "util/file_reader.cpp"
 #include "display/vertex_array_drawing_request.hpp"
 #include "particle_system.hpp"
-#include "app/console.hpp" 
 #include "display/surface_manager.hpp"
+#include "display/drawing_context.hpp"
 #include "surface_drawer.hpp"
-
+
 SurfaceDrawer::SurfaceDrawer(Surface surface_)
   : surface(surface_)
 {
@@ -45,7 +46,7 @@
   }
   // FIXME: Implement the rest blendfunc here
   else {
-    console << "Unknown blendfunc: '" << str << "'" << std::endl;
+    std::cout << "string2blendfunc: Unknown blendfunc: '" << str << "'" << std::endl;
     return GL_ONE;
   }
 }
@@ -140,5 +141,5 @@
 
   dc.draw(buffer);
 }
-
+
 /* EOF */



From grumbel at mail.berlios.de  Mon Apr 20 18:54:25 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Mon, 20 Apr 2009 18:54:25 +0200
Subject: [Windstille-commit] r2935 - in trunk/windstille/src: editor screen
Message-ID: <200904201654.n3KGsPd4028320@sheep.berlios.de>

Author: grumbel
Date: 2009-04-20 18:54:05 +0200 (Mon, 20 Apr 2009)
New Revision: 2935

Added:
   trunk/windstille/src/editor/particle_system_object_model.cpp
   trunk/windstille/src/editor/particle_system_object_model.hpp
Modified:
   trunk/windstille/src/screen/particle_viewer.cpp
   trunk/windstille/src/screen/particle_viewer.hpp
Log:
Some incomplete work on adding ParticleSystem to the editor

Added: trunk/windstille/src/editor/particle_system_object_model.cpp
===================================================================
--- trunk/windstille/src/editor/particle_system_object_model.cpp	2009-04-20 16:53:26 UTC (rev 2934)
+++ trunk/windstille/src/editor/particle_system_object_model.cpp	2009-04-20 16:54:05 UTC (rev 2935)
@@ -0,0 +1,62 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#include "particles/particle_system.hpp"
+#include "particle_system_object_model.hpp"
+
+ParticleSystemObjectModel::ParticleSystemObjectModel(const Vector2f& pos)
+  : ObjectModel("ParticleSystem", pos)
+{
+}
+
+ParticleSystemObjectModel::~ParticleSystemObjectModel()
+{
+}
+
+void
+ParticleSystemObjectModel::draw(SceneContext& sc)
+{
+  for(ParticleSystems::iterator i = systems.begin(); i != systems.end(); ++i)
+    (*i)->draw(sc);
+}
+
+void
+ParticleSystemObjectModel::update(float delta)
+{
+  for(ParticleSystems::iterator i = systems.begin(); i != systems.end(); ++i)
+    (*i)->update(delta);
+}
+
+Rectf
+ParticleSystemObjectModel::get_bounding_box() const
+{
+  return Rectf(get_world_pos(), Sizef(128.0f, 128.0f));
+}
+
+ObjectModelHandle
+ParticleSystemObjectModel::clone() const
+{
+  return ObjectModelHandle();
+}
+
+void
+ParticleSystemObjectModel::write(FileWriter& writer) const
+{
+}
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/particle_system_object_model.cpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Added: trunk/windstille/src/editor/particle_system_object_model.hpp
===================================================================
--- trunk/windstille/src/editor/particle_system_object_model.hpp	2009-04-20 16:53:26 UTC (rev 2934)
+++ trunk/windstille/src/editor/particle_system_object_model.hpp	2009-04-20 16:54:05 UTC (rev 2935)
@@ -0,0 +1,51 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#ifndef HEADER_PARTICLE_SYSTEM_OBJECT_MODEL_HPP
+#define HEADER_PARTICLE_SYSTEM_OBJECT_MODEL_HPP
+
+#include "object_model.hpp"
+
+class ParticleSystem;
+
+class ParticleSystemObjectModel : public ObjectModel
+{
+private:
+  typedef std::vector<ParticleSystem*> ParticleSystems; 
+  ParticleSystems systems;
+
+public:
+  ParticleSystemObjectModel(const Vector2f& pos);
+  ~ParticleSystemObjectModel();
+
+  void draw(SceneContext& sc);
+  void update(float delta);
+
+  Rectf get_bounding_box() const;
+  ObjectModelHandle clone() const;
+
+  void write(FileWriter& writer) const;
+
+private:
+  ParticleSystemObjectModel(const ParticleSystemObjectModel&);
+  ParticleSystemObjectModel& operator=(const ParticleSystemObjectModel&);
+};
+
+#endif
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/particle_system_object_model.hpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Modified: trunk/windstille/src/screen/particle_viewer.cpp
===================================================================
--- trunk/windstille/src/screen/particle_viewer.cpp	2009-04-20 16:53:26 UTC (rev 2934)
+++ trunk/windstille/src/screen/particle_viewer.cpp	2009-04-20 16:54:05 UTC (rev 2935)
@@ -34,7 +34,7 @@
 #include "gui/list_view.hpp"
 #include "gui/text_view.hpp"
 #include "gui/automap.hpp"
-
+
 ParticleViewer::ParticleViewer()
 {
   background = Sprite("images/greychess.sprite");
@@ -117,5 +117,5 @@
       MenuManager::display_pause_menu();
     }
 }
-
+
 /* EOF */

Modified: trunk/windstille/src/screen/particle_viewer.hpp
===================================================================
--- trunk/windstille/src/screen/particle_viewer.hpp	2009-04-20 16:53:26 UTC (rev 2934)
+++ trunk/windstille/src/screen/particle_viewer.hpp	2009-04-20 16:54:05 UTC (rev 2935)
@@ -24,13 +24,14 @@
 #include "screen.hpp"
 #include "sprite2d/sprite.hpp"
 #include "gui/gui_manager.hpp"
+#include "display/scene_context.hpp"
 #include "particles/particle_system.hpp"
-
+
 namespace gui {
 class Slider;
 class TabComponent;
 }
-
+
 class ParticleSystemGUI;
 
 /** */
@@ -56,7 +57,7 @@
   ParticleViewer (const ParticleViewer&);
   ParticleViewer& operator= (const ParticleViewer&);
 };
-
+
 #endif
 
 /* EOF */



From grumbel at mail.berlios.de  Mon Apr 20 18:57:52 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Mon, 20 Apr 2009 18:57:52 +0200
Subject: [Windstille-commit] r2936 - trunk/windstille/src/engine
Message-ID: <200904201657.n3KGvq1A031439@sheep.berlios.de>

Author: grumbel
Date: 2009-04-20 18:57:51 +0200 (Mon, 20 Apr 2009)
New Revision: 2936

Modified:
   trunk/windstille/src/engine/game_object.hpp
Log:
Minor cleanup

Modified: trunk/windstille/src/engine/game_object.hpp
===================================================================
--- trunk/windstille/src/engine/game_object.hpp	2009-04-20 16:54:05 UTC (rev 2935)
+++ trunk/windstille/src/engine/game_object.hpp	2009-04-20 16:57:51 UTC (rev 2936)
@@ -33,9 +33,10 @@
 {
 private:
   static Sector* world;
-  
+
+  bool remove_flag;
+ 
 protected:
-  bool remove_flag;
 
   /**
    * name of the GameObject. Note: You should not change it anymore once the



From grumbel at mail.berlios.de  Mon Apr 20 18:58:07 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Mon, 20 Apr 2009 18:58:07 +0200
Subject: [Windstille-commit] r2937 - trunk/windstille/src/engine
Message-ID: <200904201658.n3KGw7br031806@sheep.berlios.de>

Author: grumbel
Date: 2009-04-20 18:58:06 +0200 (Mon, 20 Apr 2009)
New Revision: 2937

Modified:
   trunk/windstille/src/engine/sector.cpp
Log:
Some incomplete work on adding ParticleSystem to the editor

Modified: trunk/windstille/src/engine/sector.cpp
===================================================================
--- trunk/windstille/src/engine/sector.cpp	2009-04-20 16:57:51 UTC (rev 2936)
+++ trunk/windstille/src/engine/sector.cpp	2009-04-20 16:58:06 UTC (rev 2937)
@@ -156,7 +156,7 @@
   } else if (reader.get_name() == "nightvision") {
     add(new Nightvision(reader));
   } else if (reader.get_name() == "particle-system") {
-    add(new ParticleSystem(reader));
+    // FIXME: disabled due to work on the editor: add(new ParticleSystem(reader));
   } else if(reader.get_name() == "scriptable-object") {    
     add(new ScriptableObject(reader));
   } else if (reader.get_name() == "vrdummy") {



From grumbel at mail.berlios.de  Mon Apr 20 18:58:50 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Mon, 20 Apr 2009 18:58:50 +0200
Subject: [Windstille-commit] r2938 - trunk/windstille/src/editor
Message-ID: <200904201658.n3KGwoii000092@sheep.berlios.de>

Author: grumbel
Date: 2009-04-20 18:58:49 +0200 (Mon, 20 Apr 2009)
New Revision: 2938

Modified:
   trunk/windstille/src/editor/object_selector.cpp
Log:
Some incomplete work on adding ParticleSystem to the editor

Modified: trunk/windstille/src/editor/object_selector.cpp
===================================================================
--- trunk/windstille/src/editor/object_selector.cpp	2009-04-20 16:58:06 UTC (rev 2937)
+++ trunk/windstille/src/editor/object_selector.cpp	2009-04-20 16:58:49 UTC (rev 2938)
@@ -90,6 +90,7 @@
   filter_entries.push_back(ComboBoxEntry("Decor", OBJECT_GROUP_DECAL | OBJECT_GROUP_DECOR));
   filter_entries.push_back(ComboBoxEntry("Lights", OBJECT_GROUP_LIGHT));
   filter_entries.push_back(ComboBoxEntry("Highlights", OBJECT_GROUP_HIGHLIGHT));
+  filter_entries.push_back(ComboBoxEntry("Particle Systems", OBJECT_GROUP_PARTICLESYSTEM));
 
   for(std::vector<ComboBoxEntry>::const_iterator i = filter_entries.begin(); i != filter_entries.end(); ++i)
     {
@@ -272,7 +273,7 @@
 void
 ObjectSelector::on_drag_begin(const Glib::RefPtr<Gdk::DragContext>& context)
 {
-  std::string iconpath = "data/editor/icon.png";
+  std::string iconpath;
 
   Gtk::IconView::ArrayHandle_TreePaths selection = iconview.get_selected_items();
   for(Gtk::IconView::ArrayHandle_TreePaths::iterator i = selection.begin();
@@ -285,15 +286,22 @@
       iconpath = (*it)[Columns::instance().pathname];
     }
 
-  Glib::RefPtr<Gdk::Pixbuf> pixbuf = Gdk::Pixbuf::create_from_file(iconpath);
-  if (WindstilleWidget* wst = EditorWindow::current()->get_windstille_widget())
+  if (iconpath.empty())
     {
-      pixbuf = pixbuf->scale_simple(std::max(4, int(pixbuf->get_width()  * wst->get_state().get_zoom())),
-                                    std::max(4, int(pixbuf->get_height() * wst->get_state().get_zoom())),
-                                    Gdk::INTERP_TILES);
+      // refuse drag: how?
     }
-  context->set_icon(pixbuf, pixbuf->get_width()/2, pixbuf->get_height()/2);
-}     
+  else
+    {
+      Glib::RefPtr<Gdk::Pixbuf> pixbuf = Gdk::Pixbuf::create_from_file(iconpath);
+      if (WindstilleWidget* wst = EditorWindow::current()->get_windstille_widget())
+        {
+          pixbuf = pixbuf->scale_simple(std::max(4, int(pixbuf->get_width()  * wst->get_state().get_zoom())),
+                                        std::max(4, int(pixbuf->get_height() * wst->get_state().get_zoom())),
+                                        Gdk::INTERP_TILES);
+        }
+      context->set_icon(pixbuf, pixbuf->get_width()/2, pixbuf->get_height()/2);
+    }
+}
 
 void
 ObjectSelector::on_drag_data_get(const Glib::RefPtr<Gdk::DragContext>& context, 



From grumbel at mail.berlios.de  Mon Apr 20 18:59:13 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Mon, 20 Apr 2009 18:59:13 +0200
Subject: [Windstille-commit] r2939 - trunk/windstille/src/editor
Message-ID: <200904201659.n3KGxDYU000683@sheep.berlios.de>

Author: grumbel
Date: 2009-04-20 18:59:09 +0200 (Mon, 20 Apr 2009)
New Revision: 2939

Modified:
   trunk/windstille/src/editor/object_model.hpp
Log:
Minor cleanup

Modified: trunk/windstille/src/editor/object_model.hpp
===================================================================
--- trunk/windstille/src/editor/object_model.hpp	2009-04-20 16:58:49 UTC (rev 2938)
+++ trunk/windstille/src/editor/object_model.hpp	2009-04-20 16:59:09 UTC (rev 2939)
@@ -47,7 +47,6 @@
   Vector2f move_offset;
 
 public:
-  ObjectModel();
   ObjectModel(const FileReader& reader);
   ObjectModel(const std::string& name, const Vector2f& pos);
   virtual ~ObjectModel();



From grumbel at mail.berlios.de  Mon Apr 20 19:10:29 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Mon, 20 Apr 2009 19:10:29 +0200
Subject: [Windstille-commit] r2940 - in trunk/windstille: . src src/editor
Message-ID: <200904201710.n3KHATT0009025@sheep.berlios.de>

Author: grumbel
Date: 2009-04-20 19:10:26 +0200 (Mon, 20 Apr 2009)
New Revision: 2940

Added:
   trunk/windstille/src/editor/command.hpp
   trunk/windstille/src/editor/group_command.hpp
   trunk/windstille/src/editor/undo_manager.cpp
   trunk/windstille/src/editor/undo_manager.hpp
Modified:
   trunk/windstille/TODO
   trunk/windstille/src/SConscript
   trunk/windstille/src/editor/windstille_widget.cpp
   trunk/windstille/src/editor/windstille_widget.hpp
Log:
Some work on undo

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-04-20 16:59:09 UTC (rev 2939)
+++ trunk/windstille/TODO	2009-04-20 17:10:26 UTC (rev 2940)
@@ -13,6 +13,11 @@
 Scripting
 =========
 
+* http://udn.epicgames.com/Three/UnrealScriptReference.html
+* http://www.modwiki.net/wiki/Scripting
+* http://developer.valvesoftware.com/wiki/Scripted_sequence
+* http://developer.valvesoftware.com/wiki/Faceposer
+
 * ParticleSystem could be hooked up to scripting
 
 * add a way to bind keys to script functions for use in debugging
@@ -588,7 +593,8 @@
 * turn the Selection into a kind-of ControlPoint, this would allow to
   keep the move/offset logic out of the ObjectModel
 
-* maybe have different RGB and RGBA Textures in the TexturePacker
+* maybe have different RGB and RGBA Textures in the TexturePacker to
+  save a bit of space
 
 * share SoftwareSurface via Manager class, generalize Manager classes
   -> template
@@ -769,6 +775,31 @@
 
 * think about Undo/Redo
 
+  * CommandGroupCommand
+
+  * NodeAddCommand
+  * NodeRemoveCommand
+  * EdgeAddCommand
+  * EdgeRemoveCommand
+  * NodeSetPosCommand
+
+  * ObjectAddCommand
+  * ObjectRemoveCommand
+  * ObjectSetAngleCommand
+  * ObjectSetScaleCommand
+  * ObjectSetPosCommand
+  * ObjectSetParent
+  * ObjectSetHFlip
+  * ObjectSetVFlip
+  * ObjectReorderCommand (raise/lower)
+
+  * LayerAddCommand
+  * LayerRemovedCommand
+  * LayerReorderCommand
+
+  * GenericCommand(Object objects[],
+                   sigc::mem_fun(&ObjectModel::set_pos));
+
 * implement non-Surface based objects:
 
    - seperate Surface stuff, turn it into a scaleable/rotatable decal quad

Modified: trunk/windstille/src/SConscript
===================================================================
--- trunk/windstille/src/SConscript	2009-04-20 16:59:09 UTC (rev 2939)
+++ trunk/windstille/src/SConscript	2009-04-20 17:10:26 UTC (rev 2940)
@@ -68,6 +68,15 @@
         'navigation/edge_position.cpp',
         ])
 
+particles_env = conf_env.Clone()
+particles_env['CPPPATH'] = ['.']
+particles_lib = particles_env.StaticLibrary('particles', [
+        'particles/deform_drawer.cpp',
+        'particles/particle_system.cpp',
+        'particles/spark_drawer.cpp',
+        'particles/surface_drawer.cpp',
+        ])
+
 display_env = conf_env.Clone()
 display_env['CPPPATH'] = ['.', '..']
 display_env.ParseConfig('sdl-config --cflags --libs')
@@ -107,7 +116,7 @@
         ])
 
 env = conf_env.Clone()
-env.Append(LIBS    = [navgraph_lib, display_lib, physfs_lib, util_lib, math_lib,
+env.Append(LIBS    = [particles_lib, navgraph_lib, display_lib, physfs_lib, util_lib, math_lib,
                       'GL', 'GLU', 'GLEW', 'squirrel', 'physfs', 'SDL_image', 'openal', 'ogg', 'vorbis', 'vorbisfile', 'png', 'boost_signals'])
 env.Append(LIBPATH = ['../external/'] )
 env.Append(CPPPATH = ['.', '..', '../external/SQUIRREL2/include/'])
@@ -193,10 +202,6 @@
         'objects/test_object.cpp',
         'objects/trigger.cpp',
         'objects/vrdummy.cpp',
-        'particles/deform_drawer.cpp',
-        'particles/particle_system.cpp',
-        'particles/spark_drawer.cpp',
-        'particles/surface_drawer.cpp',
         'properties/property.cpp',
         'properties/property_set.cpp',
         'properties/properties.cpp',
@@ -231,7 +236,7 @@
 
 editor_env = Environment(CPPPATH=['.'],
                          CXXFLAGS=['-Wall', '-Werror', '-O2', '-g'],
-                         LIBS = [navgraph_lib, display_lib, util_lib, physfs_lib, math_lib, 'GL', 'GLEW', 'SDL_image', 'physfs'])
+                         LIBS = [particles_lib, navgraph_lib, display_lib, util_lib, physfs_lib, math_lib, 'GL', 'GLEW', 'SDL_image', 'physfs'])
 
 editor_env.ParseConfig('pkg-config libpng --libs --cflags')
 editor_env.ParseConfig('sdl-config --cflags --libs')
@@ -253,6 +258,7 @@
         'editor/object_model.cpp',      
         'editor/object_model_factory.cpp',
         'editor/object_selector.cpp',
+        'editor/particle_system_object_model.cpp',
         'editor/layer_manager.cpp',
         'editor/navgraph_insert_tool.cpp',
         'editor/navgraph_select_tool.cpp',
@@ -264,6 +270,7 @@
         'editor/sprite_object_model.cpp',
         'editor/windstille_widget.cpp',
         'editor/zoom_tool.cpp',
+        'editor/undo_manager.cpp',
         ])
 
 # EOF #

Added: trunk/windstille/src/editor/command.hpp
===================================================================
--- trunk/windstille/src/editor/command.hpp	2009-04-20 16:59:09 UTC (rev 2939)
+++ trunk/windstille/src/editor/command.hpp	2009-04-20 17:10:26 UTC (rev 2940)
@@ -0,0 +1,43 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#ifndef HEADER_WINDSTILLE_EDITOR_COMMAND_HPP
+#define HEADER_WINDSTILLE_EDITOR_COMMAND_HPP
+
+#include <boost/shared_ptr.hpp>
+
+class Command
+{
+private:
+public:
+  Command() {}
+  virtual ~Command() {}
+
+  virtual void redo() =0;
+  virtual void undo() =0;
+
+private:
+  Command(const Command&);
+  Command& operator=(const Command&);
+};
+
+typedef boost::shared_ptr<Command> CommandHandle;
+
+#endif
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/command.hpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Added: trunk/windstille/src/editor/group_command.hpp
===================================================================
--- trunk/windstille/src/editor/group_command.hpp	2009-04-20 16:59:09 UTC (rev 2939)
+++ trunk/windstille/src/editor/group_command.hpp	2009-04-20 17:10:26 UTC (rev 2940)
@@ -0,0 +1,55 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#ifndef HEADER_WINDSTILLE_EDITOR_GROUP_COMMAND_HPP
+#define HEADER_WINDSTILLE_EDITOR_GROUP_COMMAND_HPP
+
+#include "command.hpp"
+
+class GroupCommand : public Command
+{
+private:
+  typedef std::vector<CommandHandle> Commands;
+  Commands cmds;
+
+public:
+  GroupCommand();
+  ~GroupCommand();
+
+  void add(CommandHandle cmd) {
+    cmds.push_back(cmds);
+  }
+
+  void redo() {
+    for(Commands::const_iterator i = cmds.begin(); i != cmds.end(); ++i)
+      (*i)->redo();
+  }
+
+  void undo() {
+    for(Commands::const_reverse_iterator i = cmds.rbegin(); i != cmds.rend(); ++i)
+      (*i)->undo();
+  }
+
+private:
+  GroupCommand(const GroupCommand&);
+  GroupCommand& operator=(const GroupCommand&);
+};
+
+#endif
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/group_command.hpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Added: trunk/windstille/src/editor/undo_manager.cpp
===================================================================
--- trunk/windstille/src/editor/undo_manager.cpp	2009-04-20 16:59:09 UTC (rev 2939)
+++ trunk/windstille/src/editor/undo_manager.cpp	2009-04-20 17:10:26 UTC (rev 2940)
@@ -0,0 +1,60 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#include "undo_manager.hpp"
+
+UndoManager::UndoManager()
+{
+}
+
+UndoManager::~UndoManager()
+{
+}
+
+void
+UndoManager::execute(CommandHandle cmd)
+{
+  cmd->redo();
+  undo_stack.push_back(cmd);
+}
+
+void
+UndoManager::undo()
+{
+  if (!undo_stack.empty())
+    {
+      CommandHandle cmd = undo_stack.back();
+      undo_stack.pop_back();
+      cmd->undo();
+      redo_stack.push_back(cmd);
+    }
+}
+
+void
+UndoManager::redo()
+{
+  if (!redo_stack.empty())
+    {
+      CommandHandle cmd = redo_stack.back();
+      redo_stack.pop_back();
+      cmd->redo();
+      undo_stack.push_back(cmd);
+    }
+}
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/undo_manager.cpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Added: trunk/windstille/src/editor/undo_manager.hpp
===================================================================
--- trunk/windstille/src/editor/undo_manager.hpp	2009-04-20 16:59:09 UTC (rev 2939)
+++ trunk/windstille/src/editor/undo_manager.hpp	2009-04-20 17:10:26 UTC (rev 2940)
@@ -0,0 +1,50 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#ifndef HEADER_WINDSTILLE_EDITOR_UNDO_MANAGER_HPP
+#define HEADER_WINDSTILLE_EDITOR_UNDO_MANAGER_HPP
+
+#include <vector>
+#include "command.hpp"
+
+class UndoManager
+{
+private:
+  std::vector<CommandHandle> undo_stack;
+  std::vector<CommandHandle> redo_stack;
+
+public:
+  UndoManager();
+  ~UndoManager();
+
+  void execute(CommandHandle cmd);
+
+  void undo();
+  void redo();
+
+  bool can_undo() const { return !undo_stack.empty(); }
+  bool can_redo() const { return !redo_stack.empty(); }
+
+private:
+  UndoManager(const UndoManager&);
+  UndoManager& operator=(const UndoManager&);
+};
+
+#endif
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/undo_manager.hpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-20 16:59:09 UTC (rev 2939)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-20 17:10:26 UTC (rev 2940)
@@ -30,6 +30,7 @@
 #include "editor_window.hpp"
 #include "scroll_tool.hpp"
 #include "sector_model.hpp"
+#include "undo_manager.hpp"
 
 #include "sprite_object_model.hpp"
 #include "windstille_widget.hpp"
@@ -40,6 +41,7 @@
                                    const Glib::RefPtr<const Gdk::GL::Config>&  glconfig,
                                    const Glib::RefPtr<const Gdk::GL::Context>& share_list)
   : editor(editor_),
+    undo_manager(new UndoManager()),
     sector_model(new SectorModel()),
     scroll_tool(new ScrollTool()),
     map_type(DecalObjectModel::COLORMAP),
@@ -291,6 +293,18 @@
 }
 
 void
+WindstilleWidget::undo()
+{
+  undo_manager->undo();
+}
+
+void
+WindstilleWidget::redo()
+{
+  undo_manager->redo();
+}
+
+void
 WindstilleWidget::selection_raise()
 {
   for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)

Modified: trunk/windstille/src/editor/windstille_widget.hpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.hpp	2009-04-20 16:59:09 UTC (rev 2939)
+++ trunk/windstille/src/editor/windstille_widget.hpp	2009-04-20 17:10:26 UTC (rev 2940)
@@ -41,6 +41,7 @@
 #include "layer.hpp"
 
 class Tool;
+class UndoManager;
 class ScrollTool;
 class SectorModel;
 class EditorWindow;
@@ -54,6 +55,8 @@
 private:
   EditorWindow& editor;
 
+  std::auto_ptr<UndoManager> undo_manager;
+
   std::string filename;
   std::auto_ptr<SectorModel> sector_model;
   std::vector<ControlPointHandle> control_points;
@@ -103,6 +106,9 @@
   void draw();
   void update(float delta);
 
+  void undo();
+  void redo();
+
   void selection_raise();
   void selection_lower();
 



From grumbel at mail.berlios.de  Mon Apr 20 20:40:25 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Mon, 20 Apr 2009 20:40:25 +0200
Subject: [Windstille-commit] r2941 - in trunk/windstille/src: . editor
Message-ID: <200904201840.n3KIePeP005426@sheep.berlios.de>

Author: grumbel
Date: 2009-04-20 20:40:24 +0200 (Mon, 20 Apr 2009)
New Revision: 2941

Added:
   trunk/windstille/src/editor/object_commands.hpp
Modified:
   trunk/windstille/src/SConscript
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/editor_window.hpp
   trunk/windstille/src/editor/group_command.hpp
   trunk/windstille/src/editor/sector_model.cpp
   trunk/windstille/src/editor/sector_model.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
   trunk/windstille/src/editor/windstille_widget.hpp
Log:
Implemented undo/redo for object removal

Modified: trunk/windstille/src/SConscript
===================================================================
--- trunk/windstille/src/SConscript	2009-04-20 17:10:26 UTC (rev 2940)
+++ trunk/windstille/src/SConscript	2009-04-20 18:40:24 UTC (rev 2941)
@@ -252,10 +252,12 @@
         'editor/decal_scale_control_point.cpp',
         'editor/editor_window.cpp',
         'editor/layer_widget.cpp',
+#        'editor/group_command.cpp',
         'editor/layer.cpp',
         'editor/main.cpp',
         'editor/minimap_widget.cpp',
-        'editor/object_model.cpp',      
+        'editor/object_model.cpp',
+#        'editor/object_commands.cpp',
         'editor/object_model_factory.cpp',
         'editor/object_selector.cpp',
         'editor/particle_system_object_model.cpp',

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-20 17:10:26 UTC (rev 2940)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-20 18:40:24 UTC (rev 2941)
@@ -30,6 +30,7 @@
 #include <gtkmm/stock.h>
 #include <gtkmm/separatortoolitem.h>
 
+#include "undo_manager.hpp"
 #include "display/scene_context.hpp"
 #include "windstille_widget.hpp"
 #include "about_window.hpp"
@@ -232,8 +233,10 @@
   }
 
   action_group->add(Gtk::Action::create("MenuEdit",    "_Edit"));
-  action_group->add(Gtk::Action::create("Undo",        Gtk::Stock::UNDO));
-  action_group->add(Gtk::Action::create("Redo",        Gtk::Stock::REDO));
+  action_group->add(Gtk::Action::create("Undo",        Gtk::Stock::UNDO),
+                    sigc::mem_fun(*this, &EditorWindow::on_undo));
+  action_group->add(Gtk::Action::create("Redo",        Gtk::Stock::REDO),
+                    sigc::mem_fun(*this, &EditorWindow::on_redo));
   action_group->add(Gtk::Action::create("Cut",         Gtk::Stock::CUT),
                     sigc::mem_fun(*this, &EditorWindow::on_cut));
   action_group->add(Gtk::Action::create("Copy",        Gtk::Stock::COPY),
@@ -611,6 +614,38 @@
 }
 
 void
+EditorWindow::update_undo_state()
+{
+  if (WindstilleWidget* wst = get_windstille_widget())
+    {
+      action_group->get_action("Undo")->set_sensitive(wst->get_undo_manager()->can_undo());
+      action_group->get_action("Redo")->set_sensitive(wst->get_undo_manager()->can_redo());
+    }
+}
+
+void
+EditorWindow::on_undo()
+{
+  if (WindstilleWidget* wst = get_windstille_widget())
+    {
+      wst->undo();
+      update_undo_state();
+      queue_draw();
+    }
+}
+
+void
+EditorWindow::on_redo()
+{
+  if (WindstilleWidget* wst = get_windstille_widget())
+    {
+      wst->redo();
+      update_undo_state();
+      queue_draw();
+    }
+}
+
+void
 EditorWindow::on_tool_select(Glib::RefPtr<Gtk::RadioAction> action, Tool* tool)
 {
   //std::cout << "on_tool_select()" << action->get_active() << std::endl;

Modified: trunk/windstille/src/editor/editor_window.hpp
===================================================================
--- trunk/windstille/src/editor/editor_window.hpp	2009-04-20 17:10:26 UTC (rev 2940)
+++ trunk/windstille/src/editor/editor_window.hpp	2009-04-20 18:40:24 UTC (rev 2941)
@@ -117,6 +117,11 @@
   void on_zoom_out();
   void on_zoom_100();
 
+  void on_undo();
+  void on_redo();
+
+  void update_undo_state();
+
   void on_cut();
   void on_copy();
   void on_paste();

Modified: trunk/windstille/src/editor/group_command.hpp
===================================================================
--- trunk/windstille/src/editor/group_command.hpp	2009-04-20 17:10:26 UTC (rev 2940)
+++ trunk/windstille/src/editor/group_command.hpp	2009-04-20 18:40:24 UTC (rev 2941)
@@ -28,11 +28,11 @@
   Commands cmds;
 
 public:
-  GroupCommand();
-  ~GroupCommand();
+  GroupCommand() {}
+  ~GroupCommand() {}
 
   void add(CommandHandle cmd) {
-    cmds.push_back(cmds);
+    cmds.push_back(cmd);
   }
 
   void redo() {

Added: trunk/windstille/src/editor/object_commands.hpp
===================================================================
--- trunk/windstille/src/editor/object_commands.hpp	2009-04-20 17:10:26 UTC (rev 2940)
+++ trunk/windstille/src/editor/object_commands.hpp	2009-04-20 18:40:24 UTC (rev 2941)
@@ -0,0 +1,51 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#ifndef HEADER_WINDSTILLE_EDITOR_OBJECT_COMMANDS_HPP
+#define HEADER_WINDSTILLE_EDITOR_OBJECT_COMMANDS_HPP
+
+#include "layer.hpp"
+#include "object_model.hpp"
+#include "command.hpp"
+
+class ObjectRemoveCommand : public Command
+{
+private:
+  ObjectModelHandle    object;
+  LayerHandle          layer;
+
+public:
+  ObjectRemoveCommand(SectorModel& sector, ObjectModelHandle object_)
+    : object(object_),
+      layer(sector.get_layer(object))
+  {}
+  virtual ~ObjectRemoveCommand() {}
+  
+  void redo() {
+    layer->remove(object);
+  }
+
+  void undo() {
+    layer->add(object);
+  }
+
+};
+
+#endif
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/object_commands.hpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Modified: trunk/windstille/src/editor/sector_model.cpp
===================================================================
--- trunk/windstille/src/editor/sector_model.cpp	2009-04-20 17:10:26 UTC (rev 2940)
+++ trunk/windstille/src/editor/sector_model.cpp	2009-04-20 18:40:24 UTC (rev 2941)
@@ -161,6 +161,22 @@
     }
 }
 
+LayerHandle
+SectorModel::get_layer(const ObjectModelHandle& object) const
+{
+  const Layers& layers = get_layers();
+ 
+  for(Layers::const_reverse_iterator i = layers.rbegin(); i != layers.rend(); ++i)
+    {
+      if ((*i)->has_object(object))
+        {
+          return *i;
+        }
+    }  
+  
+  return LayerHandle();
+}
+
 void
 SectorModel::draw(SceneContext& sc, const SelectMask& layermask, bool draw_navgraph)
 {

Modified: trunk/windstille/src/editor/sector_model.hpp
===================================================================
--- trunk/windstille/src/editor/sector_model.hpp	2009-04-20 17:10:26 UTC (rev 2940)
+++ trunk/windstille/src/editor/sector_model.hpp	2009-04-20 18:40:24 UTC (rev 2941)
@@ -91,6 +91,7 @@
 
   void add(const ObjectModelHandle& object, const Gtk::TreeModel::Path& path);
   void remove(const ObjectModelHandle& object);
+  LayerHandle get_layer(const ObjectModelHandle& object) const;
 
   void  set_ambient_color(const Color& color) { ambient_color = color; }
   Color get_ambient_color() const { return ambient_color; }

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-20 17:10:26 UTC (rev 2940)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-20 18:40:24 UTC (rev 2941)
@@ -31,6 +31,8 @@
 #include "scroll_tool.hpp"
 #include "sector_model.hpp"
 #include "undo_manager.hpp"
+#include "group_command.hpp"
+#include "object_commands.hpp"
 
 #include "sprite_object_model.hpp"
 #include "windstille_widget.hpp"
@@ -510,12 +512,17 @@
 void
 WindstilleWidget::selection_delete()
 {
- for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
+  boost::shared_ptr<GroupCommand> group_cmd(new GroupCommand());
+
+  for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
     {
-      sector_model->remove(*i);
-    } 
+      group_cmd->add(CommandHandle(new ObjectRemoveCommand(*sector_model, *i)));
+    }
+
+  undo_manager->execute(group_cmd);
+  EditorWindow::current()->update_undo_state();
+
  selection->clear();
-
  queue_draw();
 }
 

Modified: trunk/windstille/src/editor/windstille_widget.hpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.hpp	2009-04-20 17:10:26 UTC (rev 2940)
+++ trunk/windstille/src/editor/windstille_widget.hpp	2009-04-20 18:40:24 UTC (rev 2941)
@@ -130,6 +130,7 @@
   void selection_object_properties();
 
   SectorModel* get_sector_model();
+  UndoManager* get_undo_manager() const { return undo_manager.get(); }
   void set_selection(const SelectionHandle& selection);
   SelectionHandle get_selection() const;
 



From grumbel at mail.berlios.de  Mon Apr 20 20:59:49 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Mon, 20 Apr 2009 20:59:49 +0200
Subject: [Windstille-commit] r2942 - trunk/windstille/src/editor
Message-ID: <200904201859.n3KIxnve007660@sheep.berlios.de>

Author: grumbel
Date: 2009-04-20 20:59:49 +0200 (Mon, 20 Apr 2009)
New Revision: 2942

Modified:
   trunk/windstille/src/editor/object_commands.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
Log:
Implemented ObjectAddCommand

Modified: trunk/windstille/src/editor/object_commands.hpp
===================================================================
--- trunk/windstille/src/editor/object_commands.hpp	2009-04-20 18:40:24 UTC (rev 2941)
+++ trunk/windstille/src/editor/object_commands.hpp	2009-04-20 18:59:49 UTC (rev 2942)
@@ -26,13 +26,13 @@
 class ObjectRemoveCommand : public Command
 {
 private:
+  LayerHandle          layer;
   ObjectModelHandle    object;
-  LayerHandle          layer;
 
 public:
   ObjectRemoveCommand(SectorModel& sector, ObjectModelHandle object_)
-    : object(object_),
-      layer(sector.get_layer(object))
+    : layer(sector.get_layer(object_)),
+      object(object_)
   {}
   virtual ~ObjectRemoveCommand() {}
   
@@ -46,6 +46,28 @@
 
 };
 
+class ObjectAddCommand : public Command
+{
+private:
+  LayerHandle          layer;
+  ObjectModelHandle    object;
+  
+public:
+  ObjectAddCommand(LayerHandle layer_, ObjectModelHandle object_)
+    : layer(layer_),
+      object(object_)
+  {}
+  virtual ~ObjectAddCommand() {}
+  
+  void redo() {
+    layer->add(object);
+  }
+
+  void undo() {
+    layer->remove(object);
+  }
+};
+
 #endif
 
 /* EOF */

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-20 18:40:24 UTC (rev 2941)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-20 18:59:49 UTC (rev 2942)
@@ -513,12 +513,10 @@
 WindstilleWidget::selection_delete()
 {
   boost::shared_ptr<GroupCommand> group_cmd(new GroupCommand());
-
   for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
     {
       group_cmd->add(CommandHandle(new ObjectRemoveCommand(*sector_model, *i)));
     }
-
   undo_manager->execute(group_cmd);
   EditorWindow::current()->update_undo_state();
 
@@ -699,9 +697,14 @@
   EditorWindow::current()->get_layer_manager().get_treeview().get_cursor(path, focus_column);
 
   if (!path.gobj())
-    std::cout << "WindstilleWidget::on_drag_data_received(): Error: Couldn't get path" << std::endl;
+    {
+      std::cout << "WindstilleWidget::on_drag_data_received(): Error: Couldn't get path" << std::endl;
+    }
   else
-    sector_model->add(object, path);
+    {
+      undo_manager->execute(CommandHandle(new ObjectAddCommand(sector_model->get_layer(path), object)));
+      EditorWindow::current()->update_undo_state();
+    }
 }
 
 void



From grumbel at mail.berlios.de  Wed Apr 22 06:25:09 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 22 Apr 2009 06:25:09 +0200
Subject: [Windstille-commit] r2943 - in trunk/windstille: . src/editor
Message-ID: <200904220425.n3M4P9HM024615@sheep.berlios.de>

Author: grumbel
Date: 2009-04-22 06:25:08 +0200 (Wed, 22 Apr 2009)
New Revision: 2943

Added:
   trunk/windstille/src/editor/functor_command.hpp
Modified:
   trunk/windstille/TODO
   trunk/windstille/src/editor/object_commands.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
Log:
Added FunctorCommand and hooked up some more function to undo/redo

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-04-20 18:59:49 UTC (rev 2942)
+++ trunk/windstille/TODO	2009-04-22 04:25:08 UTC (rev 2943)
@@ -783,15 +783,16 @@
   * EdgeRemoveCommand
   * NodeSetPosCommand
 
-  * ObjectAddCommand
-  * ObjectRemoveCommand
+  * ObjectAddCommand      [done]
+  * ObjectRemoveCommand   [done]
+  * ObjectReorderCommand (raise/lower)
+
   * ObjectSetAngleCommand
   * ObjectSetScaleCommand
   * ObjectSetPosCommand
   * ObjectSetParent
   * ObjectSetHFlip
   * ObjectSetVFlip
-  * ObjectReorderCommand (raise/lower)
 
   * LayerAddCommand
   * LayerRemovedCommand

Added: trunk/windstille/src/editor/functor_command.hpp
===================================================================
--- trunk/windstille/src/editor/functor_command.hpp	2009-04-20 18:59:49 UTC (rev 2942)
+++ trunk/windstille/src/editor/functor_command.hpp	2009-04-22 04:25:08 UTC (rev 2943)
@@ -0,0 +1,52 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#ifndef HEADER_WINDSTILLE_EDITOR_FUNCTOR_COMMAND_HPP
+#define HEADER_WINDSTILLE_EDITOR_FUNCTOR_COMMAND_HPP
+
+#include "command.hpp"
+
+class FunctorCommand : public Command
+{
+private:
+  boost::function<void ()> undo_callback;
+  boost::function<void ()> redo_callback;
+
+public:
+  FunctorCommand(const boost::function<void ()>& undo_callback_,
+                 const boost::function<void ()>& redo_callback_)
+    : undo_callback(undo_callback_),
+      redo_callback(redo_callback_)
+  {}
+
+  void redo() {
+    redo_callback();
+  }
+
+  void undo() {
+    undo_callback();
+  }
+
+private:
+  FunctorCommand(const FunctorCommand&);
+  FunctorCommand& operator=(const FunctorCommand&);
+};
+
+#endif
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/functor_command.hpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Modified: trunk/windstille/src/editor/object_commands.hpp
===================================================================
--- trunk/windstille/src/editor/object_commands.hpp	2009-04-20 18:59:49 UTC (rev 2942)
+++ trunk/windstille/src/editor/object_commands.hpp	2009-04-22 04:25:08 UTC (rev 2943)
@@ -19,6 +19,8 @@
 #ifndef HEADER_WINDSTILLE_EDITOR_OBJECT_COMMANDS_HPP
 #define HEADER_WINDSTILLE_EDITOR_OBJECT_COMMANDS_HPP
 
+#include <boost/function.hpp>
+
 #include "layer.hpp"
 #include "object_model.hpp"
 #include "command.hpp"
@@ -68,6 +70,30 @@
   }
 };
 
+class ObjectSetPosCommand : public Command
+{
+private:
+  ObjectModelHandle    object;
+  Vector2f             orig_pos;
+  Vector2f             new_pos;
+  
+public:
+  ObjectSetPosCommand(ObjectModelHandle object_, const Vector2f& new_pos_)
+    : object(object_),
+      orig_pos(object->get_rel_pos()),
+      new_pos(new_pos_)
+  {}
+  virtual ~ObjectSetPosCommand() {}
+  
+  void redo() {
+    object->set_rel_pos(new_pos);
+  }
+
+  void undo() {
+    object->set_rel_pos(orig_pos);
+  }
+};
+
 #endif
 
 /* EOF */

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-20 18:59:49 UTC (rev 2942)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-22 04:25:08 UTC (rev 2943)
@@ -20,6 +20,7 @@
 #include <GL/gl.h>
 #include <GL/glu.h>
 #include <gtkmm.h>
+#include <boost/bind.hpp>
 
 #include "sprite2d/sprite.hpp"
 #include "display/display.hpp"
@@ -33,6 +34,7 @@
 #include "undo_manager.hpp"
 #include "group_command.hpp"
 #include "object_commands.hpp"
+#include "functor_command.hpp"
 
 #include "sprite_object_model.hpp"
 #include "windstille_widget.hpp"
@@ -351,6 +353,8 @@
 {
   if (!selection->empty())
     {
+      boost::shared_ptr<GroupCommand> group_command(new GroupCommand());
+
       if (selection->size() > 1)
         {
           const Vector2f& center = selection->get_bounding_box().get_center();
@@ -360,14 +364,20 @@
           
               pos.y = center.y + (center.y - pos.y);
           
-              (*i)->set_world_pos(pos);
+              //(*i)->set_world_pos(pos);
+              group_command->add(CommandHandle(new FunctorCommand(boost::bind(&ObjectModel::set_world_pos, *i, (*i)->get_world_pos()),
+                                                                  boost::bind(&ObjectModel::set_world_pos, *i, pos))));
             }
         }
 
       for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
         {
-          (*i)->set_vflip(!(*i)->get_vflip());
+          //(*i)->set_vflip(!(*i)->get_vflip());
+          group_command->add(CommandHandle(new FunctorCommand(boost::bind(&ObjectModel::set_vflip, *i,  (*i)->get_vflip()),
+                                                              boost::bind(&ObjectModel::set_vflip, *i, !(*i)->get_vflip()))));
         }
+
+      undo_manager->execute(group_command);
       queue_draw();
     }
 }
@@ -377,6 +387,8 @@
 {
   if (!selection->empty())
     {
+      boost::shared_ptr<GroupCommand> group_command(new GroupCommand());
+
       if (selection->size() > 1)
         {
           const Vector2f& center = selection->get_bounding_box().get_center();
@@ -386,14 +398,20 @@
           
               pos.x = center.x + (center.x - pos.x);
           
-              (*i)->set_world_pos(pos);
+              //(*i)->set_world_pos(pos);
+              group_command->add(CommandHandle(new FunctorCommand(boost::bind(&ObjectModel::set_world_pos, *i, (*i)->get_world_pos()),
+                                                                  boost::bind(&ObjectModel::set_world_pos, *i, pos))));
             }
         }
 
       for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
         {
-          (*i)->set_hflip(!(*i)->get_hflip());
+          //(*i)->set_hflip(!(*i)->get_hflip());
+          group_command->add(CommandHandle(new FunctorCommand(boost::bind(&ObjectModel::set_hflip, *i,  (*i)->get_hflip()),
+                                                              boost::bind(&ObjectModel::set_hflip, *i, !(*i)->get_hflip()))));
         }
+
+      undo_manager->execute(group_command);
       queue_draw();
     }
 }
@@ -403,25 +421,37 @@
 {
   if (selection->size() >= 2)
     {
+      boost::shared_ptr<GroupCommand> group_command(new GroupCommand());
+
       ObjectModelHandle parent = *selection->begin();
 
       Selection::iterator i = selection->begin();
       ++i;
       for(; i != selection->end(); ++i)
         {
-          (*i)->set_parent(parent);
+          //(*i)->set_parent(parent);
+          group_command->add(CommandHandle(new FunctorCommand(boost::bind(&ObjectModel::set_parent, *i, (*i)->get_parent(), true),
+                                                              boost::bind(&ObjectModel::set_parent, *i, parent, true))));
         }
+
+      undo_manager->execute(group_command);
+      queue_draw();
     }
-  queue_draw();
 }
 
 void
 WindstilleWidget::selection_clear_parent()
 {
+  boost::shared_ptr<GroupCommand> group_command(new GroupCommand());
+
   for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
     {
-      (*i)->set_parent(ObjectModelHandle());
+      //(*i)->set_parent(ObjectModelHandle());
+      group_command->add(CommandHandle(new FunctorCommand(boost::bind(&ObjectModel::set_parent, *i, (*i)->get_parent(), true),
+                                                          boost::bind(&ObjectModel::set_parent, *i, ObjectModelHandle(), true))));
     }
+
+  undo_manager->execute(group_command);
   queue_draw();
 }
 
@@ -476,15 +506,22 @@
 void
 WindstilleWidget::selection_reset_rotation()
 {
+  boost::shared_ptr<GroupCommand> group_command(new GroupCommand());
+
   for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
     {
       DecalObjectModel* decal = dynamic_cast<DecalObjectModel*>(i->get());
+
       if (decal)
         {
-          decal->set_angle(0.0f);
+          //decal->set_angle(0.0f);
+          group_command->add(CommandHandle(new FunctorCommand(boost::bind(&DecalObjectModel::set_angle, decal, decal->get_angle()),
+                                                              boost::bind(&DecalObjectModel::set_angle, decal, 0.0f))));
         }
     }
+
   on_selection_change();
+  undo_manager->execute(group_command);
   queue_draw();
 }
 
@@ -497,15 +534,21 @@
 void
 WindstilleWidget::selection_reset_scale()
 {
+  boost::shared_ptr<GroupCommand> group_command(new GroupCommand());
+
  for(Selection::iterator i = selection->begin(); i != selection->end(); ++i)
     {
       DecalObjectModel* decal = dynamic_cast<DecalObjectModel*>(i->get());
       if (decal)
         {
-          decal->set_scale(Vector2f(1.0f, 1.0f));
+          //decal->set_scale(Vector2f(1.0f, 1.0f));
+          group_command->add(CommandHandle(new FunctorCommand(boost::bind(&DecalObjectModel::set_scale, decal, decal->get_scale()),
+                                                              boost::bind(&DecalObjectModel::set_scale, decal, Vector2f(1.0f, 1.0f)))));
         }
     }
+
  on_selection_change();
+ undo_manager->execute(group_command);
  queue_draw();
 }
 



From grumbel at mail.berlios.de  Wed Apr 22 06:37:33 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 22 Apr 2009 06:37:33 +0200
Subject: [Windstille-commit] r2944 - trunk/windstille/src/editor
Message-ID: <200904220437.n3M4bXU3030444@sheep.berlios.de>

Author: grumbel
Date: 2009-04-22 06:37:31 +0200 (Wed, 22 Apr 2009)
New Revision: 2944

Modified:
   trunk/windstille/src/editor/windstille_widget.cpp
Log:
Implemented undo/redo for duplicate

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-22 04:25:08 UTC (rev 2943)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-22 04:37:31 UTC (rev 2944)
@@ -458,6 +458,7 @@
 void
 WindstilleWidget::selection_duplicate()
 {
+  boost::shared_ptr<GroupCommand> group_command(new GroupCommand());
   std::map<ObjectModelHandle, ObjectModelHandle> parent_map;
 
   SelectionHandle new_selection = Selection::create();
@@ -476,8 +477,10 @@
         {
           // Move clone a litte to make it more obvious that something happened
           obj->set_rel_pos(obj->get_rel_pos() + Vector2f(32.0f, 32.0f));
-          layer->add(obj);
           new_selection->add(obj);
+
+          //layer->add(obj);
+          group_command->add(CommandHandle(new ObjectAddCommand(layer, obj)));
         }
     }
 
@@ -500,6 +503,8 @@
         }
     }
 
+  undo_manager->execute(group_command);
+
   set_selection(new_selection);
 }
 



From grumbel at mail.berlios.de  Wed Apr 22 07:01:43 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 22 Apr 2009 07:01:43 +0200
Subject: [Windstille-commit] r2945 - in trunk/windstille: . src/editor
Message-ID: <200904220501.n3M51hjU019510@sheep.berlios.de>

Author: grumbel
Date: 2009-04-22 07:01:32 +0200 (Wed, 22 Apr 2009)
New Revision: 2945

Modified:
   trunk/windstille/TODO
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/functor_command.hpp
   trunk/windstille/src/editor/group_command.hpp
   trunk/windstille/src/editor/object_model.cpp
   trunk/windstille/src/editor/object_model.hpp
   trunk/windstille/src/editor/select_tool.cpp
   trunk/windstille/src/editor/selection.cpp
   trunk/windstille/src/editor/selection.hpp
   trunk/windstille/src/editor/windstille_widget.cpp
Log:
Moved ObjectModel offset handling into Selection, implemented undo/redo for move, fixed some undo/redo button update issues

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-04-22 04:37:31 UTC (rev 2944)
+++ trunk/windstille/TODO	2009-04-22 05:01:32 UTC (rev 2945)
@@ -787,19 +787,19 @@
   * ObjectRemoveCommand   [done]
   * ObjectReorderCommand (raise/lower)
 
-  * ObjectSetAngleCommand
-  * ObjectSetScaleCommand
-  * ObjectSetPosCommand
-  * ObjectSetParent
-  * ObjectSetHFlip
-  * ObjectSetVFlip
+  * ObjectSetAngleCommand [done]
+  * ObjectSetScaleCommand [done]
+  * ObjectSetPosCommand   [done]
+  * ObjectSetParent       [done]
+  * ObjectSetHFlip        [done]
+  * ObjectSetVFlip        [done]
 
   * LayerAddCommand
   * LayerRemovedCommand
   * LayerReorderCommand
 
-  * GenericCommand(Object objects[],
-                   sigc::mem_fun(&ObjectModel::set_pos));
+  * FunctorCommand(boost::functor<void ()>& undo,
+                   boost::functor<void ()>& redo); [done]
 
 * implement non-Surface based objects:
 

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-22 04:37:31 UTC (rev 2944)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-22 05:01:32 UTC (rev 2945)
@@ -756,6 +756,8 @@
       background_layer->set_active(wst->get_draw_background_pattern());
       visible_layer->set_active(wst->get_draw_only_active_layer());
       grid_layer->set_active(wst->get_enable_grid());
+
+      update_undo_state();
     }
   else
     {

Modified: trunk/windstille/src/editor/functor_command.hpp
===================================================================
--- trunk/windstille/src/editor/functor_command.hpp	2009-04-22 04:37:31 UTC (rev 2944)
+++ trunk/windstille/src/editor/functor_command.hpp	2009-04-22 05:01:32 UTC (rev 2945)
@@ -19,6 +19,8 @@
 #ifndef HEADER_WINDSTILLE_EDITOR_FUNCTOR_COMMAND_HPP
 #define HEADER_WINDSTILLE_EDITOR_FUNCTOR_COMMAND_HPP
 
+#include <boost/function.hpp>
+
 #include "command.hpp"
 
 class FunctorCommand : public Command

Modified: trunk/windstille/src/editor/group_command.hpp
===================================================================
--- trunk/windstille/src/editor/group_command.hpp	2009-04-22 04:37:31 UTC (rev 2944)
+++ trunk/windstille/src/editor/group_command.hpp	2009-04-22 05:01:32 UTC (rev 2945)
@@ -19,6 +19,7 @@
 #ifndef HEADER_WINDSTILLE_EDITOR_GROUP_COMMAND_HPP
 #define HEADER_WINDSTILLE_EDITOR_GROUP_COMMAND_HPP
 
+#include <vector>
 #include "command.hpp"
 
 class GroupCommand : public Command

Modified: trunk/windstille/src/editor/object_model.cpp
===================================================================
--- trunk/windstille/src/editor/object_model.cpp	2009-04-22 04:37:31 UTC (rev 2944)
+++ trunk/windstille/src/editor/object_model.cpp	2009-04-22 05:01:32 UTC (rev 2945)
@@ -113,11 +113,11 @@
   ObjectModelHandle parent = parent_ptr.lock();
   if (parent.get())
     {
-      return rel_pos + move_offset + parent->get_world_pos();
+      return rel_pos + parent->get_world_pos();
     }
   else
     {
-      return rel_pos + move_offset;
+      return rel_pos;
     }
 }
 
@@ -131,6 +131,14 @@
 }
 
 void
+ObjectModel::set_rel_pos(const Vector2f& rel_pos_)
+{
+  // Cut to integer positions
+  rel_pos.x = floorf(rel_pos_.x);
+  rel_pos.y = floorf(rel_pos_.y);
+}
+
+void
 ObjectModel::draw_select(SceneContext& sc, bool highlight)
 {
   if (highlight)
@@ -153,38 +161,6 @@
 }
 
 void
-ObjectModel::on_move_start()
-{
-}
-
-void
-ObjectModel::on_move_update(const Vector2f& offset)
-{
-  // Cut to integer positions
-  move_offset.x = floorf(offset.x);
-  move_offset.y = floorf(offset.y);
-
-  // Cut to integer positions
-  rel_pos.x = floorf(rel_pos.x);
-  rel_pos.y = floorf(rel_pos.y);
-}
-
-void
-ObjectModel::on_move_end(const Vector2f& offset)
-{
-  // Cut to integer positions
-  move_offset.x = floorf(offset.x);
-  move_offset.y = floorf(offset.y);
-
-  rel_pos += move_offset;
-  move_offset = Vector2f(0,0);
-
-  // Cut to integer positions
-  rel_pos.x = floorf(rel_pos.x);
-  rel_pos.y = floorf(rel_pos.y);
-}
-
-void
 ObjectModel::reset()
 {
 }

Modified: trunk/windstille/src/editor/object_model.hpp
===================================================================
--- trunk/windstille/src/editor/object_model.hpp	2009-04-22 04:37:31 UTC (rev 2944)
+++ trunk/windstille/src/editor/object_model.hpp	2009-04-22 05:01:32 UTC (rev 2945)
@@ -44,7 +44,6 @@
   SelectMask  select_mask;
 
   ObjectModelPtr parent_ptr;
-  Vector2f move_offset;
 
 public:
   ObjectModel(const FileReader& reader);
@@ -61,11 +60,7 @@
   void set_world_pos(const Vector2f& p);
 
   Vector2f get_rel_pos() const { return rel_pos; }
-  void     set_rel_pos(const Vector2f& rel_pos_)  {  rel_pos = rel_pos_; }
-  
-  void on_move_start();
-  void on_move_update(const Vector2f& offset);
-  void on_move_end(const Vector2f& offset);
+  void     set_rel_pos(const Vector2f& rel_pos_);
 
   SelectMask get_select_mask() const { return select_mask; }
   void   set_select_mask(const SelectMask& select_mask_) { select_mask = select_mask_; }

Modified: trunk/windstille/src/editor/select_tool.cpp
===================================================================
--- trunk/windstille/src/editor/select_tool.cpp	2009-04-22 04:37:31 UTC (rev 2944)
+++ trunk/windstille/src/editor/select_tool.cpp	2009-04-22 05:01:32 UTC (rev 2945)
@@ -185,11 +185,11 @@
       
           if (event->state & GDK_CONTROL_MASK)
             {
-              selection->on_move_end(offset + process_snap(wst));
+              selection->on_move_end(wst, offset + process_snap(wst));
             }
           else
             {
-              selection->on_move_end(offset);
+              selection->on_move_end(wst, offset);
             }
           wst.queue_draw();
         }

Modified: trunk/windstille/src/editor/selection.cpp
===================================================================
--- trunk/windstille/src/editor/selection.cpp	2009-04-22 04:37:31 UTC (rev 2944)
+++ trunk/windstille/src/editor/selection.cpp	2009-04-22 05:01:32 UTC (rev 2945)
@@ -17,6 +17,12 @@
 */
 
 #include <iostream>
+#include <boost/bind.hpp>
+
+#include "undo_manager.hpp"
+#include "group_command.hpp"
+#include "functor_command.hpp"
+#include "windstille_widget.hpp"
 #include "editor_window.hpp"
 #include "selection.hpp"
 
@@ -99,10 +105,15 @@
         }
     }
 
+  object_orig_poss.clear();
+
   for(Objects::iterator i = objects.begin(); i != objects.end(); ++i)
     {
       if (non_moveable_objects.find(*i) == non_moveable_objects.end())
-        (*i)->on_move_start();
+        {
+          //(*i)->on_move_start();
+          object_orig_poss.push_back((*i)->get_rel_pos());
+        }
     }
 
   signal_changed();
@@ -114,23 +125,35 @@
   for(Objects::iterator i = objects.begin(); i != objects.end(); ++i)
     {
       if (non_moveable_objects.find(*i) == non_moveable_objects.end())
-        (*i)->on_move_update(offset);
+        {
+          (*i)->set_rel_pos(object_orig_poss[i - objects.begin()] + offset);
+        }
     }
 }
 
 void
-Selection::on_move_end(const Vector2f& offset)
+Selection::on_move_end(WindstilleWidget& wst, const Vector2f& offset)
 {
   moving = false;
 
+  boost::shared_ptr<GroupCommand> group_command(new GroupCommand());
+
   for(Objects::iterator i = objects.begin(); i != objects.end(); ++i)
     {
       if (non_moveable_objects.find(*i) == non_moveable_objects.end())
-        (*i)->on_move_end(offset);
+        {
+          //(*i)->on_move_end(offset);
+          //(*i)->set_rel_pos(object_orig_poss[i - objects.begin()]);
+
+          group_command->add(CommandHandle(new FunctorCommand(boost::bind(&ObjectModel::set_rel_pos, *i, object_orig_poss[i - objects.begin()]),
+                                                              boost::bind(&ObjectModel::set_rel_pos, *i, object_orig_poss[i - objects.begin()] + offset))));
+        }
     }
 
   non_moveable_objects.clear();
 
+  wst.get_undo_manager()->execute(group_command);
+  EditorWindow::current()->update_undo_state();
   signal_changed();
 }
 

Modified: trunk/windstille/src/editor/selection.hpp
===================================================================
--- trunk/windstille/src/editor/selection.hpp	2009-04-22 04:37:31 UTC (rev 2944)
+++ trunk/windstille/src/editor/selection.hpp	2009-04-22 05:01:32 UTC (rev 2945)
@@ -27,6 +27,7 @@
 #include "object_model.hpp"
 
 class Selection;
+class WindstilleWidget;
 typedef boost::shared_ptr<Selection> SelectionHandle;
 
 class Selection
@@ -35,6 +36,8 @@
   typedef std::vector<ObjectModelHandle> Objects;
   Objects objects;
 
+  std::vector<Vector2f> object_orig_poss;
+
   std::set<ObjectModelHandle> non_moveable_objects;
 
   bool moving;
@@ -80,7 +83,7 @@
 
   void on_move_start();
   void on_move_update(const Vector2f& offset);
-  void on_move_end(const Vector2f& offset);
+  void on_move_end(WindstilleWidget& wst, const Vector2f& offset);
   
   /** Performs a deep clone of the selection */
   SelectionHandle clone() const;

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-22 04:37:31 UTC (rev 2944)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-22 05:01:32 UTC (rev 2945)
@@ -378,6 +378,7 @@
         }
 
       undo_manager->execute(group_command);
+      EditorWindow::current()->update_undo_state();
       queue_draw();
     }
 }
@@ -412,6 +413,7 @@
         }
 
       undo_manager->execute(group_command);
+      EditorWindow::current()->update_undo_state();
       queue_draw();
     }
 }
@@ -435,6 +437,7 @@
         }
 
       undo_manager->execute(group_command);
+      EditorWindow::current()->update_undo_state();
       queue_draw();
     }
 }
@@ -452,6 +455,7 @@
     }
 
   undo_manager->execute(group_command);
+  EditorWindow::current()->update_undo_state();
   queue_draw();
 }
 
@@ -504,7 +508,7 @@
     }
 
   undo_manager->execute(group_command);
-
+  EditorWindow::current()->update_undo_state();
   set_selection(new_selection);
 }
 
@@ -527,6 +531,7 @@
 
   on_selection_change();
   undo_manager->execute(group_command);
+  EditorWindow::current()->update_undo_state();
   queue_draw();
 }
 
@@ -554,6 +559,7 @@
 
  on_selection_change();
  undo_manager->execute(group_command);
+ EditorWindow::current()->update_undo_state();
  queue_draw();
 }
 
@@ -567,6 +573,7 @@
     }
   undo_manager->execute(group_cmd);
   EditorWindow::current()->update_undo_state();
+  EditorWindow::current()->update_undo_state();
 
  selection->clear();
  queue_draw();



From grumbel at mail.berlios.de  Wed Apr 22 18:53:50 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 22 Apr 2009 18:53:50 +0200
Subject: [Windstille-commit] r2946 - in trunk/windstille: . src/editor
Message-ID: <200904221653.n3MGroRb018736@sheep.berlios.de>

Author: grumbel
Date: 2009-04-22 18:53:48 +0200 (Wed, 22 Apr 2009)
New Revision: 2946

Added:
   trunk/windstille/src/editor/layer_commands.hpp
Modified:
   trunk/windstille/TODO
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/group_command.hpp
   trunk/windstille/src/editor/object_commands.hpp
   trunk/windstille/src/editor/sector_model.cpp
   trunk/windstille/src/editor/sector_model.hpp
Log:
Implemented some undo/redo for LayerAdd/Remove

Modified: trunk/windstille/TODO
===================================================================
--- trunk/windstille/TODO	2009-04-22 05:01:32 UTC (rev 2945)
+++ trunk/windstille/TODO	2009-04-22 16:53:48 UTC (rev 2946)
@@ -522,6 +522,8 @@
 Editor
 ======
 
+* unify delete/remove/erase a bit
+
 * figure out a way to rename image files without breaking the levels
 
 * new boost1.37 seems to be missing boost_signals, instead it has
@@ -775,7 +777,7 @@
 
 * think about Undo/Redo
 
-  * CommandGroupCommand
+  * CommandGroupCommand  [done]
 
   * NodeAddCommand
   * NodeRemoveCommand
@@ -794,8 +796,8 @@
   * ObjectSetHFlip        [done]
   * ObjectSetVFlip        [done]
 
-  * LayerAddCommand
-  * LayerRemovedCommand
+  * LayerAddCommand     [done, except proper order]
+  * LayerRemovedCommand [done, except proper order]
   * LayerReorderCommand
 
   * FunctorCommand(boost::functor<void ()>& undo,

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-22 05:01:32 UTC (rev 2945)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-22 16:53:48 UTC (rev 2946)
@@ -30,6 +30,7 @@
 #include <gtkmm/stock.h>
 #include <gtkmm/separatortoolitem.h>
 
+#include "layer_commands.hpp"
 #include "undo_manager.hpp"
 #include "display/scene_context.hpp"
 #include "windstille_widget.hpp"
@@ -41,6 +42,7 @@
 #include "navgraph_select_tool.hpp"
 #include "sector_model.hpp"
 #include "layer_widget.hpp"
+
 #include "editor_window.hpp"
 
 EditorWindow* EditorWindow::current_ = 0;
@@ -840,7 +842,12 @@
   if (WindstilleWidget* wst = get_windstille_widget())
     {
       //std::cout << "Deleting layer: " << wst << std::endl;
-      wst->get_sector_model()->delete_layer(wst->get_current_layer_path());
+      //wst->get_sector_model()->delete_layer(wst->get_current_layer_path());
+
+      CommandHandle cmd(new LayerDeleteCommand(*wst->get_sector_model(), wst->get_current_layer_path()));
+      wst->get_undo_manager()->execute(cmd);
+      EditorWindow::current()->update_undo_state();
+      queue_draw();
     }
 }
 
@@ -850,8 +857,13 @@
   if (WindstilleWidget* wst = get_windstille_widget())
     {
       //std::cout << "Adding layer" << std::endl;
-      wst->get_sector_model()->add_layer("New Layer", wst->get_current_layer_path());
+      //wst->get_sector_model()->add_layer("New Layer", wst->get_current_layer_path());
 
+      CommandHandle cmd(new LayerAddCommand(*wst->get_sector_model(), wst->get_current_layer_path()));
+      wst->get_undo_manager()->execute(cmd);
+      EditorWindow::current()->update_undo_state();
+      queue_draw();
+
       layer_manager.get_treeview().expand_all();
     }
 }

Modified: trunk/windstille/src/editor/group_command.hpp
===================================================================
--- trunk/windstille/src/editor/group_command.hpp	2009-04-22 05:01:32 UTC (rev 2945)
+++ trunk/windstille/src/editor/group_command.hpp	2009-04-22 16:53:48 UTC (rev 2946)
@@ -30,7 +30,6 @@
 
 public:
   GroupCommand() {}
-  ~GroupCommand() {}
 
   void add(CommandHandle cmd) {
     cmds.push_back(cmd);

Added: trunk/windstille/src/editor/layer_commands.hpp
===================================================================
--- trunk/windstille/src/editor/layer_commands.hpp	2009-04-22 05:01:32 UTC (rev 2945)
+++ trunk/windstille/src/editor/layer_commands.hpp	2009-04-22 16:53:48 UTC (rev 2946)
@@ -0,0 +1,80 @@
+/*
+**  Windstille - A Sci-Fi Action-Adventure Game
+**  Copyright (C) 2009 Ingo Ruhnke <grumbel at gmx.de>
+**
+**  This program is free software: you can redistribute it and/or modify
+**  it under the terms of the GNU General Public License as published by
+**  the Free Software Foundation, either version 3 of the License, or
+**  (at your option) any later version.
+**  
+**  This program is distributed in the hope that it will be useful,
+**  but WITHOUT ANY WARRANTY; without even the implied warranty of
+**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+**  GNU General Public License for more details.
+**  
+**  You should have received a copy of the GNU General Public License
+**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+#ifndef HEADER_WINDSTILLE_EDITOR_LAYER_COMMANDS_HPP
+#define HEADER_WINDSTILLE_EDITOR_LAYER_COMMANDS_HPP
+
+#include "layer.hpp"
+#include "command.hpp"
+#include "sector_model.hpp"
+
+class LayerAddCommand : public Command
+{
+private:
+  SectorModel& sector;
+  Gtk::TreeModel::Path path;
+
+public:
+  LayerAddCommand(SectorModel& sector_, const Gtk::TreeModel::Path& path_)
+    : sector(sector_), 
+      path(path_)
+  {}
+
+  void redo() {
+    sector.add_layer("New Layer", path);
+  }
+
+  void undo() {
+    sector.delete_layer(path);
+  }
+
+private:
+  LayerAddCommand(const LayerAddCommand&);
+  LayerAddCommand& operator=(const LayerAddCommand&);
+};
+
+class LayerDeleteCommand : public Command
+{
+private:
+  SectorModel& sector;
+  Gtk::TreeModel::Path path;
+  LayerHandle layer;
+
+public:
+  LayerDeleteCommand(SectorModel& sector_, const Gtk::TreeModel::Path& path_)
+    : sector(sector_), 
+      path(path_),
+      layer(sector.get_layer(path))
+  {}
+
+  void redo() {
+    sector.delete_layer(path);
+  }
+
+  void undo() {
+    sector.add_layer(layer/*, path*/);
+  }
+
+private:
+  LayerDeleteCommand(const LayerDeleteCommand&);
+  LayerDeleteCommand& operator=(const LayerDeleteCommand&);
+};
+
+#endif
+
+/* EOF */


Property changes on: trunk/windstille/src/editor/layer_commands.hpp
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Modified: trunk/windstille/src/editor/object_commands.hpp
===================================================================
--- trunk/windstille/src/editor/object_commands.hpp	2009-04-22 05:01:32 UTC (rev 2945)
+++ trunk/windstille/src/editor/object_commands.hpp	2009-04-22 16:53:48 UTC (rev 2946)
@@ -36,7 +36,6 @@
     : layer(sector.get_layer(object_)),
       object(object_)
   {}
-  virtual ~ObjectRemoveCommand() {}
   
   void redo() {
     layer->remove(object);
@@ -59,7 +58,6 @@
     : layer(layer_),
       object(object_)
   {}
-  virtual ~ObjectAddCommand() {}
   
   void redo() {
     layer->add(object);
@@ -83,7 +81,6 @@
       orig_pos(object->get_rel_pos()),
       new_pos(new_pos_)
   {}
-  virtual ~ObjectSetPosCommand() {}
   
   void redo() {
     object->set_rel_pos(new_pos);

Modified: trunk/windstille/src/editor/sector_model.cpp
===================================================================
--- trunk/windstille/src/editor/sector_model.cpp	2009-04-22 05:01:32 UTC (rev 2945)
+++ trunk/windstille/src/editor/sector_model.cpp	2009-04-22 16:53:48 UTC (rev 2946)
@@ -62,6 +62,23 @@
 }
 
 void
+SectorModel::add_layer(LayerHandle layer, const Gtk::TreeModel::Path& path)
+{
+ Gtk::ListStore::iterator it;
+
+  if (path.empty())
+    it = layer_tree->append();
+  else
+    it = layer_tree->insert(layer_tree->get_iter(path));
+  
+  (*it)[LayerManagerColumns::instance().type_icon] = Gdk::Pixbuf::create_from_file("data/editor/type.png");
+  (*it)[LayerManagerColumns::instance().name]      = "Restored Layer";
+  (*it)[LayerManagerColumns::instance().visible]   = true; 
+  (*it)[LayerManagerColumns::instance().locked]    = false; 
+  (*it)[LayerManagerColumns::instance().layer]     = layer;
+}
+
+void
 SectorModel::add_layer(const std::string& name, const Gtk::TreeModel::Path& path)
 {
   Gtk::ListStore::iterator it;
@@ -519,7 +536,6 @@
 SectorModel::on_row_deleted(const Gtk::TreeModel::Path& path)
 {
   //std::cout << "LayerManager:on_row_deleted" << std::endl;
-  
   queue_draw();
 }
 

Modified: trunk/windstille/src/editor/sector_model.hpp
===================================================================
--- trunk/windstille/src/editor/sector_model.hpp	2009-04-22 05:01:32 UTC (rev 2945)
+++ trunk/windstille/src/editor/sector_model.hpp	2009-04-22 16:53:48 UTC (rev 2946)
@@ -52,7 +52,7 @@
   Gtk::TreeModelColumn<Glib::ustring>              name;
   Gtk::TreeModelColumn<bool>                       visible;
   Gtk::TreeModelColumn<bool>                       locked;
-  Gtk::TreeModelColumn<LayerHandle>            layer;
+  Gtk::TreeModelColumn<LayerHandle>                layer;
 
 private:
   LayerManagerColumns() {
@@ -68,11 +68,10 @@
 {
 private:
   std::auto_ptr<NavigationGraph> nav_graph;
-  Glib::RefPtr<Gtk::ListStore> layer_tree;
+  Glib::RefPtr<Gtk::ListStore>   layer_tree;
   Color ambient_color;
   
 public:
-  //typedef Objects::iterator iterator;
   typedef std::vector<LayerHandle> Layers;
 
   SectorModel();
@@ -87,6 +86,7 @@
   void set_all_locked(bool v);
 
   void add_layer(const std::string& name, const Gtk::TreeModel::Path& path = Gtk::TreeModel::Path());
+  void add_layer(LayerHandle layer, const Gtk::TreeModel::Path& path = Gtk::TreeModel::Path());
   void delete_layer(const Gtk::TreeModel::Path& path);
 
   void add(const ObjectModelHandle& object, const Gtk::TreeModel::Path& path);
@@ -100,8 +100,6 @@
   Layers get_layers() const;
   LayerHandle get_layer(ObjectModelHandle object);
   
-  // void select_objects(const Rectf& rect, bool replace_old_selection = true) const;
-
   Glib::RefPtr<Gtk::ListStore> get_layer_tree() { return layer_tree; }
 
   void on_row_changed(const Gtk::TreeModel::Path& path, const Gtk::TreeModel::iterator& iter);
@@ -130,9 +128,6 @@
 
   void queue_draw();
 
-  //iterator begin() { return objects.begin(); }
-  //iterator end() { return objects.end(); }
-
 private:
   SectorModel(const SectorModel&);
   SectorModel& operator=(const SectorModel&);



From grumbel at mail.berlios.de  Wed Apr 22 20:36:40 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 22 Apr 2009 20:36:40 +0200
Subject: [Windstille-commit] r2947 - trunk/windstille/src/editor
Message-ID: <200904221836.n3MIaeUQ023541@sheep.berlios.de>

Author: grumbel
Date: 2009-04-22 20:36:39 +0200 (Wed, 22 Apr 2009)
New Revision: 2947

Modified:
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/selection.cpp
   trunk/windstille/src/editor/windstille_widget.cpp
   trunk/windstille/src/editor/windstille_widget.hpp
Log:
Move reoccuring stuff into WindstilleWidget::execute

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-22 16:53:48 UTC (rev 2946)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-22 18:36:39 UTC (rev 2947)
@@ -845,9 +845,7 @@
       //wst->get_sector_model()->delete_layer(wst->get_current_layer_path());
 
       CommandHandle cmd(new LayerDeleteCommand(*wst->get_sector_model(), wst->get_current_layer_path()));
-      wst->get_undo_manager()->execute(cmd);
-      EditorWindow::current()->update_undo_state();
-      queue_draw();
+      wst->execute(cmd);
     }
 }
 
@@ -860,9 +858,7 @@
       //wst->get_sector_model()->add_layer("New Layer", wst->get_current_layer_path());
 
       CommandHandle cmd(new LayerAddCommand(*wst->get_sector_model(), wst->get_current_layer_path()));
-      wst->get_undo_manager()->execute(cmd);
-      EditorWindow::current()->update_undo_state();
-      queue_draw();
+      wst->execute(cmd);
 
       layer_manager.get_treeview().expand_all();
     }

Modified: trunk/windstille/src/editor/selection.cpp
===================================================================
--- trunk/windstille/src/editor/selection.cpp	2009-04-22 16:53:48 UTC (rev 2946)
+++ trunk/windstille/src/editor/selection.cpp	2009-04-22 18:36:39 UTC (rev 2947)
@@ -151,9 +151,7 @@
     }
 
   non_moveable_objects.clear();
-
-  wst.get_undo_manager()->execute(group_command);
-  EditorWindow::current()->update_undo_state();
+  wst.execute(group_command);
   signal_changed();
 }
 

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-22 16:53:48 UTC (rev 2946)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-22 18:36:39 UTC (rev 2947)
@@ -118,6 +118,14 @@
 {
 }
 
+void
+WindstilleWidget::execute(CommandHandle cmd)
+{
+  undo_manager->execute(cmd);
+  EditorWindow::current()->update_undo_state();
+  queue_draw();
+}
+
 bool
 WindstilleWidget::on_timeout()
 {
@@ -377,9 +385,7 @@
                                                               boost::bind(&ObjectModel::set_vflip, *i, !(*i)->get_vflip()))));
         }
 
-      undo_manager->execute(group_command);
-      EditorWindow::current()->update_undo_state();
-      queue_draw();
+      execute(group_command);
     }
 }
 
@@ -412,9 +418,7 @@
                                                               boost::bind(&ObjectModel::set_hflip, *i, !(*i)->get_hflip()))));
         }
 
-      undo_manager->execute(group_command);
-      EditorWindow::current()->update_undo_state();
-      queue_draw();
+      execute(group_command);
     }
 }
 
@@ -436,9 +440,7 @@
                                                               boost::bind(&ObjectModel::set_parent, *i, parent, true))));
         }
 
-      undo_manager->execute(group_command);
-      EditorWindow::current()->update_undo_state();
-      queue_draw();
+      execute(group_command);
     }
 }
 
@@ -454,9 +456,7 @@
                                                           boost::bind(&ObjectModel::set_parent, *i, ObjectModelHandle(), true))));
     }
 
-  undo_manager->execute(group_command);
-  EditorWindow::current()->update_undo_state();
-  queue_draw();
+  execute(group_command);
 }
 
 void
@@ -507,8 +507,7 @@
         }
     }
 
-  undo_manager->execute(group_command);
-  EditorWindow::current()->update_undo_state();
+  execute(group_command);
   set_selection(new_selection);
 }
 
@@ -530,9 +529,7 @@
     }
 
   on_selection_change();
-  undo_manager->execute(group_command);
-  EditorWindow::current()->update_undo_state();
-  queue_draw();
+  execute(group_command);
 }
 
 void
@@ -558,9 +555,7 @@
     }
 
  on_selection_change();
- undo_manager->execute(group_command);
- EditorWindow::current()->update_undo_state();
- queue_draw();
+ execute(group_command);
 }
 
 void
@@ -571,12 +566,10 @@
     {
       group_cmd->add(CommandHandle(new ObjectRemoveCommand(*sector_model, *i)));
     }
-  undo_manager->execute(group_cmd);
-  EditorWindow::current()->update_undo_state();
-  EditorWindow::current()->update_undo_state();
 
- selection->clear();
- queue_draw();
+  execute(group_cmd);
+  selection->clear();
+  queue_draw();
 }
 
 bool
@@ -757,8 +750,7 @@
     }
   else
     {
-      undo_manager->execute(CommandHandle(new ObjectAddCommand(sector_model->get_layer(path), object)));
-      EditorWindow::current()->update_undo_state();
+      execute(CommandHandle(new ObjectAddCommand(sector_model->get_layer(path), object)));
     }
 }
 

Modified: trunk/windstille/src/editor/windstille_widget.hpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.hpp	2009-04-22 16:53:48 UTC (rev 2946)
+++ trunk/windstille/src/editor/windstille_widget.hpp	2009-04-22 18:36:39 UTC (rev 2947)
@@ -39,6 +39,7 @@
 #include "selection.hpp"
 #include "select_mask.hpp"
 #include "layer.hpp"
+#include "command.hpp"
 
 class Tool;
 class UndoManager;
@@ -80,6 +81,8 @@
 
   GraphicContextState& get_state() { return state; }
 
+  void execute(CommandHandle);
+
   virtual void on_realize();
   virtual bool on_timeout();
   virtual bool on_configure_event(GdkEventConfigure* event);



From grumbel at mail.berlios.de  Wed Apr 22 21:17:00 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Wed, 22 Apr 2009 21:17:00 +0200
Subject: [Windstille-commit] r2948 - trunk/windstille/src/editor
Message-ID: <200904221917.n3MJH0xl030822@sheep.berlios.de>

Author: grumbel
Date: 2009-04-22 21:17:00 +0200 (Wed, 22 Apr 2009)
New Revision: 2948

Modified:
   trunk/windstille/src/editor/layer.cpp
   trunk/windstille/src/editor/layer.hpp
   trunk/windstille/src/editor/layer_manager.cpp
   trunk/windstille/src/editor/sector_model.cpp
Log:
Fixing some issues with syncing Layer parameter

Modified: trunk/windstille/src/editor/layer.cpp
===================================================================
--- trunk/windstille/src/editor/layer.cpp	2009-04-22 18:36:39 UTC (rev 2947)
+++ trunk/windstille/src/editor/layer.cpp	2009-04-22 19:17:00 UTC (rev 2948)
@@ -58,7 +58,7 @@
 }
 
 void
-Layer::update(const Gtk::TreeModel::Row& row)
+Layer::sync(const Gtk::TreeModel::Row& row)
 {
   name    = ((Glib::ustring)row[LayerManagerColumns::instance().name]).raw();
   visible = row[LayerManagerColumns::instance().visible];

Modified: trunk/windstille/src/editor/layer.hpp
===================================================================
--- trunk/windstille/src/editor/layer.hpp	2009-04-22 18:36:39 UTC (rev 2947)
+++ trunk/windstille/src/editor/layer.hpp	2009-04-22 19:17:00 UTC (rev 2948)
@@ -69,7 +69,7 @@
 
   void draw(SceneContext& sc, const SelectMask& layers);
   void update(float delta);
-  void update(const Gtk::TreeModel::Row& row);
+  void sync(const Gtk::TreeModel::Row& row);
 
   ObjectModelHandle get_object_at(const Vector2f& pos, const SelectMask& layers) const;
   SelectionHandle   get_selection(const Rectf& rect, const SelectMask& layers) const;

Modified: trunk/windstille/src/editor/layer_manager.cpp
===================================================================
--- trunk/windstille/src/editor/layer_manager.cpp	2009-04-22 18:36:39 UTC (rev 2947)
+++ trunk/windstille/src/editor/layer_manager.cpp	2009-04-22 19:17:00 UTC (rev 2948)
@@ -142,7 +142,7 @@
             {
               EditorWindow::current()->on_lock_all(true);
               (*it)[LayerManagerColumns::instance().locked] = false;
-              ((LayerHandle)(*it)[LayerManagerColumns::instance().layer])->update(*it);
+              ((LayerHandle)(*it)[LayerManagerColumns::instance().layer])->sync(*it);
             }
         }
     }

Modified: trunk/windstille/src/editor/sector_model.cpp
===================================================================
--- trunk/windstille/src/editor/sector_model.cpp	2009-04-22 18:36:39 UTC (rev 2947)
+++ trunk/windstille/src/editor/sector_model.cpp	2009-04-22 19:17:00 UTC (rev 2948)
@@ -43,12 +43,12 @@
   Gtk::ListStore::iterator it = layer_tree->append();
 
   LayerHandle layer(new Layer());
-
   (*it)[LayerManagerColumns::instance().type_icon] = Gdk::Pixbuf::create_from_file("data/editor/type.png");
   (*it)[LayerManagerColumns::instance().name]      = Glib::ustring("Scene");
   (*it)[LayerManagerColumns::instance().visible]   = true;
   (*it)[LayerManagerColumns::instance().locked]    = false;
   (*it)[LayerManagerColumns::instance().layer]     = layer;
+  layer->sync(*it);
 
   layer_tree->signal_row_changed().connect(sigc::mem_fun(*this, &SectorModel::on_row_changed));
   layer_tree->signal_row_deleted().connect(sigc::mem_fun(*this, &SectorModel::on_row_deleted));
@@ -72,9 +72,9 @@
     it = layer_tree->insert(layer_tree->get_iter(path));
   
   (*it)[LayerManagerColumns::instance().type_icon] = Gdk::Pixbuf::create_from_file("data/editor/type.png");
-  (*it)[LayerManagerColumns::instance().name]      = "Restored Layer";
-  (*it)[LayerManagerColumns::instance().visible]   = true; 
-  (*it)[LayerManagerColumns::instance().locked]    = false; 
+  (*it)[LayerManagerColumns::instance().name]      = layer->get_name();
+  (*it)[LayerManagerColumns::instance().visible]   = layer->is_visible();
+  (*it)[LayerManagerColumns::instance().locked]    = layer->is_locked();
   (*it)[LayerManagerColumns::instance().layer]     = layer;
 }
 
@@ -88,11 +88,13 @@
   else
     it = layer_tree->insert(layer_tree->get_iter(path));
 
+  LayerHandle layer(new Layer());
   (*it)[LayerManagerColumns::instance().type_icon] = Gdk::Pixbuf::create_from_file("data/editor/type.png");
   (*it)[LayerManagerColumns::instance().name]      = name;
   (*it)[LayerManagerColumns::instance().visible]   = true; 
   (*it)[LayerManagerColumns::instance().locked]    = false; 
-  (*it)[LayerManagerColumns::instance().layer]     = LayerHandle(new Layer());
+  (*it)[LayerManagerColumns::instance().layer]     = layer;
+  layer->sync(*it);
 }
 
 void
@@ -377,7 +379,7 @@
   (*it)[LayerManagerColumns::instance().locked]    = locked; 
   (*it)[LayerManagerColumns::instance().layer]     = layer;
 
-  layer->update(*it);
+  layer->sync(*it);
 }
 
 void
@@ -479,14 +481,14 @@
   bool set_visible(const Gtk::TreeModel::iterator& it)
   {
     (*it)[LayerManagerColumns::instance().visible] = v;
-    ((LayerHandle)(*it)[LayerManagerColumns::instance().layer])->update(*it);
+    ((LayerHandle)(*it)[LayerManagerColumns::instance().layer])->sync(*it);
     return false;
   }
   
   bool set_locked(const Gtk::TreeModel::iterator& it)
   {
     (*it)[LayerManagerColumns::instance().locked] = v;
-    ((LayerHandle)(*it)[LayerManagerColumns::instance().layer])->update(*it);
+    ((LayerHandle)(*it)[LayerManagerColumns::instance().layer])->sync(*it);
     return false;
   }
 };
@@ -525,7 +527,7 @@
       LayerHandle layer = (*iter)[LayerManagerColumns::instance().layer];
       if (layer)
         {
-          layer->update(*iter);
+          layer->sync(*iter);
         }
     }
 



From grumbel at mail.berlios.de  Thu Apr 23 07:52:46 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 23 Apr 2009 07:52:46 +0200
Subject: [Windstille-commit] r2949 - in trunk/windstille/data: images/decal
	sectors/trainstation
Message-ID: <200904230552.n3N5qkRQ008931@sheep.berlios.de>

Author: grumbel
Date: 2009-04-23 07:48:52 +0200 (Thu, 23 Apr 2009)
New Revision: 2949

Added:
   trunk/windstille/data/images/decal/bath_tile.xcf
   trunk/windstille/data/images/decal/bathroom.xcf
   trunk/windstille/data/images/decal/container_roof2.xcf
   trunk/windstille/data/images/decal/unit1.png
   trunk/windstille/data/images/decal/unit1.xcf
   trunk/windstille/data/images/decal/ventilation.png
   trunk/windstille/data/images/decal/ventilation.xcf
   trunk/windstille/data/images/decal/ventilation2.png
Modified:
   trunk/windstille/data/images/decal/stone1.png
   trunk/windstille/data/sectors/trainstation/container.wst
   trunk/windstille/data/sectors/trainstation/greenstuff.wst
Log:
Some more images

Added: trunk/windstille/data/images/decal/bath_tile.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/bath_tile.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/x-xcf

Added: trunk/windstille/data/images/decal/bathroom.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/bathroom.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/x-xcf

Added: trunk/windstille/data/images/decal/container_roof2.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/container_roof2.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/x-xcf

Modified: trunk/windstille/data/images/decal/stone1.png
===================================================================
(Binary files differ)

Added: trunk/windstille/data/images/decal/unit1.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/unit1.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/unit1.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/unit1.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/x-xcf

Added: trunk/windstille/data/images/decal/ventilation.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/ventilation.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/windstille/data/images/decal/ventilation.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/ventilation.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/x-xcf

Added: trunk/windstille/data/images/decal/ventilation2.png
===================================================================
(Binary files differ)


Property changes on: trunk/windstille/data/images/decal/ventilation2.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/windstille/data/sectors/trainstation/container.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/container.wst	2009-04-22 19:17:00 UTC (rev 2948)
+++ trunk/windstille/data/sectors/trainstation/container.wst	2009-04-23 05:48:52 UTC (rev 2949)
@@ -12,7 +12,7 @@
     (layer
       (name "Scene")
       (visible #t)
-      (locked #f)
+      (locked #t)
       (objects))
     (layer
       (name "Character")
@@ -20,7 +20,7 @@
       (locked #f)
       (objects
         (decal
-          (id "0xaa4ec78")
+          (id "0x9c3b018")
           (pos 521 777)
           (parent "")
           (select-mask 1)
@@ -31,7 +31,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4e140")
+          (id "0x9c3abb8")
           (pos 539 200)
           (parent "")
           (select-mask 1)
@@ -42,18 +42,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4e228")
-          (pos 451 331)
-          (parent "")
-          (select-mask 1)
-          (path "images/decal/explosion_decal.png")
-          (type 0)
-          (scale 1.40212 1.74096)
-          (angle 0)
-          (hflip #f)
-          (vflip #f))
-        (decal
-          (id "0xaa4df88")
+          (id "0x9c47890")
           (pos 789 826)
           (parent "")
           (select-mask 1)
@@ -64,7 +53,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4f628")
+          (id "0x9c47ac8")
           (pos 917 826)
           (parent "")
           (select-mask 1)
@@ -75,7 +64,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4f470")
+          (id "0x9c18f38")
           (pos 789 698)
           (parent "")
           (select-mask 1)
@@ -86,7 +75,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4f778")
+          (id "0x9c18a48")
           (pos 917 698)
           (parent "")
           (select-mask 1)
@@ -97,7 +86,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4f898")
+          (id "0x9c192b8")
           (pos 805 601)
           (parent "")
           (select-mask 1)
@@ -108,7 +97,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4f190")
+          (id "0x9c18778")
           (pos 693 858)
           (parent "")
           (select-mask 1)
@@ -117,14 +106,80 @@
           (scale 1 1)
           (angle 0)
           (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9c31638")
+          (pos 1113 783)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.726562 0.792969)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9c2abd0")
+          (pos 1053 761)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/unit1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9c0ced8")
+          (pos 1155 761)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/unit1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9bd45a0")
+          (pos 1067 776)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dirty3.png")
+          (type 0)
+          (scale 1 1.03333)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa5e6558")
+          (pos 1147 769)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dirty8.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa5e59e8")
+          (pos 1042 828)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dirty7.png")
+          (type 0)
+          (scale 0.682758 0.744)
+          (angle 0)
+          (hflip #f)
           (vflip #f))))
     (layer
       (name "Lights")
-      (visible #t)
-      (locked #f)
+      (visible #f)
+      (locked #t)
       (objects
         (decal
-          (id "0xaa5f168")
+          (id "0x9c2ace8")
           (pos 1087 797)
           (parent "")
           (select-mask 1)
@@ -135,7 +190,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4fef0")
+          (id "0x9c22a28")
           (pos -147 797)
           (parent "")
           (select-mask 1)
@@ -146,7 +201,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4ffd0")
+          (id "0x9c477a0")
           (pos 1082 782)
           (parent "")
           (select-mask 1)
@@ -157,7 +212,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4c0a0")
+          (id "0x9c19010")
           (pos -148 782)
           (parent "")
           (select-mask 1)
@@ -168,7 +223,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4c8f8")
+          (id "0x9c47548")
           (pos -109 755)
           (parent "")
           (select-mask 1)
@@ -179,7 +234,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4be50")
+          (id "0x9c23258")
           (pos 1091 786)
           (parent "")
           (select-mask 1)
@@ -190,8 +245,8 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4c220")
-          (pos 981 182)
+          (id "0x9c22c90")
+          (pos 617 244)
           (parent "")
           (select-mask 1)
           (path "images/decal/light.png")
@@ -201,7 +256,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4c3a0")
+          (id "0x9be18d8")
           (pos 1101 779)
           (parent "")
           (select-mask 1)
@@ -212,7 +267,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4c740")
+          (id "0x9c233b0")
           (pos -128 779)
           (parent "")
           (select-mask 1)
@@ -225,10 +280,10 @@
     (layer
       (name "Ground")
       (visible #t)
-      (locked #f)
+      (locked #t)
       (objects
         (decal
-          (id "0xaa4d738")
+          (id "0x9c23ac0")
           (pos 663 -121)
           (parent "")
           (select-mask 1)
@@ -239,7 +294,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4de08")
+          (id "0x9c23728")
           (pos 1047 -121)
           (parent "")
           (select-mask 1)
@@ -250,7 +305,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4d868")
+          (id "0x9c22e50")
           (pos -105 -121)
           (parent "")
           (select-mask 1)
@@ -261,7 +316,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4d4f8")
+          (id "0x9ba8398")
           (pos 1484 135)
           (parent "")
           (select-mask 1)
@@ -272,7 +327,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4da60")
+          (id "0x9ba75b0")
           (pos 1484 263)
           (parent "")
           (select-mask 1)
@@ -283,7 +338,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4d9a8")
+          (id "0x9ba8130")
           (pos 1484 391)
           (parent "")
           (select-mask 1)
@@ -294,7 +349,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaba6c58")
+          (id "0x9ba7740")
           (pos 1480 519)
           (parent "")
           (select-mask 1)
@@ -305,7 +360,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaba67a0")
+          (id "0x9ba7ea0")
           (pos 1480 647)
           (parent "")
           (select-mask 1)
@@ -316,7 +371,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaba68e0")
+          (id "0x9ba79c0")
           (pos 1367 -57)
           (parent "")
           (select-mask 1)
@@ -327,7 +382,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xac06e98")
+          (id "0x9c240b8")
           (pos -540 127)
           (parent "")
           (select-mask 1)
@@ -338,7 +393,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xac07068")
+          (id "0x9ba8468")
           (pos 1373 903)
           (parent "")
           (select-mask 1)
@@ -349,7 +404,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xac07148")
+          (id "0x9ba85f0")
           (pos -540 475)
           (parent "")
           (select-mask 1)
@@ -360,7 +415,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4d300")
+          (id "0x9ba9210")
           (pos -540 591)
           (parent "")
           (select-mask 1)
@@ -371,7 +426,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xad477f8")
+          (id "0x9ba8e58")
           (pos -540 707)
           (parent "")
           (select-mask 1)
@@ -382,7 +437,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xad47900")
+          (id "0x9ba86e8")
           (pos -425 -57)
           (parent "")
           (select-mask 1)
@@ -393,7 +448,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xad47988")
+          (id "0x9ba8988")
           (pos -419 905)
           (parent "")
           (select-mask 1)
@@ -404,7 +459,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xae07d48")
+          (id "0x9ba9040")
           (pos -104 954)
           (parent "")
           (select-mask 1)
@@ -415,7 +470,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xae480e8")
+          (id "0x9ba8c70")
           (pos 280 954)
           (parent "")
           (select-mask 1)
@@ -426,7 +481,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xae07e20")
+          (id "0x9baa0a0")
           (pos 661 954)
           (parent "")
           (select-mask 1)
@@ -437,7 +492,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xae48280")
+          (id "0x9ba9ad8")
           (pos 1045 954)
           (parent "")
           (select-mask 1)
@@ -448,7 +503,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4d0b8")
+          (id "0x9ba9c98")
           (pos -544 401)
           (parent "")
           (select-mask 1)
@@ -459,7 +514,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4d1a8")
+          (id "0x9ba8b10")
           (pos 279 -97)
           (parent "")
           (select-mask 1)
@@ -472,10 +527,10 @@
     (layer
       (name "Stairs")
       (visible #t)
-      (locked #f)
+      (locked #t)
       (objects
         (decal
-          (id "0xaa4ef18")
+          (id "0x9baa700")
           (pos -389 447)
           (parent "")
           (select-mask 1)
@@ -486,7 +541,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa4ea70")
+          (id "0x9ba9f48")
           (pos -261 409)
           (parent "")
           (select-mask 1)
@@ -497,7 +552,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaec8cd0")
+          (id "0x9ba97c0")
           (pos -261 575)
           (parent "")
           (select-mask 1)
@@ -508,7 +563,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xacc74a8")
+          (id "0x9ba9de0")
           (pos -133 537)
           (parent "")
           (select-mask 1)
@@ -519,7 +574,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaec8ae8")
+          (id "0x9ba9430")
           (pos -133 703)
           (parent "")
           (select-mask 1)
@@ -530,7 +585,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaec8820")
+          (id "0x9baa760")
           (pos -5 665)
           (parent "")
           (select-mask 1)
@@ -541,7 +596,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xb0aa048")
+          (id "0x9baa818")
           (pos -5 831)
           (parent "")
           (select-mask 1)
@@ -552,7 +607,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xb0a9f60")
+          (id "0x9baaf30")
           (pos 123 793)
           (parent "")
           (select-mask 1)
@@ -565,10 +620,10 @@
     (layer
       (name "Shadow")
       (visible #t)
-      (locked #f)
+      (locked #t)
       (objects
         (decal
-          (id "0xb0d3bc8")
+          (id "0x9ba9660")
           (pos 429 -18)
           (parent "")
           (select-mask 1)
@@ -579,7 +634,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xb0e3da8")
+          (id "0x9ba7b60")
           (pos -264 91)
           (parent "")
           (select-mask 1)
@@ -590,7 +645,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaec8f88")
+          (id "0x9ba7c38")
           (pos 1200 36)
           (parent "")
           (select-mask 1)
@@ -601,7 +656,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaec8e88")
+          (id "0x9baaa18")
           (pos 481 562)
           (parent "")
           (select-mask 1)
@@ -612,7 +667,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xafa90d8")
+          (id "0x9baac98")
           (pos 804 479)
           (parent "")
           (select-mask 1)
@@ -623,7 +678,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xab31f10")
+          (id "0x9bd9230")
           (pos 821 347)
           (parent "")
           (select-mask 1)
@@ -634,7 +689,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xab320e8")
+          (id "0x9bd9688")
           (pos 854 439)
           (parent "")
           (select-mask 1)
@@ -645,7 +700,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa5cd58")
+          (id "0x9bd9330")
           (pos 713 859)
           (parent "")
           (select-mask 1)
@@ -656,7 +711,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa5e2c8")
+          (id "0x9bd9410")
           (pos 976 842)
           (parent "")
           (select-mask 1)
@@ -667,7 +722,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa5df48")
+          (id "0x9c20218")
           (pos 818 723)
           (parent "")
           (select-mask 1)
@@ -680,10 +735,10 @@
     (layer
       (name "Door")
       (visible #t)
-      (locked #f)
+      (locked #t)
       (objects
         (decal
-          (id "0xb0d3af8")
+          (id "0x9c204a8")
           (pos 338 745)
           (parent "")
           (select-mask 1)
@@ -696,10 +751,10 @@
     (layer
       (name "Background")
       (visible #t)
-      (locked #f)
+      (locked #t)
       (objects
         (decal
-          (id "0xaa5e608")
+          (id "0x9c21040")
           (pos -15 424)
           (parent "")
           (select-mask 1)
@@ -710,7 +765,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa5e7f8")
+          (id "0x9c21d48")
           (pos 973 427)
           (parent "")
           (select-mask 1)
@@ -721,7 +776,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa5d330")
+          (id "0x9c22008")
           (pos 549 839)
           (parent "")
           (select-mask 1)
@@ -732,7 +787,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa5d550")
+          (id "0x9bd8fb8")
           (pos -181 185)
           (parent "")
           (select-mask 1)
@@ -743,7 +798,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa5d720")
+          (id "0x9bd88b0")
           (pos 1267 845)
           (parent "")
           (select-mask 1)
@@ -754,7 +809,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xb149dd0")
+          (id "0x9bd8768")
           (pos 1209 472)
           (parent "")
           (select-mask 1)
@@ -765,7 +820,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xb17d7d8")
+          (id "0x9bd8e28")
           (pos 1192 578)
           (parent "")
           (select-mask 1)
@@ -776,7 +831,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xb17d998")
+          (id "0x9bd71f0")
           (pos 1206 450)
           (parent "")
           (select-mask 1)
@@ -787,7 +842,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa5dcd8")
+          (id "0x9bd73a0")
           (pos 1241 553)
           (parent "")
           (select-mask 1)
@@ -798,7 +853,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xaa5d8e0")
+          (id "0x9bd8b78")
           (pos 1206 435)
           (parent "")
           (select-mask 1)
@@ -807,6 +862,83 @@
           (scale 1 1)
           (angle 0)
           (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9bd8a68")
+          (pos 316 286)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/explosion_decal.png")
+          (type 0)
+          (scale 1.40212 1.74096)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9bd7478")
+          (pos 201 525)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dirty6.png")
+          (type 0)
+          (scale 2.40664 2.18176)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9bd7d80")
+          (pos 203 453)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.683594 0.535156)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9bd7c18")
+          (pos 194 437)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ventilation2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9bd77e8")
+          (pos 515 537)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dirty6.png")
+          (type 0)
+          (scale 2.525 1.79412)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9bd7f88")
+          (pos 486 454)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/dark.png")
+          (type 0)
+          (scale 0.683594 0.535156)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0x9bd81f8")
+          (pos 504 443)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/ventilation2.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
           (vflip #f))))))
 
 ;; EOF ;;

Modified: trunk/windstille/data/sectors/trainstation/greenstuff.wst
===================================================================
--- trunk/windstille/data/sectors/trainstation/greenstuff.wst	2009-04-22 19:17:00 UTC (rev 2948)
+++ trunk/windstille/data/sectors/trainstation/greenstuff.wst	2009-04-23 05:48:52 UTC (rev 2949)
@@ -12,10 +12,32 @@
     (layer
       (name "Light")
       (visible #t)
-      (locked #t)
+      (locked #f)
       (objects
         (decal
-          (id "0x9822f60")
+          (id "0xa485f78")
+          (pos -55 167)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 4.70117 4.27148)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa486128")
+          (pos 804 402)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/light2.png")
+          (type 1)
+          (scale 4.70117 4.27148)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa4d6b28")
           (pos 392 164)
           (parent "")
           (select-mask 1)
@@ -26,7 +48,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x9823c50")
+          (id "0xa48d458")
           (pos -434 115)
           (parent "")
           (select-mask 1)
@@ -37,7 +59,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x98237f0")
+          (id "0xa485e88")
           (pos 246 185)
           (parent "")
           (select-mask 1)
@@ -48,7 +70,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x9823da8")
+          (id "0xa485708")
           (pos 886 203)
           (parent "")
           (select-mask 1)
@@ -59,7 +81,18 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x9824010")
+          (id "0x9d967e0")
+          (pos 2078 397)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa485c48")
           (pos 1448 564)
           (parent "")
           (select-mask 1)
@@ -70,8 +103,8 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x9824378")
-          (pos 1015 -221)
+          (id "0xa485408")
+          (pos 822 -146)
           (parent "")
           (select-mask 1)
           (path "images/decal/light2.png")
@@ -81,7 +114,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x98241d8")
+          (id "0xa4857a8")
           (pos -22 234)
           (parent "")
           (select-mask 1)
@@ -92,34 +125,78 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x9824608")
-          (pos -55 167)
+          (id "0xa4b72a0")
+          (pos 1882 482)
           (parent "")
           (select-mask 1)
-          (path "images/decal/light2.png")
-          (type 1)
-          (scale 4.70117 4.27148)
+          (path "images/decal/stone1.png")
+          (type 0)
+          (scale 1 1)
           (angle 0)
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x98246c0")
-          (pos 789 423)
+          (id "0xa4cefe8")
+          (pos 2243 492)
           (parent "")
           (select-mask 1)
-          (path "images/decal/light2.png")
-          (type 1)
-          (scale 4.70117 4.27148)
+          (path "images/decal/stone1.png")
+          (type 0)
+          (scale 1 1)
           (angle 0)
           (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa4b74a0")
+          (pos 2204 729)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa4537c8")
+          (pos 1746 654)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa470078")
+          (pos 1964 732)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xb2d2970")
+          (pos 1731 757)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
           (vflip #f))))
     (layer
       (name "Scene")
       (visible #t)
-      (locked #f)
+      (locked #t)
       (objects
         (decal
-          (id "0x9824e28")
+          (id "0xa486f80")
           (pos -496.346 237.481)
           (parent "")
           (select-mask 1)
@@ -130,7 +207,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982c600")
+          (id "0xa483320")
           (pos -608 4)
           (parent "")
           (select-mask 1)
@@ -141,7 +218,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982c7c0")
+          (id "0xa483530")
           (pos -617 215)
           (parent "")
           (select-mask 1)
@@ -152,7 +229,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982cb38")
+          (id "0xa483f78")
           (pos 996 36)
           (parent "")
           (select-mask 1)
@@ -163,7 +240,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982e708")
+          (id "0xa483ac0")
           (pos 1369 541)
           (parent "")
           (select-mask 1)
@@ -174,7 +251,18 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982e7d8")
+          (id "0xa4cdc08")
+          (pos 427 34)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa483df8")
           (pos 298 252)
           (parent "")
           (select-mask 1)
@@ -185,7 +273,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982d408")
+          (id "0xa484378")
           (pos 1076 249)
           (parent "")
           (select-mask 1)
@@ -196,7 +284,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982e4a8")
+          (id "0xa484648")
           (pos 582 483)
           (parent "")
           (select-mask 1)
@@ -207,7 +295,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982e2e0")
+          (id "0xa484470")
           (pos 1094 483)
           (parent "")
           (select-mask 1)
@@ -218,7 +306,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982d658")
+          (id "0xa4ccca0")
           (pos 582 739)
           (parent "")
           (select-mask 1)
@@ -229,7 +317,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97efc58")
+          (id "0xa483780")
           (pos 1094 739)
           (parent "")
           (select-mask 1)
@@ -240,7 +328,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97ef4a8")
+          (id "0xa483940")
           (pos 529 157)
           (parent "")
           (select-mask 1)
@@ -251,7 +339,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982d008")
+          (id "0xa4cd1d8")
           (pos 420 364)
           (parent "")
           (select-mask 1)
@@ -262,7 +350,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982dfd0")
+          (id "0xa4ccf10")
           (pos 647 370)
           (parent "")
           (select-mask 1)
@@ -273,7 +361,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982dd00")
+          (id "0xa484e30")
           (pos 500 392)
           (parent "")
           (select-mask 1)
@@ -284,7 +372,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982d8e8")
+          (id "0xa484fe0")
           (pos 537 302)
           (parent "")
           (select-mask 1)
@@ -295,7 +383,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982dad0")
+          (id "0xa4849b8")
           (pos 656 335)
           (parent "")
           (select-mask 1)
@@ -306,7 +394,7 @@
           (hflip #t)
           (vflip #f))
         (decal
-          (id "0x97ef8b0")
+          (id "0xa484ac0")
           (pos 861 398)
           (parent "")
           (select-mask 1)
@@ -317,7 +405,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97efa80")
+          (id "0xa484b90")
           (pos 530 85)
           (parent "")
           (select-mask 1)
@@ -328,7 +416,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97f09d0")
+          (id "0xa4cb1b0")
           (pos 644 202)
           (parent "")
           (select-mask 1)
@@ -339,7 +427,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97ef588")
+          (id "0xa4ca7b8")
           (pos 1344 453)
           (parent "")
           (select-mask 1)
@@ -350,7 +438,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97f0898")
+          (id "0xa4cac60")
           (pos 618 446)
           (parent "")
           (select-mask 1)
@@ -361,7 +449,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97ef750")
+          (id "0xa4cae10")
           (pos 697 340)
           (parent "")
           (select-mask 1)
@@ -372,7 +460,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97f02e8")
+          (id "0xa4cb040")
           (pos 710 266)
           (parent "")
           (select-mask 1)
@@ -383,7 +471,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97f0ac8")
+          (id "0xa4ca8b0")
           (pos 856 459)
           (parent "")
           (select-mask 1)
@@ -394,7 +482,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97f0c80")
+          (id "0xa4cc3a0")
           (pos 1504 755)
           (parent "")
           (select-mask 1)
@@ -405,7 +493,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97f0650")
+          (id "0xa4ccc18")
           (pos 1392 766)
           (parent "")
           (select-mask 1)
@@ -416,7 +504,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97efe98")
+          (id "0xa4cc780")
           (pos 1242 628)
           (parent "")
           (select-mask 1)
@@ -427,7 +515,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97f00b8")
+          (id "0xa4cc920")
           (pos 1232 824)
           (parent "")
           (select-mask 1)
@@ -438,7 +526,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97ef0d8")
+          (id "0xa4cb4a0")
           (pos 1351 879)
           (parent "")
           (select-mask 1)
@@ -449,7 +537,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97ef280")
+          (id "0xa4cc4d0")
           (pos 1117 632)
           (parent "")
           (select-mask 1)
@@ -460,7 +548,7 @@
           (hflip #t)
           (vflip #f))
         (decal
-          (id "0x982a400")
+          (id "0xa4cc670")
           (pos 1104 821)
           (parent "")
           (select-mask 1)
@@ -471,7 +559,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982b458")
+          (id "0xa4cc0f8")
           (pos 598 748)
           (parent "")
           (select-mask 1)
@@ -482,7 +570,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982b188")
+          (id "0xa4cb590")
           (pos 1079 411)
           (parent "")
           (select-mask 1)
@@ -493,7 +581,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982a4c0")
+          (id "0xa4cb630")
           (pos 1127 516)
           (parent "")
           (select-mask 1)
@@ -504,7 +592,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982c468")
+          (id "0xa4cbac8")
           (pos 1179 397)
           (parent "")
           (select-mask 1)
@@ -515,7 +603,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982a6c0")
+          (id "0xa4cbb48")
           (pos 944 416)
           (parent "")
           (select-mask 1)
@@ -526,7 +614,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982c120")
+          (id "0xa4cb810")
           (pos 70 483)
           (parent "")
           (select-mask 1)
@@ -537,7 +625,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982c270")
+          (id "0xa4d1ac0")
           (pos 134 478)
           (parent "")
           (select-mask 1)
@@ -548,7 +636,18 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982c388")
+          (id "0xa4d7ab8")
+          (pos 312 310)
+          (parent "")
+          (select-mask 1)
+          (path "images/decal/stone1.png")
+          (type 0)
+          (scale 1 1)
+          (angle 0)
+          (hflip #f)
+          (vflip #f))
+        (decal
+          (id "0xa4d3038")
           (pos -442 483)
           (parent "")
           (select-mask 1)
@@ -559,7 +658,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982bf88")
+          (id "0xa4d1be8")
           (pos -442 739)
           (parent "")
           (select-mask 1)
@@ -570,7 +669,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982a9b8")
+          (id "0xa4d1de0")
           (pos 291 424)
           (parent "")
           (select-mask 1)
@@ -581,7 +680,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982aa80")
+          (id "0xa4d1f90")
           (pos -143 423)
           (parent "")
           (select-mask 1)
@@ -592,7 +691,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982b708")
+          (id "0xa4d2140")
           (pos 136 402)
           (parent "")
           (select-mask 1)
@@ -603,7 +702,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982adb0")
+          (id "0xa4d2200")
           (pos 712 417)
           (parent "")
           (select-mask 1)
@@ -614,7 +713,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982bc78")
+          (id "0xa4d2a28")
           (pos 536 388)
           (parent "")
           (select-mask 1)
@@ -625,7 +724,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x919d6e0")
+          (id "0xa4d2c50")
           (pos 295 730)
           (parent "")
           (select-mask 1)
@@ -636,7 +735,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97c01f8")
+          (id "0xa4d2ea0")
           (pos -134 695)
           (parent "")
           (select-mask 1)
@@ -647,7 +746,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xa646508")
+          (id "0xa4d27b0")
           (pos -65 969)
           (parent "")
           (select-mask 1)
@@ -658,7 +757,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97d5df0")
+          (id "0xa4d0aa0")
           (pos 361 1004)
           (parent "")
           (select-mask 1)
@@ -669,7 +768,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x9832600")
+          (id "0xa4d23a0")
           (pos 80 1241)
           (parent "")
           (select-mask 1)
@@ -680,7 +779,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97c0188")
+          (id "0xa4d2580")
           (pos -479 881)
           (parent "")
           (select-mask 1)
@@ -691,7 +790,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97d6160")
+          (id "0xa4d14e8")
           (pos -351 1153)
           (parent "")
           (select-mask 1)
@@ -702,7 +801,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97d5ed0")
+          (id "0xa4d1a18")
           (pos 503 1261)
           (parent "")
           (select-mask 1)
@@ -713,7 +812,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97d6228")
+          (id "0xa4d0ca8")
           (pos 761 957)
           (parent "")
           (select-mask 1)
@@ -724,7 +823,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0xa646430")
+          (id "0xa4d15d8")
           (pos 902 1207)
           (parent "")
           (select-mask 1)
@@ -735,7 +834,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97d60c8")
+          (id "0xa4d16e0")
           (pos 1125 1004)
           (parent "")
           (select-mask 1)
@@ -751,7 +850,7 @@
       (locked #t)
       (objects
         (decal
-          (id "0x982bad8")
+          (id "0xa4cf8c0")
           (pos -253 257)
           (parent "")
           (select-mask 1)
@@ -762,7 +861,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x9824d98")
+          (id "0xa48cd68")
           (pos -252 243)
           (parent "")
           (select-mask 1)
@@ -773,7 +872,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x9822d10")
+          (id "0xa4d1168")
           (pos 256 249)
           (parent "")
           (select-mask 1)
@@ -784,7 +883,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x982b830")
+          (id "0xa4d1248")
           (pos 257 235)
           (parent "")
           (select-mask 1)
@@ -800,7 +899,7 @@
       (locked #t)
       (objects
         (decal
-          (id "0x982b9b0")
+          (id "0xa486480")
           (pos 3 232)
           (parent "")
           (select-mask 1)
@@ -816,7 +915,7 @@
       (locked #t)
       (objects
         (decal
-          (id "0x981b198")
+          (id "0xa4d02b0")
           (pos 19.2787 37.4811)
           (parent "")
           (select-mask 1)
@@ -827,7 +926,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97c0fe0")
+          (id "0xa4d0e58")
           (pos 189.591 34.3561)
           (parent "")
           (select-mask 1)
@@ -838,7 +937,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97c19d0")
+          (id "0xa4af670")
           (pos 331 9)
           (parent "")
           (select-mask 1)
@@ -849,7 +948,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97c11d8")
+          (id "0xa4aebd0")
           (pos -237 42)
           (parent "")
           (select-mask 1)
@@ -860,7 +959,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97ecf48")
+          (id "0xa4aecc8")
           (pos -329 20)
           (parent "")
           (select-mask 1)
@@ -871,7 +970,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97ed718")
+          (id "0xa4aedf8")
           (pos -33 46)
           (parent "")
           (select-mask 1)
@@ -882,7 +981,7 @@
           (hflip #t)
           (vflip #f))
         (decal
-          (id "0x97ed5e0")
+          (id "0xa4af588")
           (pos -344 14)
           (parent "")
           (select-mask 1)
@@ -893,7 +992,7 @@
           (hflip #t)
           (vflip #f))
         (decal
-          (id "0x97ee1d0")
+          (id "0xa4afd60")
           (pos -450 29)
           (parent "")
           (select-mask 1)
@@ -904,7 +1003,7 @@
           (hflip #t)
           (vflip #f))
         (decal
-          (id "0x97ed838")
+          (id "0xa4af7b0")
           (pos 232 29)
           (parent "")
           (select-mask 1)
@@ -915,7 +1014,7 @@
           (hflip #t)
           (vflip #f))
         (decal
-          (id "0x97eebc0")
+          (id "0xa4af990")
           (pos 468 -6)
           (parent "")
           (select-mask 1)
@@ -926,7 +1025,7 @@
           (hflip #t)
           (vflip #f))
         (decal
-          (id "0x97eeb10")
+          (id "0xa4af2b0")
           (pos -545 20)
           (parent "")
           (select-mask 1)
@@ -937,7 +1036,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97c16b0")
+          (id "0xa4af450")
           (pos 512 5)
           (parent "")
           (select-mask 1)
@@ -948,7 +1047,7 @@
           (hflip #f)
           (vflip #f))
         (decal
-          (id "0x97c14b0")
+          (id "0xa4aff30")
           (pos 664 0)
           (parent "")
           (select-mask 1)
@@ -959,7 +1058,7 @@
           (hflip #t)
           (vflip #f))
         (decal
-          (id "0x97ee2b0")
+          (id "0xa4af000")
           (pos 800 7)
           (parent "")
           (select-mask 1)



From grumbel at mail.berlios.de  Thu Apr 23 07:57:46 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Thu, 23 Apr 2009 07:57:46 +0200
Subject: [Windstille-commit] r2950 - in trunk/windstille: . data
Message-ID: <200904230557.n3N5vkZS011775@sheep.berlios.de>

Author: grumbel
Date: 2009-04-23 07:57:44 +0200 (Thu, 23 Apr 2009)
New Revision: 2950

Added:
   trunk/windstille/data/SConscript
Modified:
   trunk/windstille/SConstruct
Log:
Experimenting with building .png out of .xcf automatically

Modified: trunk/windstille/SConstruct
===================================================================
--- trunk/windstille/SConstruct	2009-04-23 05:48:52 UTC (rev 2949)
+++ trunk/windstille/SConstruct	2009-04-23 05:57:44 UTC (rev 2950)
@@ -205,5 +205,6 @@
 
 SConscript('external/SConscript')
 SConscript('src/SConscript')
+SConscript('data/SConscript')
 
 # EOF #

Added: trunk/windstille/data/SConscript
===================================================================
--- trunk/windstille/data/SConscript	2009-04-23 05:48:52 UTC (rev 2949)
+++ trunk/windstille/data/SConscript	2009-04-23 05:57:44 UTC (rev 2950)
@@ -0,0 +1,30 @@
+##  -*- python -*-
+##  Windstille - A Sci-Fi Action-Adventure Game
+##  Copyright (C) 2000,2005 Ingo Ruhnke <grumbel at gmx.de>
+##
+##  This program is free software: you can redistribute it and/or modify
+##  it under the terms of the GNU General Public License as published by
+##  the Free Software Foundation, either version 3 of the License, or
+##  (at your option) any later version.
+##  
+##  This program is distributed in the hope that it will be useful,
+##  but WITHOUT ANY WARRANTY; without even the implied warranty of
+##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+##  GNU General Public License for more details.
+##  
+##  You should have received a copy of the GNU General Public License
+##  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+
+import glob
+
+Import('conf_env', 'features')
+
+data_env = conf_env.Clone()
+
+data_env.Append(BUILDERS = { "xcf2png" : Builder(action = "xcf2png $SOURCE -o $TARGET",
+                                                 suffix = ".png") })
+
+for filename in glob.glob("images/decal/*.xcf"):
+    data_env.xcf2png(filename)
+
+# EOF #



From grumbel at mail.berlios.de  Sat Apr 25 23:59:31 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sat, 25 Apr 2009 23:59:31 +0200
Subject: [Windstille-commit] r2951 - trunk/windstille/src/math
Message-ID: <200904252159.n3PLxVNI005770@sheep.berlios.de>

Author: grumbel
Date: 2009-04-25 23:59:30 +0200 (Sat, 25 Apr 2009)
New Revision: 2951

Modified:
   trunk/windstille/src/math/size.hpp
Log:
Added operator<<

Modified: trunk/windstille/src/math/size.hpp
===================================================================
--- trunk/windstille/src/math/size.hpp	2009-04-23 05:57:44 UTC (rev 2950)
+++ trunk/windstille/src/math/size.hpp	2009-04-25 21:59:30 UTC (rev 2951)
@@ -37,6 +37,8 @@
 #pragma once
 #endif
 
+#include <iostream>
+
 class Sizef;
 
 //: 2D (width,height) size structure.
@@ -158,4 +160,9 @@
 	  height(static_cast<int>(s.height))
 {}
 
+inline std::ostream& operator<<(std::ostream& s, const Size& size) 
+{
+  return s << "Size(" << size.width << ", " << size.height << ")";
+}
+
 #endif



From grumbel at mail.berlios.de  Sun Apr 26 00:00:11 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sun, 26 Apr 2009 00:00:11 +0200
Subject: [Windstille-commit] r2952 - trunk/windstille/src/editor
Message-ID: <200904252200.n3PM0BrC005921@sheep.berlios.de>

Author: grumbel
Date: 2009-04-26 00:00:10 +0200 (Sun, 26 Apr 2009)
New Revision: 2952

Modified:
   trunk/windstille/src/editor/sector_model.cpp
Log:
Minor cleanup

Modified: trunk/windstille/src/editor/sector_model.cpp
===================================================================
--- trunk/windstille/src/editor/sector_model.cpp	2009-04-25 21:59:30 UTC (rev 2951)
+++ trunk/windstille/src/editor/sector_model.cpp	2009-04-25 22:00:10 UTC (rev 2952)
@@ -340,9 +340,9 @@
   bool visible = true;;
   bool locked  = false;
 
-  reader.get("name", name);
+  reader.get("name",    name);
   reader.get("visible", visible);
-  reader.get("locked", locked);
+  reader.get("locked",  locked);
   reader.get("objects", objects_reader);
 
   //std::cout << "loading layer: " << reader.get_name() << " " << name << " " << visible << " " << locked << std::endl;



From grumbel at mail.berlios.de  Sun Apr 26 00:00:55 2009
From: grumbel at mail.berlios.de (grumbel at BerliOS)
Date: Sun, 26 Apr 2009 00:00:55 +0200
Subject: [Windstille-commit] r2953 - in trunk/windstille/src: display editor
Message-ID: <200904252200.n3PM0tiI006032@sheep.berlios.de>

Author: grumbel
Date: 2009-04-26 00:00:55 +0200 (Sun, 26 Apr 2009)
New Revision: 2953

Modified:
   trunk/windstille/src/display/display.cpp
   trunk/windstille/src/editor/editor_window.cpp
   trunk/windstille/src/editor/editor_window.hpp
   trunk/windstille/src/editor/main.cpp
   trunk/windstille/src/editor/windstille_widget.cpp
   trunk/windstille/src/editor/windstille_widget.hpp
Log:
Added screenshot support to the editor, kind of buggy, but somewhat working

Modified: trunk/windstille/src/display/display.cpp
===================================================================
--- trunk/windstille/src/display/display.cpp	2009-04-25 22:00:10 UTC (rev 2952)
+++ trunk/windstille/src/display/display.cpp	2009-04-25 22:00:55 UTC (rev 2953)
@@ -473,29 +473,33 @@
 void
 Display::save_screenshot(const std::string& filename)
 {
-  SDL_Surface* window = SDL_GetVideoSurface();
+  GLint viewport[4];
+  glGetIntegerv(GL_VIEWPORT, viewport);
+  Size size(viewport[2], viewport[3]);
 
-  const int width  = window->w;
-  const int height = window->h;
+  std::cout << "Viewpoint: " << size << std::endl;
 
-  int len = width * height * 3;
+  size.width /= 4;
+  size.width *= 4;
 
+  int len = size.width * size.height * 3;
+  
   boost::scoped_array<GLbyte> pixels(new GLbyte[len]);
 
-  glReadPixels(0, 0, width, height, GL_RGB, GL_UNSIGNED_BYTE, pixels.get());
+  glReadPixels(0, 0, size.width, size.height, GL_RGB, GL_UNSIGNED_BYTE, pixels.get());
 
   if (0)
     {
-      int pitch = width * 3;
+      int pitch = size.width * 3;
 
       // save to ppm
       std::ofstream out(filename.c_str());
       out << "P6\n"
           << "# Windstille Screenshot\n"
-          << width << " " << height << "\n"
+          << size.width << " " << size.height << "\n"
           << "255\n";
       
-      for(int y = height-1; y >= 0; --y)
+      for(int y = size.height-1; y >= 0; --y)
         out.write(reinterpret_cast<const char*>(pixels.get() + y*pitch), pitch);
 
       out.close();
@@ -503,10 +507,10 @@
   else if (0) // BMP saving
     {
 #if SDL_BYTEORDER == SDL_BIG_ENDIAN
-      SDL_Surface* surface = SDL_CreateRGBSurfaceFrom(pixels.get(), width, height, 24, width*3,
+      SDL_Surface* surface = SDL_CreateRGBSurfaceFrom(pixels.get(), size.width, size.height, 24, size.width*3,
                                                       0xff000000, 0x00ff0000, 0x0000ff00, 0x000000ff);
 #else
-      SDL_Surface* surface = SDL_CreateRGBSurfaceFrom(pixels.get(), width, height, 24, width*3,
+      SDL_Surface* surface = SDL_CreateRGBSurfaceFrom(pixels.get(), size.width, size.height, 24, size.width*3,
                                                       0x000000ff, 0x0000ff00, 0x00ff0000, 0xff000000);
 #endif
 
@@ -524,7 +528,7 @@
         }
       else
         {
-          int pitch   = width * 3;
+          int pitch   = size.width * 3;
           png_structp png_ptr;
           png_infop   info_ptr;
 
@@ -534,7 +538,7 @@
           png_init_io(png_ptr, fp);
 
           png_set_IHDR(png_ptr, info_ptr, 
-                       width, height, 8 /* bitdepth */,
+                       size.width, size.height, 8 /* bitdepth */,
                        PNG_COLOR_TYPE_RGB,
                        PNG_INTERLACE_NONE, 
                        PNG_COMPRESSION_TYPE_BASE, 
@@ -543,11 +547,11 @@
           png_set_compression_level(png_ptr, 6);
           png_write_info(png_ptr, info_ptr);
 
-          boost::scoped_array<png_bytep> row_pointers(new png_bytep[height]);
+          boost::scoped_array<png_bytep> row_pointers(new png_bytep[size.height]);
    
           // generate row pointers
-          for (int k = 0; k < height; k++)
-            row_pointers[k] = reinterpret_cast<png_byte*>(pixels.get() + ((height - k - 1) * pitch));
+          for (int k = 0; k < size.height; k++)
+            row_pointers[k] = reinterpret_cast<png_byte*>(pixels.get() + ((size.height - k - 1) * pitch));
 
           png_write_image(png_ptr, row_pointers.get());
 

Modified: trunk/windstille/src/editor/editor_window.cpp
===================================================================
--- trunk/windstille/src/editor/editor_window.cpp	2009-04-25 22:00:10 UTC (rev 2952)
+++ trunk/windstille/src/editor/editor_window.cpp	2009-04-25 22:00:55 UTC (rev 2953)
@@ -80,6 +80,8 @@
     "      <menuitem action='Save'/>"
     "      <menuitem action='SaveAs'/>"
     "      <separator/>"
+    "      <menuitem action='SaveScreenshot'/>"
+    "      <separator/>"
     "      <menuitem action='Close'/>"
     "      <menuitem action='Quit'/>"
     "    </menu>"
@@ -212,6 +214,10 @@
   action_group->add(Gtk::Action::create("Quit",        Gtk::Stock::QUIT),
                     sigc::mem_fun(*this, &EditorWindow::on_quit));
 
+  action_group->add(Gtk::Action::create_with_icon_name("SaveScreenshot", "saveas", "Save Screenshot", "Save Screenshot"),
+                    Gtk::AccelKey(GDK_F12, Gdk::CONTROL_MASK),
+                    sigc::mem_fun(*this, &EditorWindow::on_save_screenshot));
+
   {
     Glib::RefPtr<Gtk::RecentAction> recent_action = Gtk::RecentAction::create("FileRecentFiles", Gtk::Stock::OPEN);
 
@@ -566,6 +572,50 @@
 }
 
 void
+EditorWindow::on_save_screenshot()
+{
+  int page = notebook.get_current_page();
+  if (page == -1)
+    {
+      // do nothing;
+    }
+  else
+    {
+      if (WindstilleWidget* wst = static_cast<WindstilleWidget*>(notebook.get_nth_page(page)))
+        {
+          Gtk::FileChooserDialog dialog("Save Screenshot",
+                                        Gtk::FILE_CHOOSER_ACTION_SAVE);
+          dialog.set_transient_for(*this);
+          dialog.set_do_overwrite_confirmation(true);
+
+          dialog.add_button(Gtk::Stock::CANCEL, Gtk::RESPONSE_CANCEL);
+          dialog.add_button(Gtk::Stock::SAVE,   Gtk::RESPONSE_OK);
+
+
+ 
+          dialog.set_current_folder("/tmp/");
+
+          switch(dialog.run())
+            {
+              case(Gtk::RESPONSE_OK):
+                {
+                  std::string filename = dialog.get_filename();
+                  std::cout << "unimplemented screenshot: " << filename << std::endl;
+                  wst->save_screenshot(filename);
+                  break;
+                }
+
+              case(Gtk::RESPONSE_CANCEL):
+                {
+                  //std::cout << "Cancel clicked." << std::endl;
+                  break;
+                }
+            }
+        }
+    }
+}
+
+void
 EditorWindow::on_close()
 {
   int page = notebook.get_current_page();

Modified: trunk/windstille/src/editor/editor_window.hpp
===================================================================
--- trunk/windstille/src/editor/editor_window.hpp	2009-04-25 22:00:10 UTC (rev 2952)
+++ trunk/windstille/src/editor/editor_window.hpp	2009-04-25 22:00:55 UTC (rev 2953)
@@ -105,6 +105,7 @@
   void on_open();
   void on_save();
   void on_save_as();
+  void on_save_screenshot();
   void on_close();
 
   bool on_timeout();

Modified: trunk/windstille/src/editor/main.cpp
===================================================================
--- trunk/windstille/src/editor/main.cpp	2009-04-25 22:00:10 UTC (rev 2952)
+++ trunk/windstille/src/editor/main.cpp	2009-04-25 22:00:55 UTC (rev 2953)
@@ -49,7 +49,8 @@
       PHYSFS_addToSearchPath("data/", 0);
       
       Glib::RefPtr<const Gdk::GL::Config> 
-        glconfig = Gdk::GL::Config::create(Gdk::GL::MODE_RGB |
+        glconfig = Gdk::GL::Config::create(/* FIXME: Using RGBA instead of RGB to make Display::save_screenshot work*/
+                                           Gdk::GL::MODE_RGBA | 
                                            //Gdk::GL::MODE_DEPTH);
                                            Gdk::GL::MODE_DOUBLE);
       if (!glconfig)

Modified: trunk/windstille/src/editor/windstille_widget.cpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.cpp	2009-04-25 22:00:10 UTC (rev 2952)
+++ trunk/windstille/src/editor/windstille_widget.cpp	2009-04-25 22:00:55 UTC (rev 2953)
@@ -868,6 +868,18 @@
   control_points.clear();
   selection->add_control_points(control_points);
 }
+
+void
+WindstilleWidget::save_screenshot(const std::string& filename)
+{
+  Glib::RefPtr<Gdk::GL::Window> glwindow = get_gl_window();
+
+  if (glwindow->gl_begin(get_gl_context()))
+    {
+      Display::save_screenshot(filename);
+      glwindow->gl_end();
+    }
+}
 
 SectorModel*
 WindstilleWidget::get_sector_model()

Modified: trunk/windstille/src/editor/windstille_widget.hpp
===================================================================
--- trunk/windstille/src/editor/windstille_widget.hpp	2009-04-25 22:00:10 UTC (rev 2952)
+++ trunk/windstille/src/editor/windstille_widget.hpp	2009-04-25 22:00:55 UTC (rev 2953)
@@ -164,6 +164,8 @@
 
   void on_selection_change();
 
+  void save_screenshot(const std::string& filename);
+
 private:
   WindstilleWidget (const WindstilleWidget&);
   WindstilleWidget& operator= (const WindstilleWidget&);



