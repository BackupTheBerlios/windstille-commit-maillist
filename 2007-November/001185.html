<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Windstille-commit] r1535 - trunk/griv
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/windstille-commit/2007-November/index.html" >
   <LINK REL="made" HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r1535%20-%20trunk/griv&In-Reply-To=%3C200711131650.lADGorRm020224%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001184.html">
   <LINK REL="Next"  HREF="001186.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Windstille-commit] r1535 - trunk/griv</H1>
    <B>grumbel at BerliOS</B> 
    <A HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r1535%20-%20trunk/griv&In-Reply-To=%3C200711131650.lADGorRm020224%40sheep.berlios.de%3E"
       TITLE="[Windstille-commit] r1535 - trunk/griv">grumbel at mail.berlios.de
       </A><BR>
    <I>Tue Nov 13 17:50:53 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="001184.html">[Windstille-commit] r1534 - trunk/griv
</A></li>
        <LI>Next message: <A HREF="001186.html">[Windstille-commit] r1536 - trunk/griv
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1185">[ date ]</a>
              <a href="thread.html#1185">[ thread ]</a>
              <a href="subject.html#1185">[ subject ]</a>
              <a href="author.html#1185">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: grumbel
Date: 2007-11-13 17:50:52 +0100 (Tue, 13 Nov 2007)
New Revision: 1535

Modified:
   trunk/griv/griv.cpp
   trunk/griv/image.hpp
   trunk/griv/loader.cpp
   trunk/griv/workspace.hpp
Log:
- center viewport on startup

Modified: trunk/griv/griv.cpp
===================================================================
--- trunk/griv/griv.cpp	2007-11-13 16:21:11 UTC (rev 1534)
+++ trunk/griv/griv.cpp	2007-11-13 16:50:52 UTC (rev 1535)
@@ -124,6 +124,12 @@
       workspace-&gt;add(argv[i]);
     }
 
+  {
+    int w = int(sqrt(4 * workspace-&gt;size() / 3));
+    x_offset = (-w/2) * 16;
+    y_offset = (-(w*3/4)/2) * 16;
+  }
+  
   drag_n_drop = false;
   old_res = -1;
   old_x_offset = -1;

Modified: trunk/griv/image.hpp
===================================================================
--- trunk/griv/image.hpp	2007-11-13 16:21:11 UTC (rev 1534)
+++ trunk/griv/image.hpp	2007-11-13 16:50:52 UTC (rev 1535)
@@ -69,6 +69,7 @@
   std::string url;
   std::string md5;
 
+  SDL_Surface* surface_16x16;
   SDL_Surface* surface;
   int res;
   bool image_requested;

Modified: trunk/griv/loader.cpp
===================================================================
--- trunk/griv/loader.cpp	2007-11-13 16:21:11 UTC (rev 1534)
+++ trunk/griv/loader.cpp	2007-11-13 16:50:52 UTC (rev 1535)
@@ -79,7 +79,7 @@
       std::string m = this-&gt;md5(url);
       out &lt;&lt; Filesystem::get_home() &lt;&lt; &quot;/.griv/cache/by_url/&quot;
           &lt;&lt; res &lt;&lt; &quot;/&quot; &lt;&lt; m.substr(0,2) &lt;&lt; &quot;/&quot; &lt;&lt; m.substr(2) &lt;&lt; &quot;.jpg&quot;;
-      std::cout &lt;&lt; &quot;Debug: &quot; &lt;&lt; url &lt;&lt; &quot; &quot; &lt;&lt; this-&gt;md5(url) &lt;&lt; std::endl;
+      //std::cout &lt;&lt; &quot;Debug: &quot; &lt;&lt; url &lt;&lt; &quot; &quot; &lt;&lt; this-&gt;md5(url) &lt;&lt; std::endl;
     }
 
   SDL_LockMutex(mutex);

Modified: trunk/griv/workspace.hpp
===================================================================
--- trunk/griv/workspace.hpp	2007-11-13 16:21:11 UTC (rev 1534)
+++ trunk/griv/workspace.hpp	2007-11-13 16:50:52 UTC (rev 1535)
@@ -45,6 +45,8 @@
 
   void zoom_in(int x, int y);
   void zoom_out(int x, int y);
+
+  int size() { return images.size(); }
 };
 
 #endif


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001184.html">[Windstille-commit] r1534 - trunk/griv
</A></li>
	<LI>Next message: <A HREF="001186.html">[Windstille-commit] r1536 - trunk/griv
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1185">[ date ]</a>
              <a href="thread.html#1185">[ thread ]</a>
              <a href="subject.html#1185">[ subject ]</a>
              <a href="author.html#1185">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/windstille-commit">More information about the Windstille-commit
mailing list</a><br>
</body></html>
