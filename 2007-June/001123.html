<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Windstille-commit] r1471 - trunk/windstille/tools/sdl-jstest
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/windstille-commit/2007-June/index.html" >
   <LINK REL="made" HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r1471%20-%20trunk/windstille/tools/sdl-jstest&In-Reply-To=%3C200706192215.l5JMF1ud016069%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001122.html">
   <LINK REL="Next"  HREF="001124.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Windstille-commit] r1471 - trunk/windstille/tools/sdl-jstest</H1>
    <B>grumbel at BerliOS</B> 
    <A HREF="mailto:windstille-commit%40lists.berlios.de?Subject=Re%3A%20%5BWindstille-commit%5D%20r1471%20-%20trunk/windstille/tools/sdl-jstest&In-Reply-To=%3C200706192215.l5JMF1ud016069%40sheep.berlios.de%3E"
       TITLE="[Windstille-commit] r1471 - trunk/windstille/tools/sdl-jstest">grumbel at mail.berlios.de
       </A><BR>
    <I>Wed Jun 20 00:15:01 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="001122.html">[Windstille-commit] r1470 - in trunk: scripts windstille	windstille/src windstille/tools windstille/tools/sdl-jstest
</A></li>
        <LI>Next message: <A HREF="001124.html">[Windstille-commit] r1472 - in trunk/windstille/src: . input
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1123">[ date ]</a>
              <a href="thread.html#1123">[ thread ]</a>
              <a href="subject.html#1123">[ subject ]</a>
              <a href="author.html#1123">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: grumbel
Date: 2007-06-20 00:15:01 +0200 (Wed, 20 Jun 2007)
New Revision: 1471

Modified:
   trunk/windstille/tools/sdl-jstest/sdl-jstest.c
Log:
- made sdl-jstest a little prettier

Modified: trunk/windstille/tools/sdl-jstest/sdl-jstest.c
===================================================================
--- trunk/windstille/tools/sdl-jstest/sdl-jstest.c	2007-06-19 20:27:19 UTC (rev 1470)
+++ trunk/windstille/tools/sdl-jstest/sdl-jstest.c	2007-06-19 22:15:01 UTC (rev 1471)
@@ -55,7 +55,7 @@
   if (endptr == str) {
     return 0;
   }
-  
+
   return 1;
 }
 
@@ -80,7 +80,7 @@
   printf(&quot;Options:\n&quot;);
   printf(&quot;  --list             Search for available joysticks and list their properties\n&quot;);
   printf(&quot;  --test  JOYNUM     Display a graphical representation of the current joystick state\n&quot;);
-  printf(&quot;  --event JOYNUM     Display the events that are recieved by the joystick\n&quot;);
+  printf(&quot;  --event JOYNUM     Display the events that are recieved from the joystick\n&quot;);
   printf(&quot;  --help             Print this help\n&quot;);
   printf(&quot;\n&quot;);
   printf(&quot;Examples:\n&quot;);
@@ -97,7 +97,7 @@
     }
 
   // FIXME: We don't need video, but without it SDL will fail to work in SDL_WaitEvent()
-  if(SDL_Init(SDL_INIT_TIMER | SDL_INIT_VIDEO | SDL_INIT_JOYSTICK) &lt; 0)  
+  if(SDL_Init(SDL_INIT_TIMER | SDL_INIT_VIDEO | SDL_INIT_JOYSTICK) &lt; 0)
     {
       fprintf(stderr, &quot;Unable to init SDL: %s\n&quot;, SDL_GetError());
       exit(1);
@@ -119,7 +119,7 @@
             {
               printf(&quot;No joysticks were found\n&quot;);
             }
-          else 
+          else
             {
               printf(&quot;Found %d joystick(s)\n\n&quot;, num_joysticks);
               for(int joy_idx = 0; joy_idx &lt; num_joysticks; ++joy_idx)
@@ -156,21 +156,21 @@
             {
               initscr();
 
-              //cbreak(); 
+              //cbreak();
               //noecho();
-              //nonl();  
+              //nonl();
               curs_set(0);
 
               int num_axes    = SDL_JoystickNumAxes(joy);
               int num_buttons = SDL_JoystickNumButtons(joy);
               int num_hats    = SDL_JoystickNumHats(joy);
               int num_balls   = SDL_JoystickNumBalls(joy);
-              
+
               Sint16* axes    = calloc(num_axes,    sizeof(Sint16));
               Uint8*  buttons = calloc(num_buttons, sizeof(Uint8));
               Uint8*  hats    = calloc(num_hats,    sizeof(Uint8));
               Uint8*  balls   = calloc(num_balls,   2*sizeof(Sint16));
-              
+
               int quit = 0;
               SDL_Event event;
               while(!quit)
@@ -204,18 +204,18 @@
                         quit = 1;
                         printf(&quot;Recieved interrupt, exiting\n&quot;);
                         break;
-                      
+
                       default:
                         fprintf(stderr, &quot;Error: Unhandled event type: %d\n&quot;, event.type);
-                      }                
+                      }
                   } else {
                     fprintf(stderr, &quot;Error in SDL_WaitEvent\n&quot;);
                     quit = 1;
                   }
-                  
+
                   //clear();
                   move(0,0);
-                  
+
                   printw(&quot;Joystick Name:   '%s'\n&quot;, SDL_JoystickName(joy_idx));
                   printw(&quot;Joystick Number: %d\n&quot;, joy_idx);
                   printw(&quot;\n&quot;);
@@ -240,23 +240,33 @@
                   printw(&quot;Hats %2d:\n&quot;, num_hats);
                   for(int i = 0; i &lt; num_hats; ++i)
                     {
-                      printw(&quot;  %2d: %d\n&quot;, i, hats[i]);
-                      printw(&quot;  +---+\n&quot;
-                             &quot;  |%c%c%c|\n&quot;
-                             &quot;  |%c%c%c|\n&quot;
-                             &quot;  |%c%c%c|\n&quot;
-                             &quot;  +---+\n&quot;,
-                             ((hats[i] &amp; SDL_HAT_UP) &amp;&amp; (hats[i] &amp; SDL_HAT_LEFT)) ? '#' : ' ',
-                             ((hats[i] &amp; SDL_HAT_UP) &amp;&amp; !(hats[i] &amp; (SDL_HAT_LEFT | SDL_HAT_RIGHT))) ? '#' : ' ',
-                             ((hats[i] &amp; SDL_HAT_UP) &amp;&amp; (hats[i] &amp; SDL_HAT_RIGHT)) ? '#' : ' ',
+                      printw(&quot;  %2d: value: %d\n&quot;, i, hats[i]);
+                      printw(&quot;  +-----+  up:    %c\n&quot;
+                             &quot;  |%c %c %c|  down:  %c\n&quot;
+                             &quot;  |%c %c %c|  left:  %c\n&quot;
+                             &quot;  |%c %c %c|  right: %c\n&quot;
+                             &quot;  +-----+\n&quot;,
 
-                             (!(hats[i] &amp; (SDL_HAT_UP | SDL_HAT_DOWN)) &amp;&amp; (hats[i] &amp; SDL_HAT_LEFT)) ? '#' : ' ',
-                             (!(hats[i] &amp; (SDL_HAT_UP | SDL_HAT_DOWN)) &amp;&amp; !(hats[i] &amp; (SDL_HAT_LEFT | SDL_HAT_RIGHT))) ? '#' : ' ',
-                             (!(hats[i] &amp; (SDL_HAT_UP | SDL_HAT_DOWN)) &amp;&amp; (hats[i] &amp; SDL_HAT_RIGHT)) ? '#' : ' ',
+                             (hats[i] &amp; SDL_HAT_UP)?'1':'0',
 
-                             ((hats[i] &amp; SDL_HAT_DOWN) &amp;&amp; (hats[i] &amp; SDL_HAT_LEFT)) ? '#' : ' ',
-                             ((hats[i] &amp; SDL_HAT_DOWN) &amp;&amp; !(hats[i] &amp; (SDL_HAT_LEFT | SDL_HAT_RIGHT))) ? '#' : ' ',
-                             ((hats[i] &amp; SDL_HAT_DOWN) &amp;&amp; (hats[i] &amp; SDL_HAT_RIGHT)) ? '#' : ' ');                    }
+                             ((hats[i] &amp; SDL_HAT_UP) &amp;&amp; (hats[i] &amp; SDL_HAT_LEFT)) ? 'O' : ' ',
+                             ((hats[i] &amp; SDL_HAT_UP) &amp;&amp; !(hats[i] &amp; (SDL_HAT_LEFT | SDL_HAT_RIGHT))) ? 'O' : ' ',
+                             ((hats[i] &amp; SDL_HAT_UP) &amp;&amp; (hats[i] &amp; SDL_HAT_RIGHT)) ? 'O' : ' ',
+
+                             (hats[i] &amp; SDL_HAT_DOWN)?'1':'0',
+
+                             (!(hats[i] &amp; (SDL_HAT_UP | SDL_HAT_DOWN)) &amp;&amp; (hats[i] &amp; SDL_HAT_LEFT)) ? 'O' : ' ',
+                             (!(hats[i] &amp; (SDL_HAT_UP | SDL_HAT_DOWN)) &amp;&amp; !(hats[i] &amp; (SDL_HAT_LEFT | SDL_HAT_RIGHT))) ? 'O' : ' ',
+                             (!(hats[i] &amp; (SDL_HAT_UP | SDL_HAT_DOWN)) &amp;&amp; (hats[i] &amp; SDL_HAT_RIGHT)) ? 'O' : ' ',
+
+                             (hats[i] &amp; SDL_HAT_LEFT)?'1':'0',
+
+                             ((hats[i] &amp; SDL_HAT_DOWN) &amp;&amp; (hats[i] &amp; SDL_HAT_LEFT)) ? 'O' : ' ',
+                             ((hats[i] &amp; SDL_HAT_DOWN) &amp;&amp; !(hats[i] &amp; (SDL_HAT_LEFT | SDL_HAT_RIGHT))) ? 'O' : ' ',
+                             ((hats[i] &amp; SDL_HAT_DOWN) &amp;&amp; (hats[i] &amp; SDL_HAT_RIGHT)) ? 'O' : ' ',
+
+                             (hats[i] &amp; SDL_HAT_RIGHT)?'1':'0');
+                    }
                   printw(&quot;\n&quot;);
 
                   printw(&quot;Balls %2d: &quot;, num_balls);
@@ -267,7 +277,7 @@
                   printw(&quot;\n&quot;);
                   printw(&quot;\n&quot;);
                   printw(&quot;Press Ctrl-c to exit\n&quot;);
-                  
+
                   refresh();
                 } // while
 
@@ -275,7 +285,7 @@
               free(hats);
               free(buttons);
               free(axes);
-              
+
               endwin();
             }
         }
@@ -307,26 +317,26 @@
                   switch(event.type)
                     {
                     case SDL_JOYAXISMOTION:
-                      printf(&quot;SDL_JOYAXISMOTION: joystick: %d axis: %d value: %d\n&quot;, 
+                      printf(&quot;SDL_JOYAXISMOTION: joystick: %d axis: %d value: %d\n&quot;,
                              event.jaxis.which, event.jaxis.axis, event.jaxis.value);
                       break;
 
                     case SDL_JOYBUTTONDOWN:
-                      printf(&quot;SDL_JOYBUTTONUP: joystick: %d button: %d state: %d\n&quot;, 
+                      printf(&quot;SDL_JOYBUTTONUP: joystick: %d button: %d state: %d\n&quot;,
                              event.jbutton.which, event.jbutton.button, event.jbutton.state);
                       break;
                     case SDL_JOYBUTTONUP:
-                      printf(&quot;SDL_JOYBUTTONDOWN: joystick: %d button: %d state: %d\n&quot;, 
+                      printf(&quot;SDL_JOYBUTTONDOWN: joystick: %d button: %d state: %d\n&quot;,
                              event.jbutton.which, event.jbutton.button, event.jbutton.state);
                       break;
 
                     case SDL_JOYHATMOTION:
-                      printf(&quot;SDL_JOYHATMOTION: joystick: %d hat: %d value: %d\n&quot;, 
+                      printf(&quot;SDL_JOYHATMOTION: joystick: %d hat: %d value: %d\n&quot;,
                              event.jhat.which, event.jhat.hat, event.jhat.value);
                       break;
 
                     case SDL_JOYBALLMOTION:
-                      printf(&quot;SDL_JOYBALLMOTION: joystick: %d ball: %d x: %d y: %d\n&quot;, 
+                      printf(&quot;SDL_JOYBALLMOTION: joystick: %d ball: %d x: %d y: %d\n&quot;,
                              event.jball.which, event.jball.ball, event.jball.xrel, event.jball.yrel);
                       break;
 
@@ -334,14 +344,14 @@
                       quit = 1;
                       printf(&quot;Recieved interrupt, exiting\n&quot;);
                       break;
-                      
+
                     default:
                       fprintf(stderr, &quot;Error: Unhandled event type: %d\n&quot;, event.type);
                     }
                 }
               SDL_JoystickClose(joy);
-              
-            }      
+
+            }
           fprintf(stderr, &quot;Unable to init SDL: %s\n&quot;, SDL_GetError());
         }
       else


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001122.html">[Windstille-commit] r1470 - in trunk: scripts windstille	windstille/src windstille/tools windstille/tools/sdl-jstest
</A></li>
	<LI>Next message: <A HREF="001124.html">[Windstille-commit] r1472 - in trunk/windstille/src: . input
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1123">[ date ]</a>
              <a href="thread.html#1123">[ thread ]</a>
              <a href="subject.html#1123">[ subject ]</a>
              <a href="author.html#1123">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/windstille-commit">More information about the Windstille-commit
mailing list</a><br>
</body></html>
